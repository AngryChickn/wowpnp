"abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g,function(b){document.createElement(b)});(function(f){f.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(h,g){f.fx.step[g]=function(j){if(j.state==0){j.start=d(j.elem,g);j.end=c(j.end)}j.elem.style[g]="rgb("+[Math.max(Math.min(parseInt((j.pos*(j.end[0]-j.start[0]))+j.start[0]),255),0),Math.max(Math.min(parseInt((j.pos*(j.end[1]-j.start[1]))+j.start[1]),255),0),Math.max(Math.min(parseInt((j.pos*(j.end[2]-j.start[2]))+j.start[2]),255),0)].join(",")+")"}});function c(h){var g;if(h&&h.constructor==Array&&h.length==3){return h}if(g=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(h)){return[parseInt(g[1]),parseInt(g[2]),parseInt(g[3])]}if(g=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(h)){return[parseFloat(g[1])*2.55,parseFloat(g[2])*2.55,parseFloat(g[3])*2.55]}if(g=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(h)){return[parseInt(g[1],16),parseInt(g[2],16),parseInt(g[3],16)]}if(g=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(h)){return[parseInt(g[1]+g[1],16),parseInt(g[2]+g[2],16),parseInt(g[3]+g[3],16)]}return b[f.trim(h).toLowerCase()]}function d(j,g){var h;do{h=f.curCSS(j,g);if(h!=""&&h!="transparent"||f.nodeName(j,"body")){break}g="backgroundColor"}while(j=j.parentNode);return c(h)}var b={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);var swfobject=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var b=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,g=aB.userAgent.toLowerCase(),d=aB.platform.toLowerCase(),k=d?/win/.test(d):/win/.test(g),m=d?/mac/.test(d):/mac/.test(g),j=/webkit/.test(g)?parseFloat(g.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,f=!+"\v1",h=[0,0,0],n=null;if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){n=aB.plugins[ab].description;if(n&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;f=false;n=n.replace(/^.*\s+(\S+\s+\S+$)/,"$1");h[0]=parseInt(n.replace(/^(.*)\..*$/,"$1"),10);h[1]=parseInt(n.replace(/^.*\.(.*)\s.*$/,"$1"),10);h[2]=/[a-zA-Z]/.test(n)?parseInt(n.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof af.ActiveXObject!=aq){try{var l=new ActiveXObject(X);if(l){n=l.GetVariable("$version");if(n){f=true;n=n.split(" ")[1].split(",");h=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)]}}}catch(c){}}}return{w3:b,pv:h,wk:j,ie:f,win:k,mac:m}}(),aK=function(){if(!ah.w3){return}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP()}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false)}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);aP()}});if(af==top){(function(){if(ak){return}try{aL.documentElement.doScroll("left")}catch(b){setTimeout(arguments.callee,0);return}aP()})()}}if(ah.wk){(function(){if(ak){return}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);return}aP()})()}aC(aP)}}();function aP(){if(ak){return}try{var c=aL.getElementsByTagName("body")[0].appendChild(ar("span"));c.parentNode.removeChild(c)}catch(b){return}ak=true;var f=Z.length;for(var d=0;d<f;d++){Z[d]()}}function aj(b){if(ak){b()}else{Z[Z.length]=b}}function aC(b){if(typeof af.addEventListener!=aq){af.addEventListener("load",b,false)}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",b,false)}else{if(typeof af.attachEvent!=aq){aM(af,"onload",b)}else{if(typeof af.onload=="function"){var c=af.onload;af.onload=function(){c();b()}}else{af.onload=b}}}}}function aN(){if(aa){Y()}else{am()}}function Y(){var f=aL.getElementsByTagName("body")[0];var c=ar(aD);c.setAttribute("type",aE);var b=f.appendChild(c);if(b){var d=0;(function(){if(typeof b.GetVariable!=aq){var g=b.GetVariable("$version");if(g){g=g.split(" ")[1].split(",");ah.pv=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]}}else{if(d<10){d++;setTimeout(arguments.callee,10);return}}f.removeChild(c);b=null;am()})()}else{am()}}function am(){var j=aG.length;if(j>0){for(var k=0;k<j;k++){var d=aG[k].id;var o=aG[k].callbackFn;var b={success:false,id:d};if(ah.pv[0]>0){var l=aS(d);if(l){if(ao(aG[k].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(d,true);if(o){b.success=true;b.ref=av(d);o(b)}}else{if(aG[k].expressInstall&&au()){var g={};g.data=aG[k].expressInstall;g.width=l.getAttribute("width")||"0";g.height=l.getAttribute("height")||"0";if(l.getAttribute("class")){g.styleclass=l.getAttribute("class")}if(l.getAttribute("align")){g.align=l.getAttribute("align")}var h={};var f=l.getElementsByTagName("param");var n=f.length;for(var m=0;m<n;m++){if(f[m].getAttribute("name").toLowerCase()!="movie"){h[f[m].getAttribute("name")]=f[m].getAttribute("value")}}ae(g,h,d,o)}else{aF(l);if(o){o(b)}}}}}else{ay(d,true);if(o){var c=av(d);if(c&&typeof c.SetVariable!=aq){b.success=true;b.ref=c}o(b)}}}}}function av(c){var f=null;var d=aS(c);if(d&&d.nodeName=="OBJECT"){if(typeof d.SetVariable!=aq){f=d}else{var b=d.getElementsByTagName(aD)[0];if(b){f=b}}}return f}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312)}function ae(h,f,k,g){aU=true;ap=g||null;at={success:false,id:k};var b=aS(k);if(b){if(b.nodeName=="OBJECT"){aJ=aO(b);ad=null}else{aJ=b;ad=k}h.id=ac;if(typeof h.width==aq||(!/%$/.test(h.width)&&parseInt(h.width,10)<310)){h.width="310"}if(typeof h.height==aq||(!/%$/.test(h.height)&&parseInt(h.height,10)<137)){h.height="137"}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";var c=ah.ie&&ah.win?"ActiveX":"PlugIn",d="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+c+"&MMdoctitle="+aL.title;if(typeof f.flashvars!=aq){f.flashvars+="&"+d}else{f.flashvars=d}if(ah.ie&&ah.win&&b.readyState!=4){var j=ar("div");k+="SWFObjectNew";j.setAttribute("id",k);b.parentNode.insertBefore(j,b);b.style.display="none";(function(){if(b.readyState==4){b.parentNode.removeChild(b)}else{setTimeout(arguments.callee,10)}})()}aA(h,f,k)}}function aF(b){if(ah.ie&&ah.win&&b.readyState!=4){var c=ar("div");b.parentNode.insertBefore(c,b);c.parentNode.replaceChild(aO(b),c);b.style.display="none";(function(){if(b.readyState==4){b.parentNode.removeChild(b)}else{setTimeout(arguments.callee,10)}})()}else{b.parentNode.replaceChild(aO(b),b)}}function aO(c){var f=ar("div");if(ah.win&&ah.ie){f.innerHTML=c.innerHTML}else{var g=c.getElementsByTagName(aD)[0];if(g){var b=g.childNodes;if(b){var h=b.length;for(var d=0;d<h;d++){if(!(b[d].nodeType==1&&b[d].nodeName=="PARAM")&&!(b[d].nodeType==8)){f.appendChild(b[d].cloneNode(true))}}}}}return f}function aA(g,j,d){var f,b=aS(d);if(ah.wk&&ah.wk<312){return f}if(b){if(typeof g.id==aq){g.id=d}if(ah.ie&&ah.win){var h="";for(var l in g){if(g[l]!=Object.prototype[l]){if(l.toLowerCase()=="data"){j.movie=g[l]}else{if(l.toLowerCase()=="styleclass"){h+=' class="'+g[l]+'"'}else{if(l.toLowerCase()!="classid"){h+=" "+l+'="'+g[l]+'"'}}}}}var k="";for(var m in j){if(j[m]!=Object.prototype[m]){k+='<param name="'+m+'" value="'+j[m]+'" />'}}b.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+h+">"+k+"</object>";ag[ag.length]=g.id;f=aS(g.id)}else{var c=ar(aD);c.setAttribute("type",aE);for(var n in g){if(g[n]!=Object.prototype[n]){if(n.toLowerCase()=="styleclass"){c.setAttribute("class",g[n])}else{if(n.toLowerCase()!="classid"){c.setAttribute(n,g[n])}}}}for(var o in j){if(j[o]!=Object.prototype[o]&&o.toLowerCase()!="movie"){aQ(c,o,j[o])}}b.parentNode.replaceChild(c,b);f=c}}return f}function aQ(c,f,d){var b=ar("param");b.setAttribute("name",f);b.setAttribute("value",d);c.appendChild(b)}function aw(b){var c=aS(b);if(c&&c.nodeName=="OBJECT"){if(ah.ie&&ah.win){c.style.display="none";(function(){if(c.readyState==4){aT(b)}else{setTimeout(arguments.callee,10)}})()}else{c.parentNode.removeChild(c)}}}function aT(b){var c=aS(b);if(c){for(var d in c){if(typeof c[d]=="function"){c[d]=null}}c.parentNode.removeChild(c)}}function aS(b){var d=null;try{d=aL.getElementById(b)}catch(c){}return d}function ar(b){return aL.createElement(b)}function aM(b,d,c){b.attachEvent(d,c);al[al.length]=[b,d,c]}function ao(b){var c=ah.pv,d=b.split(".");d[0]=parseInt(d[0],10);d[1]=parseInt(d[1],10)||0;d[2]=parseInt(d[2],10)||0;return(c[0]>d[0]||(c[0]==d[0]&&c[1]>d[1])||(c[0]==d[0]&&c[1]==d[1]&&c[2]>=d[2]))?true:false}function az(c,h,b,d){if(ah.ie&&ah.mac){return}var g=aL.getElementsByTagName("head")[0];if(!g){return}var j=(b&&typeof b=="string")?b:"screen";if(d){aH=null;an=null}if(!aH||an!=j){var f=ar("style");f.setAttribute("type","text/css");f.setAttribute("media",j);aH=g.appendChild(f);if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1]}an=j}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(c,h)}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(c+" {"+h+"}"))}}}function ay(b,d){if(!aI){return}var c=d?"visible":"hidden";if(ak&&aS(b)){aS(b).style.visibility=c}else{az("#"+b,"visibility:"+c)}}function ai(c){var b=/[\\\"<>\.;]/;var d=b.exec(c)!=null;return d&&typeof encodeURIComponent!=aq?encodeURIComponent(c):c}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var b=al.length;for(var c=0;c<b;c++){al[c][0].detachEvent(al[c][1],al[c][2])}var f=ag.length;for(var d=0;d<f;d++){aw(ag[d])}for(var g in ah){ah[g]=null}ah=null;for(var h in swfobject){swfobject[h]=null}swfobject=null})}}();return{registerObject:function(b,g,d,c){if(ah.w3&&b&&g){var f={};f.id=b;f.swfVersion=g;f.expressInstall=d;f.callbackFn=c;aG[aG.length]=f;ay(b,false)}else{if(c){c({success:false,id:b})}}},getObjectById:function(b){if(ah.w3){return av(b)}},embedSWF:function(n,g,k,h,d,b,c,l,j,m){var f={success:false,id:g};if(ah.w3&&!(ah.wk&&ah.wk<312)&&n&&g&&k&&h&&d){ay(g,false);aj(function(){k+="";h+="";var t={};if(j&&typeof j===aD){for(var r in j){t[r]=j[r]}}t.data=n;t.width=k;t.height=h;var q={};if(l&&typeof l===aD){for(var s in l){q[s]=l[s]}}if(c&&typeof c===aD){for(var o in c){if(typeof q.flashvars!=aq){q.flashvars+="&"+o+"="+c[o]}else{q.flashvars=o+"="+c[o]}}}if(ao(d)){var p=aA(t,q,g);if(t.id==g){ay(g,true)}f.success=true;f.ref=p}else{if(b&&au()){t.data=b;ae(t,q,g,m);return}else{ay(g,true)}}if(m){m(f)}})}else{if(m){m(f)}}},switchOffAutoHideShow:function(){aI=false},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]}},hasFlashPlayerVersion:ao,createSWF:function(b,c,d){if(ah.w3){return aA(b,c,d)}else{return undefined}},showExpressInstall:function(c,b,f,d){if(ah.w3&&au()){ae(c,b,f,d)}},removeSWF:function(b){if(ah.w3){aw(b)}},createCSS:function(c,b,d,f){if(ah.w3){az(c,b,d,f)}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(c){var b=aL.location.search||aL.location.hash;if(b){if(/\?/.test(b)){b=b.split("?")[1]}if(c==null){return ai(b)}var d=b.split("&");for(var f=0;f<d.length;f++){if(d[f].substring(0,d[f].indexOf("="))==c){return ai(d[f].substring((d[f].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(aU){var b=aS(ac);if(b&&aJ){b.parentNode.replaceChild(aJ,b);if(ad){ay(ad,true);if(ah.ie&&ah.win){aJ.style.display="block"}}if(ap){ap(at)}}aU=false}}}}();var g_localTime=new Date();var g_blogimages={};if(WH.isSet("INSTART")&&WH.isSet("g_user")&&g_user.hasOwnProperty("roles")&&(g_user.roles&U_GROUP_PREMIUM_PERMISSIONS)){(function(){var b;try{b="sessionStorage" in window&&window.sessionStorage!==null}catch(c){b=false}if(b){try{sessionStorage.setItem("test","123");b=sessionStorage.getItem("test")=="123";sessionStorage.removeItem("test")}catch(c){b=false}}if(!b){if(WH.isDev()){console.log("Cannot bounce out of Instart because sessionStorage is not supported.")}return}if(sessionStorage.getItem("performedInstartReload")=="yes"){if(WH.isDev()){console.log("Cannot bounce out of Instart because we already tried this session.")}return}if(/[\.\/]g\d+[\.\/]/.test(location.href)){if(WH.isDev()){console.log("Cannot bounce out of Instart because location.href contains Instart URL.")}return}sessionStorage.setItem("performedInstartReload","yes");location.href=location.href})()}function MessageBox(b,d){b.find(".wh-message-box").remove();var c=$("<div></div>");c.hide();c.addClass("wh-message-box");c.html('<div class="message">'+d+'</div><div class="close" title="Click on this box to close it"></div>');c.click(function(){$(this).fadeOut()});b.append(c[0]);c.fadeIn()}function Rectangle(f,d,c,b){this.l=f;this.t=d;this.r=f+c;this.b=d+b}Rectangle.prototype={intersectWith:function(b){return !(this.l>=b.r||b.l>=this.r||this.t>=b.b||b.t>=this.b)},contains:function(b){return(this.l<=b.l&&this.t<=b.t&&this.r>=b.r&&this.b>=b.b)},containedIn:function(b){return b.contains(this)}};WH.aE(window,"load",function(){if(!(window.JSON&&WH.localStorage.isSupported())){return}var m=WH.localStorage.get("lvBrowse");if(!m){return}m=window.JSON.parse(m);if(!m){return}var r=/^\/[-a-z]+=\d+/i;var n=r.exec(location.pathname);if(!n){return}n=n[0];var g=function(b,d){if(!d){return WH.ce("i",{className:"fa fa-"+b})}return WH.ce("a",{className:"fa fa-"+b,href:d})};for(var o=0;o<m.length;o++){var q=m[o].urls;for(var l=0;l<q.length;l++){if(q[l]==n){var f=l>0?q[l-1]:false;var j=(l+1)<q.length?q[l+1]:false;var p=m[o].path+m[o].hash;var c=$(".header-browse");if(!c.length){return}var k=c[0];var h=g("arrow-circle-up",p);WH.Tooltip.simple(h,LANG.backtolist,"q2");WH.ae(k,g("arrow-circle-left",f));WH.ae(k,h);WH.ae(k,g("arrow-circle-right",j));k.style.display="block";return}}}});WH.smoothScroll=function(c,b){switch(typeof c){case"string":case"object":case"jQuery":var d=$(c).offset();if(!d){return}c=d.top;break;case"number":break;default:return}if(PageTemplate.Responsive.isZulInMobileMode()){c-=50}else{c-=10}$("html, body").animate({scrollTop:c},b||500)};WH.dynamicFixedElements={};WH.setupDynamicFixedElement=function(d,g){var m=$(g);if(!m.length){return}var l="dynamic-fixed-element-initialized";if(m.data(l)){WH.error("Can't set up an element to be dynamically fixed multiple times!",d,g);return}WH.dynamicFixedElements[d]={fixed:false,offset:false};var h=m.parent();var k=function(p,n,o,r,q){if(!WH.dynamicFixedElements[p].fixed||q){b(p,n);n.addClass("fixed-"+p).css("right",($(window).width()-r.left-o.width())+"px");if(n.outerHeight()+10>$(window).height()){n.addClass("scrollable-"+p)}WH.dynamicFixedElements[p].fixed=true}};var f=function(o,n){if(WH.dynamicFixedElements[o].fixed){n.removeClass("fixed-"+o).removeClass("scrollable-"+o).css("right","");WH.dynamicFixedElements[o].fixed=false}};var c=function(o,n,p,q){if(!WH.dynamicFixedElements[o].offset||q){n.css("margin-top",p+"px");WH.dynamicFixedElements[o].offset=true}};var b=function(o,n){if(WH.dynamicFixedElements[o].offset){n.css("margin-top","");WH.dynamicFixedElements[o].offset=false}};var j=(function(q,o,p,u){var t=p.get(0).getBoundingClientRect();var n=10;if(PageTemplate.Responsive.isZulInMobileMode()){n+=40}if(t.top<n){var r=(p.height()||0)-(o.height()||0);var s=t.top*-1;s+=n;if(s<r){b(q,o);k(q,o,p,p.offset(),u)}else{f(q,o);c(q,o,Math.min(s,r),u)}}else{f(q,o);b(q,o)}}).bind(null,d,m,h);$(window).scroll(j).resize(j.bind(true));j();m.data(l,true)};WH.getReputationPlusAchievementText=function(b,g,f,d){var h=WH.getAchievementText(b,g,f,true);var j=$("<span>").addClass("wsach-pts");j.mouseover(function(k){WH.Tooltip.showAtCursor(k,LANG.reputationtip,0,0,"q")}).mousemove(function(k){WH.Tooltip.cursorUpdate(k)}).mouseout(function(){WH.Tooltip.hide()});j.css("color","white");j.text(WH.numberFormat(d));var c=$("<span>");c.append(" (");c.append(j);c.append(" &ndash; ");c.append(h);c.append(") ");return c};WH.getAchievementText=function(b,h,g,c){var d=$("<span>").addClass("wsach-pts");d.mouseover(function(j){WH.Tooltip.showAtCursor(j,LANG.userachcount_tip,0,0,"q")}).mousemove(function(j){WH.Tooltip.cursorUpdate(j)}).mouseout(function(){WH.Tooltip.hide()});var f=" ";if(!c){f+=" ("}if(b){f+="<i>"+b+"</i>&middot;"}if(h){f+="<b>"+h+"</b>&middot;"}if(!g){g=0}f+="<u>"+g+"</u>";if(!c){f+=")"}d.html(f);return d};WH.formatTimeElapsed=function(g){function c(p,o,n){if(n&&LANG.timeunitsab[o]==""){n=0}if(n){return p+" "+LANG.timeunitsab[o]}else{return p+" "+(p==1?LANG.timeunitssg[o]:LANG.timeunitspl[o])}}var h=[31557600,2629800,604800,86400,3600,60,1];var k=[1,3,3,-1,5,-1,-1];g=Math.max(g,1);for(var f=3,j=h.length;f<j;++f){if(g>=h[f]){var d=f;var m=Math.floor(g/h[d]);if(k[d]!=-1){var b=k[d];g%=h[d];var l=Math.floor(g/h[b]);if(l>0){return c(m,d,1)+" "+c(l,b,1)}}return c(m,d,0)}}return"(n/a)"};WH.getStaffColorFromRoles=function(b){if(b&U_GROUP_ADMIN){return"comment-blue"}if(b&U_GROUP_GREEN_TEXT){return"comment-green"}if(b&U_GROUP_VIP){return"comment-gold"}if(b&U_GROUP_PREMIUMISH){return"comment-gold"}return""};WH.formatDate=function(c,m,g,d,l){var h=new Date();var b=new Date();b.setTime(h.getTime()-(1000*m));var f;var o=new Date(b.getYear(),b.getMonth(),b.getDate());var n=new Date(h.getYear(),h.getMonth(),h.getDate());var k=(n.getTime()-o.getTime());k/=1000;k/=86400;k=Math.round(k);if(m>=2592000){f=LANG.date_on+WH.formatDateSimple(g,d)}else{if(k>1){f=WH.sprintf(LANG.ddaysago,k);if(c){var j=new Date();j.setTime(g.getTime()+(g_localTime-g_serverTime));c.className+=" tip";c.title=j.toLocaleString()}}else{if(m>=43200){if(h.getDay()==b.getDay()){f=LANG.today}else{f=LANG.yesterday}f=WH.formatTimeSimple(b,f);if(c){var j=new Date();j.setTime(g.getTime()+(g_localTime-g_serverTime));c.className+=" tip";c.title=j.toLocaleString()}}else{f=WH.sprintf(LANG.date_ago,WH.formatTimeElapsed(m));if(c){var j=new Date();j.setTime(g.getTime()+(g_localTime-g_serverTime));c.className+=" tip";c.title=j.toLocaleString()}}}}if(l==1){f=f.substr(0,1).toUpperCase()+f.substr(1)}if(c){WH.ae(c,WH.ct(f))}else{return f}};WH.formatDateSimple=function(l,k){function h(b){return(b<10?"0"+b:b)}var c="",f=l.getDate(),j=l.getMonth()+1,g=l.getFullYear();if(g<=1970){c+=LANG.unknowndate_stc}else{c+=WH.sprintf(LANG.date_simple,h(f),h(j),g)}if(k!=null){c=WH.formatTimeSimple(l,c)}return c};WH.formatTimeSimple=function(j,b,f){function h(d){return(d<10?"0"+d:d)}var c=j.getHours(),g=j.getMinutes();if(b==null){b=""}b+=(f?" ":LANG.date_at);if(c==12){b+=LANG.noon}else{if(c==0){b+=LANG.midnight}else{if(c>12){b+=(c-12)+":"+h(g)+" "+LANG.pm}else{b+=c+":"+h(g)+" "+LANG.am}}}return b};WH.formatStartEndDates=function(c,f){if(!c&&!f){return""}var j=false;var g=false;if(c){j=new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate())}if(f){g=new Date(f.getUTCFullYear(),f.getUTCMonth(),f.getUTCDate())}var l="";if(!g){l=LANG.tab_starts+" "+j.toLocaleDateString()}else{if(!j){l=LANG.tab_ends+" "+g.toLocaleDateString()}else{var h=(function(){try{new Date().toLocaleDateString("i")}catch(n){return n.name==="RangeError"}return false})();var d={month:"long",year:"numeric"};var m="",k="",b=0;if(h&&(j.getDate()==1)){m=j.toLocaleDateString(undefined,d);b++}else{m=j.toLocaleDateString()}if(h&&((new Date(g.valueOf()+36*60*60*1000)).getMonth()!=g.getMonth())){k=g.toLocaleDateString(undefined,d);b++}else{k=g.toLocaleDateString()}if(m==k){l=m}else{if(b==1){l=j.toLocaleDateString()+" - "+g.toLocaleDateString()}else{l=m+" - "+k}}}}return l};WH.createTextGlow=function(l,g){var f=WH.ce("span");for(var c=-1;c<=1;++c){for(var b=-1;b<=1;++b){var k=WH.ce("div");k.style.position="absolute";k.style.whiteSpace="nowrap";k.style.left=c+"px";k.style.top=b+"px";if(c==0&&b==0){k.style.zIndex=4}else{k.style.color="black";k.style.zIndex=2}k.innerHTML=l;WH.ae(f,k)}}f.style.position="relative";f.className="glow"+(g!=null?" "+g:"");var h=WH.ce("span");h.style.visibility="hidden";h.innerHTML+=l;WH.ae(f,h);return f};WH.createProgressBar=function(d){if(d==null){d={}}if(typeof d.text=="undefined"){d.text=" "}if(d.color==null){d.color="rep0"}if(d.width==null||d.width>100){d.width=100}var f,g;if(d.hoverText){f=WH.ce("a");f.href="javascript:;"}else{f=WH.ce("span")}f.className="progressbar";if(d.text||d.hoverText){g=WH.ce("div");g.className="progressbar-text";if(d.text){var b=WH.ce("del");WH.ae(b,WH.ct(d.text));WH.ae(g,b)}if(d.hoverText){var c=WH.ce("ins");WH.ae(c,WH.ct(d.hoverText));WH.ae(g,c)}WH.ae(f,g)}g=WH.ce("div");g.className="progressbar-"+d.color;g.style.width=d.width+"%";if(d.height){g.style.height=d.height}WH.ae(g,WH.ct(String.fromCharCode(160)));WH.ae(f,g);if(d.text){var g=WH.ce("div");g.className="progressbar-text progressbar-hidden";WH.ae(g,WH.ct(d.text));WH.ae(f,g)}return f};WH.createReputationBar=function(c,f){if(!f){f=0}var h=WH.getReputationProgress(f);var g=h.length>0?(h[h.length-1][1]+999):0;if(!c){c=0}if(c<0){c=0}else{if(c>g){c=g}}var k=c,d=0,l,j=g;if(g!=0){while(d<h.length){if(c<h[d][1]){break}++d}--d;k-=h[d][1];j=(d+1<h.length)?(h[d+1][1]-h[d][1]):999}if(f){l=g_friendship_reactions[WH.sprintf("$1-$2",f,d)]}else{l=g_reputation_standings[d]}var b={text:l,hoverText:k+" / "+j,color:"rep"+d,width:parseInt(k/j*100)};return WH.createProgressBar(b)};WH.getReputationProgress=function(b){if(WH.isSet("g_friendships_thresholds")&&b&&g_friendships_thresholds[b]&&WH.isArray(g_friendships_thresholds[b])){return g_friendships_thresholds[b]}return[[0,0],[0,36000],[0,39000],[0,42000],[0,45000],[0,51000],[0,63000],[0,84000]]};WH.createAchievementBar=function(f,d,c,g){if(!f){f=0}var b={text:f+(g>0?"(+"+g+")":"")+(d>0?" / "+d:""),color:(c?"rep7":"ach"+(d>0?0:1)),width:(d>0?parseInt(f/d*100):100)};return WH.createProgressBar(b)};WH.addCompletionIcons=function(k,f,j,d){var g=0;for(var b in g_user.lists){var h=g_user.lists[b];if(!(h.id in g_completion[f])||!h.character){continue}var c=WH.inArray(g_completion[f][h.id],j)!=-1;if(d&&!c){continue}WH.ae(k,WH.createCompletionIcon(h,c));g++}return g};WH.createCompletionIcon=function(f,d,b){var c=WH.ce("a");c.href="/list="+f.id+"/"+f.url;c.className="progress-icon "+(d?"progress-8":"progress-0");WH.Tooltip.simple(c,WH.getCompletionTooltip(f,d),"",true);if(b){c.rel=b}return c};WH.getCompletionTooltip=function(c,b){return'<span class="q">'+(b?LANG.lvcompletion.identical:LANG.lvcompletion.missing)+LANG.colon+'</span><br><span style="white-space:nowrap"><b class="c'+c.classs+'">'+c.character+'</b><span class="q0">&nbsp; '+c.realm+" "+c.region+"</span></span>"};WH.getCompletionFlags=function(d,g){var b=0;if(!g_user.lists){return b}for(var c=g_user.lists.length-1;c>=0;c--){var f=g_user.lists[c];if(!(f.id in g_completion[d])||!f.character){continue}b=(b<<1)|(WH.inArray(g_completion[d][f.id],g)!=-1?1:0)}return b};WH.getMoneyHtml=function(b,k,c,g,p){var n=0,f="";if(k==1||k=="alliance"){k=1}else{if(k==2||k=="horde"){k=2}else{k=3}}if(b>=10000){n=1;var j=Math.floor(b/10000);f+='<span class="moneygold">'+WH.numberFormat(j)+"</span>";b%=10000}if(b>=100){if(n){f+=" "}else{n=1}var j=Math.floor(b/100);f+='<span class="moneysilver">'+j+"</span>";b%=100}if(b>=1){if(n){f+=" "}else{n=1}f+='<span class="moneycopper">'+b+"</span>"}if(c!=null){for(var d=0;d<c.length;++d){if(n){f+=" "}else{n=1}var m=c[d][0];var h=c[d][1];var l=(g_items[m]&&g_items[m].icon?g_items[m].icon:"inv_misc_questionmark");f+='<a href="/item='+m+'" class="moneyitem" style="background-image: url('+g_staticUrl+"/images/wow/icons/tiny/"+l.toLowerCase()+'.gif)">'+h+"</a>"}}if(g!=null){for(var d=0;d<g.length;++d){if(n){f+=" "}else{n=1}var o=g[d][0];var h=g[d][1];var l=(g_gatheredcurrencies[o]&&g_gatheredcurrencies[o].icon?g_gatheredcurrencies[o].icon:["inv_misc_questionmark","inv_misc_questionmark"]);if(k==3&&l[0]==l[1]){k=1}f+='<a href="/currency='+o+'" class="icontinyr tip q1" onmouseover="Listview.funcBox.moneyCurrencyOver('+o+", "+h+', event)" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()" style="background-image: url('+g_staticUrl+"/images/wow/icons/tiny/"+l[(k==3?1:k-1)].toLowerCase()+'.gif)">'+(k==3?'<span class="icontinyr" style="background-image: url('+g_staticUrl+"/images/wow/icons/tiny/"+l[0].toLowerCase()+'.gif)">':"")+h+(k==3?"</span>":"")+"</a>"}}if(p>0){if(n){f+=" "}else{n=1}f+='<span class="moneyachievement tip" onmouseover="Listview.funcBox.moneyAchievementOver(event)" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()">'+WH.numberFormat(p)+"</span>"}return f};WH.preventPageScroll=function(b){var c=(b.originalEvent&&b.originalEvent.wheelDelta)||(b.originalEvent&&-b.originalEvent.detail)||b.wheelDelta||-b.detail;this.scrollTop+=(c<0?1:-1)*100;b.preventDefault()};WH.pickerWheel=function(b){b=WH.normalizeEvent(b);if(b._wheelDelta<0){this.scrollTop+=27}else{this.scrollTop-=27}};WH.setSelectedLink=function(d,c){if(!WH.setSelectedLink.groups){WH.setSelectedLink.groups={}}var b=WH.setSelectedLink.groups;if(b[c]){b[c].className=b[c].className.replace("selected","")}d.className+=" selected";b[c]=d};WH.addPagination=function(n,f){function p(t,d){var s;if(t==f.page){s=WH.ce("span");s.className="selected"}else{s=WH.ce("a");s.href=(t>1?f.url+f.sep+t+f.pound:f.url+f.pound)}WH.ae(s,WH.ct(d!=null?d:t));return s}if(!f.pound){f.pound=""}if(!f.sep){f.sep="."}if(f.allOrNothing&&f.nPages<=1){return}var l=(f.align&&f.align=="left");var g=WH.ce("div"),o,r=WH.ce("var");g.className="pages";if(l){g.className+=" pages-left"}if(f.nPages>1){o=WH.ce("div");o.className="pages-numbers";var q=Math.max(2,f.page-2);var k=Math.min(f.nPages-1,f.page+2);var b=[];if(f.page!=f.nPages){b.push(p(f.page+1,String.fromCharCode(187)))}b.push(p(f.nPages));if(k<f.nPages-1){var c=WH.ce("span");WH.ae(c,WH.ct("..."));b.push(c)}for(var j=k;j>=q;--j){b.push(p(j))}if(q>2){var c=WH.ce("span");WH.ae(c,WH.ct("..."));b.push(c)}b.push(p(1));if(f.page!=1){b.push(p(f.page-1,String.fromCharCode(171)))}if(l){b.reverse()}for(var j=0,m=b.length;j<m;++j){WH.ae(o,b[j])}o.firstChild.style.marginRight="0";o.lastChild.style.marginLeft="0"}var r=WH.ce("var");WH.ae(r,WH.ct(WH.sprintf(LANG[f.wording[f.nItems==1?0:1]],f.nItems)));if(f.nPages>1){var c=WH.ce("span");WH.ae(c,WH.ct(String.fromCharCode(8211)));WH.ae(r,c);var h=WH.ce("a");h.className="gotopage";h.href="javascript:;";WH.disableOldIESelect(h);h.onclick=function(){var d=prompt(WH.sprintf(LANG.prompt_gotopage,1,f.nPages),f.page);if(d!=null){d|=0;if(d!=f.page&&d>=1&&d<=f.nPages){document.location.href=(d>1?f.url+f.sep+d+f.pound:f.url+f.pound)}}};h.onmouseover=function(d){WH.Tooltip.showAtCursor(d,LANG.tooltip_gotopage,0,0,"q2")};h.onmousemove=WH.Tooltip.cursorUpdate;h.onmouseout=WH.Tooltip.hide;WH.ae(r,h)}if(l){WH.ae(g,r);if(o){WH.ae(g,o)}}else{if(o){WH.ae(g,o)}WH.ae(g,r)}WH.ae(n,g)};WH.disclose=function(b,c){c.className="disclosure-"+(WH.toggleDisplay(b)?"on":"off");return false};WH.toggle=function(b){this.className=this.className.replace(/toggler-(on|off)/,"toggler-"+(WH.toggleDisplay(b,true)?"on":"off"));return false};WH.setupChangeWarning=function(g,h,c){if(!g){return}function d(){return c}g.submit(function(){window.onbeforeunload=null});var f=[];for(var b in h){var j=h[b];if(!j){continue}f[b]=j.val();j.keydown(function(){for(var k in h){var l=h[k];if(!l){continue}if(l.val()!=f[k]){window.onbeforeunload=d;return}window.onbeforeunload=null}})}};$(document).ready(function(){$("dfn").each(function(){var b=$(this).attr("title");$(this).attr("title","").addClass("tip").mouseover(function(c){WH.Tooltip.showAtCursor(c,b,0,0,"q")}).mousemove(function(c){WH.Tooltip.cursorUpdate(c)}).mouseout(function(){WH.Tooltip.hide()})});$(".text").bind("copy",function(){$("*[unselectable]",this).each(function(d,c){var b=$(c).text();$(c).text("");setTimeout(function(){$(c).text(b)},1)})})});WH.getExpansionClassName=function(b){switch(b){case 0:return null;case 1:return"icon-bc-right";case 2:return"icon-wotlk-right";case 3:return"icon-cata-right";case 4:return"icon-mop-right";case 5:return"icon-warlords-right";case 6:return"icon-legion-right";case 7:return"icon-bfa-right"}return"icon-unknown"+b+"-right"};$(document).ready(function(){$("input").each(function(){var f=$(this).attr("maxlength");var d=$(this).attr("data-charwarning");var b=d?$("#"+d):null;if(!f||!b){return}var c=function(){b.hide()};var g=function(l){var h=f-l;var m=l/f;var k=parseInt((m>=0.5)?255:(m*2*255)).toString(16);var j=parseInt((m<0.5)?255:(255-((m-0.5)*2*255))).toString(16);if(k.length==1){k="0"+k}if(j.length==1){j="0"+j}b.text(WH.sprintf(LANG.charactersremaining_format,h));b.show();b.css("color","#"+k+j+"00")};$(this).focus(function(){g($(this).val().length)}).blur(function(){c()}).keyup(function(){g($(this).val().length)})})});WH.getN5=function(b){var c=Math.abs(b);if(c<10000){return WH.numberFormat(b)}if(c<100000){return(Math.round(b/100)/10)+"k"}if(c<1000000){return Math.round(b/1000)+"k"}if(c<10000000){return(Math.round(b/1000/10)/100)+"m"}if(c<100000000){return(Math.round(b/1000/100)/10)+"m"}if(c<1000000000){return Math.round(b/1000/1000)+"m"}if(c<10000000000){return(Math.round(b/1000/1000/10)/100)+"b"}if(c<10000000000){return(Math.round(b/1000/1000/100)/10)+"b"}return Math.round(b/1000/1000/1000)+"b"};WH.debug=function(b){if(!WH.isDev()&&!User.hasPermissions(U_GROUP_ADMIN)){WH.debug=function(){};return}WH.debug=function(){var f=["DEBUG:"];var g=null;try{var c=(new Error).stack.split("\n");if(typeof c[2]==="string"){var d=c[2].replace(/^ *at /,"");g=d.match(/(.*) \(([^()]+)\)$/);if(g){if(WH.suppressExternalDebug()&&g[2].indexOf(g_staticUrl)===-1){return}f.push(g[1])}else{f.push(d)}}}catch(h){}f=f.concat(Array.prototype.slice.call(arguments));if(g){f.push(g[2])}WH.log.apply(this,f)};WH.debug.apply(this,Array.prototype.slice.call(arguments))};WH.decodeNumber=function(g,c){var d=0;g=g+"";var h=1;while(g.length>0){var f=g.charAt(g.length-1);var b=c.indexOf(f);if(b===-1){return null}d+=b*h;h*=c.length;g=g.substr(0,g.length-1)}return d};WH.encodeNumber=function(j,g){var c=g.length;var d=[j];while(d[0]>c){var k=Math.floor(d[0]/c);d[0]=d[0]-(k*c);d.unshift(k)}var f="";for(var h=0,b=d.length;h<b;h++){f+=g.charAt(d[h])}return f};WH.userIsLoggedIn=function(){return typeof g_user=="object"&&g_user.id};WH.getMajorHeading=function(g,b,f,c){if(isNaN(b)||b<1||b>6){b=2}if(isNaN(f)||f<1||f>6){f=b}var d=["heading-size-"+f];return WH.constructHeading("h"+b,g,d,c)};WH.getImitationHeading=function(f,d,b){if(isNaN(d)||d<1||d>6){d=2}var c=["imitation-heading","heading-size-"+d];return WH.constructHeading("div",f,c,b)};WH.constructHeading=function(b,g,f,c){if(typeof c!="object"){c={}}if(typeof c.classes=="string"){f.push(c.classes)}var h=WH.ce(b);h.className=f.join(" ");if(typeof c.styles=="string"){h.style=c.styles}if(typeof c.id=="string"){h.id=c.id}if(typeof g=="string"){h.innerHTML=g}else{if(g.nodeType===1||g.nodeType===3){h.appendChild(g)}else{$(h).append(g)}}if(c.asString){var d=WH.ce("div");WH.ae(d,h);return d.innerHTML}return h};WH.createRange=function(f,b){var c={};for(var d=f;d<=b;++d){c[d]=d}return c};WH.objectToArray=function(b,f){var d=[];for(var c in b){if(b.hasOwnProperty(c)){d.push({property:c,value:b[c]})}}if(f){d.sort(function(h,g){return WH.stringCompare(h[f],g[f])})}return d};WH.sortIdArray=function(c,b,d){c.sort(d?function(g,f){return WH.stringCompare(b[g][d],b[f][d])}:function(g,f){return WH.stringCompare(b[g],b[f])})};WH.sortJsonArray=function(g,c,h,f){var b=[];for(var d in g){if(g.hasOwnProperty(d)&&c[d]&&(f==null||f(c[d]))){b.push(d)}}if(h!=null){b.sort(h)}else{WH.sortIdArray(b,c)}return b};WH.sortObjectArray=function(g,c){for(var b=0,f;f=c[b];b++){var d=1;if(f.substr(0,1)==="-"){d=-1;f=f.substr(1)}g.sort((function(l,k,j,h){if(j[l]===h[l]){return 1*k}if(typeof j[l]==="string"||typeof h[l]==="string"){return WH.stringCompare(""+j[l],""+h[l])*k}return(j[l]>h[l]?1:-1)*k}).bind(null,f,d))}};WH.isEqualSimpleObject=function(f,d){for(var c in f){if(typeof f[c]=="object"){if(typeof d[c]!="object"){return false}if(!WH.isEqualSimpleObject(f[c],d[c])){return false}}else{if(f[c]!==d[c]){return false}}}for(var b in d){if(typeof d[b]=="object"){if(typeof f[b]!="object"){return false}if(!WH.isEqualSimpleObject(f[b],d[b])){return false}}else{if(f[b]!==d[b]){return false}}}return true};WH.urlize=function(d,c,f){if(typeof d!=="string"){WH.error("Tried to URLize an invalid value.",d);return""}var b=WH.ce("textarea");b.innerHTML=d.replace(/</g,"&lt;").replace(/>/g,"&gt;");d=b.value;if(f){if(f==="enus"){d=d.replace(" & "," and ")}else{d=d.replace(LANG.wordspace+LANG.ampersand+LANG.wordspace,LANG.wordspace+LANG.and+LANG.wordspace)}}d=d.replace(/%\w|['#]|^\s*|\s*$/g,"");if(c){d=d.replace(/ \/ |_|[^\u00C0-\u1FFF\u2C00-\uD7FF\w]+/g,"-")}else{d=WH.removeAccents(d).replace(/ \/ |_|[^a-z0-9]/ig,"-")}d=d.replace(/-{2,}/g,"-");d=d.replace(/^-+|-+$/g,"");d=d.toLocaleLowerCase();d=d.substr(0,80);return d};WH.deUrlize=function(c){var f=c.split("-");var b="";for(var d=0;d<f.length;d++){if(b){b+=" "}b+=WH.ucfirst(f[d])}return b};WH.ensureUrlProtocol=function(b,c){if(c){if(!c.match(/:$/)){c+=":"}return b.replace(/^https?:/,c).replace(/^(\/[^\/])/,c+"//"+location.host+"$1").replace(/^(\/\/)/,c+"$1")}else{return b.replace(/^(\/[^\/])/,location.protocol+"//"+location.host+"$1").replace(/^(\/\/)/,location.protocol+"$1")}};WH.getTinyIconUrl=function(b){return b.indexOf("/")!=-1?b:g_staticUrl+"/images/wow/icons/tiny/"+b.toLowerCase()+".gif"};WH.removeAccents=function(f){var d=f;var c=[["ß","á","ä","à","â","è","ê","é","ë","í","î","ì","ï","ñ","ò","ó","ö","ô","ú","ü","û","ù","œ","Á","Ä","À","Â","È","Ê","É","Ë","Í","Î","Ì","Ï","Ñ","Ò","Ó","Ö","Ô","Ú","Ü","Û","Ù","œ"],["ss","a","a","a","a","e","e","e","e","i","i","i","i","n","o","o","o","o","u","u","u","u","oe","A","A","A","A","E","E","E","E","I","I","I","I","N","O","O","O","O","U","U","U","U","Oe"]];for(var b=0;b<c[0].length;b++){d=d.replace(new RegExp(c[0][b],"g"),c[1][b])}return d};WH.isDateValid=function(b){return/^(20[0-2]\d)-([01]\d)-([0-3]\d) ([0-2]\d):([0-5]\d):([0-5]\d)$/.exec(b)};WH.isIpAddress=function(b){return/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/.test(b)};WH.isEmailValid=function(b){if(b.length>64){return false}return b.match(/^([a-z0-9._-]+)(\+[a-z0-9._-]+)?(@[a-z0-9.-]+\.[a-z]{2,})$/i)!=null};WH.getCurrentDomain=function(){if(WH.getCurrentDomain.CACHE){return WH.getCurrentDomain.CACHE}var b=location.hostname;if(!WH.isIpAddress(b)){var c=b.split(".");if(c.length>2){c.splice(0,c.length-2)}b=c.join(".")}WH.getCurrentDomain.CACHE=b;return b};WH.getCommentDomain=function(b){if(!WH.isPtr()&&b=="ptr"){return"//ptr.wowhead.com"}else{if(!WH.isBeta()&&b=="beta"){return"//beta.wowhead.com"}}return""};WH.isExternalUrl=function(b){return !(!b||(b.indexOf("http")!=0&&b.indexOf("//")!=0)||b.indexOf("wowhead.com")!=-1||b.indexOf("wowheadnews.")!=-1||b.indexOf(WH.getCurrentDomain())!=-1)};WH.getRelativeHostPrefix=function(){var c=true;if(WH.isDev()){c=location.protocol==="https:"}var g=c?"_https":"_http";if(!WH.getRelativeHostPrefix.CACHE){WH.getRelativeHostPrefix.CACHE={}}if(g in WH.getRelativeHostPrefix.CACHE){return WH.getRelativeHostPrefix.CACHE[g]}var d="";if(c!==(location.protocol==="https:")&&!/^[0-9\.]+$/.test(location.hostname)){var f=/^([\w\W]*)\.[^\.]+\.com$/.exec(location.hostname);f=f?f[1]:"www";var b="";if(location.port){b=location.port}if(b.substr(0,1)!==":"){b=":"+b}if(b===":80"||b===":"){b=""}d="https://"+f+".wowhead.com"+b}if(!c){d=d.replace(/^https:/,"http:")}WH.getRelativeHostPrefix.CACHE[g]=d;return d};WH.fixWowheadHttps=function(b){if(WH.isDev()){return b.replace(/\bhttps?:(\/\/(?:[^\/:]+\.)?(?:wowhead\.com|zamimg\.com)[:\/])/g,"$1")}return b.replace(/\bhttp:(\/\/(?:[^\/:]+\.)?(?:wowhead\.com|zamimg\.com)[:\/])/g,"https:$1")};WH.getLoginUrl=function(c){if(typeof c==="undefined"){c=location.pathname}var b="/account=signin";if(typeof c==="string"){c=c.replace(/^\//,"");if(c){b+="?next="+encodeURIComponent(c)}}return b};WH.goToLoginPage=function(b){window.location=WH.getLoginUrl(b)};WH.createOrRegex=function(f,c){f=f.replace(/(\(|\)|\|\+|\*|\?|\$|\^)/g,"\\$1");var h=f.split(" "),g="";for(var d=0,b=h.length;d<b;++d){if(d>0){g+="|"}g+=h[d]}return new RegExp((c!=null?"("+c+")?":"")+"("+g+")","gi")};WH.getHash=function(){return"#"+decodeURIComponent(location.href.split("#")[1]||"")};WH.modifyUrl=function(b,g,c,d){if(!c){c=$.noop}var f="";if(b.match(/(#.+)$/)){f=RegExp.$1;b=b.replace(f,"")}if(typeof c.custom=="function"){b=c.custom(b,d)}if(c.returnAfterCustom){return b+f}$.each(g,function(n,m){var l;var h;var o;var k=b.match(new RegExp("(&|\\?)?"+n+"=?([^&]+)?"));if(k!=null){l=k[0];h=k[1];o=decodeURIComponent(k[2])}if(m==null){if(!l){return}o=null}else{if(m.substr(0,2)=="+="){if(o&&c.onAppendCollision){o=c.onAppendCollision(o,m.substr(2),c.menuUrl)}else{if(!o&&c.onAppendEmpty){o=c.onAppendEmpty(m.substr(2),c.menuUrl)}else{if(!o){o=""}o+=$.trim(m.substr(2))}}}else{o=m}}if(l){var j="";if(h){j+=h}if(o!=null){j+=n;if(o){j+="="+WH.urlEncodeHref(o)}}b=b.replace(l,j)}else{if(o||m==null||m.substr(0,2)!="+="){b+=(b.indexOf("?")==-1?"?":"&")+n;if(o){b+="="+WH.urlEncodeHref(o)}}}});b=b.replace("?&","?");b=b.replace(/&&/g,"&");b=b.replace(/\/\?/g,"/");b=b.replace(/(&|\?)+$/,"");return b+f};WH.assertSession=function(){if(WH.isSet("g_user")&&g_user.id){return}if(typeof WH.assertSession.asserted!="undefined"){return}WH.ajaxIshRequest("/account=assertsession",true)};WH.getPreferredTransmogRace=function(){var b=WH.localStorage.get("transmog_racegender");if(!b&&g_user&&g_user.hasOwnProperty("cookies")&&g_user.cookies.hasOwnProperty("default_3dmodel")){b=g_user.cookies.default_3dmodel}if(!b||((""+b).indexOf(",")<0)){b="1,2"}b=b.split(",");if(b[0]==25||b[0]==26){b[0]=24}if(!parseInt(b[0],10)){b[0]=1}if(!parseInt(b[1],10)){b[1]=2}return{race:b[0],gender:b[1]}};WH.getPage=function(){var b=null;var c=location.href.split("/");if(c.length){b=c[3].replace(/^\?(.*)/,"$1").split(/[\?&#=]/)}WH.getPage=(function(d){return d}).bind(null,b);return b};WH.isBlizzardReferral=function(){var b=false;var c=WH.getGets();if(typeof c.brl!="undefined"){b="brl"}if(!b){b=!!(document.referrer&&document.referrer.match(/^https?:\/\/[^\/]*\bbattle\.net\//))}WH.isBlizzardReferral=(function(d){return d}).bind(null,b);return b};WH.updateContentHeight=function(){var g=$(".main-contents");var c=g.outerHeight()-g.height();var d=$(".sidebar");var b=d.height()-c;var f=$("#main-precontents");if(f.length){b-=f.outerHeight()}if($(document.body).hasClass("skinned")){b+=10}if(g.height()<b){g.css({"min-height":b+"px"})}};WH.prepInfobox=function(){$(".infobox").each(function(){var f=$(this);if(f.data("infobox-completion-info-added")!==true&&g_user.lists&&typeof g_pageInfo=="object"&&g_types[g_pageInfo.type]&&typeof g_pageInfo.typeId=="number"){var b=$(".compact-completion-display",f);if(b.length){var c=$("span",b);if(c.length){var d=0;c.each(function(){var m=$(this);var j=m.html();try{j=JSON.parse(j)}catch(k){return}var l;for(var h=0,g;g=g_user.lists[h];h++){if(g.id==j.id){l=g;break}}if(l){m.parent().append(WH.createCompletionIcon(l,j.completed,j.rel));m.remove();d++}});if(d){b.parent().parent().show()}}else{if(b.is(":empty")&&WH.addCompletionIcons(b.get(0),g_types[g_pageInfo.type],g_pageInfo.typeId)){b.parent().parent().show()}}}f.data("infobox-completion-info-added",true)}})};WH.enhanceTextarea=function(z,d){if(!(z instanceof jQuery)){z=$(z)}if(z.data("wh-enhanced")||z.prop("tagName")!="TEXTAREA"){return}if(typeof d!="object"){d={}}var h=(function(C){if(!C.dynamicResizeOption){return true}if(WH.localStorage.get("dynamic-textarea-resizing")==="true"){return true}if(WH.localStorage.get("dynamic-textarea-resizing")==="false"){return false}return !C.hasOwnProperty("dynamicSizing")||C.dynamicSizing}).bind(null,d);var n=z.height()||500;var u=$("<div/>",{"class":"enhanced-textarea-wrapper"}).insertBefore(z).append(z);if(!d.hasOwnProperty("color")){u.addClass("enhanced-textarea-dark")}else{if(d.color){u.addClass("enhanced-textarea-"+d.color)}}if(!d.hasOwnProperty("dynamicSizing")||d.dynamicSizing||d.dynamicResizeOption){var g=$("<div/>",{"class":"enhanced-textarea-expander"}).prependTo(u);var b=function(E,C,D){if(!D()){return}E.css("height",E.siblings(".enhanced-textarea-expander").html(WH.htmlEntities(E.val()).replace(/\n/g,"<br>")+"<br>").height()+(C?14:34)+"px")};z.bind("keydown keyup change",b.bind(this,z,d.exactLineHeights,h));b(z,d.exactLineHeights,h);var r=function(C){C.css("width",C.parent().width()+"px")};r(g);setTimeout(r.bind(null,g),1);if(!d.dynamicResizeOption||(d.dynamicResizeOption&&h())){u.addClass("enhanced-textarea-dynamic-sizing")}}if(!d.hasOwnProperty("focusChanges")||d.focusChanges){u.addClass("enhanced-textarea-focus-changes")}if(d.markup){var s=$("<div/>",{"class":"enhanced-textarea-markup-wrapper"}).prependTo(u);var w=$("<div/>",{"class":"enhanced-textarea-markup"}).appendTo(s);var v=$("<div/>",{"class":"enhanced-textarea-markup-segment"}).appendTo(w);var j=$("<div/>",{"class":"enhanced-textarea-markup-segment"}).appendTo(w);if(d.markup=="inline"){ar_AddInlineToolbar(z.get(0),v.get(0),j.get(0))}else{ar_AddToolbar(z.get(0),v.get(0),j.get(0))}if(d.dynamicResizeOption){var t=$("<div/>",{"class":"enhanced-textarea-markup-segment"}).appendTo(w);var A=$("<label/>").appendTo(t);var y=$("<input/>",{type:"checkbox",checked:h()}).appendTo(A);y.change((function(C,E,I,G,D,H){var F=this.is(":checked");WH.localStorage.set("dynamic-textarea-resizing",JSON.stringify(F));if(F){E.addClass("enhanced-textarea-dynamic-sizing");H(I,C.exactLineHeights,G)}else{E.removeClass("enhanced-textarea-dynamic-sizing");I.css("height",D+"px")}}).bind(y,d,u,z,h,n,b));$("<span/>",{text:LANG.autoresizetextbox}).appendTo(A)}if(d.scrollingMarkup){if(WH.enhanceTextarea.scrollerCount){WH.enhanceTextarea.scrollerCount++}else{WH.enhanceTextarea.scrollerCount=1}var B="fixable-markup-controls-"+WH.enhanceTextarea.scrollerCount;var m="fixed-markup-controls-"+WH.enhanceTextarea.scrollerCount;var c=function(C){var D=C.css("backgroundColor");if(D=="rgba(0, 0, 0, 0)"||D=="transparent"){return c(C.parent())}else{return D}};var o=c(w);for(var l,k=0;(l=window.document.styleSheets[k])&&l.href;k++){}if(!l){window.document.head.appendChild(document.createElement("style"));l=window.document.styleSheets[k]}var q="."+m+" ."+B+" .enhanced-textarea-markup";l.insertRule(q+" {background:"+o+";padding-bottom:5px;padding-top:10px;position:fixed;top:0;z-index:3}",l.cssRules.length);l.insertRule("body.has-mobile-zul-bar"+q+" {padding-top:50px}",l.cssRules.length);s.addClass(B);var p=function(D,E,C){var G=PageTemplate.Responsive.isZulInMobileMode()?40:0;var F=this.scrollY||this.pageYOffset||0;if(F>D.offset().top-10-G&&F<E.offset().top+E.height()-100-G){$("body").addClass(C)}else{$("body").removeClass(C)}};$(window).scroll(p.bind(window,s,u,m));p.call(window,s,u,m);var f=(function(C,D){D.css("width",C.width()+"px");C.css("height",D.height()+"px")}).bind(null,s,w);f();$(window).on("resize",f);$(function(){setTimeout(f,2000)})}}z.data("wh-enhanced",true)};WH.createOptionsMenuWidget=function(d,n,p){var h=0;var m=1;var c=2;var g=3;var l=WH.createOptionsMenuWidget.chevron;if(p.noChevron){l=""}var o=WH.ce("span");o.id="options-menu-widget-"+d;o.className="options-menu-widget "+o.id;o.innerHTML=n+l;if(p.id){o.id=p.id}if(p.className){o.className+=" "+p.className}if(p.options instanceof Array){var f=[];for(var j=0,k;k=p.options[j];j++){var b=[j,k[m]];if((typeof p.selected=="number"||typeof p.selected=="string")&&p.selected==k[h]){o.innerHTML=k[m]+l;if(k[g]){switch(typeof k[g].className){case"string":$.data(o,"options-menu-widget-class",k[g].className);o.className+=" "+k[g].className;break;case"function":$.data(o,"options-menu-widget-class",k[g].className(k,true));o.className+=" "+k[g].className(k,true);break}}}if(k[c]){b.push((function(u,t,s,r){switch(typeof s[c]){case"string":window.location=s[c];break;case"function":if(typeof r.updateWidgetText=="undefined"||r.updateWidgetText){t.innerHTML=s[m]+u;var q=$.data(t,"options-menu-widget-class");if(q){t.className=t.className.replace(new RegExp(" *\\b"+q+"\\b"),"")}if(s[g]){switch(typeof s[g].className){case"string":$.data(t,"options-menu-widget-class",s[g].className);t.className+=" "+s[g].className;break;case"function":$.data(t,"options-menu-widget-class",s[g].className(s,true));t.className+=" "+s[g].className(s,true);break}}}s[c](t,s);break}}).bind(null,l,o,k,p))}else{if(!k[g]||!k[g].menu){b[0]=null}}b[MENU_IDX_OPT]={};if(k[g]){switch(typeof k[g].className){case"string":b[MENU_IDX_OPT].className=k[g].className;break;case"function":b[MENU_IDX_OPT].className=k[g].className.bind(null,k,false);break}switch(typeof k[g].column){case"number":case"string":b[MENU_IDX_OPT].column=k[g].column;break;case"function":b[MENU_IDX_OPT].column=k[g].column.bind(null,k);break}switch(typeof k[g].tinyIcon){case"string":b[MENU_IDX_OPT].tinyIcon=k[g].tinyIcon;break;case"function":b[MENU_IDX_OPT].tinyIcon=k[g].tinyIcon.bind(null,k);break}switch(typeof k[g].fontIcon){case"string":b[MENU_IDX_OPT].fontIcon=k[g].fontIcon;break;case"function":b[MENU_IDX_OPT].fontIcon=k[g].fontIcon.bind(null,k);break}if(typeof k[g].isChecked=="function"){b[MENU_IDX_OPT].checkedFunc=k[g].isChecked.bind(null,k)}if(typeof k[g].menu=="object"&&k[g].menu instanceof Array){b[MENU_IDX_SUB]=k[g].menu}}f.push(b)}o.menu=f;if(p.menuOnClick){o.onmousedown=WH.rf;Menu.add(o,f,{showAtElement:true})}else{Menu.add(o,f)}}if(p.target){$(p.target).append(o)}else{return o}};WH.createOptionsMenuWidget.chevron=' <i class="fa fa-chevron-down fa-color-gray"></i>';WH.setupSmoothNavClicks=function(c){var b=$(".smooth-nav-inner > a",c);if(!b.length){setTimeout(WH.setupSmoothNavClicks.bind(null,c),9);return}b.each(function(){var d=this.href.replace(new RegExp("^"+location.href.replace(/#.*/,"")),"");if(d&&d.substr(0,1)==="#"){$(this).click(function(f,g){if(g.which===2){return}var h=f==="#top"?0:$(f).offset().top-20;if(isNaN(h)){return}if(Platform.isTouch()){h-=37}$("html, body").stop().animate({scrollTop:h},"500","swing");return false}.bind(null,d))}})};WH.debugMessage=function(d){var b=$(".layout > .header");if(!b.length){setTimeout(WH.debugMessage.bind(null,d),9);return}var c=$(".debug",b);if(!c.length){c=$("<div/>",{"class":"debug"}).appendTo(b)}$("<div/>",d).appendTo(c)};WH.countdownClock=function(t){var k=$("#countdown-clock-"+t.id);if(!k.length){return}var b;if(t.url){b=$("<a/>",{href:t.url,target:"_blank"})}else{b=$("<div/>")}b.addClass("countdown-clock-content").css({"background-image":"url("+t.bg+")"});var s=$("<div/>",{"class":"countdown-clock-content-inner"}).appendTo(b);if(t.impressionImage){$("<img>",{src:t.impressionImage,css:{bottom:0,height:"1px",position:"absolute",right:0,width:"1px"}}).appendTo(b)}if(t.text){s.append($("<span/>",{"class":"countdown-clock-text",html:t.text}))}var d=$("<span/>",{"class":"countdown-clock-time"}).appendTo(s);var m=$("<table/>").appendTo(d);var n=$("<tr/>").appendTo(m);var l=$("<tr/>").appendTo(m);$("<td/>").appendTo(n);$("<td/>",{html:":"}).appendTo(n);$("<td/>").appendTo(n);$("<td/>",{html:":"}).appendTo(n);$("<td/>").appendTo(n);$("<td/>",{html:LANG.timeunitspl[3]}).appendTo(l);$("<td/>").appendTo(l);$("<td/>",{html:LANG.timeunitspl[4]}).appendTo(l);$("<td/>").appendTo(l);$("<td/>",{html:LANG.timeunitspl[5]}).appendTo(l);k.addClass("countdown-clock").append(b);var q={days:0,hours:0,minutes:0};var c=new Date().getTime();var j=c;if(typeof t.time==="string"){j=new Date(t.time).getTime()}else{if(typeof t.time==="object"){var r=new Date();if(!t.time.hasOwnProperty("year")){t.time.year=r.getFullYear()}if(!t.time.hasOwnProperty("month")){t.time.month=r.getMonth+1}if(!t.time.hasOwnProperty("day")){t.time.day=r.getDay()}if(!t.time.hasOwnProperty("hour")){t.time.hour=0}if(!t.time.hasOwnProperty("minute")){t.time.minute=0}if(!t.time.hasOwnProperty("second")){t.time.second=0}j=new Date(t.time.year,t.time.month-1,t.time.day,t.time.hour,t.time.minute,t.time.second).getTime()}}var h=parseInt((j-c)/1000);var f=60;var g=f*60;var p=g*24;q.days=parseInt(h/p);h=h-(q.days*24*60*60);q.hours=parseInt(h/g);h=h-(q.hours*60*60);q.minutes=parseInt(h/f);var o=function(w,u,v){if(u.days<=0&&u.hours<=0&&u.minutes<=0){w.html(v.completionText).parent().parent().addClass("countdown-clock-complete");return}$("tr:first-child > td:nth-child(1)",w).html(u.days);$("tr:last-child > td:nth-child(1)",w).html(u.days===1?LANG.timeunitssg[3]:LANG.timeunitspl[3]);$("tr:first-child > td:nth-child(3)",w).html(u.hours);$("tr:last-child > td:nth-child(3)",w).html(u.hours===1?LANG.timeunitssg[4]:LANG.timeunitspl[4]);$("tr:first-child > td:nth-child(5)",w).html(u.minutes);$("tr:last-child > td:nth-child(5)",w).html(LANG.timeunitsab[5]);u.minutes--;if(u.minutes<0){if(u.hours>0||u.days>0){u.minutes=59}else{u.minutes=0}u.hours--}if(u.hours<0){if(u.days>0){u.hours=23}else{u.hours=0}u.days--}if(u.days<0){u.days=0}setTimeout(o.bind(null,w,u,v),60000)};o(d,q,t)};WH.createTweetDiv=function(f){var w=WH.isSet("BlueTweets");var g=w?BlueTweets.now:new Date();if(!f.id){return document.createTextNode("")}var y=WH.ce("div");y.className="full-tweet";if(f.wh_significant=="1"){y.className+=" significant"}if(f.repliedTo){var C=WH.createTweetDiv(f.repliedTo);C.className+=" replied";WH.ae(y,C)}if(f.quoted){var C=WH.createTweetDiv(f.quoted);C.className+=" replied quoted";WH.ae(y,C)}var t=WH.ce("div");WH.ae(y,t);t.className="tweet";var J=WH.ce("a");WH.ae(t,J);J.className="avatar";J.style.backgroundImage="url("+f.author.avatar.replace(/^http:/,"")+")";J.href="https://twitter.com/"+f.author.username;var j=WH.ce("div");WH.ae(t,j);j.className="main";var G=WH.ce("div");WH.ae(j,G);G.className="top";var J=WH.ce("a");WH.ae(G,J);J.href="https://twitter.com/"+f.author.username;if(w){BlueTweets.AuthorTooltip(J,f.author.id)}var r=WH.ce("span");WH.ae(J,r);r.className="author-name";WH.st(r,f.author.name);var r=WH.ce("span");WH.ae(J,r);r.className="author-username";WH.st(r,"@"+f.author.username);var J=WH.ce("a");WH.ae(G,J);J.className="timestamp";J.href="https://twitter.com/"+f.author.username+"/status/"+f.id;if(isNaN(Date.parse(f.timestamp))){f.timestamp=f.timestamp.replace(/^([A-Za-z]+ [A-Za-z]+ \d\d)( \d\d:\d\d:\d\d [-+]\d{4})( (?:19|20)\d\d)$/,"$1$3$2")}var I=(g.getTime()-Date.parse(f.timestamp))/1000;if(I<60){WH.st(J,""+I+"s")}else{if(I<60*60){WH.st(J,""+Math.floor(I/60)+"m")}else{if(I<60*60*24){WH.st(J,""+Math.floor(I/60/60)+"h")}else{if(I<60*60*24*3){WH.st(J,""+Math.floor(I/60/60/24)+"d")}else{I=(new Date(f.timestamp)).toString().split(" ");WH.st(J,""+I[1]+" "+I[2])}}}}var G=WH.ce("div");WH.ae(j,G);G.className="status";var v=f.text;var E,k,o,m,z;if(f.hasOwnProperty("entities")&&(f.entities!==null)){if(f.entities.hasOwnProperty("media")&&WH.isArray(f.entities.media)){for(m in f.entities.media){o=f.entities.media[m];v=v.replace(f.text.substr(o.indices[0],o.indices[1]-o.indices[0]),'<a href="'+o.url+'" class="entity-media">'+o.display_url+"</a>");if(o.type=="photo"){var h="",B=0;for(var p in o.sizes){if((o.sizes[p].w>=250)&&(B==0||o.sizes[p].w<B)){h=p;B=o.sizes[p].w}}if(h!=""){if(B>375){B=375}var K=WH.ce("img");WH.ae(j,K);K.className="photo";K.width=B;K.height=Math.floor(o.sizes[h].h*(B/o.sizes[h].w));K.src=o.media_url.replace(/^http:/,"")+":"+h}}}}if(f.entities.hasOwnProperty("urls")&&WH.isArray(f.entities.urls)){E=[];z=f.quoted?WH.sprintf("https://twitter.com/$1/status/$2",f.quoted.author.username,f.quoted.id):false;for(m in f.entities.urls){o=f.entities.urls[m];k=f.text.substr(o.indices[0],o.indices[1]-o.indices[0]);if(WH.inArray(E,k)>=0){continue}E.push(k);if(z&&o.expanded_url.indexOf(z)==0){v=v.replace(k,"")}else{v=v.replace(k,'<a href="'+o.url+'" class="entity-url">'+o.display_url+"</a>","g")}}}if(f.entities.hasOwnProperty("user_mentions")&&WH.isArray(f.entities.user_mentions)){E=[];for(m in f.entities.user_mentions){o=f.entities.user_mentions[m];k=f.text.substr(o.indices[0],o.indices[1]-o.indices[0]).toLowerCase();if(WH.inArray(E,k)>=0){continue}E.push(k);v=v.replace(k,'<a href="https://twitter.com/'+o.screen_name+'" class="entity-mention">@'+o.screen_name+"</a>","gi")}}if(f.entities.hasOwnProperty("hashtags")&&WH.isArray(f.entities.hashtags)){E=[];for(m in f.entities.hashtags){o=f.entities.hashtags[m];k=f.text.substr(o.indices[0],o.indices[1]-o.indices[0]).toLowerCase();if(WH.inArray(E,k)>=0){continue}E.push(k);v=v.replace(k,'<a href="https://twitter.com/search?q=#'+o.text+'" class="entity-hashtag">#'+o.text+"</a>","gi")}}}G.innerHTML=v;var A=WH.ce("div");WH.ae(j,A);A.className="bottom";if(w&&g_user&&(g_user.roles&U_GROUP_MODERATOR)){var J=WH.ce("a");WH.ae(A,J);J.href="javascript:;";J.className="markup-link";J.setAttribute("data-tweet",f.id);WH.aE(J,"click",BlueTweets.ShowLinks);WH.st(J,"Links");var D=WH.ce("label");D.className="significance";WH.ae(A,D);var F=WH.ce("input");WH.ae(D,F);F.type="checkbox";F.setAttribute("data-tweet",f.id);F.checked=(f.wh_significant=="1");WH.aE(F,"click",BlueTweets.SetSignificant);var r=WH.ce("span");WH.ae(D,r);WH.st(r,"Significant");var n=WH.ce("div",{className:"mod-footer"});WH.ae(j,n);var H=BlueTweets.wowClasses;if(!f.hasOwnProperty("wh_classFlags")){f.wh_classFlags=0}for(m=0;m<H.length;m++){F=WH.ce("img",{className:"sig-role"});if(f.wh_classFlags&Math.pow(2,H[m].id)){F.className+=" selected"}F.setAttribute("data-tweet",f.id);F.setAttribute("data-wowclass",H[m].id);WH.aE(F,"click",BlueTweets.ToggleClassRoleFlag);F.src=g_staticUrl+"/images/wow/icons/tiny/"+H[m].icon+".gif";WH.ae(n,F);WH.Tooltip.simple(F,H[m].name)}WH.ae(n,WH.ce("span",{style:"display: inline-block; width: 15px; height: 15px"}));if(!f.hasOwnProperty("wh_roleFlags")){f.wh_roleFlags=0}var b=["tank","healer","dps"];for(m in g_roles){if(!g_roles.hasOwnProperty(m)){continue}F=WH.ce("img",{className:"sig-role"});if(f.wh_roleFlags&Math.pow(2,m)){F.className+=" selected"}F.setAttribute("data-tweet",f.id);F.setAttribute("data-role",m);WH.aE(F,"click",BlueTweets.ToggleClassRoleFlag);F.src=g_staticUrl+"/images/wow/icons/tiny/role_"+b[m]+".gif";WH.ae(n,F);WH.Tooltip.simple(F,g_roles[m])}}var J=WH.ce("a");WH.ae(A,J);J.className="widget reply";J.href="https://twitter.com/intent/tweet?in_reply_to="+f.id;J.target="whtwitter";WH.st(J,"Reply");J.insertBefore(WH.ce("span"),J.firstChild);var J=WH.ce("a");WH.ae(A,J);J.className="widget retweet";J.href="https://twitter.com/intent/retweet?tweet_id="+f.id;J.target="whtwitter";WH.st(J,"Retweet");J.insertBefore(WH.ce("span"),J.firstChild);var J=WH.ce("a");WH.ae(A,J);J.className="widget favorite";J.href="https://twitter.com/intent/favorite?tweet_id="+f.id;J.target="whtwitter";WH.st(J,"Favorite");J.insertBefore(WH.ce("span"),J.firstChild);return y};WH.slashHashEvent=null;try{WH.slashHashEvent=new Event("slashhash")}catch(e){try{WH.slashHashEvent=document.createEvent("Event");WH.slashHashEvent.initEvent("slashhash",true,true)}catch(e){}}WH.getSlashHash=function(c){var d=""+location.href;var b=d.indexOf(c);if(b==-1){return location.hash?(""+location.hash).replace(/^#/,""):""}var f=d.substr(0,b+c.length);return d.substr(f.length+1)};WH.setSlashHash=function(f,j,d){var g=""+location.href;var c=g.indexOf(f);if(c==-1){alert("Bad hash update: No root found!");return}var h=g.substr(0,c+f.length);var k=g.substr(h.length+1);if(j.substr(0,1)=="#"){j=j.substr(1)}var b=j?"/"+j:"";if(d){if(window.history&&window.history.pushState){window.history.pushState({},"",h+b);if(WH.slashHashEvent&&window.dispatchEvent){window.dispatchEvent(WH.slashHashEvent)}}else{location.hash="#"+b}}else{if(window.history&&window.history.replaceState){window.history.replaceState({},"",h+b);if(WH.slashHashEvent&&window.dispatchEvent){window.dispatchEvent(WH.slashHashEvent)}}else{location.replace("#"+b)}}return k};WH.setHash=function(c,b){var d=""+location.hash;if(c.substr(0,1)!="#"){c="#"+c}if(c=="#."){WH.clearHash(b||false)}else{if(b){location.hash=c}else{location.replace(c)}}return d};WH.clearHash=function(b){var d=""+location.hash;var c=(""+location.href).replace(/#.*/,"");if(b){if(window.history&&window.history.pushState){window.history.pushState({},"",c)}else{location.hash="#."}}else{if(window.history&&window.history.replaceState){window.history.replaceState({},"",c)}else{location.replace("#.")}}return d};WH.selectText=function(c){var f=document,g=f.getElementById(c),b,d;if(f.body.createTextRange){b=document.body.createTextRange();b.moveToElementText(g);b.select()}else{if(window.getSelection){d=window.getSelection();b=document.createRange();b.selectNodeContents(g);d.removeAllRanges();d.addRange(b)}}};WH.ucfirst=function(b){return b.charAt(0).toUpperCase()+b.slice(1)};WH.loadAssets=function(l,k){var h=function(n){var o=WH.ce("link");o.rel="stylesheet";o.href=n;WH.ae(document.getElementsByTagName("head")[0],o)};var f=function(n,p){var o=WH.ce("script");o.type="text/javascript";o.src=n;if(p){WH.aE(o,"load",p)}WH.ae(document.getElementsByTagName("head")[0],o)};switch(l){case"artifact-weapon-calc":if(WH.isSet("ArtifactCalc")){if(k){k()}return}h(g_staticUrl+"/css/legacy/tools/artifact-calc.css?"+g_wow_build);var b=g_staticUrl+"/js/ArtifactCalc.js?"+g_wow_build;if(WH.isSet("g_artifact_textures")){f(b,k)}else{var j="/data/artifact-calc&w"+g_wow_build;f(j,f.bind(null,b,k))}break;case"battle-pet-team-calc":if(WH.isSet("BattlePetTeamCalc")){if(k){k()}return}h(g_staticUrl+"/css/legacy/tools/battle-pet-team-calc.css?"+g_wow_build);var c=g_staticUrl+"/js/BattlePetTeamCalcCore.js?"+g_wow_build;if(WH.isSet("g_battlepets")){f(c,k)}else{f("/data/petspecies?"+g_wow_build,f.bind(null,c,k))}break;case"pvp-talent-calc":if(WH.isSet("PvpTalentCalc")){if(k){k()}return}h(g_staticUrl+"/css/legacy/tools/pvp-calc.css?"+g_wow_build);var m=g_staticUrl+"/js/talent-pvp.js?"+g_wow_build;if(WH.isSet("g_talents_pvp")){f(m,k)}else{var d="/data/talents-pvp?"+g_wow_build;f(d,f.bind(null,m,k))}break;case"talent-calc":if(WH.isSet("TalentCalc")){if(k){k()}return}h(g_staticUrl+"/css/legacy/tools/talent-calc.css?"+g_wow_build);var g=g_staticUrl+"/js/talent.js?"+g_wow_build;if(WH.isSet("g_glyphs")){f(g,k)}else{f("/data/glyphs?"+g_wow_build,f.bind(null,g,k))}break;default:alert('Tried to load unknown asset set "'+String(l)+'".')}};WH.isInt=function(b){return typeof b==="number"&&parseFloat(b)==parseInt(b)&&!isNaN(b)};WH.ensureObjectPath=function(b,c){var d=Array.prototype.slice.call(arguments,1);if(typeof d[0]!="string"){return b}if(typeof b[d[0]]!="object"){b[d[0]]={}}if(d[1]){b[d[0]]=WH.ensureObjectPath.apply(this,[b[d[0]]].concat(d.slice(1)))}return b};WH.preventDefault=function(b){if(b&&b.preventDefault){b.preventDefault()}};WH.preventTyping=function(d){if(d&&d.preventDefault){var f=("which" in d)?d.which:d.keyCode;var c=(f>=48&&f<=57)||(f>=65&&f<=90)||(f>=96&&f<=105)||(f>=106&&f<=111)||(f>=186&&f<=192)||(f>=219&&f<=222);var b=(d.altKey||d.ctrlKey||d.shiftKey||d.metaKey);if(c&&!b){d.preventDefault()}}};WH.leadingZeroes=function(d,c){var b=d+"";while(b.length<c){b="0"+b}return b};$(document).ready(function(){$("form.vote-comment input").click(function(){var c=$(this).attr("data-vote");var h=$(this).parent();var g=h.find(".ajax");var b=h.find("input");var d=h.attr("data-post");var f=h.attr("data-type");b.prop("disabled",true);g.show();$.post("/vote",{post:d,type:f,vote:c},function(j){if(j!="ok"){b.prop("disabled",false);g.hide();alert(LANG.voteerror_tip);return}h.remove()});return false})});$(document).ready(function(){$("a.wsach").each(function(){var d=$(this).text();var m=$(this).attr("title");var g=parseInt($(this).attr("data-earned"));var h=$(this).attr("data-user");var c=$(this).parent().parent().attr("id")=="user-achievement-list";var b=$(this).attr("data-progress");var l=$(this).attr("data-quality");var k=$(this).attr("data-count");$(this).attr("title","");var n=$("<div>");n.append('<table><tr><td style="padding-bottom: 0.35em"><b class="q" data-quality="'+l+'"></b></td></tr><tr><td><span></span></td></tr></table>');n.find("b").text(d);n.find("span").text(m);if(g){var j=null;var f=(new Date()).getTime()/1000;if(h){if(g>31*24*60*60){n.append('<span class="q0"><br />'+WH.sprintf(k>1?LANG.earnedwsafirsttime4_format:LANG.earnedwsatime4_format,h,WH.formatDateSimple(new Date((f-g)*1000)))+"</span>")}else{n.append('<span class="q0"><br />'+WH.sprintf(k>1?LANG.earnedwsafirsttime2_format:LANG.earnedwsatime2_format,h,WH.formatTimeElapsed(g))+"</span>")}}else{if(!c){if(g>31*24*60*60){n.append('<span class="q0"><br />'+WH.sprintf(k>1?LANG.earnedwsafirsttime3_format:LANG.earnedwsatime3_format,WH.formatDateSimple(new Date((f-g)*1000)))+"</span>")}else{n.append('<span class="q0"><br />'+WH.sprintf(k>1?LANG.earnedwsafirsttime_format:LANG.earnedwsatime_format,WH.formatTimeElapsed(g))+"</span>")}}}if(j){n.append('<span class="q0"><br />'+j+"</span>")}}else{if(!c&&b){n.append('<span class="q0"><br /><small></small>'+LANG.progress+": "+b+"</td></tr>")}}WH.Tooltip.simple(this,n.html())})});var U_GROUP_TESTER=1;var U_GROUP_ADMIN=2;var U_GROUP_EDITOR=4;var U_GROUP_MOD=8;var U_GROUP_BUREAU=16;var U_GROUP_DEV=32;var U_GROUP_VIP=64;var U_GROUP_BLOGGER=128;var U_GROUP_PREMIUM=256;var U_GROUP_LOCALIZER=512;var U_GROUP_SALESAGENT=1024;var U_GROUP_SCREENSHOT=2048;var U_GROUP_VIDEO=4096;var U_GROUP_APIONLY=8192;var U_GROUP_PENDING=16384;var U_GROUP_STAFF=U_GROUP_ADMIN|U_GROUP_EDITOR|U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV|U_GROUP_BLOGGER|U_GROUP_LOCALIZER|U_GROUP_SALESAGENT;var U_GROUP_EMPLOYEE=U_GROUP_ADMIN|U_GROUP_BUREAU|U_GROUP_DEV;var U_GROUP_GREEN_TEXT=U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV;var U_GROUP_PREMIUMISH=U_GROUP_PREMIUM|U_GROUP_EDITOR;var U_GROUP_MODERATOR=U_GROUP_ADMIN|U_GROUP_MOD|U_GROUP_BUREAU;var U_GROUP_COMMENTS_MODERATOR=U_GROUP_BUREAU|U_GROUP_MODERATOR|U_GROUP_LOCALIZER;var U_GROUP_PREMIUM_PERMISSIONS=U_GROUP_PREMIUM|U_GROUP_STAFF|U_GROUP_VIP|U_GROUP_EDITOR;var g_users={};var g_completion={};var g_favorites=[];var g_customColors={};WH.isUsernameValid=function(b){return(b.match(/[^a-z0-9]/i)==null&&b.length>=4&&b.length<=16)};WH.requireCaptcha=function(){return !((g_user.permissions&1)>0||(typeof(skipCaptcha)!="undefined"&&skipCaptcha))};var User=new function(){var b=this;b.hasPermissions=function(c){if(!c){return true}return !!(g_user.roles&c)};this.saveOption=function(c,d){$.ajax("/account=save-option",{method:"POST",data:{key:c,value:d}})}};WH.Admin=new function(){this.foo="test"};function Ajax(c,d){if(!c){return}var b;try{b=new XMLHttpRequest()}catch(f){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(f){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(f){if(window.createRequest){b=window.createRequest()}else{alert(LANG.message_ajaxnotsupported);return}}}}this.request=b;WH.cO(this,d);this.method=this.method||(this.params&&"POST")||"GET";b.open(this.method,c,this.async==null?true:this.async);b.onreadystatechange=Ajax.onReadyStateChange.bind(this);if(this.method.toUpperCase()=="POST"){b.setRequestHeader("Content-Type",(this.contentType||"application/x-www-form-urlencoded")+"; charset="+(this.encoding||"UTF-8"))}b.send(this.params)}Ajax.onReadyStateChange=function(){if(this.request.readyState==4){if(this.request.status==0||(this.request.status>=200&&this.request.status<300)){this.onSuccess!=null&&this.onSuccess(this.request,this)}else{this.onFailure!=null&&this.onFailure(this.request,this)}if(this.onComplete!=null){this.onComplete(this.request,this)}}};var Announcement=function(b){if(!b){b={}}WH.cO(this,b);if(!this.parentDiv){if(this.parent){this.parentDiv=WH.ge(this.parent)}else{return}}if(!this.parentDiv){return}this.parentDiv.setAttribute("data-announcement-id",Math.abs(this.id));if(g_user.id==0&&(!WH.cookiesEnabled()||WH.getWowheadCookie("announcement-"+this.id)=="closed")){return}this.initialize()};Announcement.prototype={initialize:function(){this.parentDiv.style.display="none";this.parentDiv.className=this.getClass();var h=this.innerDiv=WH.ce("div");h.className="announcement-inner text";this.setStyle(this.style);var b=null;var g=parseInt(this.id);if(g_user&&(g_user.roles&(U_GROUP_ADMIN|U_GROUP_BUREAU))>0&&Math.abs(g)>0){if(g<0){b=WH.ce("a");b.style.cssFloat=b.style.styleFloat="right";b.href="/admin=announcements&id="+Math.abs(g)+"&status=2";b.onclick=function(){return confirm("Are you sure you want to delete "+this.name+"?")};WH.ae(b,WH.ct("Delete"));var f=WH.ce("small");WH.ae(f,b);WH.ae(h,f);b=WH.ce("a");b.style.cssFloat=b.style.styleFloat="right";b.style.marginRight="10px";b.href="/admin=announcements&id="+Math.abs(g)+"&status="+(this.status==1?0:1);b.onclick=function(){return confirm("Are you sure you want to delete "+this.name+"?")};WH.ae(b,WH.ct((this.status==1?"Disable":"Enable")));var f=WH.ce("small");WH.ae(f,b);WH.ae(h,f)}b=WH.ce("a");b.href="/admin=announcements&id="+Math.abs(g)+"&edit";b.className="fa fa-pencil";WH.Tooltip.simpleNonTouch(b,LANG.edit,"q2");var f=WH.ce("small");WH.ae(f,b);WH.ae(h,f)}var d=WH.ce("div");d.id=this.parent+"-markup";d.className="announcement-markup";WH.ae(h,d);var c=WH.ce("div");c.id=this.parent+"-markup-responsive";c.className="announcement-markup-responsive";WH.ae(h,c);if(g>=0){b=WH.ce("a");b.id="closeannouncement";b.href="javascript:;";b.className="fa fa-times announcement-close";if(this.nocookie){b.onclick=this.hide.bind(this)}else{b.onclick=this.markRead.bind(this)}WH.ae(h,b);if(g==195||g==200){$(b).removeClass("fa-times announcement-close").addClass("fa-square q1").text("I Accept")}else{WH.Tooltip.simpleNonTouch(b,LANG.close,"q2")}}WH.ae(h,WH.ce("div",{style:{clear:"both"}}));WH.ae(this.parentDiv,h);this.setText(this.text,this.mobiletext);setTimeout(this.show.bind(this),500)},show:function(){$(this.parentDiv).animate({opacity:"show",height:"show"},{duration:333});WH.Track.nonInteractiveEvent("Announcements","Show",""+this.name)},hide:function(){$(this.parentDiv).animate({opacity:"hide",height:"hide"},{duration:200})},markRead:function(){WH.Track.interactiveEvent("Announcements","Close",""+this.name);WH.setWowheadCookie("announcement-"+this.id,"closed");this.hide()},getClass:function(){var c="announcement announcement-";switch(this.mode){case 2:c+="fixed";break;case 0:c+="pagetop";break;case 1:default:c+="contenttop"}if(this["class"]){var d=this["class"].split(" ");for(var b in d){if(d[b]){c+=" announcement-styling-"+d[b]}}}return c},setClass:function(b){this["class"]=b;this.parentDiv.className=this.getClass()},setStyle:function(b){this.style=b;this.innerDiv.setAttribute("style",b?WH.fixWowheadHttps(b):"")},setText:function(b,c){this.text=b;this.mobiletext=c;WH.markup.printHtml(this.text,this.parent+"-markup",{allow:WH.markup.CLASS.STAFF});WH.Track.addClickEvents(WH.ge(this.parent+"-markup"),{category:"Announcements",actions:{"Follow link":function(d){return true}}},this.id);if(!c){c=b}WH.markup.printHtml(c,this.parent+"-markup-responsive",{allow:WH.markup.CLASS.STAFF});WH.Track.addClickEvents(WH.ge(this.parent+"-markup-responsive"),{category:"Announcements",actions:{"Follow link":function(d){return true}}},this.id)}};var g_audiocontrols={__windowloaded:false,__rewardedAchievement:false};var g_audioplaylist={};if(!window.JSON){window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(c){if(c instanceof Object){var f="";if(c.constructor===Array){for(var b=0;b<c.length;f+=this.stringify(c[b])+",",b++){}return"["+f.substr(0,f.length-1)+"]"}if(c.toString!==Object.prototype.toString){return'"'+c.toString().replace(/"/g,"\\$&")+'"'}for(var d in c){f+='"'+d.replace(/"/g,"\\$&")+'":'+this.stringify(c[d])+","}return"{"+f.substr(0,f.length-1)+"}"}return typeof c==="string"?'"'+c.replace(/"/g,"\\$&")+'"':String(c)}}}AudioControls=function(){var n=-1;var d=false;var g=false;var m=false;var j=false;var p={};var h=[];var l="";function f(){if(g_audiocontrols.__rewardedAchievement){return}if(!(WH.isSet("g_user")&&g_user.id)){return}$.ajax({url:"/website-achievement-explored",data:{trigger:"playsound"},success:function(){AchievementCheck()},type:"POST"});g_audiocontrols.__rewardedAchievement=true}function o(r,A,u){var q=WH.ce("audio");q.preload="none";q.controls="true";$(q).click(function(s){s.stopPropagation()});WH.aE(q,"ended",f);q.style.marginTop="5px";p.audio.parentNode.replaceChild(q,p.audio);p.audio=q;WH.aE(p.audio,"ended",c.bind(r));if(u){q.preload="auto";j=true;WH.aE(p.audio,"canplaythrough",b.bind(this))}if(!d){p.table.style.visibility="visible"}var t;do{n+=A;if(n>h.length-1){n=0;if(!d){var v=WH.ce("div");v.className="minibox";WH.st(v,WH.sprintf(LANG.message_browsernoaudio,t.type));p.table.parentNode.replaceChild(v,p.table);return}}if(n<0){n=h.length-1}t=h[n]}while(p.audio.canPlayType(t.type)=="");var B=WH.ce("source");B.src=t.url;B.type=t.type;WH.ae(p.audio,B);if(p.hasOwnProperty("title")){if(l){WH.ee(p.title);var y=WH.ce("a");y.href=l;WH.st(y,'"'+t.title+'"');WH.ae(p.title,y)}else{WH.st(p.title,'"'+t.title+'"')}}if(p.hasOwnProperty("trackdisplay")){WH.st(p.trackdisplay,""+(n+1)+" / "+h.length)}if(!d){d=true;for(var w=n+1;w<=h.length-1;w++){if(p.audio.canPlayType(h[w].type)){$(p.controlsdiv).children("a").removeClass("btn-disabled");break}}}if(p.hasOwnProperty("addbutton")){$(p.addbutton).removeClass("btn-disabled");WH.st(p.addbutton,LANG.add)}}function b(){if(!j){return}j=false;p.audio.play()}this.init=function(u,r,s){if(!WH.isArray(u)){return}if(u.length==0){return}if((r.id=="")||g_audiocontrols.hasOwnProperty(r.id)){var z=0;while(g_audiocontrols.hasOwnProperty("auto-audiocontrols-"+(++z))){}r.id="auto-audiocontrols-"+z}g_audiocontrols[r.id]=this;if(typeof s=="undefined"){s={}}g=!!s.loop;if(s.hasOwnProperty("url")){l=s.url}h=u;p.div=r;if(!s.listview){var A=WH.ce("table",{className:"audio-controls"});p.table=A;p.table.style.visibility="hidden";WH.ae(p.div,A);var w=WH.ce("tr");WH.ae(A,w);var t=WH.ce("td");WH.ae(w,t);p.audio=WH.ce("div");WH.ae(t,p.audio);p.title=WH.ce("div",{className:"audio-controls-title"});WH.ae(t,p.title);p.controlsdiv=WH.ce("div",{className:"audio-controls-pagination"});WH.ae(t,p.controlsdiv);var B=k(LANG.previous,true);WH.ae(p.controlsdiv,B);WH.aE(B,"click",this.btnPrevTrack.bind(this));p.trackdisplay=WH.ce("div",{className:"audio-controls-pagination-track"});WH.ae(p.controlsdiv,p.trackdisplay);var q=k(LANG.next,true);WH.ae(p.controlsdiv,q);WH.aE(q,"click",this.btnNextTrack.bind(this))}else{m=true;var v=WH.ce("div");p.table=v;WH.ae(p.div,v);p.audio=WH.ce("div");WH.ae(v,p.audio);p.trackdisplay=s.trackdisplay;p.controlsdiv=WH.ce("span");WH.ae(v,p.controlsdiv)}if(g_audioplaylist.isEnabled()&&!s.fromplaylist){var y=k(LANG.add);WH.ae(p.controlsdiv,y);WH.aE(y,"click",this.btnAddToPlaylist.bind(this,y));p.addbutton=y;if(m){y.style.verticalAlign="50%"}}if(g_audiocontrols.__windowloaded){this.btnNextTrack()}};function c(){o(this,1,(g||(n<(h.length-1))))}this.btnNextTrack=function(){o(this,1,(d&&(p.audio.readyState>1)&&(!p.audio.paused)))};this.btnPrevTrack=function(){o(this,-1,(d&&(p.audio.readyState>1)&&(!p.audio.paused)))};this.btnAddToPlaylist=function(r){if(m){for(var q=0;q<h.length;q++){g_audioplaylist.addSound(h[q])}}else{g_audioplaylist.addSound(h[n])}r.className+=" btn-disabled";WH.st(r,LANG.added)};this.isPlaying=function(){return !p.audio.paused};this.removeSelf=function(){p.table.parentNode.removeChild(p.table);delete g_audiocontrols[p.div]};function k(q,r){return WH.createButton(q,null,{disabled:r,"float":false,style:"margin:0 12px"})}};WH.aE(window,"load",function(){g_audiocontrols.__windowloaded=true;for(var b in g_audiocontrols){if(b.substr(0,2)!="__"){g_audiocontrols[b].btnNextTrack()}}});AudioPlaylist=function(){var d=false;var h=[];var g,f;var c=false;this.init=function(){if(!WH.localStorage.isSupported()){return}d=true;var j;if(j=WH.localStorage.get("AudioPlaylist")){h=JSON.parse(j)}};this.savePlaylist=function(){if(!d){return false}WH.localStorage.set("AudioPlaylist",JSON.stringify(h))};this.isEnabled=function(){return d};this.addSound=function(j){if(!d){return false}this.init();h.push(j);this.savePlaylist();b()};this.deleteSound=function(j){if(j<0){h=[]}else{h.splice(j,1)}this.savePlaylist();if(!g.isPlaying()){g.removeSelf();this.setAudioControls(f)}if(h.length==0){WH.Tooltip.hide()}};this.getList=function(){var k=[];for(var j=0;j<h.length;j++){k.push(h[j].title)}return k};this.setAudioControls=function(j){if(!d){return false}f=j;g=new AudioControls();g.init(h,f,{loop:true,fromplaylist:true})};function b(){if(c){return}if(!(WH.isSet("g_user")&&g_user.id)){return}if(h.length<2){return}$.ajax({url:"/sound&playlist",data:{achievement:1},success:function(){AchievementCheck()},type:"POST"});c=true}};g_audioplaylist=(new AudioPlaylist);g_audioplaylist.init();WH.BattleNet=new function(){var c=false;var b=0;this.CharacterExists=function(l,g,d,n){if(!WH.localStorage.isSupported()||!(JSON&&"stringify" in JSON)){n(true);return false}g=g.toLowerCase().replace(/[^\w -]/,"").replace(" ","-");var m=(l+"|"+g+"|"+d).toLowerCase();if(!c){c={};try{c=JSON.parse(WH.localStorage.get("BattleNetCharCache"));if(c==null){c={}}}catch(j){c={}}}if(c.hasOwnProperty(m)){if(parseInt(c[m].substr(1),10)>Math.floor((Date.now()-(1000*60*60*24*4))/1000)){n(c[m].substr(0,1)=="t");return true}}var k="LR"+(b++);this[k]=(function(s,q,p,t){s[q]=((t&&t.name)?"t":"f")+Math.floor(Date.now()/1000);WH.localStorage.set("BattleNetCharCache",JSON.stringify(s));p(s[q])}).bind(null,c,m,n);var f="https://"+l+".api.battle.net/wow/character/"+g+"/"+d+"?apikey="+WH.BattleNet.apiKey+"&jsonp=WH.BattleNet."+k;var h=WH.ce("script",{type:"text/javascript",src:f});WH.aE(h,"error",function(){WH.BattleNet[k](false)});WH.ae(document.getElementsByTagName("head")[0],h);return true};this.apiKey="nysaj9axzq4dvdjvg8tnhk9m5jde372w"};function SetupReplies(b,c){SetupAddEditComment(b,c,false);SetupShowMoreComments(b,c);b.find(".comment-reply-row").each(function(){SetupRepliesControls($(this),c)});b.find(".comment-reply-row").hover(function(){$(this).find("span").attr("data-hover","true")},function(){$(this).find("span").attr("data-hover","false")})}function SetupAddEditComment(y,c,p){var j=null;var s=null;var v=null;var C=null;var q=null;var F=null;var l=null;var o=15;var A=600;var D=false;var z=false;var f=false;var t=false;var r=y.find(".comment-replies > table");var u=y.find(".add-reply");var g=c.replies.length;if(p){w()}else{u.click(function(){w()})}function m(){if(D){return}D=true;var G=$("<tr/>");if(p){G.addClass("comment-reply-row").addClass("reply-edit-row")}G.html('<td style="width: 0"></td><td class="comment-form"><form><table><form><table><tr><td style="width: 600px"><textarea required="required" name="body" cols="68" rows="3"></textarea></td><td><input type="submit" value="'+(p?LANG.save:LANG.addreply)+'" /><img src="'+g_staticUrl+'/images/icons/ajax.gif" class="ajax-loader" /></td></tr><tr><td colspan="2"><span class="text-counter">Text counter placeholder</span></td></tr></table></form></td>');s=G.find(".comment-form textarea");v=G.find(".comment-form input[type=submit]");C=G.find(".comment-form span.text-counter");j=G.find(".comment-form form");q=G.find(".comment-form .ajax-loader");F=G.find(".comment-form");j.submit(function(){k();return false});h();s.keyup(function(H){h()});s.keydown(function(H){if(H.keyCode==27){B();return false}});s.keypress(function(H){if(H.keyCode==13){k();return false}});if(p){y.after(G);y.hide();j.find("textarea").text(c.replies[y.attr("data-idx")].body)}else{r.append(G)}l=G;WH.safeFocus(j.find("textarea"))}function w(){if(!D){m()}z=true;if(!p){u.hide();y.find(".comment-replies").show();F.show()}}function B(){z=false;if(p){if(l){l.remove()}y.show();return}u.show();F.hide();if(g==0){y.find(".comment-replies").hide()}}function k(){if(!z||t){return}if(s.val().length<o||s.val().length>A){if(!f){f=true;C.animate({opacity:"0.0"},150);C.animate({opacity:"1.0"},150,null,function(){f=false})}return false}b();$.ajax({type:"POST",url:p?"/comment/edit-reply":"/comment=add-reply",data:{commentId:c.id,replyId:(p?y.attr("data-replyid"):0),body:s.val()},success:function(G){E(G)},dataType:"json",error:function(G){n(G.responseText)}});return true}function b(){t=true;q.show();v.prop("disabled",true);F.find(".wh-message-box").remove()}function d(){t=false;q.hide();v.prop("disabled",false)}function E(G){c.replies=G;Listview.templates.comment.updateReplies(c)}function n(G){d();MessageBox(F,G)}function h(){var J="(error)";var G="q0";var I=s.val().replace(/(\s+)/g," ").replace(/^\s*/,"").replace(/\s*$/,"").length;var H=A-I;if(I==0){J=WH.sprintf(LANG.replylength1_format,o)}else{if(I<o){J=WH.sprintf(LANG.replylength2_format,o-I)}else{J=WH.sprintf(H==1?LANG.replylength4_format:LANG.replylength3_format,H);if(H<120){G="q10"}else{if(H<240){G="q5"}else{if(H<360){G="q11"}}}}}C.html(J).attr("class",G)}}function SetupShowMoreComments(d,h){var f=d.find(".show-more-replies");var b=d.find(".comment-replies");f.click(function(){c()});function c(){f.hide();b.append($("<img>",{"class":"ajax-loader",alt:"",src:g_staticUrl+"/images/icons/ajax.gif"}));$.ajax({type:"GET",url:"/comment=show-replies",data:{id:h.id},success:function(j){h.replies=j;Listview.templates.comment.updateReplies(h)},dataType:"json",error:function(){g()}})}function g(){f.show();b.find(".ajax-loader").remove();MessageBox(b,"There was an error fetching the comments. Try refreshing the page.")}}function SetupRepliesControls(s,l){var q=s.attr("data-replyid");var g=s.find(".reply-upvote");var b=s.find(".reply-downvote");var m=s.find(".reply-report");var c=s.find(".reply-rating");var n=s.find(".reply-controls");var j=s.find(".reply-delete");var f=s.find(".reply-edit");var p=false;var r=false;f.click(function(){SetupAddEditComment(s,l,true)});m.click(function(){if(p||!confirm(LANG.replyreportwarning_tip)){return}p=true;$.ajax({type:"POST",url:"/comment=flag-reply",data:{id:q},success:function(){h()},error:function(t){d(t.responseText)}})});g.click(function(){if(g.attr("data-hasvoted")=="true"||g.attr("data-canvote")!="true"||p){return}p=true;$.ajax({type:"POST",url:"/comment=upvote-reply",data:{id:q},success:function(){o(1)},error:function(t){d(t.responseText)}})});b.click(function(){if(b.attr("data-hasvoted")=="true"||b.attr("data-canvote")!="true"||p){return}p=true;$.ajax({type:"POST",url:"/comment=downvote-reply",data:{id:q},success:function(){o(-1)},error:function(t){d(t.responseText)}})});j.click(function(){if(r){return}if(!confirm(LANG.deletereplyconfirmation_tip)){return}r=true;$.ajax({type:"POST",url:"/comment=delete-reply",data:{id:q},success:function(){k()},error:function(t){d(t.responseText)}})});function o(u){var t=parseInt(c.text());t+=u;c.text(t);if(u>0){g.attr("data-hasvoted","true")}else{b.attr("data-hasvoted","true")}g.attr("data-canvote","false");b.attr("data-canvote","false");if(ratingChance>0){m.remove()}p=false}function h(){p=false;m.remove()}function k(){s.remove();r=false}function d(t){p=false;r=false;if(!t){t="An error has occurred. Try refreshing the page."}MessageBox(n,t)}}function co_addYourComment(){tabsContribute.focus(0);var b=WH.gE(document.forms.addcomment,"textarea")[0];WH.safeFocus(b)}function co_validateForm(g){var d=WH.gE(g,"textarea")[0];var h=false;if(WH.isSet("tabsContribute")){for(var c=0;c<tabsContribute.tabs.length;c++){if(tabsContribute.tabs[c].id=="suggest-a-video"){h=c;break}}}if(h!==false&&d.value.length<350){var b;for(var c in vi_sitevalidation){if(!vi_sitevalidation.hasOwnProperty(c)){continue}if(b=vi_sitevalidation[c].exec(d.value)){break}}if(b&&!confirm(LANG.message_commentasvideo_tip)){tabsContribute.show(h);$('#tab-suggest-a-video input[name="videourl"]').attr("value",b[0]);return false}}if(Listview.funcBox.coValidate(d)){return true}return false}$(document).ready(function(){WH.setupChangeWarning($("form[name=addcomment]"),[$("textarea[name=commentbody]")],LANG.message_startedpost)});WH.cookiesEnabled=function(){document.cookie="enabledTest";return(document.cookie.indexOf("enabledTest")!=-1)?true:false};WH.getWowheadCookie=function(b){if(g_user.id>0){return g_user.cookies[b]}else{return WH.getCookies(b)}};WH.setWowheadCookie=function(d,f,c){var b=d.substr(0,5)=="temp_";if(!c&&g_user.id>0&&!b){new Ajax("/cookie="+d+"&"+d+"="+WH.urlEncode(f),{method:"get",onSuccess:function(g){if(g.responseText==0){g_user.cookies[d]=f}}})}else{if(c||g_user.id==0){WH.setCookie(d,14,f,"/",".wowhead.com")}}};var Dialog=function(){var h=this,d,v=null,q,c={},p,f=false,s=WH.ce("form"),g={};s.onsubmit=function(){t();return false};this.show=function(z,y){if(z){q=z;d=WH.cOr({},Dialog.templates[q]);h.template=d}else{return}if(d.onInit&&!f){(d.onInit.bind(h,s,y))()}if(y.onBeforeShow){c.onBeforeShow=y.onBeforeShow.bind(h,s)}if(d.onBeforeShow){d.onBeforeShow=d.onBeforeShow.bind(h,s)}if(y.onShow){c.onShow=y.onShow.bind(h,s)}if(d.onShow){d.onShow=d.onShow.bind(h,s)}if(y.onHide){c.onHide=y.onHide.bind(h,s)}if(d.onHide){d.onHide=d.onHide.bind(h,s)}if(y.onSubmit){c.onSubmit=y.onSubmit}if(d.onSubmit){v=d.onSubmit.bind(h,s)}if(y.data){f=false;p={};WH.cO(p,y.data)}h.data=p;Lightbox.show("dialog-"+q,{onShow:b,onHide:o})};this.getValue=function(y){return m(y)};this.setValue=function(z,y){l(z,y)};this.getSelectedValue=function(y){return u(y)};this.getCheckedValue=function(y){return w(y)};function b(y,z){if(z||!f){k(y)}if(d.onBeforeShow){d.onBeforeShow()}if(c.onBeforeShow){c.onBeforeShow()}Lightbox.setSize(d.width,d.height);y.className+=" dialog";r();if(d.onShow){d.onShow()}if(c.onShow){c.onShow()}window.setTimeout(n,5)}function n(){for(var y=0,A,z;A=d.fields[y];y++){if(WH.inArray(["text","number"],A.type)>=0){g[A.id].focus();break}}}function k(H){WH.ee(H);WH.ee(s);var I=WH.ce("div");I.className="lightbox-content text";WH.ae(H,I);WH.ae(I,s);if(d.title){WH.ae(s,WH.getImitationHeading(WH.ct(d.title),1))}var J=WH.ce("table"),F=WH.ce("tbody"),C=false;WH.ae(J,F);WH.ae(s,J);for(var P=0,Q=d.fields.length;P<Q;++P){var z=d.fields[P],A;if(!C){tr=WH.ce("tr");th=WH.ce("th");td=WH.ce("td")}z.__tr=tr;if(p[z.id]==null){p[z.id]=(z.value?z.value:"")}var B;if(z.options){B=[];if(z.optorder){WH.cO(B,z.optorder)}else{for(var O in z.options){B.push(O)}}if(z.sort){B.sort(function(V,U){return z.sort*WH.stringCompare(z.options[V],z.options[U])})}}switch(z.type){case"caption":th.colSpan=2;th.style.textAlign="left";th.style.padding=0;if(z.compute){(z.compute.bind(h,null,p[z.id],s,th,tr))()}else{if(z.label){WH.ae(th,WH.ct(z.label))}}WH.ae(tr,th);WH.ae(F,tr);continue;break;case"textarea":var R=A=WH.ce("textarea");R.name=z.id;if(z.disabled){R.disabled=true}R.rows=z.size[0];R.cols=z.size[1];td.colSpan=2;if(z.label){th.colSpan=2;th.style.textAlign="left";th.style.padding=0;td.style.padding=0;WH.ae(th,WH.ct(z.label));WH.ae(tr,th);WH.ae(F,tr);tr=WH.ce("tr")}WH.ae(td,R);break;case"select":var R=A=WH.ce("select");R.name=z.id;if(z.size){R.size=z.size}if(z.disabled){R.disabled=true}if(z.multiple){R.multiple=true}if(z.onchange){R.onchange=z.onchange.bind(h,R)}for(var O=0,E=B.length;O<E;++O){var L=WH.ce("option");L.value=B[O];WH.ae(L,WH.ct(z.options[B[O]]));WH.ae(R,L)}WH.ae(td,R);break;case"dynamic":td.colSpan=2;td.style.textAlign="left";td.style.padding=0;if(z.compute){(z.compute.bind(h,null,p[z.id],s,td,tr))()}WH.ae(tr,td);WH.ae(F,tr);A=td;break;case"checkbox":case"radio":var N=0;A=[];for(var O=0,E=B.length;O<E;++O){var K=WH.ce("span"),R,M,G="sdfler46"+z.id+"-"+B[O];if(O>0&&!z.noInputBr){WH.ae(td,WH.ce("br"))}M=WH.ce("label");M.setAttribute("for",G);M.onmousedown=WH.rf;R=WH.ce("input");R.setAttribute("type",z.type);R.name=z.id;R.value=B[O];R.id=G;if(z.disabled){R.disabled=true}if(z.onchange){R.onchange=z.onchange.bind(h,R)}if(z.submitOnDblClick){M.ondblclick=R.ondblclick=function(U){t()}}if(z.compute){(z.compute.bind(h,R,p[z.id],s,td,tr,M))()}WH.ae(M,R);WH.ae(M,WH.ct(z.options[B[O]]));WH.ae(td,M);A.push(R)}break;default:var R=A=WH.ce("input");R.name=z.id;if(z.size){R.size=z.size}if(z.disabled){R.disabled=true}if(z.submitOnEnter){R.onkeypress=function(U){U=WH.normalizeEvent(U);if(U.keyCode==13){t()}}}R.setAttribute("type",z.type);WH.ae(td,R);break}if(z.label){if(z.type=="textarea"){if(z.labelAlign){td.style.textAlign=z.labelAlign}td.colSpan=2}else{if(z.labelAlign){th.style.textAlign=z.labelAlign}WH.ae(th,WH.ct(z.label));WH.ae(tr,th)}}if(z.placeholder){R.placeholder=z.placeholder}if(z.type!="checkbox"&&z.type!="radio"){if(z.width){R.style.width=z.width}if(z.compute&&z.type!="caption"&&z.type!="dynamic"){(z.compute.bind(h,R,p[z.id],s,td,tr))()}}if(z.caption){var K=WH.ce("small");if(z.type!="textarea"){K.style.paddingLeft="2px"}WH.ae(K,WH.ct(z.caption));WH.ae(td,K)}if(z.style&&typeof R!=="undefined"){for(var D in z.style){R.style[D]=z.style[D]}}WH.ae(tr,td);WH.ae(F,tr);C=z.mergeCell;g[z.id]=A}var T={arrow:"external-link",check:"check",question:"question",x:"times"};for(var P=d.buttons.length;P>0;--P){var y=d.buttons[P-1],S=WH.ce("a");S.onclick=t.bind(S,y[0]);S.className="dialog-"+y[0]+" fa fa-"+T[y[0]];S.href="javascript:;";WH.ae(S,WH.ct(y[1]));WH.ae(H,S)}f=true}function r(){for(var B=0,y=d.fields.length;B<y;++B){var D=d.fields[B],C=g[D.id];switch(D.type){case"caption":break;case"select":for(var A=0,z=C.options.length;A<z;A++){C.options[A].selected=(C.options[A].value==p[D.id]||WH.inArray(p[D.id],C.options[A].value)!=-1)}break;case"checkbox":case"radio":for(var A=0,z=C.length;A<z;A++){C[A].checked=(C[A].value==p[D.id]||WH.inArray(p[D.id],C[A].value)!=-1)}break;default:C.value=p[D.id];break}if(D.update){(D.update.bind(h,null,p[D.id],s,C))()}}}function o(){if(d.onHide){d.onHide()}if(c.onHide){c.onHide()}}function t(A){if(A=="x"){return Lightbox.hide()}for(var z=0,y=d.fields.length;z<y;++z){var C=d.fields[z],B;switch(C.type){case"caption":continue;case"select":B=u(C.id);break;case"checkbox":case"radio":B=w(C.id);break;case"dynamic":if(C.getValue){B=C.getValue(C,p,s);break}default:B=m(C.id);break}if(C.validate){if(!C.validate(B,p,s)){return}}if(B&&typeof B=="string"){B=WH.trim(B)}p[C.id]=B}j(A)}function j(z){var y;if(v){y=v(p,z,s)}if(c.onSubmit){y=c.onSubmit(p,z,s)}if(y===undefined||y){Lightbox.hide()}return false}function m(y){return g[y].value}function l(z,y){g[z].value=y}function u(C){var z=[],B=g[C];for(var A=0,y=B.options.length;A<y;A++){if(B.options[A].selected){z.push(parseInt(B.options[A].value)==B.options[A].value?parseInt(B.options[A].value):B.options[A].value)}}if(z.length==1){z=z[0]}return z}function w(C){var z=[],B=g[C];for(var A=0,y=B.length;A<y;A++){if(B[A].checked){z.push(parseInt(B[A].value)==B[A].value?parseInt(B[A].value):B[A].value)}}return z}};Dialog.templates={};Dialog.extraFields={};WH.addCss=function(c){var d=WH.ce("style");d.type="text/css";if(d.styleSheet){d.styleSheet.cssText=c}else{WH.ae(d,WH.ct(c))}var b=document.getElementsByTagName("head")[0];WH.ae(b,d)};WH.setTextNodes=function(d,c){if(d.nodeType==3){d.nodeValue=c}else{for(var b=0;b<d.childNodes.length;++b){WH.setTextNodes(d.childNodes[b],c)}}};WH.setInnerHtml=function(f,d,b){if(f.nodeName.toLowerCase()==b){f.innerHTML=d}else{for(var c=0;c<f.childNodes.length;++c){WH.setInnerHtml(f.childNodes[c],d,b)}}};WH.getFirstTextContent=function(d){for(var c=0;c<d.childNodes.length;++c){if(d.childNodes[c].nodeName=="#text"){return d.childNodes[c].nodeValue}var b=WH.getFirstTextContent(d.childNodes[c]);if(b){return b}}return false};WH.getTextContent=function(d){var b="";for(var c=0;c<d.childNodes.length;++c){if(d.childNodes[c].nodeValue){b+=d.childNodes[c].nodeValue}else{if(d.childNodes[c].nodeName=="BR"){if(WH.Browser.ie67){b+="\r"}else{b+="\n"}}}b+=WH.getTextContent(d.childNodes[c])}return b};WH.toggleDisplay=function(f,c){var d=$(f);var b=d.is(":visible");if(c){d.slideToggle(150)}else{d.toggle()}if(!b){WH.Tools.Bloodmallet.updateChartsSizes(f)}return !b};WH.preventScroll=function(b,c){if(b){WH.aE(document,"mousewheel",WH.preventScroll.cancelScroll);WH.aE(window,"DOMMouseScroll",WH.preventScroll.cancelScroll);if(c){WH.aE(document.body,"touchmove",WH.preventScroll.touch.bind(c))}}else{WH.dE(document,"mousewheel",WH.preventScroll.cancelScroll);WH.dE(window,"DOMMouseScroll",WH.preventScroll.cancelScroll);WH.dE(document.body,"touchmove",WH.preventScroll.touch)}};WH.preventScroll.cancelScroll=function(b){if(b.stopPropagation){b.stopPropagation()}if(b.preventDefault){b.preventDefault()}b.returnValue=false;b.cancelBubble=true;return false};WH.preventScroll.touch=function(c){var d=$(this);if(d.length){var b=d.get(0);if(b.contains&&!b.contains(c.target)){c.preventDefault()}}else{c.preventDefault()}};WH.safeFocus=function(b){if(!Platform.isTouch()){$(b).focus()}};WH.safeSelect=function(b){if(!Platform.isTouch()){$(b).select()}};WH.setCaretPosition=function(d,c){if(!d){return}if(d.createTextRange){var b=d.createTextRange();b.move("character",c);b.select()}else{if(d.selectionStart!=undefined){d.focus();d.setSelectionRange(c,c)}else{d.focus()}}};WH.insertTag=function(g,k,b,m){var d=WH.ge(g);d.focus();if(d.selectionStart!=null){var o=d.selectionStart,j=d.selectionEnd,l=d.scrollLeft,f=d.scrollTop;var c=d.value.substring(o,j);if(typeof m=="function"){c=m(c)}d.value=d.value.substr(0,o)+k+c+b+d.value.substr(j);d.selectionStart=d.selectionEnd=j+k.length;d.scrollLeft=l;d.scrollTop=f}else{if(document.selection&&document.selection.createRange){var h=document.selection.createRange();if(h.parentElement()!=d){return}var c=h.text;if(typeof m=="function"){c=m(c)}h.text=k+c+b}}if(d.onkeyup){d.onkeyup()}};WH.onAfterTyping=function(c,f,d){var b;c.onkeyup=function(){if(b){clearTimeout(b);b=null}b=setTimeout(f,d)}};WH.isLeftClick=function(b){b=WH.normalizeEvent(b);return(b&&b._button==1)};WH.preventEmptyFormSubmission=function(){if(!$.trim(this.elements[0].value)){return false}};var Draggable=new function(){var b={},l={},o,g;function m(s){s=WH.normalizeEvent(s);if(this._handle){var p=s._target,r=false,q=0;while(p&&q<=3){if(p==this._handle){r=true;break}p=p.parentNode;++q}if(!r){return false}}o=this;b=WH.getCursorPos(s);WH.aE(document,"mousemove",d);WH.aE(document,"mouseup",j);if(o.onClick){o.onClick(s,o)}return false}function d(s){s=WH.normalizeEvent(s);var t=WH.getCursorPos(s);if(o){if(Math.abs(t.x-b.x)>5||Math.abs(t.y-b.y)>5){c(s,o);o=null}}if(!g||!g._bounds){return false}var r=k(g),q=t.x-b.x,p=t.y-b.y;q=Math.max(g._bounds.x1-l.x,Math.min(g._bounds.x2-l.x-(r.x2-r.x1),q));p=Math.max(g._bounds.y1-l.y,Math.min(g._bounds.y2-l.y-(r.y2-r.y1),p));n(q,p);return false}function j(p){p=WH.normalizeEvent(p);o=null;if(g){f(p)}}function c(q,p){if(g){f(q)}var r=WH.ac(p);l.x=r[0];l.y=r[1];if(p._targets.length){g=p.cloneNode(true);g._orig=p;WH.ae(document.body,g);n(-2323,-2323)}else{g=p}WH.Tooltip.disabled=true;WH.Tooltip.hide();if(p.onDrag){p.onDrag(q,g,p)}g._bounds=k(p._container);g.className+=" dragged"}function f(u){var t=false,v=WH.getCursorPos(u);if(g._orig&&g._orig._targets.length){h();var w={x1:g._x,x2:g._x+parseInt(g.offsetWidth),y1:g._y,y2:g._y+parseInt(g.offsetHeight)};WH.de(g);g=g._orig;for(var q=0,p=g._targets.length;q<p;++q){var s=g._targets[q],r=k(s);if(w.x2>=r.x1&&w.x1<r.x2&&w.y2>=r.y1&&w.y1<r.y2){t=true;if(g.onDrop){g.onDrop(u,g,s,(v.x>=r.x1&&v.x<=r.x2&&v.y>=r.y1&&v.y<=r.y2))}else{WH.ae(s,g)}}}}if(!t&&g.onDrop){g.onDrop(u,g,null)}WH.dE(document,"mousemove",d);WH.dE(document,"mouseup",j);WH.Tooltip.disabled=false;g.className=g.className.replace(/dragged/,"");g=null}function n(q,p){g.style.position="absolute";g.style.left=l.x+q+"px";g.style.top=l.y+p+"px";g._x=l.x+q;g._y=l.y+p}function h(){g.style.left="-2323px";g.style.top="-2323px"}function k(p){var q=WH.ac(p);return{x1:q[0],x2:q[0]+parseInt(p.offsetWidth),y1:q[1],y2:q[1]+parseInt(p.offsetHeight)}}this.init=function(t,s){t.onmousedown=m;var q=t.getElementsByTagName("a");for(var r=0,p=q.length;r<p;++r){WH.disableOldIESelect(q[r])}if(!t._targets){t._targets=[]}if(!t._container){t._container=document.body}if(s!=null){if(s.targets){for(var r=0,p=s.targets.length;r<p;++r){t._targets.push(WH.ge(s.targets[r]))}}if(s.container){t._container=WH.ge(s.container)}if(s.onClick){t.onClick=s.onClick}if(s.onDrop){t.onDrop=s.onDrop}if(s.onDrag){t.onDrag=s.onDrag}}}};WH.Entity=new function(){this.getLegacyPath=function(f,d,c,b){var g="/"+g_types[f]+"="+d;if(!c&&c!==false){c=WH.Gatherer.getName(f,d)}if(c){g+="/"+WH.urlize(c,true)}if(WH.isString(b)){if(b!==""){g+="?"+b}}else{if(WH.isObject(b)){b=WH.Url.constructQueryString(b);if(b){g+="?"+b}}}return g};this.getPath=function(f,d,c,b){var g="/"+g_types[f]+"/";if(!c&&c!==false){c=WH.Gatherer.getName(f,d)}if(c){g+=WH.urlize(c,true)+"-"+d}else{g+=d}if(WH.isString(b)){if(b!==""){g+="?"+b}}else{if(WH.isObject(b)){b=WH.Url.constructQueryString(b);if(b){g+="?"+b}}}return g}};var Facebook={getCurrentOpenGraphUrl:function(){return $("head meta[property='og:url']").attr("content")},createLikeButton:function(c,d){if(!d){d={}}var g,f,b;if(d.simple){f=90;b=21;g="button_count"}else{f=400;b=23;g="standard"}return $("<iframe/>",{src:"//www.facebook.com/plugins/like.php?href="+WH.urlEncode(c)+"&locale=en_US&layout="+g+"&show_faces=false&action=like&font=arial&colorscheme=dark&width="+f+"&height="+b,scrolling:"no",frameborder:"0",allowtransparency:"true",css:{border:"none",overflow:"hidden",width:f+"px",height:b+"px",display:"none"}}).on("load",function(){$(this).show()})}};var Favorites=new function(){var h=null;var d=null;var n=null;this.pageInit=function(q,p,r){if(typeof q=="string"){if(!document.querySelector){return}q=document.querySelector(q)}if(!q||typeof p!="number"||typeof r!="number"){return}h=p;d=r;k(q)};function j(){var p=typeof g_pageInfo=="object"&&typeof g_pageInfo.type=="number"&&typeof g_pageInfo.typeId=="number"?document.querySelector("#main-contents .heading-size-1"):null;if(!p){if(document.readyState!=="complete"){setTimeout(j,9)}return}h=g_pageInfo.type;d=g_pageInfo.typeId;k(p)}this.hasFavorites=function(){return !!g_favorites.length};this.getMenu=function(){var u=[];var B=0;var q=0;for(var v=0,t;t=g_favorites[v];v++){if(!t.entities.length){continue}B++;var C=[];for(var A=0,s;s=t.entities[A];A++){C.push([s[0],s[1],"/"+g_types[t.id]+"="+s[0]]);q++}Menu.sort(C);u.push([t.id,LANG.types[t.id][2],,C])}Menu.sort(u);if((B==1&&q<=45)||(B==2&&B+q<=30)||(B>2&&B+q<=15)){var z=[];for(var y=0;C=u[y];y++){z.push([,C[MENU_IDX_NAME]]);for(var w=0,p;p=C[MENU_IDX_SUB][w];w++){var r=[p[MENU_IDX_ID],p[MENU_IDX_NAME],p[MENU_IDX_URL]];if(p[MENU_IDX_OPT]){r[MENU_IDX_OPT]=p[MENU_IDX_OPT]}z.push(r)}}u=z}return u};this.refreshMenu=function(){var p=$(".zul-bar-user-item-favorites");if(!p.length){return}var q=Favorites.getMenu();if(!q.length){p.hide();return}Menu.add(p,q);p.show()};function k(p){n=$("<span/>",{"class":"fav-star fa"}).appendTo(p);if(WH.userIsLoggedIn()&&g_user.sessionKey){n.addClass("fa-star"+(o(h,d)?"":"-o")).click((function(r,s,q){g(r,s,q);m(r,s);WH.Tooltip.hide()}).bind(null,h,d,p.textContent.trim().replace(/(.+)<.*/,"$1")));WH.Tooltip.simpleNonTouch(n.get(0),function(){var q=this.className.match(/\bfa-star-o\b/)?LANG.addtofavorites:LANG.removefromfavorites;return'<div class="no-wrap">'+q+"</div>"},"q2",true)}else{n.addClass("fa-star-o").click(function(){WH.goToLoginPage()});WH.Tooltip.simpleNonTouch(n.get(0),LANG.favorites_login+'<div class="q2" style="margin-top:10px">'+LANG.clicktologin+"</span>",null,true)}}function m(q,s){if(n){var p="fa-star-o";var r="fa-star";if(!o(q,s)){p="fa-star";r="fa-star-o"}n.removeClass(p).addClass(r)}}function o(r,t){var q=c(r);if(q==-1){return false}for(var p=0,s;s=g_favorites[q].entities[p];p++){if(s[0]==t){return true}}return false}function g(q,r,p){if(o(q,r)){b(q,r)}else{f(q,r,p)}}function f(s,u,r){var q=c(s,true);if(q==-1){WH.error("Invalid type when adding entity to favorites! Type was:",s);return}for(var p=0,t;t=g_favorites[q].entities[p];p++){if(t[0]==u){alert(LANG.favorites_duplicate.replace("%s",LANG.types[s][1]));return}}l("add",s,u);g_favorites[q].entities.push([u,r]);Favorites.refreshMenu()}function b(r,t){var q=c(r);if(q==-1){return}for(var p=0,s;s=g_favorites[q].entities[p];p++){if(s[0]==t){l("remove",r,t);g_favorites[q].entities.splice(p,1);if(!g_favorites[q].entities.length){g_favorites.splice(q,1)}Favorites.refreshMenu();return}}}function c(r,p){if(!LANG.types[r]){return -1}for(var q=0,s;s=g_favorites[q];q++){if(s.id==r){return q}}if(!p){return -1}g_favorites.push({id:r,entities:[]});g_favorites.sort(function(u,t){return WH.stringCompare(LANG.types[u.id],LANG.types[t.id])});for(q=0;s=g_favorites[q];q++){if(s.id==r){return q}}return -1}function l(r,q,s){var p={id:s,sessionKey:g_user.sessionKey};p[r]=q;$.post("/account=favorites",p)}if(document.querySelector&&WH.localStorage.isSupported()){j()}};var ContactTool=new function(){this.general=0;this.comment=1;this.post=2;this.screenshot=3;this.video=5;this.guide=6;var b;var f={0:[[1,true],[9,true],[2,true],[8,true],[3,true],[4,true],[5,true],[6,true],[7,true]],1:[[15,function(g){return((g.roles&U_GROUP_MODERATOR)==0)}],[16,true],[18,function(g){return((g.roles&U_GROUP_MODERATOR)==0)}],[19,function(g){return((g.roles&U_GROUP_MODERATOR)==0)}],[20,function(g){return((g.roles&U_GROUP_MODERATOR)==0)}]],2:[[30,function(g){return(g_users&&g_users[g.user]&&(g_users[g.user].roles&U_GROUP_MODERATOR)==0)}],[37,function(g){return((g.roles&U_GROUP_MODERATOR)==0&&g_users&&g_users[g.user]&&(g_users[g.user].roles&U_GROUP_MODERATOR)==0&&g_users[g.user].avatar==2)}],[31,true],[32,true],[33,function(g){return(g_users&&g_users[g.user]&&(g_users[g.user].roles&U_GROUP_MODERATOR)==0)}],[34,function(g){return(g_users&&g_users[g.user]&&(g_users[g.user].roles&U_GROUP_MODERATOR)==0&&g.op&&!g.sticky)}],[35,function(g){return(g_users&&g_users[g.user]&&(g_users[g.user].roles&U_GROUP_MODERATOR)==0)}],[36,function(g){return(g_users&&g_users[g.user]&&(g_users[g.user].roles&U_GROUP_MODERATOR)==0)}]],3:[[45,true],[46,true],[47,function(g){return(g_users&&g_users[g.user]&&(g_users[g.user].roles&U_GROUP_MODERATOR)==0)}],[48,function(g){return(g_users&&g_users[g.user]&&(g_users[g.user].roles&U_GROUP_MODERATOR)==0)}]],5:[[45,true],[46,true],[47,function(g){return(g_users&&g_users[g.user]&&(g_users[g.user].roles&U_GROUP_MODERATOR)==0)}],[48,function(g){return(g_users&&g_users[g.user]&&(g_users[g.user].roles&U_GROUP_MODERATOR)==0)}]],6:[[45,true],[46,true],[48,true]]};var d={1:LANG.ct_resp_error1,2:LANG.ct_resp_error2,3:LANG.ct_resp_error3,7:LANG.ct_resp_error7};var c=null;this.displayError=function(h,g){alert(g)};this.onShow=function(){if(location.hash&&location.hash!="#contact"){c=location.hash}if(this.data.mode==0){location.replace("#contact")}};this.onHide=function(){if(c&&(c.indexOf("screenshots:")==-1||c.indexOf("videos:")==-1)){WH.setHash(c)}else{WH.clearHash()}};this.onSubmit=function(q,s,j){if(q.submitting){return false}for(var r=0;r<j.elements.length;++r){j.elements[r].disabled=true}var o=["contact=1","mode="+WH.urlEncode(q.mode),"reason="+WH.urlEncode(q.reason),"desc="+WH.urlEncode(q.description),"ua="+WH.urlEncode(navigator.userAgent),"appname="+WH.urlEncode(navigator.appName),"page="+WH.urlEncode(q.currenturl)];if(q.mode==0){if(q.relatedurl){o.push("relatedurl="+WH.urlEncode(q.relatedurl))}if(q.email){o.push("email="+WH.urlEncode(q.email))}}else{if(q.mode==1){o.push("id="+WH.urlEncode(q.comment.id))}else{if(q.mode==2){o.push("id="+WH.urlEncode(q.post.id))}else{if(q.mode==3){o.push("id="+WH.urlEncode(q.screenshot.id))}else{if(q.mode==5){o.push("id="+WH.urlEncode(q.video.id))}else{if(q.mode==6){o.push("id="+WH.urlEncode(q.guide))}}}}}}if(q.reason===1||q.reason===9){var t="";if(typeof WAS==="undefined"){t='"Ads" object not found. User may have ad blocking enabled. No ad log available.'}else{var g=WAS.getDfpLog();if(g&&g.length){t+="<br><b><i>DFP LOG</i></b><br>";for(var n=0,v;v=g[n];n++){t+="<br><b>"+v._time+"</b><br>";t+="<b>Unit:</b> "+v._env+" "+v._slot+"<br>";t+="<b>Channel:</b> "+v._channelName+" ("+v._channelGroup+")<br>";if(v._error){t+='<span style="color:#ff4040"><b>Error:</b> '+v._error+"</span><br>"}delete v._time;delete v._env;delete v._slot;delete v._channelName;delete v._channelGroup;delete v._error;var p=WH.objectToArray(v,"property");for(var k=0,u;u=p[k];k++){t+="<b>"+u.property+":</b> "+JSON.stringify(u.value)+"<br>"}}}if(t){t="<b>Ad Env: "+WAS.getAdSetupDescription()+"</b><br>"+t}}if(!t){t="No ad data. Probably blocked by user."}o.push("adinfo="+encodeURIComponent(t))}q.submitting=true;var h="/contactus";new Ajax(h,{method:"POST",params:o.join("&"),onSuccess:function(w,l){var m=w.responseText;if(m==0){if(g_user.name){alert(WH.sprintf(LANG.ct_dialog_thanks_user,g_user.name))}else{alert(LANG.ct_dialog_thanks)}Lightbox.hide()}else{if(d[m]){alert(d[m])}else{alert("Error: "+m)}}},onFailure:function(m,l){alert("Failure submitting contact request: "+m.statusText)},onComplete:function(w,m){for(var l=0;l<j.elements.length;++l){j.elements[l].disabled=false}q.submitting=false}});return false};this.show=function(g){if(!g){g={}}var j={mode:0};WH.cO(j,g);j.reasons=f[j.mode];if(location.href.indexOf("#contact")!=-1){j.currenturl=location.href.substr(0,location.href.indexOf("#contact"))}else{j.currenturl=location.href}var h="contactus";if(j.mode!=0){h="reportform"}if(!b){this.init()}b.show(h,{data:j,onShow:this.onShow,onHide:this.onHide,onSubmit:this.onSubmit})};this.checkPound=function(){if(location.hash&&location.hash=="#contact"){ContactTool.show()}};this.init=function(){b=new Dialog();Dialog.templates.contactusEmailOnly={title:LANG.ct_dialog_contactwowhead,width:550,buttons:[["x",LANG.cancel]],fields:[{id:"noemailwarning",type:"caption",compute:function(j,h,g,k){$(k).html('<b id="contact-emailwarn">'+WH.TERMS.contactDialogEmailOnly_tip.replace("%1$s",'<a href="mailto:feedback@wowhead.com">').replace("%2$s","</a>")+"</b>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(g){},onShow:function(g){setTimeout(Lightbox.reveal,250)}};Dialog.templates.contactus={title:LANG.ct_dialog_contactwowhead,width:550,buttons:[["check",LANG.ok],["x",LANG.cancel]],fields:[{id:"reason",type:"select",label:LANG.ct_dialog_reason,required:1,options:[],compute:function(p,q,j,m){WH.ee(p);for(var n=0;n<this.data.reasons.length;++n){var h=this.data.reasons[n][0];var k=this.data.reasons[n][1];var g=false;if(typeof k=="function"){g=k(this.extra)}else{g=k}if(!g){continue}var l=WH.ce("option");l.value=h;if(q&&q==h){l.selected=true}WH.ae(l,WH.ct(g_contact_reasons[h]));WH.ae(p,l)}p.onchange=function(){if(this.value==1||this.value==2||this.value==3){j.currenturl.parentNode.parentNode.style.display="";j.relatedurl.parentNode.parentNode.style.display=""}else{if(this.value==9){j.currenturl.parentNode.parentNode.style.display="";j.relatedurl.parentNode.parentNode.style.display="none"}else{j.currenturl.parentNode.parentNode.style.display="none";j.relatedurl.parentNode.parentNode.style.display="none"}}}.bind(p);m.style.width="98%"},validate:function(k,j,h){var g="";if(!k||k.length==0){g=LANG.ct_dialog_error_reason}if(g==""){return true}ContactTool.displayError(h.reason,g);WH.safeFocus(h.reason);return false}},{id:"currenturl",type:"text",disabled:true,label:LANG.ct_dialog_currenturl,size:40},{id:"relatedurl",type:"text",label:LANG.ct_dialog_relatedurl,caption:LANG.ct_dialog_optional,size:40,validate:function(l,k,j){var h="";var g=/^(http(s?)\:\/\/|\/)?([\w]+:\w+@)?([a-zA-Z]{1}([\w\-]+\.)+([\w]{2,5}))(:[\d]{1,5})?((\/?\w+\/)+|\/?)(\w+\.[\w]{3,4})?((\?\w+=\w+)?(&\w+=\w+)*)?/;l=l.trim();if(l.length>=250){h=LANG.ct_dialog_error_relatedurl}else{if(l.length>0&&!g.test(l)){h=LANG.ct_dialog_error_invalidurl}}if(h==""){return true}ContactTool.displayError(j.relatedurl,h);WH.safeFocus(j.relatedurl);return false}},{id:"email",type:"text",label:LANG.ct_dialog_email,caption:LANG.ct_dialog_email_caption,compute:function(l,k,h,m,j){var g=function(){$("#contact-emailwarn").css("display",WH.isEmailValid($(h.email).val())?"none":"");Lightbox.reveal()};$(l).keyup(g).blur(g)},validate:function(k,j,h){var g="";k=k.trim();if(k.length>=100){g=LANG.ct_dialog_error_emaillen}else{if(k.length>0&&!WH.isEmailValid(k)){g=LANG.ct_dialog_error_email}}if(g==""){return true}ContactTool.displayError(h.email,g);WH.safeFocus(h.email);return false}},{id:"description",type:"textarea",caption:LANG.ct_dialog_desc_caption,width:"98%",required:1,size:[10,30],validate:function(k,j,h){var g="";k=k.trim();if(k.length==0||k.length>100000){g=LANG.ct_dialog_error_desc}if(g==""){return true}ContactTool.displayError(h.description,g);WH.safeFocus(h.description);return false}},{id:"noemailwarning",type:"caption",compute:function(j,h,g,k){$(k).html('<span id="contact-emailwarn" class="q10">'+LANG.ct_dialog_noemailwarning+"</span>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(g){},onShow:function(g){if(this.data.focus&&g[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,g[this.data.focus],g[this.data.focus].value.length),100)}else{if(g.reason&&!g.reason.value){setTimeout(g.reason.focus.bind(g.reason),10)}else{if(g.relatedurl&&!g.relatedurl.value){setTimeout(g.relatedurl.focus.bind(g.relatedurl),10)}else{if(g.email&&!g.email.value){setTimeout(g.email.focus.bind(g.email),10)}else{if(g.description&&!g.description.value){setTimeout(g.description.focus.bind(g.description),10)}}}}}setTimeout(Lightbox.reveal,250)}};Dialog.templates.reportform={title:LANG.ct_dialog_report,width:550,buttons:[["check",LANG.ok],["x",LANG.cancel]],fields:[{id:"reason",type:"select",label:LANG.ct_dialog_reason,options:[],compute:function(q,s,k,n){switch(this.data.mode){case 1:k.firstChild.innerHTML=WH.sprintf(LANG.ct_dialog_reportcomment,'<a href="/user='+this.data.comment.user+'">'+this.data.comment.user+"</a>");break;case 2:var r='<a href="/user='+this.data.post.user+'">'+this.data.post.user+"</a>";if(this.data.post.op){k.firstChild.innerHTML=WH.sprintf(LANG.ct_dialog_reporttopic,r)}else{k.firstChild.innerHTML=WH.sprintf(LANG.ct_dialog_reportpost,r)}break;case 3:k.firstChild.innerHTML=WH.sprintf(LANG.ct_dialog_reportscreen,'<a href="/user='+this.data.screenshot.user+'">'+this.data.screenshot.user+"</a>");break;case 5:k.firstChild.innerHTML=WH.sprintf(LANG.ct_dialog_reportvideo,'<a href="/user='+this.data.video.user+'">'+this.data.video.user+"</a>");break;case 6:k.firstChild.innerHTML="Report guide";break}k.firstChild.setAttribute("style","");WH.ee(q);var m;if(this.data.mode==1){m=this.data.comment}else{if(this.data.mode==2){m=this.data.post}else{if(this.data.mode==3){m=this.data.screenshot}else{if(this.data.mode==5){m=this.data.video}else{if(this.data.mode==6){m=this.data.guide}}}}}WH.ae(q,WH.ce("option",{selected:(!s),value:-1}));for(var p=0;p<this.data.reasons.length;++p){var j=this.data.reasons[p][0];var h=this.data.reasons[p][1];var g=false;if(typeof h=="function"){g=h(m)}else{g=h}if(!g){continue}var l=WH.ce("option");l.value=j;if(s&&s==j){l.selected=true}WH.ae(l,WH.ct(g_contact_reasons[j]));WH.ae(q,l)}n.style.width="98%"},validate:function(k,j,h){var g="";if(!k||k==-1||k.length==0){g=LANG.ct_dialog_error_reason}if(g==""){return true}ContactTool.displayError(h.reason,g);WH.safeFocus(h.reason);return false}},{id:"description",type:"textarea",caption:LANG.ct_dialog_desc_caption,width:"98%",required:1,size:[10,30],validate:function(k,j,h){var g="";k=k.trim();if(k.length==0||k.length>10000){g=LANG.ct_dialog_error_desc}if(g==""){return true}ContactTool.displayError(h.description,g);WH.safeFocus(h.description);return false}}],onInit:function(g){},onShow:function(h){var j=$(h).find("*[name=reason]")[0];var g=$(h).find("*[name=description]")[0];if(this.data.focus&&h[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,h[this.data.focus],h[this.data.focus].value.length),100)}else{if(!j.value){setTimeout(j.focus.bind(j),10)}else{if(!g.value){setTimeout(g.focus.bind(g),10)}}}}}};$(document).ready(this.checkPound)};WH.Gatherer=new function(){var requested={};this.fetchItems=function(itemIDs,options){fetchData("items",itemIDs,options)};this.fetchSpells=function(spellIDs,options){fetchData("spells",spellIDs,options)};this.getName=function(entityType,entityId){if(!g_gathered_types[entityType]||!g_gathered_types[entityType][entityId]){return null}if(g_gathered_types[entityType][entityId].name){return g_gathered_types[entityType][entityId].name}return g_gathered_types[entityType][entityId]["name_"+Locale.getName()]};function fetchData(type,entityIDs,options){if(!options){options={}}var entityArray=prepareEntityArray(type,entityIDs,options);if(!entityArray.length){switch(typeof options.onSuccess){case"string":eval(options.onSuccess+"()");break;case"function":options.onSuccess();break}return}entityArray.sort();var url="/gatherer?"+type+"="+entityArray.join(",");if(typeof options.onSuccess=="string"){url+="&callback="+options.onSuccess}var callback=typeof options.onSuccess=="function"?options.onSuccess:null;$.getScript(url,callback)}function prepareEntityArray(type,entityIDs,options){if(!requested[type]){requested[type]={}}if(entityIDs instanceof Array){var entityArray=[];for(var i=0,entityID;entityID=entityIDs[i];i++){if(validateID(entityID)){if(requested[type][entityID]&&!options.forceRequest){}else{requested[type][entityID]=true;entityArray.push(entityID)}}}return entityArray}else{if(validateID(entityIDs)){if(requested[type][entityIDs]&&!options.forceRequest){return[]}else{requested[type][entityIDs]=true;return[entityIDs]}}else{if(typeof console!="undefined"&&typeof console.error=="function"){console.error("Gatherer requires an array of IDs or single ID!")}return[]}}}function validateID(id){return typeof id=="number"||(typeof id=="string"&&!id.match(/[^0-9]/))}};WH.displayStars=function(b){if(!b){b=".guide-image-link"}$(b).each(function(c,f){var d=f.getAttribute("data-rating");if(typeof d!=="undefined"){if(d!=="-1"){GetStars(d).appendTo($(f).children().first())}f.removeAttribute("data-rating")}})};function GetStars(b,l,p,o){var k=5;var j=b;if(p){b=p}b=Math.round(b*2)/2;var n=Math.round(b);var m=$("<span>").addClass("stars").addClass("max-"+k).addClass("stars-"+n);if(!g_user.id){l=false}if(l){m.addClass("ratable")}if(p){m.addClass("rated")}var c="<span>";var g=b;for(var f=1;f<=k;++f){if(g<1&&g>0){c+='<b class="stars-half">'}else{if(g<=0){c+='<b class="stars-empty">'}else{c+='<b class="stars-full">'}}g--;c+='<i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star-half"></i>'}for(var f=1;f<=k;++f){c+="</b>"}c+="</span>";m.append(c);if(l){var d=0;$("b",m).each(function(){var q=++d;$("> i",this).click(function(){VoteGuide(o,j,q);return false})})}if(p){var h=$("<span>").addClass("clear fa fa-times-circle").click(function(){VoteGuide(o,j,0)});m.append(h)}if(b>=0){m.mouseover(function(q){WH.Tooltip.showAtCursor(q,"Rating:&nbsp;"+b+"&nbsp;/&nbsp;"+k,0,0,"q")}).mousemove(function(q){WH.Tooltip.cursorUpdate(q)}).mouseout(function(){WH.Tooltip.hide()})}return m}function VoteGuide(guideId,oldRating,newRating){$("#guiderating").html(GetStars(oldRating,true,newRating,guideId));$.ajax({cache:false,url:"/guide=vote",type:"POST",error:function(){$("#guiderating").html(GetStars(oldRating,true,0,guideId));alert("Voting failed. Try again later.")},success:function(json){var data=eval("("+json+")");$("#guiderating-value").text(data.rating);$("#guiderating-votes").text(WH.getN5(data.nvotes))},data:{id:guideId,rating:newRating}})}function applyGuideStyles(){var b=$("#guide-body");if(b.length){$("table[border]",b).not("[class]").not('[border="0"]').addClass("grid");b.addClass("guide-styles")}}var Icon={questionMarkIcon:"inv_misc_questionmark",sizes:["small","medium","large","blizzard"],sizes2:[18,36,56,64],sizeIds:{small:0,medium:1,large:2,blizzard:3},premiumOffsets:[[-56,-36],[-56,0],[0,0],[0,0]],premiumBorderClasses:["-premium","-gold","","-premiumred","-red",""],STANDARD_BORDER:2,privilegeBorderClasses:{uncommon:"-q2",rare:"-q3",epic:"-q4",legendary:"-q5"},create:function(c,r,l,d,h,p,b,q,n){var k=WH.ce(n?"span":"div");var g=WH.ce("ins");var j=WH.ce("del");if(r==null){r=Icon.sizeIds.medium}k.className="icon"+Icon.sizes[r];WH.ae(k,g);if(!b){WH.ae(k,j)}if(c){Icon.setTexture(k,r,c)}if(d){var m=WH.ce("a");m.href=d;if(d.indexOf("wowhead.com")==-1&&d.substr(0,5)=="http:"){m.target="_blank"}WH.ae(k,m)}else{if(c){var o=k.firstChild.style;var f=(o.backgroundImage.indexOf("/avatars/")!=-1);if(!f){k.onclick=Icon.onClick;if(d!==false){var m=WH.ce("a");m.href="javascript:;";WH.ae(k,m)}}}}if(q&&typeof m!="undefined"){m.rel=q}Icon.setNumQty(k,h,p);return k},createUser:function(d,k,g,c,f,j,b){if(d==2){k=g_staticUrl+"/uploads/avatars/"+k+".jpg"}var h=Icon.create(k,g,null,c,null,null,j);if(f!=Icon.STANDARD_BORDER){if(Icon.premiumBorderClasses[f]){h.className+=" "+h.className+Icon.premiumBorderClasses[f]}}else{if(b&&Icon.privilegeBorderClasses.hasOwnProperty(b)){h.className+=" "+h.className+Icon.privilegeBorderClasses[b]}}if(d==2){Icon.moveTexture(h,g,Icon.premiumOffsets[g][0],Icon.premiumOffsets[g][1],true)}return h},getPrivilegeBorder:function(c){var b=false;if(c>=5000){b="uncommon"}if(c>=10000){b="rare"}if(c>=15000){b="epic"}if(c>=25000){b="legendary"}return b},setUrl:function(c,b){if(!b){b="javascript:;"}Icon.getLink(c).href=b},setTexture:function(f,d,c){var b=f.firstChild.style;if(!c){b.backgroundImage=null;return}if(c.indexOf("/")!=-1){b.backgroundImage="url("+c+")"}else{b.backgroundImage="url("+g_staticUrl+"/images/wow/icons/"+Icon.sizes[d]+"/"+c.toLowerCase()+".jpg)"}Icon.moveTexture(f,d,0,0)},moveTexture:function(g,d,b,h,f){var c=g.firstChild.style;if(b||h){if(f){c.backgroundPosition=b+"px "+h+"px"}else{c.backgroundPosition=(-b*Icon.sizes2[d])+"px "+(-h*Icon.sizes2[d])+"px"}}else{if(c.backgroundPosition){c.backgroundPosition=""}}},setNumQty:function(g,d,h){var c=WH.gE(g,"span");for(var f=0,b=c.length;f<b;++f){if(c[f]){WH.de(c[f])}}if(d!=null&&((d>1&&d<2147483647)||(d.length&&d!="0"&&d!="1"))){c=WH.createTextGlow(d,"q1");c.style.right="0";c.style.bottom="0";c.style.position="absolute";WH.ae(g,c)}if(h!=null&&h>0){c=WH.createTextGlow("("+h+")","q");c.style.left="0";c.style.top="0";c.style.position="absolute";WH.ae(g,c)}},getLink:function(b){return WH.gE(b,"a")[0]},showIconName:function(b){if(b.firstChild){var d=b.firstChild.style;if(d.backgroundImage.length&&(d.backgroundImage.indexOf(g_staticUrl)>=4||g_staticUrl=="")){var f=d.backgroundImage.lastIndexOf("/"),c=d.backgroundImage.indexOf(".jpg");if(f!=-1&&c!=-1){Icon.displayIcon(d.backgroundImage.substring(f+1,c))}}}},onClick:function(){Icon.showIconName(this)},displayIcon:function(c){if(!Dialog.templates.icondisplay){var b=392;switch(Locale.getId()){case LOCALE_ESES:b=408;break;case LOCALE_RURU:b=412;break}Dialog.templates.icondisplay={title:LANG.icon,width:b,buttons:[["arrow",LANG.original],["x",LANG.close]],fields:[{id:"icon",label:LANG.dialog_imagename,required:1,type:"text",labelAlign:"left",compute:function(g,f,d,k){k.className="icon-dialog-content";var j=WH.ce("div");var h=this.iconDiv=WH.ce("div");h.update=function(){setTimeout(function(){WH.safeSelect(g)},10);WH.ee(h);WH.ae(h,Icon.create(g.value,2))};WH.ae(h,Icon.create(f,2));WH.ae(j,h);WH.ae(j,g);WH.ae(k,j)}},{id:"location",label:" ",required:1,type:"caption",compute:function(j,h,f,d,g){WH.ee(d);d.className="icon-dialog-caption";var l=WH.ce("div");var k=LANG.dialog_seeallusingicon;k=k.replace("$1",'<a href="/items?filter=142;0;'+this.data.icon+'">'+LANG.types[3][3]+"</a>");k=k.replace("$2",'<a href="/spells?filter=15;0;'+this.data.icon+'">'+LANG.types[6][3]+"</a>");k=k.replace("$3",'<a href="/achievements?filter=10;0;'+this.data.icon+'">'+LANG.types[10][3]+"</a>");l.innerHTML=k;WH.ae(d,l)}}],onInit:function(d){this.updateIcon=this.template.updateIcon.bind(this,d)},onShow:function(d){this.updateIcon();if(location.hash&&location.hash.indexOf("#icon")==-1){this.oldHash=location.hash}else{this.oldHash=""}var f="#icon";var g=(WH.isSet("g_pageInfo")&&g_pageInfo.type&&WH.inArray([3,6,10],g_pageInfo.type)==-1);if(!g){f+=":"+this.data.icon}location.hash=f},onHide:function(d){if(this.oldHash){WH.setHash(this.oldHash)}else{WH.clearHash()}},updateIcon:function(d){this.iconDiv.update()},onSubmit:function(d,h,f,g){if(f=="arrow"){var j=window.open(g_staticUrl+"/images/wow/icons/large/"+h.icon.toLowerCase()+".jpg","_blank");j.focus();return false}return true}}}if(!Icon.icDialog){Icon.icDialog=new Dialog()}Icon.icDialog.show("icondisplay",{data:{icon:c}})},checkPound:function(){if(location.hash&&location.hash.indexOf("#icon")==0){var c=location.hash.split(":");var b=false;if(c.length==2){b=c[1]}else{if(c.length==1&&WH.isSet("g_pageInfo")){switch(g_pageInfo.type){case 3:b=g_items[g_pageInfo.typeId].icon.toLowerCase();break;case 6:b=g_spells[g_pageInfo.typeId].icon.toLowerCase();break;case 10:b=g_achievements[g_pageInfo.typeId].icon.toLowerCase();break}}}if(b){Icon.displayIcon(b)}}}};if(!WH.wowheadRemote){$(document).ready(Icon.checkPound)}var Lightbox=new function(){var f,o,r,l={},c={},p,d;function q(){WH.aE(f,"click",g);WH.aE(o,"click",h);WH.aE(document,"keydown",j);WH.aE(window,"resize",b)}function m(){WH.dE(f,"click",g);WH.dE(o,"click",h);WH.dE(document,"keydown",j);WH.dE(window,"resize",b)}function k(){if(p){return}p=1;var s=document.body;f=WH.ce("div");f.className="lightbox-overlay";o=WH.ce("div");o.className="lightbox-outer";r=WH.ce("div");r.className="lightbox-inner";f.style.display=o.style.display="none";WH.ae(s,f);WH.ae(o,r);WH.ae(s,o)}function j(s){s=WH.normalizeEvent(s);switch(s.keyCode){case 27:g();break}}function b(s){if(s!=1234){if(c.onResize){c.onResize()}}f.style.height=document.body.offsetHeight+"px"}function h(s){if(s.target&&s.target.className=="lightbox-outer"){g()}}function g(){if(!p){return}m();if(c.onHide){c.onHide()}f.style.display=o.style.display="none";WAS.restoreHidden();PoundChecker.resume();WH.preventScroll(false)}function n(){f.style.display=o.style.display=l[d].style.display="";Lightbox.setSize(r.offsetWidth,r.offsetHeight,1)}this.setSize=function(s,t,u){r.style.visibility="hidden";if(!u){r.style.width=s+"px"}r.style.visibility="visible"};this.show=function(w,u,t){c=u||{};Menu.hide(true);WH.Tooltip.hide();WAS.hideAll();PoundChecker.pause();k();q();if(d!=w&&l[d]!=null){l[d].style.display="none"}d=w;var v=0,s;if(l[w]==null){v=1;s=WH.ce("div",{className:"lightbox-frame"});WH.ae(r,s);l[w]=s}else{s=l[w];s.className="lightbox-frame"+(s.className?" "+s.className.replace(/lightbox-frame */,""):"")}if(c.onShow){c.onShow(s,v,t)}b(1234);n();WH.preventScroll(true,".lightbox-content")};this.reveal=function(){n()};this.hide=function(){g()};this.isVisible=function(){return(f&&f.style.display!="none")}};var Links=new function(){var c=null;var g=null;var d={item:1};var b={29:"icondb"};this.onShow=function(){if(location.hash&&location.hash!="#links"){g=location.hash}location.replace("#links")};this.onHide=function(){if(g&&(g.indexOf("screenshots:")==-1||g.indexOf("videos:")==-1)){WH.setHash(g)}else{WH.clearHash()}};this.show=function(h){if(!h||!h.type||!h.typeId){return}var t=g_types[h.type];if(!c){this.init()}if(d[t]){var n=false;for(var r in Dialog.templates.links.fields){if(Dialog.templates.links.fields[r].id==="armoryurl"){n=true}}if(!n){Dialog.templates.links.fields.push({id:"armoryurl",type:"text",label:"Armory URL",size:40})}}var u="";if(h.linkColor&&h.linkId&&h.linkName){u=WH.getIngameLink(h.linkColor,h.linkId,h.linkName)}if(h.sound){u="/script PlaySound("+h.sound+")"}if(h.dressup&&h.dressup.length){u='/run local function f(i,b)DressUpItemLink("item:"..i.."::::::::::::9:"..b);end;';for(var v=0,s;s=h.dressup[v];v++){while(s.length<2){s.push(0)}u+="f("+s.shift()+","+(s.length>1?('"'+s.join(":")+'"'):s.shift())+");"}}if(u){if(f(Dialog.templates.links.fields,"ingamelink")===false){Dialog.templates.links.fields.splice(Dialog.templates.links.fields.length-1,0,{id:"ingamelink",type:"text",label:"Ingame Link",size:40})}}var q={armoryurl:"http://us.battle.net/wow/en/"+t+"/"+h.typeId,ingamelink:u,markuptag:"["+(b[h.type]||t)+"="+h.typeId+((h.bonuses&&h.bonuses.length)?(" bonus="+h.bonuses.join(":")):"")+(h.spec?" spec="+h.spec:"")+"]"};var m="";var l=f(Dialog.templates.links.fields,"simcraft");if(t=="item"&&h.slot){var j,w,m="";w=parseInt(h.slot);for(var p in g_character_slots_data){if(!g_character_slots_data.hasOwnProperty(p)){continue}j=g_character_slots_data[p];if(WH.inArray(j.itemSlots,w)>=0){m=j.simCraftName||j.name;break}}if(m){q.simcraft=m+"="+h.linkName.toLowerCase().replace(/['\.]/g,"").replace(/\W/g,"_")+",id="+h.typeId;if(h.bonuses&&h.bonuses.length&&h.bonuses[0]!=0){q.simcraft+=",bonus_id="+h.bonuses.join("/")}if(h.dropLevel){q.simcraft+=",drop_level="+h.dropLevel}}}if(m){if(l===false){Dialog.templates.links.fields.splice(Dialog.templates.links.fields.length-1,0,{id:"simcraft",type:"text",label:"SimulationCraft",size:40})}}else{if(l!==false){Dialog.templates.links.fields.splice(l,1)}}c.show("links",{data:q,onShow:this.onShow,onHide:this.onHide,onSubmit:function(){return false}})};this.checkPound=function(){if(location.hash&&location.hash=="#links"){$("#open-links-button").click()}};this.init=function(){c=new Dialog();Dialog.templates.links={title:"Links",buttons:[["x",LANG.close]],fields:[{id:"markuptag",type:"text",label:"Markup Tag",size:40}],onInit:function(h){},onShow:function(h){setTimeout(function(){WH.safeSelect(h.ingamelink)},50);setTimeout(Lightbox.reveal,100)}}};function f(j,m){var k=false;for(var l,h=0;l=j[h];h++){if(l.id==m){k=h;break}}return k}$(document).ready(this.checkPound)};function li_addListMenu(b){var f=WH.ce("span");f.className="zul-bar-user-item-list-wrapper";if(!b){f.style.position="relative";f.style.opacity=0.1;f.style.right="-400px"}var c=WH.ce("a");c.href="javascript:;";c.id="zul-bar-user-item-lists";li_initListMenu(c);var h=WH.ce("span");h.className="zul-bar-user-item-list-text";h.innerHTML=LANG.li_myprofiles;var d=WH.ce("span");d.className="zul-bar-user-item-list-number";d.innerHTML=g_user.templists.length;var g=WH.ce("span");g.className="fa fa-chevron-down";WH.ae(c,h);WH.ae(c,d);WH.ae(c,g);WH.ae(f,c);$("#zul-bar-user").prepend(f);if(!b){$(f).animate({opacity:1,right:0},{duration:1000,easing:"easeOutBounce",complete:function(){if($(document.body).hasClass("home")){var j=WH.ce("span");j.className="zul-bar-user-item-list-warning";j.innerHTML='<a href="/account=signin">'+LANG.li_logintosave+"</a>";j.style.display="none";WH.aef(this,j);$(j).fadeIn()}}})}}$(document).ready(function(){if(g_user.templists&&g_user.templists.length){setTimeout(li_addListMenu,1000)}});function li_initListMenu(b){var c=[];g_user.templists.sort(function(f,d){return WH.stringCompare(f.name,d.name)});$.each(g_user.templists,function(d,f){c.push(li_generateListMenuItem(f))});$(b).addClass("hassubmenu");Menu.add(b,c)}function li_generateListUrl(b){return"/list="+b.id+"/"+b.url}function li_generateListMenuItem(d,b){var c={className:(d.mode!=1||(d.armory&&!d.errcode)?"listmanager-mode"+d.mode:"q10")};if(b&&d.region){if(d.thumbnail){c.armory="//render-"+d.region.toLowerCase()+".worldofwarcraft.com/character/"+d.thumbnail}else{if(d.race&&d.gender){c.armory="//"+d.region.toLowerCase()+".battle.net/wow/static/images/2d/avatar/"+d.race+"-"+d.gender+".jpg"}}}else{if(d.mode==1&&d.pinned){c.fontIcon="thumb-tack"}}return[d.id,d.name,li_generateListUrl(d),null,c]}function li_createList(h,c,g,b,f){WH.assertSession();if(h==1){if(!g||!b||!f){if(c!==null){alert(LANG.li_filloutdetails)}if(c){return}var d=new Dialog();d.show("fetchlist",{data:{region:g,realm:b,character:f},onSubmit:function(j){li_createList(1,false,j.region,j.realm,j.character);return false}});return}location.href="/list/"+WH.urlize(g+"-"+b+"-"+f,true)}else{new Ajax("/list&new",{method:"POST",params:"t="+new Date().getTime(),onSuccess:function(l,j){var k=li_onSaveTab(l,j);if(k){location.href=li_generateListUrl(k)}}})}}function li_addToSaved(v,m,A,q){v=v||window.event;var n;for(var u in g_types){if(g_types[u]==m){n=u;break}}if(!n||!A){return}if(!isNaN(A)){var z=(m=="currency"?"g_gatheredcurrencies":"g_"+m+"s");A=[$.extend({},window[z][A])];if(m=="item"){var b=WH.ge("tt"+A[0].id);if(b&&b._bonusesBtn&&b._bonusesBtn.selectedBonus){var h=b._bonusesBtn.selectedBonus.split(":");var c=h.indexOf("u");if(c!=-1){h.splice(c,1)}if(h&&h.length>0){A[0].bonuses=h}}}}var g={},p,d={"-1":function(C,D){var k=[];if(D.bonuses&&D.bonuses.length){for(var j in D.bonuses){if(D.bonuses[j]){k.push(D.bonuses[j])}}}return(C=="item"&&(D.classs==4||D.classs==2)&&D.id)?([D.id]).concat(k):false},"-2":function(j,k){return(j=="spell"&&k.cat==-5?k.id:false)},"-3":function(j,k){return(j=="npc"&&!k.untameable&&k.npc&&k.npc.type==12?k.npc.id:(j=="npc"&&k.type==12?k.id:false))}};for(var s in g_list_tabs){g[s]=[];for(var u=0;u<A.length;++u){if(n==s){g[s].push(A[u].id)}else{if(d[s]&&(p=d[s](m,A[u]))){g[s].push(p)}}}}for(var s in g){if(g[s].length!=A.length){delete g[s]}}var y=function(J,j,G,D,k,I){var C;var H=function(O,L){var M=li_onSaveTab(O,L);if(M){var N=$("#announcement-0").empty().offset().top;if($(document).scrollTop()>N){$("body").animate({scrollTop:N},1000)}I=I?'"'+I+'"':g_list_tabs[J];new Announcement({parent:"announcement-0",text:WH.sprintf('[span class="listmanager-announcement"][span class="icon-star"][/span]'+WH.sprintf(LANG.li_savedtotab,I)+': [url="/list=$1/$2"]'+k+"[/url].[/span]",M.id,M.url),style:"",nocookie:1,id:"list-"+M.id})}};var F="";if(J=="-1"){for(var K=0;K<j.length;++K){F+=((F=="")?"":",")+j[K].join(":")}}else{F=j.join(",")}if(G==null){var E=new Dialog();E.show("createlist",{data:{name:k,type:J,ids:F},onSubmit:function(M){var L="/list&new&type="+M.type+"&ids="+F;new Ajax(L,{method:"POST",params:"name="+WH.urlEncode(M.name)+"&t="+new Date().getTime(),onSuccess:H})}});return}else{if(D==null){C="/list&new-tab="+G+"&type="+J+"&ids="+F}else{C="/list="+G+"&append-tab="+D+"&ids="+F}}new Ajax(C,{method:"POST",params:"t="+new Date().getTime(),onSuccess:H})};var f=[[,LANG.li_choosealist]];for(var u in g_user.lists){var w=g_user.lists[u];if(w.mode==1){continue}var o=[];for(var s in g){for(var r=0;r<w.lists.length;++r){var l=w.lists[r];if(l.type!=s){continue}if(!o.length){o.push([,LANG.li_addtoexistingtab])}o.push([l.id,l.name,y.bind(null,s,g[s],w.id,l.id,w.name,l.name)])}}o.push([,LANG.li_createnewtab]);for(var s in g){o.push([-s,g_list_tabs[s],y.bind(null,s,g[s],w.id,null,w.name,null)])}f.push([w.id,w.name,,o])}if(g_user.canCreateList){var B=LANG.li_newlist,t=1;for(var u in g_user.lists){if(g_user.lists[u].name==B||g_user.lists[u].name==(B+" ("+t+")")){t++}}if(t>1){B+=" ("+t+")"}var o=[];o.push([,LANG.li_chooseatab]);for(var s in g){o.push([-s,g_list_tabs[s],y.bind(null,s,g[s],null,null,B,null)])}f.push([-1,LANG.li_createnewlist+"...",,o,{fontIcon:"plus"}])}if(g_user.id<1){f=[[0,LANG.li_addlogin,WH.getLoginUrl()]]}if(q){Menu.show(f,q)}else{Menu.showAtCursor(f,WH.normalizeEvent(v))}}function li_onSaveTab(xhr,opt){var text=xhr.responseText;if(text.charAt(0)!="{"||text.charAt(text.length-1)!="}"){return}var list=null;try{list=(JSON&&JSON.parse(text))||eval(text)}catch(e){return}if(!list||!list.id){return}return list}function li_getCurrentUserList(c){if(g_user.lists&&g_user.lists.length){for(var b in g_user.lists){if(g_user.lists[b].id==c){return g_user.lists[b]}}}return null}function li_getListStatus(id,onSuccess){new Ajax("/list&status="+id+"&t="+Math.random(),{method:"POST",onSuccess:function(xhr,opt){var response=eval(xhr.response)[0];if(!response.id){return}li_setButtonStatus(WH.ge("list-status"),response);if(response.refresh){setTimeout(li_getListStatus,response.refresh,id,onSuccess);return}if(response.status==3&&onSuccess){onSuccess()}}})}function li_setButtonStatus(f,d){var b=LANG["li_status"+d.status];var g=$("#list-delete");g.hide();if(d.errcode>0){b=LANG["li_code"+d.errcode]+" #"+d.errcode;g.show()}var h="";if(d.status==1||d.status==2){f.blur();h=" fa-spin";if(d.position===0){b+=WH.TERMS.colon_punct+WH.TERMS.nextInLine}else{b+=WH.TERMS.colon_punct+WH.sprintf(LANG.li_linenumber,WH.numberFormat(d.position))}}if(f){var c=" btn-";switch(d.status){case 1:case 2:c+="warning";break;case 3:c+="success";break;case 4:c+="danger";break;case 0:default:c+="primary"}f.className=f.className.replace(/ +btn-[^ ]+\b/,c).replace(/( fa-spin)?( +status-[^ ]+\b)?/,h+" status-"+d.status);f.innerHTML=b}}function li_updateRealmSelect(d,b){WH.ee(b);WH.ae(b,WH.ce("option"));if(!li_realms||!li_realms[d]){return}for(var c=0;c<li_realms[d].length;++c){var f=WH.ce("option");WH.st(f,li_realms[d][c]);WH.ae(b,f)}}function li_appendSticky(){var k=WH.ge("infobox-sticky-li");if(!k){return}var h=g_pageInfo.type;var b=g_pageInfo.typeId;if(lv_lists.length){var d=$("#infobox-lists");if(!d){d=$("th",$(k).parents().prev("tr"))}d.append(" ("+lv_lists.length+")").wrapInner($('<a href="#lists"></a>').click(function(){tabsRelated.focus(tabsRelated.getTabById("lists"));return false}))}var c=WH.ce("div");c.style.width="150px";c.style.whiteSpace="normal";c.style.margin="0 auto";var l=WH.arrayFilter(lv_lists,function(m){return m.user==g_user.name});if(l.length){WH.st(c,"You have added this to");WH.ae(c,WH.ce("br"));for(var f=0;f<l.length;++f){if(f>4){WH.ae(c,WH.ct(" and "+(l.length-f)+" more."));break}var g=l[f];var j=WH.ce("a");j.href=li_generateListUrl(g);j.className=(g.mode!=1||(g.armory&&!g.errcode)?"listmanager-mode"+g.mode:"q10");WH.st(j,l[f].name);if(f>0){WH.ae(c,WH.ct(f==l.length-1?LANG.and:", "))}WH.ae(c,j)}}else{if(g_user.id>0){WH.st(c,LANG.li_notaddedtolistyet)}}var j=WH.ce("a");j.href="/account=signin";if(g_user.canCreateList){j.href="javascript:;";j.onclick=(function(m){li_addToSaved.call(this,m,g_types[h],b)}).bind(j)}WH.st(j,LANG.li_addtolist);WH.ae(k,c);WH.ae(k,j);li_appendSticky=function(){}}Dialog.templates.createlist={title:LANG.li_createnewlist,width:400,buttons:[["check",LANG.ok],["x",LANG.cancel]],fields:[{id:"name",label:LANG.name,required:1,type:"text"}]};Dialog.templates.fetchlist={title:LANG.li_lookupbnetprofile,width:400,buttons:[["check",LANG.ok],["x",LANG.cancel]],fields:[{id:"region",label:LANG.region,required:1,type:"select",options:{US:"US",EU:"EU",KR:"KR",TW:"TW"},compute:function(g,f,c,h,d,b){g.id="dialog-region";$(g).change(function(){li_updateRealmSelect($(this).val(),$("#dialog-realm").get(0))})}},{id:"realm",label:LANG.realm,required:1,type:"select",options:[],compute:function(g,f,c,h,d,b){g.id="dialog-realm";li_updateRealmSelect($("#dialog-region").val(),g)}},{id:"character",label:LANG.li_character,required:1,type:"text"}]};WH.ajaxIshRequest("/data/realms");var g_listviews={};function Listview(b){WH.cO(this,b);if(typeof this.tabs==="string"){this.tabs=window[this.tabs]}if(this.id){var l=(this.tabs?"tab-":"lv-")+this.id;if(this.parent){var v=WH.ce("div");v.id=l;WH.ae(WH.ge(this.parent),v);this.container=v}else{this.container=WH.ge(l)}if(this.tabs){this.container.style.display="none"}}else{return}var z=WH.getGets();if((z.debug!=null||g_user.debug)&&g_user.roles&U_GROUP_STAFF){this.debug=true}if(this.template&&Listview.templates[this.template]){this.template=Listview.templates[this.template]}else{return}g_listviews[this.id]=this;if(this.data==null){this.data=[]}if(this.poundable==null){if(this.template.poundable!=null){this.poundable=this.template.poundable}else{this.poundable=true}}if(this.searchable==null){if(this.template.searchable!=null){this.searchable=this.template.searchable}else{this.searchable=false}}if(this.filtrable==null){if(this.template.filtrable!=null){this.filtrable=this.template.filtrable}else{this.filtrable=false}}if(this.sortable==null){if(this.template.sortable!=null){this.sortable=this.template.sortable}else{this.sortable=true}}if(this.customPound==null){if(this.template.customPound!=null){this.customPound=this.template.customPound}else{this.customPound=false}}if(this.data.length==1){this.filtrable=false;this.searchable=false}if(this.searchable&&this.searchDelay==null){if(this.template.searchDelay!=null){this.searchDelay=this.template.searchDelay}else{this.searchDelay=333}}if(this.clickable==null){if(this.template.clickable!=null){this.clickable=this.template.clickable}else{this.clickable=true}}if(this.hideBands==null){this.hideBands=this.template.hideBands}if(this.hideNav==null){this.hideNav=this.template.hideNav}if(this.hideHeader==null){this.hideHeader=this.template.hideHeader}if(this.hideCount==null){this.hideCount=this.template.hideCount}if(this.computeDataFunc==null&&this.template.computeDataFunc!=null){this.computeDataFunc=this.template.computeDataFunc}if(this.createCbControls==null&&this.template.createCbControls!=null){this.createCbControls=this.template.createCbControls}if(this.createTooltipToggle==null&&this.template.createTooltipToggle!=null){this.createTooltipToggle=this.template.createTooltipToggle}if(this.template.onBeforeCreate!=null){if(this.onBeforeCreate==null){this.onBeforeCreate=this.template.onBeforeCreate}else{this.onBeforeCreate=[this.template.onBeforeCreate,this.onBeforeCreate]}}if(this.onAfterCreate==null&&this.template.onAfterCreate!=null){this.onAfterCreate=this.template.onAfterCreate}if(this.onNoData==null&&this.template.onNoData!=null){this.onNoData=this.template.onNoData}if(this.createNote==null&&this.template.createNote!=null){this.createNote=this.template.createNote}if(this.sortOptions==null&&this.template.sortOptions!=null){this.sortOptions=this.template.sortOptions}if(this.customFilter==null&&this.template.customFilter!=null){this.customFilter=this.template.customFilter}if(this.onSearchSubmit==null&&this.template.onSearchSubmit!=null){this.onSearchSubmit=this.template.onSearchSubmit}if(this.getItemLink==null&&this.template.getItemLink!=null){this.getItemLink=this.template.getItemLink}if(this.noRowClick==null&&this.template.noRowClick!=null){this.noRowClick=this.template.noRowClick}if(this.forceBandTop==null&&this.template.forceBandTop!=null){this.forceBandTop=this.template.forceBandTop}if(this.completionText==null&&this.template.completionText!=null){this.completionText=this.template.completionText}if(this.completionText==null){this.completionText=LANG.lvcompletion}if(this.clip==null&&this.template.clip!=null){this.clip=this.template.clip}if(this.clip||this.template.compute||this.id=="topics"||this.id=="recipes"){this.debug=false}if(this.mode==null){this.mode=this.template.mode}if(this.template.noStyle!=null){this.noStyle=this.template.noStyle}if(this.nItemsPerPage==null){if(this.template.nItemsPerPage!=null){this.nItemsPerPage=this.template.nItemsPerPage}else{this.nItemsPerPage=50}}this.nItemsPerPage|=0;if(this.nItemsPerPage<=0){this.nItemsPerPage=0}this.nFilters=0;this.resetRowVisibility();if(this.mode==Listview.MODE_TILED){if(this.nItemsPerRow==null){var s=this.template.nItemsPerRow;this.nItemsPerRow=(s!=null?s:4)}this.nItemsPerRow|=0;if(this.nItemsPerRow<=1){this.nItemsPerRow=1}if(this.nextRowCheck==null){this.nextRowCheck=this.template.nextRowCheck}}else{if(this.mode==Listview.MODE_CALENDAR){this.dates=[];this.nItemsPerRow=7;this.nItemsPerPage=1;this.nDaysPerMonth=[];if(this.template.startOnMonth!=null){this.startOnMonth=this.template.startOnMonth}else{this.startOnMonth=new Date()}this.startOnMonth.setDate(1);this.startOnMonth.setHours(0,0,0,0);if(this.nMonthsToDisplay==null){if(this.template.nMonthsToDisplay!=null){this.nMonthsToDisplay=this.template.nMonthsToDisplay}else{this.nMonthsToDisplay=1}}var n=this.startOnMonth.getFullYear(),p=this.startOnMonth.getMonth();for(var q=0;q<this.nMonthsToDisplay;++q){var w=new Date(n,p+q,32);this.nDaysPerMonth[q]=32-w.getDate();for(var r=1;r<=this.nDaysPerMonth[q];++r){this.dates.push({date:new Date(n,p+q,r)})}}if(this.template.rowOffset!=null){this.rowOffset=this.template.rowOffset}}else{this.nItemsPerRow=1}}this.columns=[];for(var r=0,t=this.template.columns.length;r<t;++r){var B=this.template.columns[r],k={};WH.cO(k,B);this.columns.push(k)}if(this.extraCols!=null){for(var r=0,t=this.extraCols.length;r<t;++r){var g=null;var f=this.extraCols[r];if(f.after||f.before){var h=WH.inArray(this.columns,(f.after?f.after:f.before),function(d){return d.id});if(h!=-1){g=(f.after?h+1:h)}}if(g==null){g=this.columns.length}if(f.id=="debug-id"){this.columns.splice(0,0,f)}else{this.columns.splice(g,0,f)}}}this.visibility=[];var o=[],A=[];if(this.visibleCols!=null){WH.arrayWalk(this.visibleCols,function(d){o[d]=1})}if(this.hiddenCols!=null){WH.arrayWalk(this.hiddenCols,function(d){A[d]=1})}if($.isArray(this.sortOptions)){for(var r=0,t=this.sortOptions.length;r<t;++r){var f=this.sortOptions[r];if(o[f.id]!=null||(!f.hidden&&A[f.id]==null)){this.visibility.push(r)}}}else{for(var r=0,t=this.columns.length;r<t;++r){var f=this.columns[r];if(o[f.id]!=null||(!f.hidden&&A[f.id]==null)){this.visibility.push(r)}}}if(this.sort==null&&this.template.sort){this.sort=this.template.sort.slice(0)}if(this.sort!=null){var c=this.sort;this.sort=[];for(var r=0,t=c.length;r<t;++r){var f=parseInt(c[r]);if(isNaN(f)){var u=0;if(c[r].charAt(0)=="-"){u=1;c[r]=c[r].substring(1)}var h=WH.inArray(this.columns,c[r],function(d){return d.id});if(h!=-1){if(u){this.sort.push(-(h+1))}else{this.sort.push(h+1)}}}else{this.sort.push(f)}}}else{this.sort=[]}if(this.debug){this.columns.splice(0,0,{id:"debug-id",compute:function(d,j){if(d.id){WH.ae(j,WH.ct(d.id))}},getVisibleText:function(d){if(d.id){return d.id}else{return""}},getValue:function(d){if(d.id){return d.id}else{return 0}},sortFunc:function(j,d,m){if(j.id==null){return -1}else{if(d.id==null){return 1}}return WH.stringCompare(j.id,d.id)},name:"ID",width:"5%",tooltip:"ID"});this.visibility.splice(0,0,-1);for(var r=0,t=this.visibility.length;r<t;++r){this.visibility[r]=this.visibility[r]+1}for(var r=0,t=this.sort.length;r<t;++r){if(this.sort[r]<0){this.sort[r]=this.sort[r]-1}else{this.sort[r]=this.sort[r]+1}}}if(this.tabs){this.tabIndex=this.tabs.add(this.getTabName(),$.extend({id:this.id,onLoad:this.initialize.bind(this)},this.tabOpts));this.tabClick=Tabs.trackClick.bind(this.tabs,this.tabs.tabs[this.tabIndex])}else{this.initialize()}}Listview.MODE_DEFAULT=0;Listview.MODE_CHECKBOX=1;Listview.MODE_DIV=2;Listview.MODE_TILED=3;Listview.MODE_CALENDAR=4;Listview.MODE_FLEXGRID=5;Listview.prototype={initialize:function(){if(this.data.length){if(this.computeDataFunc!=null){for(var m=0,n=this.data.length;m<n;++m){this.computeDataFunc(this.data[m])}}}if(this.tabs){this.pounded=(this.tabs.poundedTab==this.tabIndex);if(this.pounded){this.readPound()}}else{this.readPound()}this.applySort();var l;if(this.onBeforeCreate!=null){if(typeof this.onBeforeCreate=="function"){l=this.onBeforeCreate()}else{for(var m=0;m<this.onBeforeCreate.length;++m){(this.onBeforeCreate[m].bind(this))()}}}this.noData=WH.ce("div");this.noData.className="listview-nodata text";if(this.mode==Listview.MODE_DIV){this.mainContainer=this.mainDiv=WH.ce("div");if(!this.noStyle){this.mainContainer.className="listview-mode-div"}}else{if(this.mode==Listview.MODE_FLEXGRID){this.mainContainer=this.mainDiv=WH.ce("div",{className:"listview-mode-flexgrid"});this.mainContainer.setAttribute("data-cell-min-width",this.template.cellMinWidth);if(this.clickable){this.mainContainer.className+=" clickable"}var c=$(".layout");var h=parseInt(c.css("max-width"))-(parseInt(c.css("padding-left"))||0)-(parseInt(c.css("padding-right"))||0);var k=Math.floor(h/this.template.cellMinWidth);var j='.listview-mode-flexgrid[data-cell-min-width="'+this.template.cellMinWidth+'"] > div {min-width:'+this.template.cellMinWidth+"px;width:"+(100/k)+"%}";var b=40;while(k--){if(k){j+="\n@media screen and (max-width: "+(((k+1)*this.template.cellMinWidth)-1+b)+"px) {";j+='\n    .listview-mode-flexgrid[data-cell-min-width="'+this.template.cellMinWidth+'"] > div {width:'+(100/k)+"%}";j+="\n}"}}if($(".layout.has-sidebar").length){h=h-$("#sidebar").outerWidth();k=Math.floor(h/this.template.cellMinWidth);j+='\n.layout.has-sidebar .listview-mode-flexgrid[data-cell-min-width="'+this.template.cellMinWidth+'"] > div {min-width:'+this.template.cellMinWidth+"px;width:"+(100/k)+"%}";while(k--){if(k){j+="\n@media screen and (max-width: "+(((k+1)*this.template.cellMinWidth)-1+b+320)+"px) {";j+='\n    .layout.has-sidebar .listview-mode-flexgrid[data-cell-min-width="'+this.template.cellMinWidth+'"] > div {width:'+(100/k)+"%}";j+="\n}"}}}$("<style/>").text(j).appendTo(document.head)}else{this.mainContainer=this.table=WH.ce("table");this.thead=WH.ce("thead");this.tbody=WH.ce("tbody");if(this.clickable){this.tbody.className="clickable"}if(this.mode==Listview.MODE_TILED||this.mode==Listview.MODE_CALENDAR){if(!this.noStyle){this.table.className="listview-mode-"+(this.mode==Listview.MODE_TILED?"tiled":"calendar")}var d=(100/this.nItemsPerRow)+"%",f=WH.ce("colgroup"),g;for(var m=0;m<this.nItemsPerRow;++m){g=WH.ce("col");g.style.width=d;WH.ae(f,g)}WH.ae(this.mainContainer,f);if(this.sortOptions){setTimeout((function(){this.updateSortArrow()}).bind(this),0)}}else{if(!this.noStyle){this.table.className="listview-mode-default"}this.createHeader();this.updateSortArrow()}WH.ae(this.table,this.thead);WH.ae(this.table,this.tbody)}}this.createBands();if(this.customFilter!=null){this.updateFilters()}this.updateNav();this.refreshRows();this.updateBrowseSession();if(this.onAfterCreate!=null){this.onAfterCreate(l)}},createHeader:function(){var j=WH.ce("tr");if(this.mode==Listview.MODE_CHECKBOX){var h=WH.ce("th"),k=WH.ce("div"),c=WH.ce("a");h.style.width="33px";c.href="javascript:;";c.className="listview-cb";WH.disableOldIESelect(c);WH.ae(c,WH.ct(String.fromCharCode(160)));WH.ae(k,c);WH.ae(h,k);WH.ae(j,h)}for(var g=0,b=this.visibility.length;g<b;++g){var f=this.visibility[g],d=this.columns[f],h=WH.ce("th");k=WH.ce("div"),c=WH.ce("a"),outerSpan=WH.ce("span"),innerSpan=WH.ce("span");d.__th=h;if(this.filtrable&&(d.filtrable==null||d.filtrable)){c.onmouseup=Listview.headerClick.bind(this,d,f);c.onclick=c.oncontextmenu=WH.rf}else{if(this.sortable&&(d.sortable==null||d.sortable)){c.href="javascript:;";c.onclick=this.sortBy.bind(this,f+1,false)}}if(c.onclick){if(!Platform.isTouch()){c.onmouseover=Listview.headerOver.bind(this,c,d);c.onmouseout=WH.Tooltip.hide}WH.disableOldIESelect(c)}else{c.className="static"}if(d.width!=null){h.style.width=d.width}if(d.align!=null){h.style.textAlign=d.align}if(d.span!=null){h.colSpan=d.span}WH.ae(innerSpan,WH.ct(d.name?d.name:String.fromCharCode(160)));WH.ae(outerSpan,innerSpan);WH.ae(c,outerSpan);WH.ae(k,c);WH.ae(h,k);WH.ae(j,h)}if(this.hideHeader){this.thead.style.display="none"}WH.ae(this.thead,j)},createSortOptions:function(j){if(!$.isArray(this.sortOptions)){return}var f=WH.ce("div");f.className="listview-sort-options";f.innerHTML=LANG.lvnote_sort;var h=WH.ce("span");h.className="listview-sort-options-choices";var d=null;if($.isArray(this.sort)){d=this.sort[0]}var b;var c=[];for(var g=0;g<this.sortOptions.length;g++){if(this.sortOptions[g].hidden){continue}b=WH.ce("a");b.href="javascript:;";b.innerHTML=this.sortOptions[g].name;b.onclick=this.sortGallery.bind(this,b,g+1);if(d===g+1){b.className="active"}c.push(b)}for(g=0;g<c.length;g++){WH.ae(h,c[g])}WH.ae(f,h);WH.aef(j,f)},sortGallery:function(b,c){var d=$(b);d.siblings("a").removeClass("active");d.addClass("active");this.sortBy(c)},createBands:function(){var s=WH.ce("div"),q=WH.ce("div"),t=WH.ce("div"),r=WH.ce("div");this.bandTop=s;this.bandBot=q;this.noteTop=t;this.noteBot=r;s.className="listview-band-top";q.className="listview-band-bottom";this.navTop=this.createNav(true);this.navBot=this.createNav(false);t.className=r.className="listview-note";if(this.note){t.innerHTML=this.note}else{if(this.createNote){this.createNote(t,r)}}this.createSortOptions(t);if(this.debug){WH.ae(t,WH.ct(" ("));var c=WH.ce("a");c.onclick=this.getList.bind(this);WH.ae(c,WH.ct("CSV"));WH.ae(t,c);WH.ae(t,WH.ct(")"))}if(this._errors){var f=WH.ce("small"),m=WH.ce("b");m.className="q10 icon-report";if(t.innerHTML){m.style.marginLeft="10px"}f.onmouseover=function(b){WH.Tooltip.showAtCursor(b,LANG.lvnote_witherrors,0,0,"q")};f.onmousemove=WH.Tooltip.cursorUpdate;f.onmouseout=WH.Tooltip.hide;WH.st(m,LANG.error);WH.ae(f,m);WH.ae(t,f)}if(!t.firstChild&&!(this.createCbControls||this.mode==Listview.MODE_CHECKBOX)){WH.ae(t,WH.ct(String.fromCharCode(160)))}if(!(this.createCbControls||this.mode==Listview.MODE_CHECKBOX)){WH.ae(r,WH.ct(String.fromCharCode(160)))}WH.ae(s,this.navTop);if(this.searchable){var p=this.updateFilters.bind(this,true),j=(this._truncated?LANG.lvsearchdisplayedresults:LANG.lvsearchresults),f=WH.ce("span"),d=WH.ce("em"),o=WH.ce("a"),n=WH.ce("input");f.className="listview-quicksearch";if(this.tabClick){$(f).click(this.tabClick)}WH.ae(f,d);o.href="javascript:;";o.onclick=function(){var b=this.nextSibling;b.value="";b.placeholder=j;p()};o.style.display="none";WH.ae(o,WH.ce("span"));WH.ae(f,o);WH.disableOldIESelect(o);d.className="fa fa-search";n.setAttribute("type","text");n.placeholder=j;n.style.width=(this._truncated?"20em":"16em");WH.onAfterTyping(n,p,this.searchDelay);n.onmouseover=function(){if(WH.trim(this.value)!=""){this.className=""}};n.onfocus=function(){this.className=""};n.onblur=function(){if(WH.trim(this.value)==""){this.value=""}};n.onkeypress=this.submitSearch.bind(this);WH.ae(f,n);this.quickSearchBox=n;this.quickSearchGlass=d;this.quickSearchClear=o;WH.ae(s,f)}WH.ae(s,t);if(this.showLootSpecs){this.classSelectorDiv=WH.ce("div");this.classSelectorDiv.id="class-selector";this.classSelectorDiv.style.paddingLeft="3px";var g="";g+='<div id="class-selector-c0" class="iconmedium active"><ins><span style="text-align: center; line-height: 30px; height: 30px; width: 30px;">'+LANG.su_note_all+'</span></ins><span><img src="'+g_staticUrl+'/images/Icon/medium/border/default.png" /></span><a href="javascript:;" data-classid="0"></a></div>';for(var l in g_file_classes){g+='<div id="class-selector-c'+l+'" class="iconmedium"><ins><img src="'+g_staticUrl+"/images/wow/icons/medium/class_"+g_file_classes[l]+'.jpg" /></ins><span><img src="'+g_staticUrl+'/images/Icon/medium/border/default.png" /></span><a href="javascript:;" data-classid="'+l+'"></a></div>'}this.classSelectorDiv.innerHTML=g;$("div.iconmedium a",this.classSelectorDiv).bind("mouseover",function(b){var v=parseInt($(b.target).attr("data-classid"));if(v){var u=g_chr_classes[v];WH.Tooltip.showAtCursor(b,u,0,0,"q")}});$("div.iconmedium",this.classSelectorDiv).bind("mouseout",function(b){WH.Tooltip.hide()});var h=this;$("div.iconmedium a",this.classSelectorDiv).bind("contextmenu",function(b){return false});$("div.iconmedium a",this.classSelectorDiv).bind("mousedown",function(u){var b=parseInt($(u.target).attr("data-classid"));switch(u.which){case 3:if(b&&$(u.target).parent().hasClass("active")){$(u.target).parent().removeClass("active");Listview.funcBox.filterByClass.call(h,null);$("#class-selector-c0").addClass("active")}break;default:$(".iconmedium",h.classSelectorDiv).removeClass("active");$(u.target).parent().addClass("active");Listview.funcBox.filterByClass.call(h,b);break}});$(s).append(this.classSelectorDiv);$(s).append('<div class="pad" style="clear: left;"></div>');if(WH.localStorage.get("dynamic_quest_class")){l=WH.localStorage.get("dynamic_quest_class");$("#class-selector-c"+l+" a",this.classSelectorDiv).trigger("mousedown")}}WH.ae(q,this.navBot);WH.ae(q,r);if(this.createCbControls||this.mode==Listview.MODE_CHECKBOX){if(this.note&&!this.showLootSpecs){t.style.paddingBottom="5px"}this.cbBarTop=this.createCbBar(true);this.cbBarBot=this.createCbBar(false);WH.ae(s,this.cbBarTop);WH.ae(q,this.cbBarBot);if(!this.noteTop.firstChild&&!this.cbBarTop.firstChild){this.noteTop.innerHTML="&nbsp;"}if(!this.noteBot.firstChild&&!this.cbBarBot.firstChild){this.noteBot.innerHTML="&nbsp;"}if(this.noteTop.firstChild&&this.cbBarTop.firstChild&&!this.showLootSpecs){this.noteTop.style.paddingBottom="6px"}if(this.noteBot.firstChild&&this.cbBarBot.firstChild){this.noteBot.style.paddingBottom="6px"}}if(this.hideBands&1){s.style.display="none"}if(this.hideBands&2){q.style.display="none"}WH.ae(this.container,this.bandTop);this.containerScroller=WH.ce("div");this.containerScroller.className="listview-scroller";WH.ae(this.container,this.containerScroller);if(this.clip){var k=WH.ce("div");k.className="listview-clip";k.style.width=this.clip.w+"px";k.style.height=this.clip.h+"px";this.clipDiv=k;WH.ae(k,this.mainContainer);WH.ae(k,this.noData);WH.ae(this.containerScroller,k)}else{WH.ae(this.containerScroller,this.mainContainer);WH.ae(this.containerScroller,this.noData)}WH.ae(this.container,this.bandBot)},createNav:function(j){var c=WH.ce("div"),f=WH.ce("a"),d=WH.ce("a"),b=WH.ce("a"),m=WH.ce("a"),l=WH.ce("span"),k=WH.ce("b"),h=WH.ce("b"),g=WH.ce("b");c.className="listview-nav";f.href=d.href=b.href=m.href="javascript:;";WH.ae(f,WH.ct(String.fromCharCode(171)+LANG.lvpage_first));WH.ae(d,WH.ct(String.fromCharCode(8249)+LANG.lvpage_previous));WH.ae(b,WH.ct(LANG.lvpage_next+String.fromCharCode(8250)));WH.ae(m,WH.ct(LANG.lvpage_last+String.fromCharCode(187)));WH.disableOldIESelect(f);WH.disableOldIESelect(d);WH.disableOldIESelect(b);WH.disableOldIESelect(m);f.onclick=this.firstPage.bind(this);d.onclick=this.previousPage.bind(this);b.onclick=this.nextPage.bind(this);m.onclick=this.lastPage.bind(this);if(this.mode==Listview.MODE_CALENDAR){WH.ae(k,WH.ct("a"));WH.ae(l,k)}else{WH.ae(k,WH.ct("a"));WH.ae(h,WH.ct("a"));WH.ae(g,WH.ct("a"));WH.ae(l,k);WH.ae(l,WH.ct(LANG.hyphen));WH.ae(l,h);WH.ae(l,WH.ct(LANG.lvpage_of));WH.ae(l,g)}WH.ae(c,f);WH.ae(c,d);WH.ae(c,l);WH.ae(c,b);WH.ae(c,m);if(j){if(this.hideNav&1){c.style.display="none"}}else{if(this.hideNav&2){c.style.display="none"}}if(this.tabClick){$("a",c).click(this.tabClick)}return c},createCbBar:function(b){var c=WH.ce("div");if(this.createCbControls){this.createCbControls(c,b)}if(this.createTooltipToggle){this.createTooltipToggle(c,b)}if(c.firstChild){c.className="listview-withselected"+(b?"":"2");WH.ae(c,this.createToggleAll())}return c},createToggleAll:function(){var c=WH.ce("a");c.className="listview-toggleall";var b=function(d){WH.Tooltip.showAtCursor(d,($("td:first-child input:checkbox:not(:checked)",$(this).parents(".listview")).length?LANG.lvnote_selectall:LANG.lvnote_deselectall),0,0,"q")};c.onclick=(function(d,g,h){var f=$("td:first-child",$(this).parents(".listview"));if($("input:checkbox:not(:checked)",f).length){Listview.cbSelect.call(d,true)}else{Listview.cbSelect.call(d,false)}g.call(this,h)}).bind(c,this,b);c.onmousedown=WH.rf;c.onmouseover=b;c.onmousemove=WH.Tooltip.cursorUpdate;c.onmouseout=WH.Tooltip.hide;return c},refreshRows:function(m){var o=null;switch(this.mode){case Listview.MODE_DIV:o=this.mainContainer;break;case Listview.MODE_FLEXGRID:o=this.mainDiv;break;default:o=this.tbody}if(!o){return}WH.ee(o);if(this.nRowsVisible==0){if(!this.filtered&&!this.forceBandTop){this.bandTop.style.display=this.bandBot.style.display="none";this.mainContainer.style.display="none"}this.noData.style.display="";this.showNoData();return}var r,d,f;if(!(this.hideBands&1)){this.bandTop.style.display=""}if(!(this.hideBands&2)){this.bandBot.style.display=""}if(this.nDaysPerMonth&&this.nDaysPerMonth.length){r=0;for(var l=0;l<this.rowOffset;++l){r+=this.nDaysPerMonth[l]}d=r+this.nDaysPerMonth[l]}else{if(this.nItemsPerPage>0){r=this.rowOffset;d=Math.min(r+this.nRowsVisible,r+this.nItemsPerPage);if(this.filtered&&this.rowOffset>0){for(var l=0,n=0;l<this.data.length&&n<this.rowOffset;++l){var t=this.data[l];if(t.__hidden||t.__deleted){++r}else{++n}}d+=(r-this.rowOffset)}}else{r=0;d=this.nRowsVisible}}var c=d-r;if(this.mode==Listview.MODE_DIV){for(var h=0;h<c;++h){var l=r+h,t=this.data[l];if(!t){break}if(t.__hidden||t.__deleted){++c;continue}WH.ae(this.mainDiv,this.getDiv(l))}}else{if(this.mode==Listview.MODE_FLEXGRID){for(var h=0;h<c;++h){var l=r+h;var s=this.data[l];if(!s){break}if(s.__hidden||s.__deleted){++c;continue}WH.ae(this.mainDiv,this.getDiv(l))}}else{if(this.mode==Listview.MODE_TILED){var g=0,p=WH.ce("tr");for(var h=0;h<c;++h){var l=r+h,t=this.data[l];if(!t){break}if(t.__hidden||t.__deleted){++c;continue}WH.ae(p,this.getCell(l,m));if((++g==this.nItemsPerRow)||(this.nextRowCheck&&this.nextRowCheck(this.data[l+1],t))){WH.ae(this.tbody,p);if(h+1<c){p=WH.ce("tr")}g=0}}if(g!=0){for(;g<4;++g){var q=WH.ce("td");q.className="empty-cell";WH.ae(p,q)}WH.ae(this.tbody,p)}}else{if(this.mode==Listview.MODE_CALENDAR){var p=WH.ce("tr");for(var l=0;l<7;++l){var b=WH.ce("th");WH.st(b,LANG.date_days[l]);WH.ae(p,b)}WH.ae(this.tbody,p);p=WH.ce("tr");for(var g=0;g<this.dates[r].date.getDay();++g){var q=WH.ce("td");q.className="empty-cell";WH.ae(p,q)}for(var h=r;h<d;++h){WH.ae(p,this.getEvent(h));if(++g==7){WH.ae(this.tbody,p);p=WH.ce("tr");g=0}}if(g!=0){for(;g<7;++g){var q=WH.ce("td");q.className="empty-cell";WH.ae(p,q)}WH.ae(this.tbody,p)}}else{for(var h=0;h<c;++h){var l=r+h,t=this.data[l];if(!t){break}if(t.__hidden||t.__deleted){++c;continue}WH.ae(this.tbody,this.getRow(l,m))}}}}}this.mainContainer.style.display="";this.noData.style.display="none";$WowheadPower.attachTouchTooltips(o)},showNoData:function(){var c=this.noData;WH.ee(c);var b=-1;if(this.onNoData){b=(this.onNoData.bind(this,c))()}if(b==-1){if(this.noDataText){WH.ae(this.noData,WH.ct(this.noDataText))}else{WH.ae(this.noData,WH.ct(this.filtered?LANG.lvnodata2:LANG.lvnodata))}}},getDiv:function(b){var c=this.data[b];if(c.__div==null||this.minPatchVersion!=c.__minPatch){this.createDiv(c,b)}return c.__div},createDiv:function(c,b){var d=WH.ce("div");c.__div=d;if(this.minPatchVersion){c.__minPatch=this.minPatchVersion}if(this.getItemLink&&this.clickable){d.onclick=this.itemClick.bind(this,c)}(this.template.compute.bind(this,c,d,b))()},getCell:function(c,b){var d=this.data[c];if(b||d.__td==null){this.createCell(d,c)}return d.__td},createCell:function(c,b){var d=WH.ce("td");c.__td=d;(this.template.compute.bind(this,c,d,b))()},getEvent:function(b){var c=this.dates[b];if(c.__td==null){this.createEvent(c,b)}return c.__td},createEvent:function(c,b){c.events=WH.arrayFilter(this.data,function(g){if(g.__hidden||g.__deleted){return false}var h=WH.getEventNextDates(g,c.date);if(h[0]&&h[1]){h[0].setHours(0,0,0,0);h[1].setHours(0,0,0,0);return h[0]<=c.date&&h[1]>=c.date}return false});var f=WH.ce("td");c.__td=f;if(c.date.getFullYear()==g_serverTime.getFullYear()&&c.date.getMonth()==g_serverTime.getMonth()&&c.date.getDate()==g_serverTime.getDate()){f.className="calendar-today"}var d=WH.ce("div");d.className="calendar-date";WH.st(d,c.date.getDate());WH.ae(f,d);d=WH.ce("div");d.className="calendar-event";WH.ae(f,d);(this.template.compute.bind(this,c,d,b))();if(this.getItemLink){f.onclick=this.itemClick.bind(this,c)}},getRow:function(c,b){var d=this.data[c];if(b||d.__tr==null){this.createRow(d)}return d.__tr},setRow:function(b){if(this.data[b.pos]){this.data[b.pos]=b;this.data[b.pos].__tr=b.__tr;this.createRow(this.data[b.pos]);this.refreshRows()}},createRow:function(l){var h=WH.ce("tr");l.__tr=h;if(this.mode==Listview.MODE_CHECKBOX){var c=WH.ce("td");if(!l.__nochk){c.className="listview-cb";c.onclick=Listview.cbCellClick;var d=WH.ce("input");WH.disableOldIESelect(d);d.type="checkbox";d.onclick=Listview.cbClick;if(l.__chk){d.checked=true}l.__cb=d;WH.ae(c,d)}WH.ae(h,c)}for(var f=0,g=this.visibility.length;f<g;++f){var j=this.visibility[f],b=this.columns[j],c=WH.ce("td"),k;if(b.align!=null){c.style.textAlign=b.align}if(b.compute){k=(b.compute.bind(this,l,c,h,j))()}else{if(l[b.value]!=null){k=l[b.value]}else{k=-1}}if(k!=-1&&k!=null){c.insertBefore(WH.ct(k),c.firstChild)}WH.ae(h,c)}if(this.mode==Listview.MODE_CHECKBOX&&l.__chk){h.className="checked"}if(l.frommerge==1){h.className+=" mergerow"}if(this.getItemLink){h.onclick=this.itemClick.bind(this,l)}},itemClick:function(f,d){if(this.noRowClick){return}d=WH.normalizeEvent(d);var b=0,c=d._target;while(c&&b<3){if(c.nodeName=="A"){return}c=c.parentNode}location.href=this.getItemLink(f)},submitSearch:function(d){d=WH.normalizeEvent(d);if(!this.onSearchSubmit||d.keyCode!=13){return}for(var c=0,b=this.data.length;c<b;++c){if(this.data[c].__hidden){continue}(this.onSearchSubmit.bind(this,this.data[c]))()}},validatePage:function(){var d=this.nItemsPerPage,c=this.rowOffset,b=this.nRowsVisible;if(c<0){this.rowOffset=0}else{if(this.mode==Listview.MODE_CALENDAR){this.rowOffset=Math.min(c,this.nDaysPerMonth.length-1)}else{this.rowOffset=this.getRowOffset(c+d>b?b-1:c)}}},getRowOffset:function(c){var b=this.nItemsPerPage;return(b>0&&c>0?Math.floor(c/b)*b:0)},resetRowVisibility:function(){for(var c=0,b=this.data.length;c<b;++c){this.data[c].__hidden=false}this.filtered=false;this.rowOffset=0;this.nRowsVisible=this.data.length},getColText:function(f,c,b){var d="";if(this.template.getVisibleText){d=WH.trim(this.template.getVisibleText(f)+" ")}if(c.getVisibleText){return d+c.getVisibleText(f)}if(c.getValue){return d+c.getValue.call(this,f)}if(c.value){return d+f[c.value]}if(c.compute){return d+c.compute.call(this,f,WH.ce("td"),WH.ce("tr"),b)}return""},resetFilters:function(){for(var f=0,b=this.visibility.length;f<b;++f){var d=this.visibility[f];var c=this.columns[d];if(c.__filter){c.__th.firstChild.firstChild.className="";c.__filter=null;this.nFilters--}}},updateFilters:function(b){WH.Tooltip.hide();this.resetRowVisibility();var y,t,h;if(this.searchable){this.quickSearchBox.parentNode.style.display="";y=WH.trim(this.quickSearchBox.value);if(y){this.quickSearchGlass.style.display="none";this.quickSearchClear.style.display="";y=y.toLowerCase().replace(/\s+/g," ");t=y.split(" ");h=t.length}else{this.quickSearchGlass.style.display="";this.quickSearchClear.style.display="none"}}else{if(this.quickSearchBox){this.quickSearchBox.parentNode.style.display="none"}}if(!y&&this.nFilters==0&&this.customFilter==null&&this.classFilter==null){if(b){this.updateNav();this.refreshRows();this.updateBrowseSession()}return}var v={1:function(j,k){return j>k},2:function(j,k){return j==k},3:function(j,k){return j<k},4:function(j,k){return j>=k},5:function(j,k){return j<=k},6:function(j,E,k){return E<=j&&j<=k}};var r={1:function(k,j,E){return j>E},2:function(k,j,E){return k<=E&&E<=j},3:function(k,j,E){return k<E},4:function(k,j,E){return j>=E},5:function(k,j,E){return k<=E},6:function(k,j,F,E){return F<=j&&k<=E}};var s=0;for(var A=0,B=this.data.length;A<B;++A){var f=this.data[A],o=0;nSearchMatches=0,matches=[];f.__hidden=true;if(this.customFilter&&!this.customFilter(f,A)){continue}if(this.customFilter2&&!this.customFilter2(f,A)){continue}if(this.classFilter&&!this.classFilter(f,A)){continue}for(var z=0,g=this.visibility.length;z<g;++z){var p=this.visibility[z];var c=this.columns[p];if(c.__filter){var m=c.__filter,l=false;if(c.type!=null&&c.type=="range"){var q=c.getMinValue(f),D=c.getMaxValue(f);l=(r[m.type])(q,D,m.value,m.value2)}else{if(c.type==null||c.type=="num"||m.type>0){var u=null;if(c.getValue){u=c.getValue(f)}else{if(c.value){u=parseFloat(f[c.value])}}if(!u){u=0}l=(v[m.type])(u,m.value,m.value2)}else{var n=this.getColText(f,c,p);if(n){n=n.toString().toLowerCase();if(m.invert){l=n.match(m.regex)!=null}else{var C=0;for(var w=0,d=m.words.length;w<d;++w){if(n.indexOf(m.words[w])!=-1){++C}else{break}}l=(C==m.words.length)}}}}if(m.invert){l=!l}if(l){++o}else{break}}if(y){var n=this.getColText(f,c,p);if(n){n=n.toString().toLowerCase();for(var w=0,d=t.length;w<d;++w){if(!matches[w]){if(n.indexOf(t[w])!=-1){matches[w]=1;++nSearchMatches}}}}}}if(f.__alwaysvisible||((this.nFilters==0||o==this.nFilters)&&(!y||nSearchMatches==h))){f.__hidden=false;++s}}this.filtered=(s<this.data.length);this.nRowsVisible=s;if(b){this.updateNav();this.refreshRows();this.updateBrowseSession()}},changePage:function(){this.validatePage();this.refreshRows();this.updateNav();this.updatePound();this.updateBrowseSession();var b=WH.getScroll(),d=WH.ac(this.container);if(b.y>d[1]){scrollTo(b.x,d[1])}},firstPage:function(){this.rowOffset=0;this.changePage();return false},previousPage:function(){this.rowOffset-=this.nItemsPerPage;this.changePage();return false},nextPage:function(){this.rowOffset+=this.nItemsPerPage;this.changePage();return false},lastPage:function(){this.rowOffset=99999999;this.changePage();return false},addSort:function(b,d){var c=WH.inArray(b,Math.abs(d),function(f){return Math.abs(f)});if(c!=-1){d=b[c];b.splice(c,1)}b.splice(0,0,d)},sortBy:function(d,c){var b=this.sortOptions||this.columns;if(d<=0||d>b.length){return}this.searchSort=false;if(Math.abs(this.sort[0])==d&&!c){this.sort[0]=-this.sort[0]}else{var f=-1;if(b[d-1].type=="text"){f=1}this.addSort(this.sort,f*d)}this.applySort();this.refreshRows();this.updateSortArrow();this.updatePound()},applySort:function(){if(this.sort.length==0){return}Listview.sort=this.sort;Listview.columns=this.columns;Listview.sortOptions=this.sortOptions;if(this.template.beforeSort){this.template.beforeSort.call(this)}if(this.indexCreated){this.data.sort(Listview.sortIndexedRows.bind(this))}else{this.data.sort(Listview.sortRows.bind(this))}this.updateSortIndex();this.updateBrowseSession()},setSort:function(b,c,d){this.searchSort=false;if(this.sort.toString()!=b.toString()){this.sort=b;this.applySort();if(c){this.refreshRows()}if(d){this.updatePound()}}},readPound:function(){if(!this.poundable||!location.hash.length){return false}var c=location.hash.substr(1);if(this.tabs){var k=c.lastIndexOf(":");if(k==-1){return false}c=c.substr(k+1)}var b=parseInt(c);if(!isNaN(b)){this.rowOffset=b;this.validatePage();if(this.poundable!=2){var g=[];var j=c.match(/(\+|\-)[0-9]+/g);if(j!=null){var f=this.sortOptions||this.columns;for(var d=j.length-1;d>=0;--d){var h=parseInt(j[d])|0;var c=Math.abs(h);if(c<=0||c>f.length){break}this.addSort(g,h)}this.setSort(g,false,false)}}if(this.tabs){this.tabs.setTabPound(this.tabIndex,this.getTabPound())}}},updateBrowseSession:function(){if((!window.JSON)||(!WH.localStorage.isSupported())){return}if(typeof fi_filters=="undefined"&&typeof Filter=="undefined"&&location.pathname!="/search"){return}if(this.data.length<3){return}if(typeof this.getItemLink!="function"){return}var l=5;var g=location.pathname+location.search;var f=(new Date(g_serverTime.getTime()-1000*60*60*24*3)).getTime();var d=WH.localStorage.get("lvBrowse");if(d){d=window.JSON.parse(d);for(var c=0;c<d.length;c++){if((d[c].path==g)||(d[c].when<f)){d.splice(c--,1)}}if(d.length>=l){d.splice(l-1,d.length-l-1)}}else{d=[]}var k=[],j,h=/^\/[-a-z]+=\d+/i;for(var c=0;c<this.data.length;c++){if(j=h.exec(this.getItemLink(this.data[c]))){k.push(j[0])}}if(k.length<3){return}d.unshift({path:g,hash:location.hash,when:g_serverTime.getTime(),urls:k});WH.localStorage.set("lvBrowse",window.JSON.stringify(d))},updateSortArrow:function(){if(!this.sort.length||!this.thead||this.mode==Listview.MODE_CALENDAR||this.searchSort){return}var b=WH.inArray(this.visibility,Math.abs(this.sort[0])-1);if(b==-1){return}if(this.mode==Listview.MODE_TILED){if(!this.sortOptions){return}var d=$(".listview-sort-options a",this.noteTop).get(b);if(this.lsa&&this.lsa!=d){this.lsa.className=""}d.className=this.sort[0]<0?"active sortdesc":"active sortasc";this.lsa=d;return}if(this.mode==Listview.MODE_CHECKBOX&&b<this.thead.firstChild.childNodes.length-1){b+=1}var c=this.thead.firstChild.childNodes[b].firstChild.firstChild.firstChild;if(this.lsa&&this.lsa!=c){this.lsa.className=""}c.className=(this.sort[0]<0?"sortdesc":"sortasc");this.lsa=c},updateSortIndex:function(){var c=this.data;for(var d=0,b=c.length;d<b;++d){c[d].__si=d}this.indexCreated=true},updateTabName:function(){if(this.tabs&&this.tabIndex!=null){this.tabs.setTabName(this.tabIndex,this.getTabName())}},updatePound:function(c){if(!this.poundable){return}var b="",f="";if(c){if(location.hash.length&&this.tabs){var d=location.hash.lastIndexOf(":");if(d!=-1&&!isNaN(parseInt(location.hash.substr(d+1)))){b=location.hash.substr(d+1)}}}else{b=this.getTabPound()}if(this.customPound){f=this.customPound}else{if(this.tabs){f=this.id}}if(b&&this.tabs){this.tabs.setTabPound(this.tabIndex,b)}location.replace("#"+f+(f&&b?":":"")+b)},updateNav:function(){var g=[this.navTop,this.navBot],n=this.nItemsPerPage,l=this.rowOffset,h=this.nRowsVisible,d=0,j=0,f=0,m=0,b=new Date();if(h>0){if(!(this.hideNav&1)){g[0].style.display=""}if(!(this.hideNav&2)){g[1].style.display=""}}else{g[0].style.display=g[1].style.display="none"}if(this.mode==Listview.MODE_CALENDAR){for(var c=0;c<this.nDaysPerMonth.length;++c){if(c==l){if(c>0){j=1}if(c>1){d=1}if(c<this.nDaysPerMonth.length-1){f=1}if(c<this.nDaysPerMonth.length-2){m=1}}}b.setTime(this.startOnMonth.valueOf());b.setMonth(b.getMonth()+l)}else{if(n){if(l>0){j=1;if(l>=n+n){d=1}}if(l+n<h){f=1;if(l+n+n<h){m=1}}}}for(var c=0;c<2;++c){var k=g[c].childNodes;k[0].setAttribute("data-visible",d?"yes":"no");k[1].setAttribute("data-visible",j?"yes":"no");k[3].setAttribute("data-visible",f?"yes":"no");k[4].setAttribute("data-visible",m?"yes":"no");k=k[2].childNodes;if(this.mode==Listview.MODE_CALENDAR){k[0].firstChild.nodeValue=LANG.date_months[b.getMonth()]+" "+b.getFullYear()}else{k[0].firstChild.nodeValue=l+1;k[2].firstChild.nodeValue=n?Math.min(l+n,h):h;k[4].firstChild.nodeValue=h}}if(!d&&!j&&!f&&!m){$(g[0]).addClass("listview-nav-nocontrols");$(g[1]).addClass("listview-nav-nocontrols")}else{$(g[0]).removeClass("listview-nav-nocontrols");$(g[1]).removeClass("listview-nav-nocontrols")}},getTabName:function(){var c=this.name,f=this.data.length;for(var d=0,b=this.data.length;d<b;++d){if(this.data[d].__hidden||this.data[d].__deleted){--f}}if(typeof this.forceQuantity=="number"||typeof this.forceQuantity=="string"){f=this.forceQuantity}if((f>0||typeof this.forceQuantity=="string")&&!this.hideCount){c+=WH.sprintf(LANG.qty,f)}return c},getTabPound:function(){var b="";b+=this.rowOffset;if(this.poundable!=2&&this.sort.length){b+=("+"+this.sort.join("+")).replace(/\+\-/g,"-")}return b},getCheckedRows:function(){var f=[];for(var d=0,b=this.data.length;d<b;++d){var c=this.data[d];if((c.__cb&&c.__cb.checked)||(!c.__cb&&c.__chk)){f.push(c)}}return f},resetCheckedRows:function(){for(var d=0,b=this.data.length;d<b;++d){var c=this.data[d];if(c.__cb){c.__cb.checked=false}else{if(c.__chk){c.__chk=null}}if(c.__tr){c.__tr.className=c.__tr.className.replace("checked","")}}},deleteRows:function(d){if(!d||!d.length){return}for(var c=0,b=d.length;c<b;++c){var f=d[c];if(!f.__hidden&&!f.__hidden){this.nRowsVisible-=1}f.__deleted=true}this.updateTabName();if(this.rowOffset>=this.nRowsVisible){this.previousPage()}else{this.refreshRows();this.updateNav();this.updateBrowseSession()}},setData:function(b){this.data=b;this.indexCreated=false;this.resetCheckedRows();this.resetRowVisibility();if(this.tabs){this.pounded=(this.tabs.poundedTab==this.tabIndex);if(this.pounded){this.readPound()}}else{this.readPound()}this.applySort();this.updateSortArrow();if(this.customFilter!=null||this.classFilter!=null){this.updateFilters()}this.updateNav();this.refreshRows();this.updateBrowseSession()},getClipDiv:function(){return this.clipDiv},getNoteTopDiv:function(){return this.noteTop},getNoDataDiv:function(){return this.noData},focusSearch:function(){WH.safeFocus(this.quickSearchBox)},clearSearch:function(){this.quickSearchBox.value=""},getList:function(){if(!this.debug){return}var c="";for(var b=0;b<this.data.length;b++){if(!this.data[b].__hidden){c+=this.data[b].id+", "}}listviewIdList.show(c)},createIndicator:function(b,g,k,j){if(!this.noteIndicators){this.noteIndicators=WH.ce("div");this.noteIndicators.className="listview-indicators";$(this.noteIndicators).insertBefore($(this.noteTop))}var d=this.tabClick;var h=$('<span class="indicator"></span>').html(b).append(!g?"":$('<a class="indicator-x" style="outline: none">[x]</a>').attr("href",(typeof g=="function"?"javascript:;":g)).click(function(){if(d){d()}if(typeof g=="function"){g()}})).css("cursor",(typeof k=="function"?"pointer":null)).click(function(){if(d){d()}if(typeof k=="function"){k()}});if(j){WH.Tooltip.simple(h.get(0),j,"q")}$(this.noteIndicators).append(h);$(this.noteTop).css("padding-top","7px");if(!this.showLootSpecs){$(this.noteTop).css("padding-bottom","11px")}return h[0]},removeIndicators:function(){if(this.noteIndicators){$(this.noteIndicators).remove();this.noteIndicators=null}$(this.noteTop).css("padding-top","")},createProgressBar:function(s,r,d,o,q,h){if(!this.noteProgressBars){this.noteProgressBars=WH.ce("table");this.noteProgressBars.className="listview-progressbars";$(this.noteProgressBars).insertBefore($(this.noteTop))}var m=4;if(isNaN(q)||q<1){q=1}if(q>m){q=m}var p=this.noteProgressBars.lastChild,g=q;if(p&&p.childNodes){for(var k=0;k<p.childNodes.length;++k){g+=(p.childNodes[k].colSpan||1)}}if(!p||g>m){p=WH.ce("tr");WH.ae(this.noteProgressBars,p)}var f=WH.ce("td");if(q>1){f.colSpan=q}if(d){f.className="clickable";f.onclick=function(){d.apply(this,o)}}if(s){var b=WH.ce("div");b.className="heading";WH.st(b,s);WH.ae(f,b)}var j=WH.ce("div");j.className="bar-wrap";var l=WH.ce("div");l.className="bar-bg";WH.ae(j,l);if(r[2]){var n=WH.ce("div");n.className="bar yellow";n.style.width=Math.round(((r[1]+r[2]+r[5])/r[0])*1000)/10+"%";WH.ae(j,n)}var n=WH.ce("div");n.className="bar";n.style.width=Math.round(((r[1]+r[5])/r[0])*1000)/10+"%";if(h){n.className+=" "+h}WH.ae(j,n);if(r[5]){var n=WH.ce("div");n.className="bar gray";n.style.width=Math.round((r[5]/r[0])*1000)/10+"%";WH.ae(j,n)}else{r[5]=0}var c=WH.ce("span");WH.st(c,(r[1]+r[5])+(r[2]||r[3]?" ("+(r[3]||r[2])+")":"")+" / "+r[0]);WH.ae(j,c);WH.ae(f,j);WH.ae(p,f);$(this.noteTop).css("padding-top","")},removeProgressBars:function(){if(this.noteProgressBars){$(this.noteProgressBars).remove();this.noteProgressBars=null}$(this.noteTop).css("padding-top","")},addTooltipToggle:function(j,h){if(!g_user.premium){return}var f=false;for(var c=0;c<this.data.length;c++){if(h[this.data[c].id]&&h[this.data[c].id].hasOwnProperty("screenshot")){f=true;break}}if(!f){return}WH.Tooltip.hideScreenshots=true;if(WH.localStorage.isSupported()){WH.Tooltip.hideScreenshots=WH.localStorage.get("tooltipScreenshots")!="1"}var b=function(){WH.Tooltip.hideScreenshots=!this.checked;if(WH.localStorage.isSupported()){if(this.checked){WH.localStorage.set("tooltipScreenshots","1")}else{WH.localStorage.remove("tooltipScreenshots")}}$("input[type=checkbox].tooltipToggle").prop("checked",!!this.checked)};var d=WH.ce("label");var g=WH.ce("input");g.type="checkbox";g.className="tooltipToggle";g.checked=!WH.Tooltip.hideScreenshots;WH.aE(g,"click",b.bind(g));WH.ae(d,g);WH.ae(d,WH.ct(LANG.lvnote_screenshottooltips));WH.ae(j,d)},noteTopFormIsEmpty:function(){var b=true;$("input, select",this.noteTop).each(function(){switch(this.tagName){case"INPUT":if(this.value){b=false;return false}break;case"SELECT":if($(this).val()){b=false;return false}break}});return b}};Listview.sortRows=function(f,d){var k=Listview.sort,l=Listview.sortOptions||Listview.columns;if(this.searchSort&&f.hasOwnProperty("searchpopularity")&&d.hasOwnProperty("searchpopularity")&&((f.searchpopularity>0)||(d.searchpopularity>0))){return WH.stringCompare(d.searchpopularity,f.searchpopularity)}for(var j=0,c=k.length;j<c;++j){var h,g=l[Math.abs(k[j])-1];if(!g){g=this.template}if(g.sortFunc){h=g.sortFunc.call(this,f,d,k[j])}else{h=WH.stringCompare(f[g.value],d[g.value])}if(h!=0){return h*k[j]}}return 0};Listview.sortIndexedRows=function(f,d){var h=Listview.sort,j=Listview.sortOptions||Listview.columns,g;if(this.searchSort&&f.hasOwnProperty("searchpopularity")&&d.hasOwnProperty("searchpopularity")&&((f.searchpopularity>0)||(d.searchpopularity>0))){return WH.stringCompare(d.searchpopularity,f.searchpopularity)}for(var c in h){_=j[Math.abs(h[c])-1];if(!_){_=this.template}if(_.sortFunc){g=_.sortFunc.call(this,f,d,h[0])}else{g=WH.stringCompare(f[_.value],d[_.value])}if(g!=0){return g*h[c]}}return(f.__si-d.__si)};Listview.cbSelect=function(d){for(var g=0,c=this.data.length;g<c;++g){var f=this.data[g];var j=d;if(f.__hidden){continue}if(!f.__nochk&&f.__cb){var b=f.__cb,h=b.parentNode.parentNode;if(j==null){j=!b.checked}if(b.checked!=j){b.checked=j;h.className=(b.checked?h.className+" checked":h.className.replace("checked",""))}}else{if(j==null){j=true}}f.__chk=j}};Listview.cbClick=function(b){setTimeout(Listview.cbUpdate.bind(0,0,this,this.parentNode.parentNode),1);WH.sp(b)};Listview.cbCellClick=function(b){setTimeout(Listview.cbUpdate.bind(0,1,this.firstChild,this.parentNode),1);WH.sp(b)};Listview.cbUpdate=function(c,b,d){if(c){b.checked=!b.checked}d.className=(b.checked?d.className+" checked":d.className.replace("checked",""))};Listview.cbAddToList=function(b,c){var d=this.getCheckedRows();if(!d.length){return}li_addToSaved(b,c,d)};Listview.headerClick=function(b,c,d){d=WH.normalizeEvent(d);if(this.tabClick){this.tabClick()}if(d._button==3||d.shiftKey||d.ctrlKey){WH.Tooltip.hide();setTimeout(Listview.headerFilter.bind(this,b,null),1)}else{this.sortBy(c+1)}return false};Listview.headerFilter=function(c,f){var k="";if(c.__filter){if(c.__filter.invert){k+="!"}k+=c.__filter.text}if(f==null){f=prompt(WH.sprintf(LANG.prompt_colfilter1+"\n\n"+(c.type=="text"?LANG.prompt_colfilter2:LANG.prompt_colfilter3),c.name),k)}if(f!=null){var b={text:"",type:-1};f=WH.trim(f.replace(/\s+/g," "));if(!f&&this.onEmptyFilter){this.onEmptyFilter(c)}else{if(f){if(f.charAt(0)=="!"||f.charAt(0)=="-"){b.invert=1;f=f.substr(1)}if(c.type=="text"){b.type=0;b.text=f;if(b.invert){b.regex=WH.createOrRegex(f)}else{b.words=f.toLowerCase().split(" ")}}var l,g;if(f.match(/(>|=|<|>=|<=)\s*([0-9\.]+)/)){l=parseFloat(RegExp.$2);if(!isNaN(l)){switch(RegExp.$1){case">":b.type=1;break;case"=":b.type=2;break;case"<":b.type=3;break;case">=":b.type=4;break;case"<=":b.type=5;break}b.value=l;b.text=RegExp.$1+" "+l}}else{if(f.match(/([0-9\.]+)\s*\-\s*([0-9\.]+)/)){l=parseFloat(RegExp.$1);g=parseFloat(RegExp.$2);if(!isNaN(l)&&!isNaN(g)){if(l>g){var h=l;l=g;g=h}if(l==g){b.type=2;b.value=l;b.text="= "+l}else{b.type=6;b.value=l;b.value2=g;b.text=l+" - "+g}}}else{var d=f.toLowerCase().split(" ");if(!c.allText&&d.length==1&&!isNaN(l=parseFloat(d[0]))){b.type=2;b.value=l;b.text="= "+l}else{if(c.type=="text"){b.type=0;b.text=f;if(b.invert){b.regex=WH.createOrRegex(f)}else{b.words=d}}}}}if(b.type==-1){alert(LANG.message_invalidfilter);return}}}if(!c.__filter||b.text!=c.__filter.text||b.invert!=c.__filter.invert){var j=c.__th.firstChild.firstChild;if(f&&b.text){if(!c.__filter){j.className="q5";this.nFilters++}c.__filter=b}else{if(c.__filter){j.className="";this.nFilters--}c.__filter=null}this.updateFilters(1)}}};Listview.headerOver=function(c,d,f){if(!((this.sortable&&(d.sortable==null||d.sortable))||(this.filtrable&&(d.filtrable==null||d.filtrable)))){return}var b="";b+='<b class="q1">'+(d.tooltip?d.tooltip:d.name)+"</b>";if(d.__filter){b+="<br />"+WH.sprintf((d.__filter.invert?LANG.tooltip_colfilter2:LANG.tooltip_colfilter1),d.__filter.text)}b+='<br /><span class="q2">'+LANG.tooltip_lvheader1+"</span>";if(this.filtrable&&(d.filtrable==null||d.filtrable)){b+='<br /><span class="q2">'+(WH.Browser.opera?LANG.tooltip_lvheader3:LANG.tooltip_lvheader2)+"</span>"}WH.Tooltip.show(c,b,0,0,"q")};Listview.extraCols={id:{id:"id",name:"ID",width:"5%",compute:function(b,c){if(b.id){WH.ae(c,WH.ct(b.id))}}},patch:{id:"obj-patch",name:LANG.patch,compute:function(g,j){if(typeof g.patch!="undefined"){var b=parseInt(g.patch);if(b==0||b==-1){WH.ae(j,WH.ct("???"))}else{var c=Math.floor(b/10000);var f=Math.floor(b/100)%100;var h=b%100;var d=WH.sprintf("$1.$2.$3",c,f,h);WH.ae(j,WH.ct(d))}}},sortFunc:function(d,c,f){if(d.patch==c.patch){return 0}else{if(d.patch<c.patch){return -1}else{return 1}}}},date:{id:"obj-date",name:LANG.added,compute:function(d,f){if(d.date){if(d.date<=86400){WH.ae(f,WH.ct("???"))}else{var c=new Date(d.date*1000);var b=(g_serverTime-c)/1000;return WH.formatDate(f,b,c,null,true)}}},sortFunc:function(d,c,f){if(d.date==c.date){return 0}else{if(d.date<c.date){return -1}else{return 1}}}},cost:{id:"cost",name:LANG.cost,getValue:function(b){if(b.cost){return(b.cost[2]&&b.cost[2][0]?b.cost[2][0][1]:0)||(b.cost[1]&&b.cost[1][0]?b.cost[1][0][1]:0)||b.cost[0]}},compute:function(h,j){if(h.cost){var f=h.cost[0];var d=null;var c=h.cost[2];var b=h.cost[1];var g=0;if(h.side!=null){d=h.side}else{if(h.react!=null){if(h.react[0]==1&&h.react[1]==-1){d=1}else{if(h.react[0]==-1&&h.react[1]==1){d=2}}}}Listview.funcBox.appendMoney(j,f,d,c,b,g)}},sortFunc:function(d,c,f){if(d.cost==null){return -1}else{if(c.cost==null){return 1}}var k=0,j=0,h=0,g=0;if(d.cost[2]!=null){WH.arrayWalk(d.cost[2],function(b,l,n,m){k+=Math.pow(10,m)+b[1]})}if(c.cost[2]!=null){WH.arrayWalk(c.cost[2],function(b,l,n,m){j+=Math.pow(10,m)+b[1]})}if(d.cost[1]!=null){WH.arrayWalk(d.cost[1],function(b,l,n,m){h+=Math.pow(10,m)+b[1]})}if(c.cost[1]!=null){WH.arrayWalk(c.cost[1],function(b,l,n,m){g+=Math.pow(10,m)+b[1]})}return WH.stringCompare(k,j)||WH.stringCompare(h,g)||WH.stringCompare(d.cost[0],c.cost[0])}},count:{id:"count",name:LANG.count,value:"count",compute:function(c,f){if(!(this._totalCount>0||c.outof>0)){return}if(c.outof){var b=WH.ce("div");b.className="small q0";WH.ae(b,WH.ct(WH.sprintf(LANG.lvdrop_outof,c.outof)));WH.ae(f,b)}return c.count>0?c.count:"??"},getVisibleText:function(b){var c=b.count;if(b.outof){c+=" "+b.outof}return c},sortFunc:function(d,c,f){if(d.count==null){return -1}else{if(c.count==null){return 1}}return WH.stringCompare(d.count,c.count)}},percent:{id:"percent",name:"%",value:"percent",compute:function(row,td){var personalLootDifficulty=this.selectedDifficulty==5||this.selectedDifficulty==17;if((row.modes&&personalLootDifficulty)||(g_pageInfo&&g_pageInfo.type==1&&g_world_bosses[g_pageInfo.typeId])||(g_pageInfo&&g_pageInfo.type==3&&(g_world_bosses[row.id]||row.personal_loot))){$(td).addClass("tip").mouseover(function(event){WH.Tooltip.showAtCursor(event,LANG.personal_loot_tt,0,0,"q")}).mousemove(function(event){WH.Tooltip.cursorUpdate(event)}).mouseout(function(){WH.Tooltip.hide()});return LANG.personal_loot_abbrev}if(row.count<=0){return"??"}if(row.pctstack){var text="";var data=eval("("+row.pctstack+")");for(var amt in data){var pct=(data[amt]*row.percent)/100;if(pct>=1.95){pct=parseFloat(pct.toFixed(0))}else{if(pct>=0.195){pct=parseFloat(pct.toFixed(1))}else{pct=parseFloat(pct.toFixed(2))}}text+=WH.sprintf(LANG.stackof_format,amt,pct)+"<br />"}$(td).addClass("tip").mouseover(function(event){WH.Tooltip.showAtCursor(event,text,0,0,"q")}).mousemove(function(event){WH.Tooltip.cursorUpdate(event)}).mouseout(function(){WH.Tooltip.hide()})}var value=parseFloat(row.percent.toFixed(row.percent>=1.95?0:(row.percent>=0.195?1:2)));if(row.pctstack){$(td).append($("<span>").addClass("tip").text(value))}else{return value}},getVisibleText:function(b){if(b.count<=0){return"??"}if(b.percent>=1.95){return b.percent.toFixed(0)}else{if(b.percent>=0.195){return parseFloat(b.percent.toFixed(1))}else{return parseFloat(b.percent.toFixed(2))}}},sortFunc:function(f,c,g){if(f.count==null){return -1}else{if(c.count==null){return 1}}if(f.percent>=1.95){var d=f.percent.toFixed(0)}else{if(f.percent>=0.195){d=parseFloat(f.percent.toFixed(1))}else{d=parseFloat(f.percent.toFixed(2))}}if(c.percent>=1.95){var h=c.percent.toFixed(0)}else{if(c.percent>=0.195){h=parseFloat(c.percent.toFixed(1))}else{h=parseFloat(c.percent.toFixed(2))}}return WH.stringCompare(d,h)}},stock:{id:"stock",name:LANG.stock,width:"10%",value:"stock",compute:function(b,c){if(b.stock>0){return b.stock}else{return String.fromCharCode(8734)}},getVisibleText:function(b){if(b.stock>0){return b.stock}else{return String.fromCharCode(8734)+" infinity"}}},currency:{id:"currency",name:LANG.currency,getValue:function(b){if(b.currency){return(b.currency[0]?b.currency[0][1]:0)}},compute:function(c,d){if(c.currency){var b=null;if(c.side!=null){b=c.side}else{if(c.react!=null){if(c.react[0]==1&&c.react[1]==-1){b=1}else{if(c.react[0]==-1&&c.react[1]==1){b=2}}}}Listview.funcBox.appendMoney(d,null,b,null,c.currency)}},sortFunc:function(d,c,f){if(d.currency==null){return -1}else{if(c.currency==null){return 1}}var h=0,g=0;WH.arrayWalk(d.currency,function(b,j,l,k){h+=Math.pow(10,k)+b[1]});WH.arrayWalk(c.currency,function(b,j,l,k){g+=Math.pow(10,k)+b[1]});return WH.stringCompare(h,g)}},mode:{id:"mode",name:"Mode",after:"name",type:"text",compute:function(d,f){if(d.modes&&d.modes.mode){if(this.validateBonuses){for(var b in this.validateBonuses){if(WH.inArray(d.bonustrees,this.validateBonuses[b])!=-1){if(this.diffLangref&&this.diffLangref[this.selectedDifficulty]){return this.diffLangref[this.selectedDifficulty]}else{break}}}}if(d.bonustrees&&this.diffLangref&&this.diffLangref[this.selectedDifficulty]){return this.diffLangref[this.selectedDifficulty]}var c=[983040,65784];if(((d.modes.mode&c[0])==c[0])||((d.modes.mode&c[1])==c[1])||(d.modes.mode&3)==3){return LANG.su_note_all}return Listview.extraCols.mode.getVisibleText(d)}},getVisibleText:function(q){var b=q.modes.mode&983040;if(b){switch(b){case 65536:return LANG.tab_normal;case 131072:return LANG.tab_heroic;case 262144:return LANG.tab_mythic;case 524288:return LANG.tab_raidfinder;default:break}}else{var h=!!(q.modes.mode&26);var k=!!(q.modes.mode&97);var d=!!(q.modes.mode&33554432);var f=!!(q.modes.mode&67108864);var o=!!(q.modes.mode&40);var g=!!(q.modes.mode&80);var j=!!(q.modes.mode&128);var c=(q.modes.mode&65787)==128;var m=!!(q.modes.mode&65536);var l=(q.modes.mode&65787)==65536;var p;if(o&&!g){p=10}else{if(g&&!o){p=25}}var n;if(h&&!k&&!d&&!f){n="normal"}else{if(k&&!h&&!d&&!f){n="heroic"}else{if(d&&!h&&!k&&!f){n="mythic"}}}if(n&&!j&&!m){if(p&&!d){return WH.sprintf(LANG["tab_"+n+"X"],p)}else{return LANG["tab_"+n]}}if(p&&!j&&!m){return WH.sprintf(LANG.lvzone_xman,p)}if(c){return LANG.tab_raidfinder}if(l){return LANG.tab_flexible}}return LANG.su_note_all},sortFunc:function(d,c,f){return -WH.stringCompare(Listview.extraCols.mode.compute.call(this,d),Listview.extraCols.mode.compute.call(this,c))}},requires:{id:"requires",name:LANG.requires,type:"text",compute:function(c,d){if(c.achievement&&g_achievements[c.achievement]){WH.noWrap(d);d.className="small";d.style.lineHeight="18px";var b=WH.ce("a");b.href="/achievement="+c.achievement;b.className="icontiny tinyspecial";b.style.backgroundImage="url("+g_staticUrl+"/images/wow/icons/tiny/"+g_achievements[c.achievement].icon.toLowerCase()+".gif)";b.style.whiteSpace="nowrap";WH.st(b,g_achievements[c.achievement]["name_"+Locale.getName()]);WH.ae(d,b)}},getVisibleText:function(b){if(b.achievement&&g_achievements[b.achievement]){return g_achievements[b.achievement].name}},sortFunc:function(d,c,f){return WH.stringCompare(this.getVisibleText(d),this.getVisibleText(c))}},reqskill:{id:"reqskill",name:LANG.skill,width:"10%",value:"reqskill",before:"yield"},yield:{id:"yield",name:LANG.yields,type:"text",align:"left",span:2,value:"name",compute:function(f,h,d){if(f.yield&&g_items[f.yield]){var c=WH.ce("td");c.style.width="1px";c.style.paddingRight="0";c.style.borderRight="none";WH.ae(c,g_items.createIcon(f.yield,1));WH.ae(d,c);h.style.borderLeft="none";var g=WH.ce("div");var b=WH.ce("a");b.href="/item="+f.yield;b.className="q"+g_items[f.yield].quality;WH.ae(b,WH.ct(g_items[f.yield]["name_"+Locale.getName()]));WH.ae(g,b);WH.ae(h,g)}},getVisibleText:function(b){if(b.yield&&g_items[b.yield]){return g_items[b.yield]["name_"+Locale.getName()]}},sortFunc:function(d,c,f){if(!d.yield||!g_items[d.yield]||!c.yield||!g_items[c.yield]){return(d.yield&&g_items[d.yield]?1:(c.yield&&g_items[c.yield]?-1:0))}return -WH.stringCompare(g_items[d.yield].quality,g_items[c.yield].quality)||WH.stringCompare(g_items[d.yield]["name_"+Locale.getName()],g_items[c.yield]["name_"+Locale.getName()])}},compare:{id:"compare",name:LANG.completion,getValue:function(b){return Math.floor(b.compare.progress*100)},compute:function(c,d,b){WH.ae(d,Listview.funcBox.getComparisonText(c.compare,this.completionMode,this.dataSource,this.completionText))},sortFunc:function(d,c,f){return d.compare.progress-c.compare.progress}},modify:{id:"modify",sortable:0,filtrable:0,compute:function(d,f,c){if(this.createModifyButton){f.style.cursor="default";$(f).click(function(g){g.stopPropagation()});var b=WH.ce("a");b.href="javascript:;";b.className="icon-edit";b.innerHTML=LANG.li_menu_modify;WH.ae(f,this.createModifyButton(d,b))}}},bpetquality:{id:"quality",name:LANG.quality,compute:function(d,f,c){var b=(d.compare.data[0].bpet&&d.compare.data[0].bpet.id)?g_item_qualities[d.compare.data[0].bpet.quality]:"";WH.ae(f,WH.ct(b))},sortFunc:function(f,d,g){var c=(f.compare.data[0].bpet&&f.compare.data[0].bpet.id)?f.compare.data[0].bpet.quality:-1;var h=(d.compare.data[0].bpet&&d.compare.data[0].bpet.id)?d.compare.data[0].bpet.quality:-1;return c-h}}};Listview.templates={};Listview.funcBox={smartNoDataSearchText:function(b){b.innerHTML=this.noteTopFormIsEmpty&&this.noteTopFormIsEmpty()?LANG.lv_search:LANG.lvnodata2},getCurrentItemBonuses:function(f){var k=[];var j=f.bonuses?f.bonuses:(this.itemBonusesFromDD?this.itemBonusesFromDD:null);var g=!f.bonuses&&this.itemBonusesFromDD;var d=g?this.validateBonuses:[];if((!j||!j.length)&&f.context){var c=Listview.funcBox.getBonusDataForContext.call(this,f.context);if(c.length==2){j=c[0];d=c[1];g=true}}if(j){for(var b in j){var h=j[b];if((WH.inArray(k,h)==-1)&&(!g||(WH.inArray(f.bonustrees,d[b])!=-1))){k.push(h)}}}return k},getItemLevelWithBonuses:function(n){var j=n.level;var f=false;var d=false;var c=Listview.funcBox.getCurrentItemBonuses.call(this,n);if(c.length>0&&WH.isSet("g_itembonuses")){for(var m in c){var g=c[m];if(g_itembonuses[g]){WH.arrayWalk(g_itembonuses[g],function(p){switch(p[0]){case 1:j+=p[1];break;case 11:case 13:f=p[1];break;case 14:d=p[1];break}})}}}if(f){var b=WH.convertScalingFactor.SD;var h=b?b[f]:null;if(h&&h[21]){var l=h[21];var o=((WH.maxLevel<=l)?WH.maxLevel:l);var k=Math.round(WH.getCurveValue(h[22],o));if(k){return k}}}if(d&&(j==n.level)&&(d<600)){return d}return j},filterByClass:function(c){if(c){WH.localStorage.set("dynamic_quest_class",c);this.classFilter=function(f){for(var d in f.specs){if(WH.inArray(g_chr_specs_by_class[c],f.specs[d])!=-1){return true}}return false};if(!WH.isSet("g_filterByClassAchievement")){if(!(WH.isSet("g_user")&&g_user.id)){return}$.ajax({url:"/website-achievement-explored",data:{trigger:"bosslootfilter"},success:function(){AchievementCheck()},type:"POST"});window.g_filterByClassAchievement=true}}else{WH.localStorage.remove("dynamic_quest_class");this.classFilter=null;for(var b in this.data){this.data[b].__tr=null}}this.updateFilters(1);this.applySort();this.refreshRows(true)},createSimpleCol:function(d,f,b,c){return{id:d,name:(LANG[f]!==undefined?LANG[f]:f),width:b,value:c}},initLootTable:function(c){var b;if(this._totalCount!=null){b=this._totalCount}else{b=c.outof}if(b==0){if(c.count!=-1){c.percent=c.count}else{c.percent=0}}else{c.percent=c.count/b*100}(Listview.funcBox.initModeFilter.bind(this,c))()},initModeFilter:function(c){if(this._lootModes==null){this._lootModes={99:0}}if(this._distinctModes==null){this._distinctModes={99:0}}if((!c.modes||c.modes.mode==4)&&c.classs!=12&&c.commondrop){this._lootModes[99]++;this._distinctModes[99]++}else{if(c.modes){for(var b=-2;b<=24;++b){if(this._lootModes[b]==null){this._lootModes[b]=0}if(c.modes.mode&1<<parseInt(b)+2){this._lootModes[b]++}}if(this._distinctModes[c.modes.mode]==null){this._distinctModes[c.modes.mode]=0}this._distinctModes[c.modes.mode]++}}},addModeIndicator:function(){var o=0;for(var l in this._distinctModes){if(this._distinctModes[l]){o++}}if(this._distinctModes[4]&&o<2){return}var g=location.hash.match(/:mode=([^:]+)/);var c=[0,-1,-2,23,24,1,3,2,4,5,14,15,16,17,99];var s={"-2":LANG.tab_heroic,"-1":LANG.tab_normal,0:LANG.tab_noteworthy,1:WH.sprintf(LANG.tab_normalX,10),2:WH.sprintf(LANG.tab_normalX,25),3:WH.sprintf(LANG.tab_heroicX,10),4:WH.sprintf(LANG.tab_heroicX,25),5:LANG.tab_raidfinder,14:LANG.tab_normal,15:LANG.tab_heroic,16:LANG.tab_mythic,17:LANG.tab_raidfinder,23:LANG.tab_mythic,24:LANG.tab_timewalking,99:""};var q={};this.diffLangref={};$.extend(this.diffLangref,s);if(WAS.showAds()){q[1]=s[1];q[2]=s[2];q[3]=s[3];q[4]=s[4];q[5]=s[5];s[1]=LANG.lvitem_normal+10;s[2]=LANG.lvitem_normal+25;s[3]=LANG.lvitem_heroic+10;s[4]=LANG.lvitem_heroic+25;s[5]=LANG.lvitem_lfr;s[14]=LANG.lvitem_normal;s[15]=LANG.lvitem_heroic;s[16]=LANG.lvitem_mythic;s[17]=LANG.lvitem_lfr;s[23]=LANG.lvitem_mythic;s[24]=LANG.lvitem_timewalking}var d=this,b=[],p;var n=function(u,f,j){WH.setSelectedLink(this,"lootmode-"+d.tabIndex);d.selectedDifficulty=f;var t=Listview.funcBox.getItemBonusesForDifficulty.call(d,f);d.itemBonusesFromDD=t[0];d.validateBonuses=t[1];d.customPound=d.id+(f!=null?":mode="+WH.urlize(s[f].replace(" ","")):"");d.customFilter=function(v){console.info("mode",u);return Listview.funcBox.filterMode(v,d._totalCount,u)};d.updateFilters(1);d.applySort();d.refreshRows(true);if(j){d.updatePound(1)}};var k;for(var h=0,m=c.length;h<m;++h){var l=c[h];if(!this._lootModes[l]){continue}p=$("<a><span>"+s[l]+"</span> ("+this._lootModes[l]+")</a>");p[0].f=n.bind(p[0],1<<l+2,l,1);p.click(p[0].f);if(l==-2||l==3||l==4||l==15||l==16||l==23){p.addClass("icon-heroic")}b.push({indicator:$('<span class="indicator-mode"></span>').append(p).append($("<b"+(l<-1||l>2?' class="icon-heroic"':"")+">"+s[l]+" ("+this._lootModes[l]+")</b>")),tooltip:q[l]});if(b.length==1){k=n.bind(p[0],1<<l+2,l,0)}if(g&&g[1]==WH.urlize(s[l].replace(" ",""))){(p[0].f)()}}if(k&&(!WH.setSelectedLink.groups||!WH.setSelectedLink.groups["lootmode-"+d.tabIndex])){k()}var r=false;for(var l=0,m=b.length;l<m;++l){p=$("a",b[l].indicator);if(!$("span",p).html()&&b.length==3){r=true}else{this.createIndicator(b[l].indicator,null,p[0].f,b[l].tooltip)}}if(r){k()}if(this.showLootSpecs){this.classSelectorDiv.style.marginTop="0px"}$(this.noteTop).append($('<div class="clear"></div>'))},filterMode:function(f,c,d){if(c!=null&&f.count!=null){if(f._count==null){f._count=f.count}var b=f._count;if(d!=null&&f.modes[d]){b=f.modes[d].count;c=f.modes[d].outof}f.__tr=null;f.count=b;f.outof=c;if(c){f.percent=b/c*100}else{f.percent=b}}return(d!=null?((!f.modes||f.modes.mode==4)&&f.classs!=12&&f.commondrop?(d==32):(f.modes&&(f.modes.mode&d))):true)},getItemBonusesForDifficulty:function(c){var b=[];if(c&&WH.isSet("g_pageInfo")){var f=c<0?-c:c;var g=0;var h=g_pageInfo.typeId;switch(g_pageInfo.type){case 1:g=(g_npcs[h]&&g_npcs[h].hasOwnProperty("location"))?g_npcs[h].location[0]:0;break;case 7:g=h;break;default:break}var d=0;if(WH.isSet("g_mapdifficulties")&&g_mapdifficulties[g]&&g_mapdifficulties[g][f]){d=g_mapdifficulties[g][f]}else{if(WH.isSet("g_difficulties")&&g_difficulties[f]){d=g_difficulties[f].order}}b=Listview.funcBox.getBonusDataForContext.call(this,d)}return b},getBonusDataForContext:function(h){var d=[];if(h&&WH.isSet("g_item_bonuscontexts")&&g_item_bonuscontexts[h]){var j=[];var f=[];for(var g in g_item_bonuscontexts[h]){var c=g_item_bonuscontexts[h][g];j.push(c[1]);f.push(c[0])}d=[j,f]}return d},initSubclassFilter:function(c){var b=c.classs||0;if(this._itemClasses==null){this._itemClasses={}}if(this._itemClasses[b]==null){this._itemClasses[b]=0}this._itemClasses[b]++},addSubclassIndicator:function(){var k=location.hash.match(/:type=([^:]+)/),b=[];for(var l in g_item_classes){b.push({i:l,n:g_item_classes[l]})}b.sort(function(j,f){return WH.stringCompare(j.n,f.n)});var n=function(j,f){WH.setSelectedLink(this,"itemclass");c.customPound=c.id+(j!=null?":type="+j:"");c.customFilter=function(p){return j==null||j==p.classs};c.updateFilters(1);c.applySort();c.refreshRows();if(f){c.updatePound(1)}};var c=this,d=[],o;o=$("<a><span>"+LANG.su_note_all+"</span></a>");o[0].f=n.bind(o[0],null,1);o.click(o[0].f);var h=n.bind(o[0],null,0);h();d.push($('<span class="indicator-mode"></span>').append(o).append($("<b>"+LANG.su_note_all+"</b>")));for(var g=0,m=b.length;g<m;++g){var l=b[g].i;if(!this._itemClasses[l]){continue}o=$("<a><span>"+g_item_classes[l]+"</span> ("+this._itemClasses[l]+")</a>");o[0].f=n.bind(o[0],l,1);o.click(o[0].f);d.push($('<span class="indicator-mode"></span>').append(o).append($("<b>"+g_item_classes[l]+" ("+this._itemClasses[l]+")</b>")));if(k&&k[1]==WH.urlize(l)){(o[0].f)()}}if(d.length>2){for(var l=0,m=d.length;l<m;++l){this.createIndicator(d[l],null,$("a",d[l])[0].f)}}},initStatisticFilter:function(b){if(this._achievTypes==null){this._achievTypes={}}if(this._achievTypes[b.type]==null){this._achievTypes[b.type]=0}this._achievTypes[b.type]++},addStatisticIndicator:function(){var h=location.hash.match(/:type=([^:]+)/),b=[];for(var k in g_achievement_types){b.push({i:k,n:g_achievement_types[k]})}b.sort(function(j,f){return WH.stringCompare(j.n,f.n)});var m=function(j,f){WH.setSelectedLink(this,"achievType");c.customPound=c.id+(j!=null?":type="+j:"");c.customFilter=function(p){return j==null||j==p.type};c.updateFilters(1);c.applySort();c.refreshRows();if(f){c.updatePound(1)}};var c=this,n=[],o;o=$("<a><span>"+LANG.su_note_all+"</span></a>");o[0].f=m.bind(o[0],null,1);o.click(o[0].f);var g=m.bind(o[0],null,0);g();n.push($('<span class="indicator-mode"></span>').append(o).append($("<b>"+LANG.su_note_all+"</b>")));for(var d=0,l=b.length;d<l;++d){var k=b[d].i;if(!this._achievTypes[k]){continue}o=$("<a><span>"+g_achievement_types[k]+"</span> ("+this._achievTypes[k]+")</a>");o[0].f=m.bind(o[0],k,1);o.click(o[0].f);n.push($('<span class="indicator-mode"></span>').append(o).append($("<b>"+g_achievement_types[k]+" ("+this._achievTypes[k]+")</b>")));if(h&&h[1]==k){(o[0].f)()}}if(n.length>2){for(var k=0,l=n.length;k<l;++k){this.createIndicator(n[k],null,$("a",n[k])[0].f)}}},initQuestFilter:function(c){if(this._questTypes==null){this._questTypes={}}for(var b=1;b<=4;++b){if(this._questTypes[b]==null){this._questTypes[b]=0}if(c._type&&(c._type&1<<b-1)){this._questTypes[b]++}}},addQuestIndicator:function(){var h=location.hash.match(/:type=([^:]+)/);var k=function(f,m){WH.setSelectedLink(this,"questType");l.customPound=l.id+(f!=null?":type="+f:"");l.customFilter=function(n){return f==null||(n._type&1<<f-1)};l.updateFilters(1);l.applySort();l.refreshRows();if(m){l.updatePound(1)}};var l=this,g=[],c;c=$("<a><span>"+LANG.su_note_all+"</span></a>");c[0].f=k.bind(c[0],null,1);c.click(c[0].f);var j=k.bind(c[0],null,0);j();g.push($('<span class="indicator-mode"></span>').append(c).append($("<b>"+LANG.su_note_all+"</b>")));for(var d=1;d<=4;++d){if(!this._questTypes[d]){continue}c=$("<a><span>"+g_quest_indicators[d]+"</span> ("+this._questTypes[d]+")</a>");c[0].f=k.bind(c[0],d,1);c.click(c[0].f);g.push($('<span class="indicator-mode"></span>').append(c).append($("<b>"+g_quest_indicators[d]+" ("+this._questTypes[d]+")</b>")));if(h&&h[1]==d){(c[0].f)()}}if(g.length>2){for(var d=0,b=g.length;d<b;++d){this.createIndicator(g[d],null,$("a",g[d])[0].f)}}},initSpellFilter:function(c){if(this._spellTypes==null){this._spellTypes={}}if(this._spellTypes[c.cat]==null){this._spellTypes[c.cat]=0}this._spellTypes[c.cat]++;if(c.talentspec&&c.talentspec.length){switch(c.cat){case -14:case -12:case -2:if(this._spellSpecs==null){this._spellSpecs={}}for(var b=0;b<c.talentspec.length;b++){if(this._spellSpecs[c.talentspec[b]]==null){this._spellSpecs[c.talentspec[b]]=0}this._spellSpecs[c.talentspec[b]]++}break}}},addSpellIndicator:function(){var j=location.hash.match(/:type=([^:]+)/);var k=location.hash.match(/:spec=([^:]+)/);var n=function(t,u){WH.setSelectedLink(this,"spellType");var s=location.hash.match(/:spec=([^:]+)/);var f=s?s[1]:null;d.customPound=d.id+(t!=null?":type="+t:"")+(f!=null?":spec="+f:"");d.customFilter=function(v){return(f==null||(WH.inArray(v.talentspec,f)!=-1)||(v.cat==-13&&v.rank&&v.rank.indexOf(g_chr_specs[f])>=0))&&(t==null||v.cat==t)};d.updateFilters(1);d.applySort();d.refreshRows();if(u){d.updatePound(1)}};var l=function(f,u){WH.setSelectedLink(this,"spellSpec");var t=location.hash.match(/:type=([^:]+)/);var s=t?t[1]:null;d.customPound=d.id+(s!=null?":type="+s:"")+(f!=null?":spec="+f:"");d.customFilter=function(v){return(f==null||(WH.inArray(v.talentspec,f)!=-1)||(v.cat==-13&&v.rank&&v.rank.indexOf(g_chr_specs[f])>=0))&&(s==null||v.cat==s)};d.updateFilters(1);d.applySort();d.refreshRows();if(u){d.updatePound(1)}};var d=this,o=[],r;r=$("<a><span>"+LANG.su_note_all+"</span></a>");r[0].f=n.bind(r[0],null,1);r.click(r[0].f);var g=n.bind(r[0],null,0);g();o.push($('<span class="indicator-mode"></span>').append(r).append($("<b>"+LANG.su_note_all+"</b>")));for(var h in g_spell_categories){if(!this._spellTypes[h]){continue}r=$("<a><span>"+g_spell_categories[h]+"</span> ("+this._spellTypes[h]+")</a>");r[0].f=n.bind(r[0],h,1);r.click(r[0].f);o.push($('<span class="indicator-mode"></span>').append(r).append($("<b>"+g_spell_categories[h]+" ("+this._spellTypes[h]+")</b>")));if(j&&j[1]==h){(r[0].f)()}}var c=-1;var p=[];if(this._wowClass){p=g_chr_specs_by_class[this._wowClass]}else{for(h in g_chr_specs){if(g_chr_specs.hasOwnProperty(h)){p.push(h)}}}for(var q=0;q<p.length;q++){h=p[q];if(!this._spellSpecs[h]){continue}if(c==-1){r=$("<a><span>"+LANG.su_note_all+"</span></a>");r[0].f=l.bind(r[0],null,1);r.click(r[0].f);l.call(r[0],null,0);o.push($('<span class="indicator-mode"></span>').append(r).append($("<b>"+LANG.su_note_all+"</b>")));c=o.length-1}r=$("<a><span>"+g_chr_specs[h]+"</span> ("+this._spellSpecs[h]+")</a>");r[0].f=l.bind(r[0],h,1);r.click(r[0].f);o.push($('<span class="indicator-mode"></span>').append(r).append($("<b>"+g_chr_specs[h]+" ("+this._spellSpecs[h]+")</b>")));if(k&&k[1]==h){(r[0].f)()}}var b;if(o.length>2){for(var h=0,m=o.length;h<m;++h){b=this.createIndicator(o[h],null,$("a",o[h])[0].f);if(h>0&&h==c){b.style.clear="left"}}}},initComparisonFilter:function(g,d){if(g.__deleted){return}if(this._comparisonSources==null){this._comparisonSources={all:0,identical:0,similar:0,extra:0,missing:0}}if(g.compare.data.length<2){return}this._comparisonSources.all++;if(g.compare.progress==1){this._comparisonSources.identical++}else{if(g.compare.progress>0){this._comparisonSources.similar++}else{if(g.compare.primary==this.dataSource){this._comparisonSources.extra++}else{this._comparisonSources.missing++}}}if(this._comparisonCategories==null){this._comparisonCategories={total:[0,0,0,0,{},0]}}if(!this.compareSummary){return}if(g.compare.primary!=this.dataSource){this._comparisonCategories.total[0]++}if(g.compare.progress==1){this._comparisonCategories.total[g.compare.auxiliary?5:1]++}else{if(g.compare.progress>0){this._comparisonCategories.total[2]+=(d?1:g.compare.progress);this._comparisonCategories.total[3]++}}if(!this.compareSummary.categoryId){return}var c,f,b=g[this.compareSummary.categoryId];if(!WH.isArray(b)){b=[b]}for(f=0;f<b.length;f++){c=b[f];if(this.compareSummary.names[c]){if(this._comparisonCategories[c]==null){this._comparisonCategories[c]=[0,0,0,0,{all:0,identical:0,similar:0,extra:0,missing:0},0]}if(g.compare.primary!=this.dataSource){this._comparisonCategories[c][0]++}this._comparisonCategories[c][4].all++;if(g.compare.progress==1){this._comparisonCategories[c][g.compare.auxiliary?5:1]++;this._comparisonCategories[c][4].identical++}else{if(g.compare.progress>0){this._comparisonCategories[c][2]+=(d?1:g.compare.progress);this._comparisonCategories[c][3]++;this._comparisonCategories[c][4].similar++}else{if(g.compare.primary==this.dataSource){this._comparisonCategories[c][4].extra++}else{this._comparisonCategories[c][4].missing++}}}}}},addComparisonFilter:function(){this.removeIndicators();this.removeProgressBars();Listview.funcBox.addComparisonIndicator.call(this);Listview.funcBox.addComparisonProgressBars.call(this)},addComparisonIndicator:function(){if(!this._comparisonSources||!this._comparisonSources.all){return}var l=location.hash.match(/:compare=([^:]+)/);var o=function(w,v){WH.setSelectedLink(this,h.id+"-compareSource");var f=location.hash.match(/:catg=([^:]+)/);var u=(f&&f[1])?f[1]:null;var t=h.compareSummary.categoryId;h.customPound=h.id+(w!=null?":compare="+w:"")+(u!=null?":catg="+u:"");h.customFilter=function(y){return((w===null)||(w=="identical"&&y.compare.progress==1)||(w=="similar"&&y.compare.progress>0&&y.compare.progress<1)||(w=="extra"&&(y.compare.progress==-1||(y.compare.progress==0&&y.compare.primary==this.dataSource)))||(w=="missing"&&y.compare.progress==0&&y.compare.primary!=this.dataSource))&&(u===null||u==y[t]||(WH.isArray(y[t])&&WH.inArray(y[t],u)>=0))};h.updateFilters(1);h.applySort();h.refreshRows();if(v){h.updatePound(1)}};var h=this,c=[],p=["all","identical","similar","extra","missing"],r,s=this._comparisonSources;var m=location.hash.match(/:catg=([^:]+)/);var d=(m&&m[1])?m[1]:null;var g=h.compareSummary.categoryId;if((d!==null)&&(this._comparisonCategories[d])){s=this._comparisonCategories[d][4]}for(var k=0;k<p.length;++k){var b=p[k];if(!s[b]){continue}var q=this.completionMode?this.completionText[b]:LANG["lvcomparison_"+b],j="";if(b=="all"){b=null}else{j=" ("+s[b]+")"}r=$("<a><span>"+q+"</span>"+j+"</a>");r[0].f=o.bind(r[0],b,1);r.click(r[0].f);c.push($('<span class="indicator-mode"></span>').append(r).append($("<b>"+q+j+"</b>")));if(l&&l[1]==b){(r[0].f)()}else{if(b===null){(o.bind(r[0],b,0))()}}}for(var k=0,n=c.length;k<n;++k){this.createIndicator(c[k],null,$("a",c[k])[0].f)}if(this.onAfterAddComparison){this.onAfterAddComparison.call(this)}},addComparisonProgressBars:function(){if(!this._comparisonCategories||!this._comparisonCategories.total||!this._comparisonCategories.total[0]){return}var h=location.hash.match(/:catg=([^:]+)/),k=this,g=this.compareSummary.categoryId;var j=function(l,f){WH.setSelectedLink(this,k.id+"-category");var m=location.hash.match(/:compare=([^:]+)/);var n=(m&&m[1])?m[1]:null;k.customPound=k.id+(n!=null?":compare="+n:"")+(l!=null?":catg="+l:"");k.customFilter=function(o){return(l===null||l==o[g])&&((n===null)||(n=="identical"&&o.compare.progress==1)||(n=="similar"&&o.compare.progress>0&&o.compare.progress<1)||(n=="extra"&&(o.compare.progress==-1||(o.compare.progress==0&&o.compare.primary==this.dataSource)))||(n=="missing"&&o.compare.progress==0&&o.compare.primary!=this.dataSource))};k.updateFilters(1);k.applySort();k.refreshRows();if(f){k.updatePound(1);WH.ee(k.noteIndicators);Listview.funcBox.addComparisonIndicator.call(k)}};this.createProgressBar(LANG.overallprogress,this._comparisonCategories.total,j,[null,1],4);$("tr:last-child td:last-child",this.noteProgressBars).click();if(this.compareSummary.order){for(var d=0;d<this.compareSummary.order.length;++d){var c=this.compareSummary.order[d];if(!this.compareSummary.names[c]||!this._comparisonCategories[c]){continue}var b=this._comparisonCategories[c];if(!b[0]){if(!b[4].all){continue}b=[b[4].all,b[4].extra,0,0]}this.createProgressBar(this.compareSummary.names[c],b,j,[c,1]);if(h&&h[1]==c){$("tr:last-child td:last-child",this.noteProgressBars).click()}}}},addItemSummary:function(){if(!this.noteItemSummary){this.noteItemSummary=WH.ce("div");this.noteItemSummary.className="listview-summary-wrapper";$(this.noteItemSummary).insertAfter($(this.noteTop))}WH.ee(this.noteItemSummary);g_summaries["listview-summary-"+this.id]=null;var g=WH.ce("div");g.className="listview-summary-background";WH.ae(this.noteItemSummary,g);var j=WH.ce("div");j.className="listview-summary";WH.ae(g,j);var h=WH.ce("div");h.className="listview-summary-inner";WH.ae(j,h);var c=WH.ce("a");c.className="listview-summary-left";c.onclick=function(){var l=$(this);var m=l.siblings(".listview-summary-inner");m.animate({scrollLeft:-1*m.width()},1000);l.removeClass("show");l.siblings(".listview-summary-right").addClass("show")};WH.ae(c,WH.ce("span"));WH.ae(j,c);c=WH.ce("a");c.className="listview-summary-right";c.onclick=function(){var l=$(this);var m=l.siblings(".listview-summary-inner");m.animate({scrollLeft:m.width()},1000);l.removeClass("show");l.siblings(".listview-summary-left").addClass("show")};WH.ae(c,WH.ce("span"));WH.ae(j,c);var b=[];for(var f=0;f<this.data.length;++f){if(this.data[f].raw[0]!=4&&this.data[f].raw[0]!=19){var d=this.data[f].raw.slice(1,this.data[f].raw.length);d[8]=0;b.push([d])}}this.attachedSummary=new Summary({id:"listview-summary-"+this.id,template:"listmanager",parent:h,groups:b,level:this.characterSettings.level,talentSpec:this.characterSettings.talentSpec,charClass:this.characterSettings.charClass,race:this.characterSettings.race,selectedTalents:this.characterSettings.selectedTalents,noMaxHighlight:this.compareSummaryNoMaxHighlight,totalName:this.compareSummaryTotalName});var k=function(){var m=$(this),l=$("table.grid",m);if(m.width()<l.width()){m.siblings(".listview-summary-right").addClass("show")}else{m.siblings(".listview-summary-left, .listview-summary-right").removeClass("show")}};if(!this.summaryResizeAdded){$(window).resize((function(l){$(".listview .listview-summary-inner").each(l)}).bind(null,k));this.summaryResizeAdded=true}setTimeout((function(l,m){$(".listview-summary-inner",l).each(m)}).bind(null,this.noteItemSummary,k),0);if(this.showPaperdoll){g.className+=" has-paperdoll";Listview.funcBox.addPaperdoll.call(this,g)}},addPaperdoll:function(f){if(!this.notePaperdoll||!WH.ge(this.notePaperdoll.id)){this.notePaperdoll=WH.ce("div");this.notePaperdoll.id="listview-paperdoll-"+this.id;this.notePaperdoll.className="listview-paperdoll";if(f){$(f).prepend(this.notePaperdoll)}else{$(this.notePaperdoll).insertAfter($(this.noteTop))}}WH.ee(this.notePaperdoll);var c=$.extend({id:"paperdoll-"+this.id,parent:this.notePaperdoll.id,data:this.data,sheathMain:-1,sheathOff:-1},this.characterSettings);if(this.onCreatePaperdollSlot){c.onCreateSlot=this.onCreatePaperdollSlot}var g={16:"Main",17:"Off"};for(var d=0,b=c.data.length;d<b;d++){if(g_items[c.data[d].id]&&g_items[c.data[d].id].jsonequip&&typeof g_items[c.data[d].id].jsonequip.sheathtype=="number"){if(c.data[d].raw&&g.hasOwnProperty(c.data[d].raw[0])){c["sheath"+g[c.data[d].raw[0]]]=g_items[c.data[d].id].jsonequip.sheathtype}}}new Paperdoll(c)},assocArrCmp:function(f,d,c){if(f==null){return -1}else{if(d==null){return 1}}var j=Math.max(f.length,d.length);for(var h=0;h<j;++h){if(f[h]==null){return -1}else{if(d[h]==null){return 1}}var g=WH.stringCompare(c[f[h]],c[d[h]]);if(g!=0){return g}}return 0},assocBinFlags:function(b,f){var d=[];for(var c in f){if(!isNaN(c)&&c<=32&&(b&(1<<(c-1)))){d.push(c)}}d.sort(function(h,g){return WH.stringCompare(f[h],f[g])});return d},location:function(l,c,d){if(l.location==null){return -1}var g=d?d:3;var j=l.location.slice(0,g);if(j.length<l.location.length){j.push(-1)}for(var f=0,h=j.length;f<h;++f){if(f>0){WH.ae(c,WH.ct(LANG.comma))}var b=j[f];if(b==-1){WH.ae(c,WH.ct(LANG.ellipsis))}else{var k=WH.ce("a");k.className="q1";k.href="/zone="+b;WH.ae(k,WH.ct(g_zones[b]));WH.ae(c,k)}}},arrayText:function(c,f){if(c==null){return}else{if(!WH.isArray(c)){return f[c]}}var g="";for(var d=0,b=c.length;d<b;++d){if(d>0){g+=" "}if(!f[c[d]]){continue}g+=f[c[d]]}return g},createCenteredIcons:function(b,k,m,f,c,o){if(b!=null){var h=0;var w=WH.ce("div"),z=WH.ce("div");WH.ae(document.body,w);if(m&&(b.length!=1||f!=2)){var s=WH.ce("div");s.style.position="relative";s.style.width="1px";var A=WH.ce("div");A.className="q0";A.style.position="absolute";A.style.right="2px";A.style.lineHeight="26px";A.style.fontSize="11px";A.style.whiteSpace="nowrap";WH.ae(A,WH.ct(m));WH.ae(s,A);WH.ae(w,s);w.style.paddingLeft=$(A).width()+"px"}var u=g_items;if(f==1){u=g_spells}else{if(f==3){u=g_petabilities}}for(var q=0,r=b.length;q<r;++q){if(o&&h%o==0){WH.ae(w,WH.ce("div",{className:"clear-left"}))}h++;var t;if(b[q]==null){t=WH.ce("div");t.style.width=t.style.height="26px"}else{var n,j,g;if(typeof b[q]=="object"){n=b[q][0];j=b[q][1];g=b[q][2]}else{n=b[q]}if(typeof n=="string"){t=Icon.create(n,0,null,g)}else{if(n){t=u.createIcon(n,0,j)}else{t=Icon.create("inventoryslot_empty",0,null,"javascript:;")}}if(c){t.children[2].rel=c[q]}}if(b.length==1&&f==2){if(n&&g_items[n]){WH.ee(w);var v=g_items[n],y=WH.ce("a"),p=WH.ce("span");p.style.paddingTop="4px";y.href="/item="+n;y.className="q"+v.quality+" icontiny tinyspecial";y.style.backgroundImage="url("+g_staticUrl+"/images/wow/icons/tiny/"+v.icon.toLowerCase()+".gif)";y.style.whiteSpace="nowrap";WH.st(y,v["name_"+Locale.getName()]);WH.ae(p,y);if(j>1){WH.ae(p,WH.ct(" ("+j+")"))}if(m){var s=WH.ce("span");s.className="q0";s.style.fontSize="11px";s.style.whiteSpace="nowrap";WH.ae(s,WH.ct(m));WH.ae(w,s);if($(A).length>0){p.style.paddingLeft=$(A).width()+"px"}}WH.ae(w,p)}}else{t.style.cssFloat=t.style.styleFloat="left";WH.ae(w,t);w.style.margin="0 auto";w.style.textAlign="left";var l=b.length;if(o&&o<b.length){l=o}w.style.width=(26*l)+"px"}}z.className="clear";WH.ae(k,w);WH.ae(k,z);return true}},createSocketedIcons:function(m,f,c,h,o){var p=0,l=WH.ce("div"),b=WH.ce("div");for(var g=0,j=m.length;g<j;++g){var n,k=c[g];if(g_items&&g_items[k]){n=g_items.createIcon(k,0)}else{if(WH.isSet("g_gems")&&g_gems&&g_gems[k]){n=Icon.create(g_gems[k].icon,0,null,"/item="+k)}else{n=Icon.create(null,0,null,"javascript:;")}}n.className+=" iconsmall-socket-"+g_file_gems[m[g]]+(!c||!k?"-empty":"");n.style.cssFloat=n.style.styleFloat="left";if(h&&h[g]){n.insertBefore(WH.ce("var"),n.childNodes[1]);++p}WH.ae(l,n)}l.style.margin="0 auto";l.style.textAlign="left";l.style.width=(26*m.length)+"px";b.className="clear";WH.ae(f,l);WH.ae(f,b);if(o&&p==m.length){l=WH.ce("div");l.style.paddingTop="4px";WH.ae(l,WH.ct(o));WH.ae(f,l)}},addBattlePetExpandedView:function(j,k,l,u,d){if(!d){d=j}var r=function(){setTimeout((function(){if(Platform.isTouch()&&!$(".expanded-pet-view",this).is(":visible")){var A=$("a",this).attr("href");if(A){location.href=A}}}).bind(this),5)};if(d.tagName=="TD"){d.onmouseover=function(){$(this).addClass("expand-pet-view");r.call(this)};d.onmouseout=function(){$(this).removeClass("expand-pet-view")}}else{d.onmouseover=function(){$(this).parents("td").addClass("expand-pet-view");r.call(this)};d.onmouseout=function(){$(this).parents("td").removeClass("expand-pet-view")}}var f=WH.ce("div");f.className="expanded-pet-view";if(k.compare){WH.ae(f,Listview.funcBox.getComparisonText(k.compare,this.completionMode,this.dataSource,this.completionText))}if(k.companion){f.className+=" companion"}if(k.untameable){f.className+=" untameable"}if(k.elite){f.className+=" elite"}var w=WH.ce("img");w.src=g_staticUrl+ModelViewer.getStaticBase()+"/thumbs/npc/"+k.model+".png";w.height=w.width=240;WH.ae(f,w);var q=WH.ce("div");q.className="icon";WH.ae(q,Icon.create(k.icon,1,null,this.getItemLink(k)));WH.ae(f,q);q=WH.ce("div");q.className="type";q.style.backgroundPosition=((k.type-1)*-35)+"px 0";q.onmouseover=function(B,A){WH.Tooltip.showAtCursor(A,g_battlepetability_types[k.type],0,0,"q")};q.onmousemove=WH.Tooltip.cursorUpdate;q.onmouseout=WH.Tooltip.hide;WH.ae(f,q);var y=WH.ce("div");y.className="name";if(k.elite){w=WH.ce("img");w.src=g_staticUrl+"/images/icons/boss.gif";w.height=16;w.width=12;w.style.verticalAlign="middle";w.onmouseover=function(A){WH.Tooltip.showAtCursor(A,LANG.lvspecies_elite,0,0,"q")};w.onmousemove=WH.Tooltip.cursorUpdate;w.onmouseout=WH.Tooltip.hide;WH.ae(y,w);WH.ae(y,WH.ct(" "))}var t=WH.ce("a");t.href=this.getItemLink(k);t.className="q"+l.quality;t.innerHTML=k.npc.name;WH.ae(y,t);WH.ae(f,y);var o=WH.ce("div");o.className="leveltype";if(k.elite){o.innerHTML=(k.companion?LANG.lvspecies_companion:WH.sprintf(LANG.lvspecieselite_levelcombo,l.level,g_battlepetability_types[k.type]))}else{o.innerHTML=(k.companion?LANG.lvspecies_companion:WH.sprintf(LANG.lvspecies_levelcombo,l.level,g_battlepetability_types[k.type]))}WH.ae(f,o);if(!k.companion){var z=WH.ce("table");z.className="stats";var m=["health","power","speed"],v=WH.ce("tr"),s=WH.ce("tr"),b,c;for(var p=0;p<m.length;++p){b=WH.ce("td");c=WH.ce("span");c.className=m[p]+"-icon";b.onmouseover=(function(B,A){WH.Tooltip.showAtCursor(A,B,0,0,"q")}).bind(null,LANG[m[p]]);b.onmousemove=WH.Tooltip.cursorUpdate;b.onmouseout=WH.Tooltip.hide;WH.ae(b,c);WH.ae(v,b);b=WH.ce("td");b.innerHTML=u[m[p]];b.onmouseover=(function(B,A){WH.Tooltip.showAtCursor(A,B,0,0,"q")}).bind(null,LANG[m[p]]);b.onmousemove=WH.Tooltip.cursorUpdate;b.onmouseout=WH.Tooltip.hide;WH.ae(s,b)}WH.ae(z,v);WH.ae(z,s);WH.ae(f,z);var g=WH.ce("div");g.className="abilities";if(k.untameable){span=WH.ce("div");span.className="label q0";span.innerHTML=LANG.untameable;WH.ae(g,span);for(var p=0;p<k.abilities.length;++p){q=WH.ce("div");q.className="icon-"+(p+1);WH.ae(q,Icon.create(g_petabilities[k.abilities[p]].icon,0,null,"/pet-ability="+k.abilities[p]));WH.ae(g,q)}}else{for(var p=1;p<=3;p++){q=WH.ce("span");q.className="connector-"+p;WH.ae(g,q)}for(var p=0;p<k.abilities.length;++p){q=WH.ce("div");q.className="icon-"+(p+1);if(p<3&&l.level>=WH.battlePetAbilityLevels[1]){q.className+=" iconsmall-gold"}var n=null;if(l.level<WH.battlePetAbilityLevels[p]||WH.battlePetAbilityLevels[p]>1){n=WH.battlePetAbilityLevels[p]}if(l.level<WH.battlePetAbilityLevels[p]){q.className+=" inactive"}var h=g_petabilities[k.abilities[p]]?g_petabilities[k.abilities[p]].icon:Icon.questionMarkIcon;WH.ae(q,Icon.create(h,0,null,"/pet-ability="+k.abilities[p],n));WH.ae(g,q)}}WH.ae(f,g)}WH.ae(j,f)},getItemType:function(d,c,b){if(b!=null&&g_item_subsubclasses[d]!=null&&g_item_subsubclasses[d][c]!=null){return{url:"/items="+d+"."+c+"."+b,text:g_item_subsubclasses[d][c][b]}}else{if(c!=null&&g_item_subclasses[d]!=null){return{url:"/items="+d+"."+c,text:g_item_subclasses[d][c]}}else{return{url:"/items="+d,text:g_item_classes[d]}}}},getQuestCategory:function(b){return g_quest_sorts[b]},getQuestReputation:function(f,c){if(c.reprewards){for(var d=0,b=c.reprewards.length;d<b;++d){if(c.reprewards[d][0]==f){return c.reprewards[d][1]}}}},getFactionCategory:function(c,b){if(c){return g_faction_categories[c]}else{return g_faction_categories[b]}},createTextRange:function(c,b){c|=0;b|=0;if(c>1||b>1){if(c!=b&&b>0){return c+"-"+b}else{return c+""}}return null},coGetColor:function(f,c,b){if(f.user&&g_customColors[f.user]){return" comment-"+g_customColors[f.user]}switch(c){case -1:var d=null;if(!b){d=f.divPost.childNodes[1].className.match(/comment-([a-z]+)/)}else{d=f.divBody[0].className.match(/comment-([a-z]+)/)}if(d!=null){return" comment-"+d[1]}break;case 3:if(f.roles&U_GROUP_PREMIUMISH){return" comment-gold"}case 4:if(f.roles&U_GROUP_ADMIN){return" comment-blue"}if(f.roles&U_GROUP_GREEN_TEXT){return" comment-green"}if(f.roles&U_GROUP_VIP){return" comment-gold"}if(f.roles&U_GROUP_PREMIUMISH){return" comment-red"}break}if(f.roles&U_GROUP_ADMIN){return" comment-blue"}if((f.commentv2&&f.sticky)||(f.roles&U_GROUP_GREEN_TEXT)||(f.rating>=10)){return" comment-green"}if(f.rating&&f.rating<-2){return" comment-bt"}if(f.roles&U_GROUP_PREMIUMISH){return" comment-gold"}return""},coFlagUpOfDate:function(d){var b=d.commentCell.find(".comment-notification");var c=d.user==g_user.name||((g_user.roles&(U_GROUP_ADMIN|U_GROUP_MODERATOR))!=0);if(!c){return}if(confirm("Mark comment "+d.id+" as up to date?")){d.container.removeClass("comment-outofdate");$.post("/comment=out-of-date",{id:d.id,remove:1},function(f){if(f=="ok"){MessageBox(b,LANG.lvcomment_uptodateresponse)}else{MessageBox(b,"Error: "+f)}})}return},coFlagOutOfDate:function(f){var b=f.commentCell.find(".comment-notification");var c=f.user==g_user.name||((g_user.roles&(U_GROUP_ADMIN|U_GROUP_MODERATOR))!=0);if(c){if(confirm("Mark comment "+f.id+" as out of date?")){f.container.addClass("comment-outofdate");$.post("/comment=out-of-date",{id:f.id},function(g){if(g=="ok"){MessageBox(b,LANG.lvcomment_outofdateresponse)}else{MessageBox(b,"Error: "+g)}})}return}var d=null;while(true){d=prompt(LANG.lvcomment_outofdate_tip);if(d==null||d==false){return}else{if(d.toString().length>0){break}}alert(LANG.youmustprovideareason_stc)}$.post("/comment=out-of-date",{id:f.id,reason:d},function(g){if(g=="ok"){MessageBox(b,LANG.lvcomment_outofdateresponsequeued)}else{MessageBox(b,"Error: "+g)}})},coDelete:function(d){var c=d.user==g_user.name||((g_user.roles&(U_GROUP_ADMIN|U_GROUP_MOD|U_GROUP_BUREAU))!=0);var b=d.commentCell.find(".comment-notification");if(c){if(!confirm(LANG.confirm_deletecomment)){return}$.post("/comment=delete",{id:d.id});if(!d.commentv2){this.deleteRows([d]);return}d.container.addClass("comment-deleted");MessageBox(b,LANG.commentdeleted_tip);d.deletedInfo=[g_serverTime,g_user.name];d.deleted=true;Listview.templates.comment.updateCommentCell(d);return}},coUndelete:function(d){var c=d.user==g_user.name||((g_user.roles&(U_GROUP_ADMIN|U_GROUP_MOD))!=0);var b=d.commentCell.find(".comment-notification");if(confirm(LANG.votetoundelete_tip)){$.post("/comment=undelete",{id:d.id});if(c){MessageBox(b,"This comment has been restored.");if(d.commentv2){d.container.removeClass("comment-deleted");d.deletedInfo=null;d.deleted=false;Listview.templates.comment.updateCommentCell(d)}}else{MessageBox(b,LANG.votedtodelete_tip)}}},coEdit:function(j,g,d){if(d){j.divBody.hide();j.divResponse.hide()}var h=$("<div/>");h.addClass("comment-edit");j.divEdit=h[0];if(g==-1){if(g_users[j.user]!=null){j.roles=g_users[j.user].roles}}var c=Listview.funcBox.coEditAppend(h,j,g,d);var b=$("<div/>");b.addClass("comment-edit-buttons");var f=$("<button/>",{text:LANG.compose_save});f.click(Listview.funcBox.coEditButton.bind(f[0],j,true,g,d));b.append(f);b.append(WH.ct(" "));f=$("<button/>",{text:LANG.compose_cancel});f.click(Listview.funcBox.coEditButton.bind(f[0],j,false,g,d));b.append(f);h.append(b);h.insertAfter(j.divBody);WH.safeFocus(c)},coEditAppend:function(w,j,v,K,p,l){var q=Listview.funcBox.coGetCharLimit(v);if(j.body===null){j.body=""}if(v==1||v==3||v==4){j.user=g_user.name;j.roles=g_user.roles;j.rating=1}else{if(v==2){j.roles=g_user.roles;j.rating=1}}if(p){j.roles&=~U_GROUP_PENDING}if(v==-1||v==0){var u=$("<div/>",{text:LANG.compose_mode});u.addClass("comment-edit-modes");var D=$("<a/>",{href:"javascript:;",text:LANG.compose_edit});D.click(Listview.funcBox.coModeLink.bind(D[0],1,v,j));D.addClass("selected");u.append(D);u.append(WH.ct("|"));var B=$("<a/>",{href:"javascript:;",text:LANG.compose_preview});B.click(Listview.funcBox.coModeLink.bind(B[0],2,v,j));u.append(B);w.append(u)}var c=$("<div/>",{css:{display:"none"}});c.addClass("text comment-body"+Listview.funcBox.coGetColor(j,v,K));var s=$("<div/>");s.addClass("comment-edit-body");var r=$('<div style="float: left" />');r.addClass("toolbar");var n=$('<div style="float: left" />');n.addClass("menu-buttons");var t=$("<textarea/>",{val:j.body,rows:10,css:{clear:"left"}});t.addClass("comment-editbox");switch(v){case 1:t.attr("name","commentbody");break;case 2:t.attr({name:"desc",originalValue:j.body});break;case 3:t.attr("name","body");break;case 4:t.attr({name:"sig",originalValue:j.body,rows:3});t.css("height","auto");break}if(v!=-1&&v!=0){var L=$("<a/>"),C=$("<div/>"),J=$("<div/>"),m=screen.availWidth<=480;var o=Listview.funcBox.coLivePreview.bind(t[0],j,v,C[0]);L.addClass("disclosure-"+(m?"off":"on"));L.text(LANG.compose_livepreview);L.attr("href","javascript:;");L.click(function(){o(1);var M=WH.toggleDisplay(C);L.toggleClass("disclosure-on",M);L.toggleClass("disclosure-off",!M)});J.addClass("pad");c.append(WH.getMajorHeading(L,3,null,{classes:"first"}));c.append(C);c.append(J);WH.onAfterTyping(t[0],o,50);t.focus(function(){o();c.css("display",(m?"none":""));if(v!=4&&!l){t.css("height","22em")}})}else{if(v!=4&&!l){t.focus(function(){t.css("height","22em")})}}var H=[{id:"b",icon:"bold",title:LANG.markup_b,pre:"[b]",post:"[/b]"},{id:"i",icon:"italic",title:LANG.markup_i,pre:"[i]",post:"[/i]"},{id:"u",icon:"underline",title:LANG.markup_u,pre:"[u]",post:"[/u]"},{id:"s",icon:"strikethrough",title:LANG.markup_s,pre:"[s]",post:"[/s]"},{id:"small",icon:"text-height",title:LANG.markup_small,pre:"[small]",post:"[/small]"},{id:"url",icon:"link",title:LANG.markup_url,nopending:true,onclick:function(){var M=prompt(LANG.prompt_linkurl,"https://");if(M){WH.insertTag(t[0],"[url="+M+"]","[/url]")}}},{id:"quote",icon:"quote-left",title:LANG.markup_quote,pre:"[quote]",post:"[/quote]"},{id:"code",icon:"code",title:LANG.markup_code,pre:"[code]",post:"[/code]"},{id:"ul",icon:"list-ul",title:LANG.markup_ul,pre:"[ul]\n[li]",post:"[/li]\n[/ul]",rep:function(M){return M.replace(/\n/g,"[/li]\n[li]")}},{id:"ol",icon:"list-ol",title:LANG.markup_ol,pre:"[ol]\n[li]",post:"[/li]\n[/ol]",rep:function(M){return M.replace(/\n/g,"[/li]\n[li]")}},{id:"li",icon:"circle",title:LANG.markup_li,pre:"[li]",post:"[/li]"}];if(!K){for(var F=0,G=H.length;F<G;++F){var g=H[F];if(v==4&&g.id=="quote"){break}if((g_user.roles&U_GROUP_PENDING)&&g.nopending){continue}var y=$("<button/>",{click:function(M,N){N.preventDefault();(M.onclick!=null?M.onclick:WH.insertTag.bind(0,t[0],M.pre,M.post,M.rep))()}.bind(null,g)});y[0].setAttribute("type","button");y.attr("title",g.title);var I=$("<i/>",{"class":"fa fa-"+g.icon});y.append(I);r.append(y)}}else{for(var F=0,G=H.length;F<G;++F){var g=H[F];if((g_user.rolls&U_GROUP_PENDING)&&g.nopending){continue}var A="tb-"+g.id;var y=$("<button/>",{click:function(M,N){N.preventDefault();(M.onclick!=null?M.onclick:WH.insertTag.bind(0,t[0],M.pre,M.post,M.rep))()}.bind(null,g),"class":A,title:g.title});y[0].setAttribute("type","button");y.append("<ins/>");r.append(y)}r.addClass("formatting button sm")}var b=function(N,M){var O=prompt(WH.sprintf(LANG.markup_prompt,N),"");if(O!=null){WH.insertTag(t[0],"["+M+"="+(parseInt(O)||0)+"]","")}};var k=LANG.ellipsis;var h=[[0,LANG.markup_links,,[[9,LANG.types[10][0]+k,b.bind(null,LANG.types[10][1],"achievement")],[11,LANG.types[13][0]+k,b.bind(null,LANG.types[13][1],"class")],[7,LANG.types[8][0]+k,b.bind(null,LANG.types[8][1],"faction")],[0,LANG.types[3][0]+k,b.bind(null,LANG.types[3][1],"item")],[1,LANG.types[4][0]+k,b.bind(null,LANG.types[4][1],"item-set")],[2,LANG.types[1][0]+k,b.bind(null,LANG.types[1][1],"npc")],[3,LANG.types[2][0]+k,b.bind(null,LANG.types[2][1],"object")],[8,LANG.types[9][0]+k,b.bind(null,LANG.types[9][1],"pet")],[4,LANG.types[5][0]+k,b.bind(null,LANG.types[5][1],"quest")],[12,LANG.types[14][0]+k,b.bind(null,LANG.types[14][1],"race")],[13,LANG.types[15][0]+k,b.bind(null,LANG.types[15][1],"skill")],[5,LANG.types[6][0]+k,b.bind(null,LANG.types[6][1],"spell")],[6,LANG.types[7][0]+k,b.bind(null,LANG.types[7][1],"zone")]]]];s.append(r);s.append(n);s.append($('<div style="clear: left" />'));s.append(t);s.append($("<br/>"));Menu.addButtons(n[0],h);if(v==4){s.append(WH.ct(WH.sprintf(LANG.compose_limit2,q,3)))}else{s.append(WH.ct(WH.sprintf(LANG.compose_limit,q)))}var E=$('<span class="comment-remaining"> '+WH.sprintf(LANG.compose_remaining,q-j.body.length)+"</span>");s.append(E);t.keyup(Listview.funcBox.coUpdateCharLimit.bind(0,t,E,q));t.keydown(Listview.funcBox.coUpdateCharLimit.bind(0,t,E,q));if((v==-1||v==0)&&g_user.roles&U_GROUP_MODERATOR){var f=$("<div/>",{"class":"pad"});var z=$("<div/>",{text:(g_user.roles&U_GROUP_ADMIN?"Admin":"Moderator")+" response"});var d=$("<textarea/>",{val:j.response,rows:3,css:{height:"6em"}});s.append(f);s.append(z);s.append(d)}w.append(s);w.append(c);$("<div/>").append('<div class="pad"/>').append(WH.getMajorHeading($('<a class="disclosure-off"/>').text(LANG.compose_formattinghelp).click(function(){WH.disclose(this.parentNode.nextSibling,this)}),3,null,{classes:"first"})).append($('<div style="display: none"/>').append(WH.markup.getHtml("[markupdoc help=user]"))).insertAfter(w.parent());return t},coLivePreview:function(g,h,b,c){if(c!=1&&b.style.display=="none"){return}var d=this,m=Listview.funcBox.coGetCharLimit(h),j=(d.value.length>m?d.value.substring(0,m):d.value);if(h==4){var k;if((k=j.indexOf("\n"))!=-1&&(k=j.indexOf("\n",k+1))!=-1&&(k=j.indexOf("\n",k+1))!=-1){j=j.substring(0,k)}}var l=WH.markup.rolesToClass(g.roles);var f=WH.markup.getHtml(j,{allow:l,mode:WH.markup.MODE.COMMENT,roles:g.roles});if(f){b.innerHTML=f}else{b.innerHTML='<span class="q6">...</span>'}},coEditButton:function(j,d,k,n){if(d){var g=WH.gE(j.divEdit,"textarea");var f=g[0];if(!Listview.funcBox.coValidate(f,k)){return}if(f.value!=j.body||(g[1]&&g[1].value!=j.response)){var b=0;if(j.lastEdit!=null){b=j.lastEdit[1]}++b;j.lastEdit=[g_serverTime,b,g_user.name];if(!j.commentv2){Listview.funcBox.coUpdateLastEdit(j)}var o=Listview.funcBox.coGetCharLimit(k);var m=WH.markup.rolesToClass(j.roles);var h=WH.markup.getHtml((f.value.length>o?f.value.substring(0,o):f.value),{allow:m,mode:WH.markup.MODE.COMMENT,roles:j.roles});var l=(g[1]&&g[1].value.length>0)?WH.markup.getHtml("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+g[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:WH.markup.MODE.COMMENT,roles:g_user.roles}):"";if(j.commentv2){j.body=f.value;if(g_user.roles&U_GROUP_MODERATOR&&g[1]){j.response=g[1].value}Listview.templates.comment.updateCommentCell(j)}else{if(!n){j.divBody.innerHTML=h;j.divResponse.innerHTML=l}else{j.divBody.html(h);j.divResponse.html(l)}j.body=f.value;if(g_user.roles&U_GROUP_MODERATOR&&g[1]){j.response=g[1].value}}var c="body="+WH.urlEncode(j.body);if(j.response!==undefined){c+="&response="+WH.urlEncode(j.response)}if(k==-1){new Ajax("/forums=editpost&id="+j.id,{method:"POST",params:c})}else{new Ajax("/comment=edit&id="+j.id,{method:"POST",params:c})}}}if(j.commentv2){Listview.templates.comment.updateCommentCell(j)}else{if(!n){j.divBody.style.display="";j.divResponse.style.display="";j.divLinks.firstChild.style.display=""}else{j.divBody.show();j.divResponse.show()}}if(!j.commentv2){WH.de(j.divEdit);j.divEdit=null}},coGetCharLimit:function(b){if(b==2){return 7500}if(b==4){return 250}if(g_user.roles&U_GROUP_STAFF){return 16000000}var c=1;if(g_user.premium){c=3}switch(b){case 0:case 1:return 7500*c;case -1:case 3:return 15000*c}},coUpdateCharLimit:function(b,c,d){var f=$(b).val();if(f.length>d){$(b).val(f.substring(0,d))}else{$(c).html(" "+WH.sprintf(LANG.compose_remaining,d-f.length)).removeClass("q10");if(f.length==d){$(c).addClass("q10")}}},coModeLink:function(j,b,h){var q=Listview.funcBox.coGetCharLimit(b);var c=WH.markup.MODE.COMMENT;WH.arrayWalk(WH.gE(this.parentNode,"a"),function(m){m.className=""});this.className="selected";var g=WH.gE(this.parentNode.parentNode,"textarea"),d=g[0],o=d.parentNode,k=$(".comment-body",o.parentNode)[0];if(b==4){c=WH.markup.MODE.SIGNATURE}switch(j){case 1:o.style.display="";k.style.display="none";WH.safeFocus(o.firstChild);break;case 2:o.style.display="none";var l=(d.value.length>q?d.value.substring(0,q):d.value);if(b==4){var n;if((n=l.indexOf("\n"))!=-1&&(n=l.indexOf("\n",n+1))!=-1&&(n=l.indexOf("\n",n+1))!=-1){l=l.substring(0,n)}}var p=WH.markup.rolesToClass(h.roles);var f=WH.markup.getHtml(l,{allow:p,mode:c,roles:h.roles});if(g[1]&&g[1].value.length>0){f+=WH.markup.getHtml("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+g[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:c,roles:g_user.roles})}k.innerHTML=f;k.style.display="";break}},coValidate:function(b,d){d|=0;if(d==1||d==-1){if(WH.trim(b.value).length<1){alert(LANG.message_forumposttooshort);return false}}else{if(WH.trim(b.value).length<1){alert(LANG.message_commenttooshort);return false}}var c=Listview.funcBox.coGetCharLimit(d);if(b.value.length>c){if(!confirm(WH.sprintf(d==1?LANG.confirm_forumposttoolong:LANG.confirm_commenttoolong,c,b.value.substring(c-30,c)))){return false}}return true},coSortNewestFirst:function(b){WH.setCookie("comments_sort",1000,"1","/",".wowhead.com");$(b).parent().find("a.selected").removeClass("selected");b.className="selected";this.mainDiv.className+=" listview-aci";this.setSort([-5,4,6,-1,-2],true,false)},coSortOldestFirst:function(b){WH.setCookie("comments_sort",1000,"2","/",".wowhead.com");$(b).parent().find("a.selected").removeClass("selected");b.className="selected";this.mainDiv.className+=" listview-aci";this.setSort([-5,4,6,1,2],true,false)},coSortHighestRatedFirst:function(b){WH.setCookie("comments_sort",1000,"3","/",".wowhead.com");$(b).parent().find("a.selected").removeClass("selected");b.className="selected";this.mainDiv.className=this.mainDiv.className.replace("listview-aci","");this.setSort([-5,4,6,-3,2],true,false)},coFilterByPatchVersion:function(b){this.minPatchVersion=b.value;this.refreshRows()},coUpdateLastEdit:function(h){var c=h.divLastEdit;if(!c){return}if(h.lastEdit!=null){var g=h.lastEdit;c.childNodes[1].firstChild.nodeValue=g[2];c.childNodes[1].href="/user="+g[2];var f=new Date(g[0]);var b=(g_serverTime-f)/1000;if(c.childNodes[3].firstChild){WH.de(c.childNodes[3].firstChild)}WH.formatDate(c.childNodes[3],b,f);var d="";if(h.rating!=null){d+=WH.sprintf(LANG.lvcomment_patch,WH.Wow.getVersionStringFromTimestamp(f))}if(g[1]>1){d+=LANG.dash+WH.sprintf(LANG.lvcomment_nedits,g[1])}c.childNodes[4].nodeValue=d;c.style.display=""}else{c.style.display="none"}},coFormatFileSize:function(d){var c=-1;var b="KMGTPEZY";while(d>=1024&&c<7){d/=1024;++c}if(c<0){return d+" byte"+(d>1?"s":"")}else{return d.toFixed(1)+" "+b[c]+"B"}},dateEventOver:function(d,c,j){var b=WH.getEventNextDates(c,d),l="";if(b[0]&&b[1]){var h=b[0],g=b[1],f,k;h.setFullYear(d.getFullYear(),d.getMonth(),d.getDate());g.setFullYear(d.getFullYear(),d.getMonth(),d.getDate());if(d.getFullYear()==b[0].getFullYear()&&d.getMonth()==b[0].getMonth()&&d.getDate()==b[0].getDate()){f=true}if(d.getFullYear()==b[1].getFullYear()&&d.getMonth()==b[1].getMonth()&&d.getDate()==b[1].getDate()){k=true}if(f&&k){l=WH.formatTimeSimple(h,LANG.lvscreenshot_from,1)+" "+WH.formatTimeSimple(g,LANG.date_to,1)}else{if(f){l=WH.formatTimeSimple(h,LANG.tab_starts)}else{if(k){l=WH.formatTimeSimple(g,LANG.tab_ends)}else{l=LANG.allday}}}}WH.Tooltip.showAtCursor(j,'<span class="q1">'+c.name+"</span><br />"+l,0,0,"q")},comparisonTextOver:function(c,d,b,k,h){var n='<table class="compare"><tr>';var l;n+="<tr>";for(var g=0;g<c.data.length;++g){l=(c.data[g].status==b?"this":"other");n+="<td><b>"+d?k[l]:LANG["lvcomparison_"+l]+"</b></td>"}n+="</tr>";for(var g=0;g<c.tooltip.length;++g){var m=1;if(c.progress<1){m=(c.tooltip[g][c.data[0].status]?1:0);for(var f=1;m&&f<c.data.length;++f){if(c.tooltip[g][c.data[f].status]=="&lt;"+LANG.fiany+"&gt;"){continue}if(!c.tooltip[g][c.data[f].status]||c.tooltip[g][c.data[f].status]!=c.tooltip[g][c.data[0].status]){m=0}}}n+="<tr>";for(var f=0;f<c.data.length;++f){n+='<td class="q'+m+'">'+c.tooltip[g][c.data[f].status]+"</td>"}n+="</tr>"}n+="</table>";WH.Tooltip.showAtCursor(h,n,0,0,"q")},ssCellOver:function(){this.className="screenshot-caption-over"},ssCellOut:function(){this.className="screenshot-caption"},ssCellClick:function(c,f){f=WH.normalizeEvent(f);if(f.shiftKey||f.ctrlKey){return}var b=0,d=f._target;while(d&&b<3){if(d.nodeName=="A"){return}if(d.nodeName=="IMG"){break}d=d.parentNode}ScreenshotViewer.show({screenshots:this.data,pos:c,hashname:this.id})},ssCreateCb:function(f,c){if(c.__nochk){return}var d=WH.ce("div");d.className="listview-cb";d.onclick=Listview.cbCellClick;var b=WH.ce("input");b.type="checkbox";b.onclick=Listview.cbClick;WH.disableOldIESelect(b);if(c.__chk){b.checked=true}c.__cb=b;WH.ae(d,b);WH.ae(f,d)},viCellClick:function(c,f){f=WH.normalizeEvent(f);if(f.shiftKey||f.ctrlKey){return}var b=0,d=f._target;while(d&&b<3){if(d.nodeName=="A"){return}if(d.nodeName=="IMG"){break}d=d.parentNode}VideoViewer.show({videos:this.data,pos:c})},moneyAchievementOver:function(b){WH.Tooltip.showAtCursor(b,"<b>"+LANG.tooltip_achievementpoints+"</b>",0,0,"q1")},moneyCurrencyOver:function(h,g,j){var k=g_gatheredcurrencies[h]["name_"+Locale.getName()];switch(h){case 395:var c=[[80,16,LANG.tooltip_ppbheroic],[80,23,LANG.tooltip_ppbraid],[85,75,LANG.tooltip_ppbheroic],[90,100,LANG.tooltip_ppbheroic]];break;case 396:var c=[[90,40,WH.sprintf(LANG.tooltip_ppb10man,LANG.tooltip_ppbraid)],[90,40,WH.sprintf(LANG.tooltip_ppb25man,LANG.tooltip_ppbraid)]];break;default:var c=[];break}if(c.length&&g){k+='<br /><span class="q">';for(var d=0,b=c.length;d<b;++d){var f=Math.ceil(g/c[d][1]);if(d>0){k+="<br />"}k+=WH.sprintf(LANG["tooltip_pointsperboss"+(f==1?1:2)],f,c[d][0],c[d][2])}k+="</span>"}WH.Tooltip.showAtCursor(j,k,0,0,"q1")},appendMoney:function(j,b,k,c,g,r){var q,p,n=0;if(k==1||k=="alliance"){k=1}else{if(k==2||k=="horde"){k=2}else{k=3}}if(b>=10000){n=1;q=WH.ce("span");q.className="moneygold";WH.ae(q,WH.ct(WH.numberFormat(Math.floor(b/10000))));WH.ae(j,q);b%=10000}if(b>=100){if(n){WH.ae(j,WH.ct(" "))}else{n=1}q=WH.ce("span");q.className="moneysilver";WH.ae(q,WH.ct(Math.floor(b/100)));WH.ae(j,q);b%=100}if(b>=1){if(n){WH.ae(j,WH.ct(" "))}else{n=1}q=WH.ce("span");q.className="moneycopper";WH.ae(q,WH.ct(b));WH.ae(j,q)}if(c!=null){for(var f=0;f<c.length;++f){if(n){WH.ae(j,WH.ct(" "))}else{n=1}var m=c[f][0];var h=c[f][1];var l=g_items.getIcon(m);q=WH.ce("a");q.href="/item="+m;q.className="moneyitem";q.style.backgroundImage="url("+g_staticUrl+"/images/wow/icons/tiny/"+l.toLowerCase()+".gif)";WH.ae(q,WH.ct(h));WH.ae(j,q)}}if(g!=null){for(var f=0;f<g.length;++f){if(n){WH.ae(j,WH.ct(" "))}else{n=1}var o=g[f][0];var h=g[f][1];if(!g_gatheredcurrencies[o]){$.each(g_currencies,function(s,d){g_gatheredcurrencies[s]=[];g_gatheredcurrencies[s]["name_"+Locale.getName()]=d[0];g_gatheredcurrencies[s].icon=[];g_gatheredcurrencies[s].icon.push(d[1]);g_gatheredcurrencies[s].icon.push(d[1])})}var l=g_gatheredcurrencies.getIcon(o,(k==3?0:k-1));if((!l)&&WH.isSet("g_currencies")&&g_currencies.hasOwnProperty(o)){l=g_currencies[o].icon}if(!l){l="inv_misc_questionmark"}q=WH.ce("a");q.href="/currency="+o;q.className="icontinyr tip q1";q.style.display="inline-block";q.style.backgroundImage="url("+g_staticUrl+"/images/wow/icons/tiny/"+l.toLowerCase()+".gif)";q.onmouseover=Listview.funcBox.moneyCurrencyOver.bind(q,o,h);q.onmousemove=WH.Tooltip.cursorUpdate;q.onmouseout=WH.Tooltip.hide;WH.ae(j,q);WH.ae(q,WH.ct(WH.numberFormat(h)))}}if(r>0){if(n){WH.ae(j,WH.ct(" "))}else{n=1}q=WH.ce("span");q.className="moneyachievement tip";q.onmouseover=Listview.funcBox.moneyAchievementOver;q.onmousemove=WH.Tooltip.cursorUpdate;q.onmouseout=WH.Tooltip.hide;WH.ae(q,WH.ct(WH.numberFormat(r)));WH.ae(j,q)}},viewColors:function(b,c){if(c>=50000){b.css("color","#FF4040");b.css("font-weight","bold")}else{if(c>=25000){b.css("color","#FF8000");b.css("font-weight","bold")}else{if(c>=10000){b.css("color","#A335EE")}else{if(c>=5000){b.css("color","#0070DD")}else{if(c>=1000){b.css("color","#1EFF00")}}}}}},getUpperSource:function(b,c){switch(b){case 2:if(c.bd){return LANG.source_bossdrop}if(c.z){return LANG.source_zonedrop}break;case 4:return LANG.source_quests;case 5:return LANG.source_vendors}return g_sources[b]},getLowerSource:function(d,f,c){switch(d){case 3:if(f.p&&g_sources_pvp[f.p]){return{text:g_sources_pvp[f.p]}}break}switch(c){case 0:case 1:case 2:if(f.z){var b={url:"/zone="+f.z,text:g_zones[f.z]};if(f.t&&d==5){b.pretext=LANG.lvitem_vendorin}if(f.dd&&f.dd!=99){if(f.dd<0){b.posttext=WH.sprintf(LANG.lvitem_dd,"",(f.dd<-1?LANG.lvitem_heroic:LANG.lvitem_normal))}else{if(f.dd>=14){b.posttext=(f.dd==15||f.dd==16)?LANG.lvitem_heroic:LANG.lvitem_normal}else{b.posttext=WH.sprintf(LANG.lvitem_dd,(f.dd&1?LANG.lvitem_raid10:LANG.lvitem_raid25),(f.dd>2?LANG.lvitem_heroic:LANG.lvitem_normal))}}}return b}break;case 5:return{url:"/quests="+f.c2+"."+f.c,text:Listview.funcBox.getQuestCategory(f.c)};break;case 6:if(f.c&&f.s){return{url:"/spells="+f.c+"."+f.s,text:g_spell_skills[f.s]}}else{return{url:"/spells=0",text:"??"}}break}},getExpansionText:function(b){var c="";if(b.expansion==1){c+=" bc"}else{if(b.expansion==2){c+=" wotlk wrath"}else{if(b.expansion==3){c+=" cat cata cataclysm"}}}return c},getComparisonText:function(f,g,b,k){var l=WH.ce("span");l.className="compare-text";if(!g){l.style.display="block";l.style.margin="0 auto";l.style.textAlign="left";l.style.width="53px"}if(!k){k=LANG.lvcompletion}var h=f.hasOwnProperty("progressAmount")?f.progressAmount:f.progress;if(h<0){h=0}var c=WH.ce("span");c.className="progress-icon progress-"+(h==1?"8":Math.min(Math.round(h*8),7));var n=WH.ce("span");if(g){if(f.progress==1){WH.st(n,k.identical)}else{if(f.progress==-1){WH.st(n,k.duplicate)}else{if(!f.progress&&f.primary==b){WH.st(n,k.extra)}else{if(!f.progress){WH.st(n,k.missing)}else{var m=WH.ce("span");m.className="tip";WH.st(m,Math.floor(f.progress*100)+"%");WH.ae(n,WH.ct(k.similar+" ("));WH.ae(n,m);WH.ae(n,WH.ct(")"))}}}}}else{WH.st(n,Math.floor(f.progress*100)+"%")}var d=true;for(var j in f.tooltip){d=d&&(f.tooltip[j].length!=f.data.length)}if(f.tooltip.length&&d){l.onmouseover=Listview.funcBox.comparisonTextOver.bind(l,f,g,b,k);l.onmousemove=WH.Tooltip.cursorUpdate;l.onmouseout=WH.Tooltip.hide;if(!g){n.className="tip"}}n.insertBefore(WH.ct(" "),n.firstChild);n.insertBefore(c,n.firstChild);n.style.whiteSpace="nowrap";WH.ae(l,n);return l}};Listview.templates.list={sort:["-rating","name"],searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",span:2,compute:function(j,f,k){var h=WH.ce("td");h.style.width="1px";h.style.borderRight="none";h.style.paddingRight="0";WH.ae(k,h);f.style.borderLeft="none";if(j.thumbnail&&j.region){h.style.padding="4px 0 4px 10px";WH.ae(h,Icon.create("//render-"+j.region.toLowerCase()+".worldofwarcraft.com/character/"+j.thumbnail,this.iconSize===null?1:this.iconSize,null,this.getItemLink(j)));h.getElementsByTagName("ins")[0].style.backgroundSize="contain"}var l=(j.hasOwnProperty("id")||j.level>=10)?"a":"span";var b=$("<"+l+">").text(j.name).addClass("listview-cleartext").addClass(j.mode!=1||(j.armory&&!j.errcode)?"listmanager-mode"+j.mode:"q10");if(j.mode==1){f.className+=" nowrap"}if(l=="a"){var c=this.getItemLink(j);b.attr("href",c);if(!j.hasOwnProperty("id")){WH.BattleNet.CharacterExists(j.region,j.realm,j.name,function(m){if(m){return}b.attr("href","javascript:;");b.addClass("q10");j.unreachable=true})}}else{b.addClass("q0")}if(j.description){b.mouseover(function(m){WH.Tooltip.showAtCursor(m,j.description,0,0,"q")}).mousemove(function(m){WH.Tooltip.cursorUpdate(m)}).mouseout(function(){WH.Tooltip.hide()})}if(j.user==g_user.name||(g_user.roles&(U_GROUP_ADMIN|U_GROUP_BUREAU))>0){var g=$("<a>").addClass(j.published?"fa fa-eye":"fa fa-eye-slash").css("padding-right","3px").mouseover(function(m){WH.Tooltip.showAtCursor(m,j.published?LANG.li_clicktohide:LANG.li_clicktoshow,0,0,"q2")}).mousemove(function(m){WH.Tooltip.cursorUpdate(m)}).mouseout(function(){WH.Tooltip.hide()});g.click(function(){WH.Tooltip.hide();new Ajax("/list&publish="+j.id,{method:"POST",onSuccess:function(){if(g.hasClass("fa-eye-slash")){g.removeClass("fa-eye-slash").addClass("fa-eye").mouseover(function(m){WH.Tooltip.showAtCursor(m,LANG.li_clicktohide,0,0,"q2")})}else{g.removeClass("fa-eye").addClass("fa-eye-slash").mouseover(function(m){WH.Tooltip.showAtCursor(m,LANG.li_clicktoshow,0,0,"q2")})}}})});$(f).append(g);var d=$("<a>").addClass("fa fa-thumb-tack"+(j.pinned?"":" fa-color-gray")).mouseover(function(m){WH.Tooltip.showAtCursor(m,j.pinned?LANG.li_clicktounpin:LANG.li_clicktopin,0,0,"q2")}).mousemove(function(m){WH.Tooltip.cursorUpdate(m)}).mouseout(function(){WH.Tooltip.hide()});d.click(function(){WH.Tooltip.hide();new Ajax("/list&pin="+j.id,{method:"POST",onSuccess:function(){if(d.hasClass("fa-color-gray")){d.removeClass("fa-color-gray").mouseover(function(m){WH.Tooltip.showAtCursor(m,LANG.li_clicktounpin,0,0,"q2")})}else{d.addClass("fa-color-gray").mouseover(function(m){WH.Tooltip.showAtCursor(m,LANG.li_clicktopin,0,0,"q2")})}}})});$(f).append(d)}$(f).append(b);return},getVisibleText:function(b){return b.name}},{id:"realm",name:LANG.realm,type:"text",hidden:true,value:"realm",width:"15%",compute:function(b,c){WH.st(c,b.realm+" "+b.region)},sortFunc:function(d,c){return WH.stringCompare(d.region,c.region)||WH.stringCompare(d.realm,c.realm)}},{id:"race",name:LANG.race,type:"text",width:"10%",compute:function(f,h){if(f.race){var g=WH.ce("div"),c=WH.ce("div"),b;b=Icon.create("race_"+g_file_races[f.race]+"_"+g_file_genders[f.gender],0,null,"/race="+f.race);b.onmouseover=function(d){WH.Tooltip.showAtCursor(d,g_chr_races[f.race],0,0,"q")};b.onmousemove=WH.Tooltip.cursorUpdate;b.onmouseout=WH.Tooltip.hide;b.style.cssFloat=b.style.syleFloat="left";g.style.margin="0 auto";g.style.textAlign="left";g.style.width="26px";c.className="clear";WH.ae(g,b);WH.ae(h,g);WH.ae(h,c)}},getVisibleText:function(b){return g_file_genders[b.gender]+" "+g_chr_races[b.race]},sortFunc:function(d,c,f){return WH.stringCompare(g_chr_races[d.race],g_chr_races[c.race])}},{id:"classs",name:LANG.classs,type:"text",width:"10%",compute:function(f,h){if(f.classs){var g=WH.ce("div"),c=WH.ce("div"),b;b=Icon.create("class_"+g_file_classes[f.classs],0,null,"/class="+f.classs);b.onmouseover=function(d){WH.Tooltip.showAtCursor(d,g_chr_classes[f.classs],0,0,"q")};b.onmousemove=WH.Tooltip.cursorUpdate;b.onmouseout=WH.Tooltip.hide;b.style.cssFloat=b.style.syleFloat="left";g.style.margin="0 auto";g.style.textAlign="left";g.style.width="26px";c.className="clear";WH.ae(g,b);WH.ae(h,g);WH.ae(h,c)}},getVisibleText:function(b){return g_chr_classes[b.classs]},sortFunc:function(d,c,f){return WH.stringCompare(this.getVisibleText(d),this.getVisibleText(c))}},{id:"level",name:LANG.level,value:"level",width:"10%"},{id:"user",name:LANG.author,type:"text",compute:function(c,f){var d=$("<a>").attr("href","/user="+c.user).text(c.user);var b=WH.getStaffColorFromRoles(c.userroles|0);if(b!=""){d.addClass(b)}else{d.css("color","white")}$(f).append(d)},getVisibleText:function(b){return b.user},sortFunc:function(d,c){return WH.stringCompare(d.user,c.user)}},{id:"patch",name:LANG.patch,type:"text",value:"patch",width:"10%",compute:function(c,f){var b=$("<span>").text(WH.sprintf("$1.$2.$3",Math.floor(c.patch/100/100),Math.floor(c.patch/100)%100,c.patch%100));var d=(WH.Wow.getPatchVersionObject()).versionNum;if(parseInt(c.patch/100)*100>=d){b.addClass("q2")}$(f).append(b);return}}],getItemLink:function(b){if(b.hasOwnProperty("id")){return li_generateListUrl(b)}if(b.level<10||b.unreachable){return"javascript:;"}return"/list/"+b.url+"?private"}};Listview.templates.resource={sort:[1],mode:0,nItemsPerPage:100,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",span:2,compute:function(d,j,g){var c=WH.ce("td");c.style.width="1px";c.style.paddingRight="0";c.style.borderRight="none";var f=Icon.create(d.icon,(this.iconSize==null?0:this.iconSize),null,this.getItemLink(d));WH.ae(c,f);WH.ae(g,c);j.style.borderLeft="none";var h=WH.ce("div");WH.ae(j,h);var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(d);WH.ae(b,WH.ct(d.name));WH.ae(h,b)},getVisibleText:function(b){return b.name}},{id:"description",name:LANG.description,type:"text",align:"left",compute:function(b,c){c.innerHTML=b.description}}],getItemLink:function(b){return"/resource/"+b.id}};Listview.templates.skill={sort:[1],searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",span:2,compute:function(c,j,g){var d=WH.ce("td");d.style.width="1px";d.style.paddingRight="0";d.style.borderRight="none";WH.ae(d,Icon.create(c.icon,0,null,this.getItemLink(c)));WH.ae(g,d);j.style.borderLeft="none";var h=WH.ce("div");var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(c);WH.ae(b,WH.ct(c.name));if(c.expansion){var f=WH.ce("span");f.className=WH.getExpansionClassName(c.expansion);WH.ae(f,b);WH.ae(h,f)}else{WH.ae(h,b)}WH.ae(j,h)},getVisibleText:function(b){var c=b.name+Listview.funcBox.getExpansionText(b);return c}},{id:"category",name:LANG.category,type:"text",width:"16%",compute:function(c,d){if(c.category!=0&&g_skill_categories[c.category]){d.className="small q1";var b=WH.ce("a");b.href="/skills="+c.category;WH.ae(b,WH.ct(g_skill_categories[c.category]));WH.ae(d,b)}},getVisibleText:function(b){return g_skill_categories[skill.category]},sortFunc:function(d,c,f){return WH.stringCompare(g_skill_categories[d.category],g_skill_categories[c.category])}}],getItemLink:function(b){return"/skill="+b.id}};Listview.templates.spell={sort:["name","skill","level"],mode:1,searchable:1,filtrable:1,completionText:LANG.lvcompletion_collection,columns:[{id:"name",name:LANG.name,type:"text",align:"left",span:2,value:"name",compute:function(k,h,o){var j=WH.ce("td"),q;j.style.width="44px";j.style.padding="3px 0 3px 12px";j.style.borderRight="none";if(k.creates!=null){q=g_items.createIcon(k.creates[0],1,Listview.funcBox.createTextRange(k.creates[1],k.creates[2]))}else{if((k.taughtby!=null)&&g_items[k.taughtby]){q=g_items.createIcon(k.taughtby,1);k.name=g_items[k.taughtby].name.charAt(0)+k.name.substring(1)}else{q=g_spells.createIcon(k.id,1)}}q.style.cssFloat=q.style.styleFloat="left";WH.ae(j,q);WH.ae(o,j);h.style.borderLeft="none";var b=WH.ce("div");var p=WH.ce("a");if(!k.name){WH.error("Spell has no name! Using a placeholder.",k);k.name="@"+LANG.parens_open+LANG.types[6][0]+" #"+k.id+LANG.parens_close}var n=k.name.charAt(0);p.className="listview-cleartext";if(n!="@"){p.className+=" q"+(8-parseInt(n))}p.href=this.getItemLink(k);if(k.frommerge==1){p.className+=" icon-merge-right"}WH.ae(p,WH.ct(k.name.substring(1)));WH.ae(b,p);if(k.rank){var m=WH.ce("div");m.className="small2";WH.ae(m,WH.ct(k.rank));WH.ae(b,m)}if(this.showRecipeClass&&k.reqclass){var m=WH.ce("div");m.className="small2";var g=Listview.funcBox.assocBinFlags(k.reqclass,g_chr_classes);for(var j=0,l=g.length;j<l;++j){if(j>0){WH.ae(m,WH.ct(", "))}p=WH.ce("a");p.href="/class="+g[j];p.className="c"+g[j];WH.st(p,g_chr_classes[g[j]]);WH.ae(m,p)}WH.ae(b,m)}if(k.id>g_spells.ZAM_IDS){b.style.position="relative";var m=WH.ce("div");m.className="listview-name-info";WH.ae(m,WH.ct(LANG.unreleasedspell));WH.aef(b,m)}if(k.reqrace){b.style.position="relative";var m=WH.ce("div");m.className="listview-name-info";if((k.reqrace&1791)==1101){WH.ae(m,WH.ct(g_sides[1]))}else{if((k.reqrace&1791)==690){WH.ae(m,WH.ct(g_sides[2]))}else{var f=Listview.funcBox.assocBinFlags(k.reqrace,g_chr_races);m.className+=" q1";for(var j=0,l=f.length;j<l;++j){if(j>0){WH.ae(m,WH.ct(LANG.comma))}var p=WH.ce("a");p.href="/race="+f[j];WH.st(p,g_chr_races[f[j]]);WH.ae(m,p)}}}WH.aef(b,m)}WH.ae(h,b)},getVisibleText:function(c){var g=c.name;if(c.rank){g+=" "+c.rank}if(c.reqclass){var f=Listview.funcBox.assocBinFlags(c.reqclass,g_chr_classes);for(var d=0,b=f.length;d<b;++d){if(d>0){g+=LANG.comma}g+=g_chr_classes[f[d]]}}if(c.reqrace){g+=" "+Listview.funcBox.arrayText(Listview.funcBox.assocBinFlags(c.reqrace,g_chr_races),g_chr_races)}if((c.reqrace&1791)==1101){g+=" "+g_sides[1]}else{if((c.reqrace&1791)==690){g+=" "+g_sides[2]}}return g}},{id:"level",name:LANG.level,width:"10%",value:"level",compute:function(b,c){if(b.level>0){return b.level}},hidden:true},{id:"trainingcost",name:LANG.cost,width:"10%",hidden:true,getValue:function(b){if(b.trainingcost){return b.trainingcost}},compute:function(b,c){if(b.trainingcost){Listview.funcBox.appendMoney(c,b.trainingcost)}},sortFunc:function(d,c,f){if(d.trainingcost==null){return -1}else{if(c.trainingcost==null){return 1}}if(d.trainingcost<c.trainingcost){return -1}else{if(d.trainingcost>c.trainingcost){return 1}}return 0}},{id:"classes",name:LANG.classes,type:"text",hidden:true,width:"20%",getVisibleText:function(c){var g="";if(c.reqclass){var f=Listview.funcBox.assocBinFlags(c.reqclass,g_chr_classes);for(var d=0,b=f.length;d<b;++d){if(d>0){g+=LANG.comma}g+=g_chr_classes[f[d]]}}return g},compute:function(c,k){if(c.reqclass){var g=Listview.funcBox.assocBinFlags(c.reqclass,g_chr_classes);var j=WH.ce("div");j.style.width=(26*g.length)+"px";j.style.margin="0 auto";for(var f=0,b=g.length;f<b;++f){var h=Icon.create("class_"+g_file_classes[g[f]],0,null,"/class="+g[f]);h.style.cssFloat=h.style.styleFloat="left";$(h).mouseover((function(d){return function(l){WH.Tooltip.showAtCursor(l,d,0,0,"q")}})(g_chr_classes[g[f]])).mousemove(function(d){WH.Tooltip.cursorUpdate(d)}).mouseout(function(){WH.Tooltip.hide()});WH.ae(j,h)}WH.ae(k,j)}},sortFunc:function(d,c,f){return Listview.funcBox.assocArrCmp(Listview.funcBox.assocBinFlags(d.reqclass,g_chr_classes),Listview.funcBox.assocBinFlags(c.reqclass,g_chr_classes),g_chr_classes)}},{id:"singleclass",name:LANG.classs,type:"text",hidden:true,width:"15%",compute:function(b,g){if(b.reqclass){var c=Listview.funcBox.assocBinFlags(b.reqclass,g_chr_classes);var d=c[0];var f=$("<a>").css("background-image",'url("'+g_staticUrl+"/images/wow/icons/tiny/class_"+g_file_classes[d]+'.gif")').addClass("icontiny tinyspecial").addClass("c"+d).attr("href","/class="+d).text(g_chr_classes[d]);$(g).append(f)}},sortFunc:function(d,c,f){return Listview.funcBox.assocArrCmp(Listview.funcBox.assocBinFlags(d.reqclass,g_chr_classes),Listview.funcBox.assocBinFlags(c.reqclass,g_chr_classes),g_chr_classes)}},{id:"glyphtype",name:LANG.glyphtype,type:"text",hidden:true,width:"10%",compute:function(b,c){if(b.glyphtype){return g_item_glyphs[b.glyphtype]}}},{id:"guildlevel",name:LANG.guildlevel,width:"10%",value:"guildlevel",compute:function(b,c){if(b.guildlevel>0){return b.guildlevel}},hidden:true},{id:"schools",name:LANG.school,type:"text",width:"10%",hidden:true,compute:function(b,g){var f="";var d=b.schools?b.schools:b.school;for(var c=0;c<32;++c){if(!(d&(1<<c))){continue}if(f!=""){f+=", "}f+=g_spell_resistances[c]}return f},sortFunc:function(d,c,f){return WH.stringCompare(this.compute(d),this.compute(c))}},{id:"type",name:LANG.type,type:"text",width:"14%",hidden:true,compute:function(h,d){var c=WH.ce("div");c.className="small";if(WH.inArray([7,-2,-7,-12,-11,-13,-14,-16,-17,-18],h.cat)!=-1){var n=WH.ce("a");n.className="q0";n.href="/spells="+h.cat;WH.ae(n,WH.ct(g_spell_categories[h.cat]));WH.ae(c,n);WH.ae(c,WH.ce("br"));if(h.talentspec){var m=0,k;for(var g=0,l=h.talentspec.length;g<l;++g){var o=h.talentspec[g]&65535;if(this._wowClass&&(WH.inArray(g_chr_specs_by_class[this._wowClass],o)==-1)){continue}if(!g_chr_specs.hasOwnProperty(o)){continue}if(m++>0){WH.ae(c,WH.ct(LANG.comma))}k=h.reqclass||h.chrclass;if(k){k=(1+Math.log(h.reqclass)/Math.LN2)}else{for(var f in g_chr_specs_by_class){if(!g_chr_specs_by_class.hasOwnProperty(f)){continue}if(WH.inArray(g_chr_specs_by_class[f],o)>=0){k=f;break}}}var b=WH.ce("a");b.className="q1";b.href="/spells="+h.cat+"."+k+"."+o;WH.ae(b,WH.ct(g_chr_specs[o]));WH.ae(c,b)}if(m==0){k=h.reqclass||h.chrclass;if(k){for(g in g_chr_classes){if(!g_chr_classes.hasOwnProperty(g)){continue}if((k&Math.pow(2,parseInt(g,10)-1))!=0){if(m++>0){WH.ae(c,WH.ct(LANG.comma))}var b=WH.ce("a");b.className="q1";b.href="/spells="+h.cat+"."+g;WH.ae(b,WH.ct(g_chr_classes[g]));WH.ae(c,b)}}}}}else{if(g_spell_types[h.cat]){if(h.cat==-11&&(h.type==1||h.type==2)){var b=WH.ce("a");b.className="q1";b.href="/spells="+h.cat+"?filter=cr=22;crs="+h.type+";crv=0";WH.ae(b,WH.ct(g_spell_types[h.cat][h.type]));WH.ae(c,b)}else{WH.ae(c,WH.ct(g_spell_types[h.cat][h.type]))}}else{if(h.reqclass){var b=WH.ce("a");b.className="q1";b.href="/spells="+h.cat+"."+(1+Math.log(h.reqclass)/Math.LN2)+(g_item_glyphs[h.glyphtype]?"?filter=gl="+h.glyphtype:"");WH.ae(b,WH.ct((g_item_glyphs[h.glyphtype]?g_item_glyphs[h.glyphtype]+" ":"")+g_chr_classes[(1+Math.log(h.reqclass)/Math.LN2)]));WH.ae(c,b)}}}}else{if(g_spell_categories[h.cat]){var n=WH.ce("a");n.className="q1";n.href="/spells="+h.cat;WH.ae(n,WH.ct(g_spell_categories[h.cat]));WH.ae(c,n)}}WH.ae(d,c)},getVisibleText:function(b){var c=g_spell_categories[b.cat];if(WH.inArray([7,-2,-12,-11,-13,-14,-16,-17,-18],b.cat)!=-1){if(b.talentspec){c+=" "+Listview.funcBox.arrayText(b.talentspec,g_chr_specs)}else{if(g_spell_types[b.cat]){c+=" "+g_spell_types[b.cat][b.type]}else{if(g_item_glyphs[b.glyphtype]){c+=" "+g_item_glyphs[b.glyphtype]}c+=" "+g_chr_classes[(1+Math.log(b.reqclass)/Math.LN2)]}}}return c},sortFunc:function(d,c,f){var h=(g_spell_types[d.cat]?g_spell_types[d.cat][d.type]:d.type),g=(g_spell_types[c.cat]?g_spell_types[c.cat][c.type]:d.type);return WH.stringCompare(d.cat,c.cat)||WH.stringCompare(h,g)}},{id:"reagents",name:LANG.reagents,width:"9%",getValue:function(b){return(b.reagents?b.reagents.length:0)},compute:function(j,f){var b=(j.reagents!=null);if(b){f.style.padding="0";var l=WH.ce("div");var m=j.reagents;l.style.width=(44*m.length)+"px";l.style.margin="0 auto";for(var g=0,k=m.length;g<k;++g){var c=m[g][0];var h=m[g][1];var n=g_items.createIcon(c,1,h);n.style.cssFloat=n.style.styleFloat="left";WH.ae(l,n)}WH.ae(f,l)}},sortFunc:function(d,c){var g=(d.reagents!=null?d.reagents.length:0);var f=(c.reagents!=null?c.reagents.length:0);if(g>0&&g==f){return WH.stringCompare(d.reagents.toString(),c.reagents.toString())}else{return WH.stringCompare(g,f)}}},{id:"source",name:LANG.source,type:"text",width:"12%",hidden:true,compute:function(c,g){if(c.source!=null){var f="";for(var d=0,b=c.source.length;d<b;++d){if(d>0){f+=LANG.comma}f+=g_sources[c.source[d]]}return f}},sortFunc:function(d,c,f){return Listview.funcBox.assocArrCmp(d.source,c.source,g_sources)}},{id:"side",name:LANG.side,type:"text",hidden:true,compute:function(b,d){if(b.side&&b.side!=3){var c=WH.ce("span");c.className=(b.side==1?"icon-alliance":"icon-horde");c.onmouseover=function(f){WH.Tooltip.showAtCursor(f,g_sides[b.side],0,0,"q")};c.onmousemove=WH.Tooltip.cursorUpdate;c.onmouseout=WH.Tooltip.hide;WH.ae(d,c)}},getVisibleText:function(b){if(b.side){return g_sides[b.side]}},sortFunc:function(d,c,f){return WH.stringCompare(g_sides[d.side],g_sides[c.side])}},{id:"itemsource",name:LANG.source,type:"text",hidden:true,compute:function(b,f){var d=g_items[b.taughtby];if(d){for(var c=0;c<Listview.templates.item.columns.length;++c){if(Listview.templates.item.columns[c].id=="source"){return Listview.templates.item.columns[c].compute(d,f)}}}},getVisibleText:function(b){var d=g_items[b.taughtby];if(d){for(var c=0;c<Listview.templates.item.columns.length;++c){if(Listview.templates.item.columns[c].id=="source"){return Listview.templates.item.columns[c].getVisibleText(d)}}}},sortFunc:function(d,c){var h=g_items[d.taughtby];var g=g_items[c.taughtby];if(h&&g){for(var f=0;f<Listview.templates.item.columns.length;++f){if(Listview.templates.item.columns[f].id=="source"){return Listview.templates.item.columns[f].sortFunc(h,g)}}}}},{id:"branch",name:LANG.branch,type:"text",width:"10%",hidden:true,compute:function(b,c){if(b.project){if(g_project_branches[b.project.branch]){$(c).append(g_project_branches[b.project.branch]+"<br />")}$(c).append("<small"+(!b.project.rarity?' class="q0"':"")+">"+g_project_rarity[b.project.rarity||0]+"</small>")}},getVisibleText:function(b){var c="";if(b.project){if(g_project_branches[b.project.branch]){c+=g_project_branches[b.project.branch]+" "}c+=g_project_rarity[b.project.rarity||0]}return c},sortFunc:function(d,c,f){if(!d.project||!c.project){return(d.project?1:(c.project?-1:0))}return WH.stringCompare(g_project_branches[d.project.branch],g_project_branches[c.project.branch])||-WH.stringCompare(d.project.rarity,c.project.rarity)}},{id:"fragments",name:LANG.fragments,type:"text",width:"10%",hidden:true,compute:function(b,d){if(b.project){var c=$("<a/>",{href:"/currency="+b.project.currency,text:b.project.ncurrency});c.addClass("q1");if(!g_gatheredcurrencies[b.project.currency]){$.each(g_currencies,function(g,f){g_gatheredcurrencies[g]=[];g_gatheredcurrencies[g]["name_"+Locale.getName()]=f[0];g_gatheredcurrencies[g].icon=[];g_gatheredcurrencies[g].icon.push(f[1]);g_gatheredcurrencies[g].icon.push(f[1])})}c.addClass("icontinyr tip");c.css("background-image","url("+g_staticUrl+"/images/wow/icons/tiny/"+g_gatheredcurrencies[b.project.currency].icon[0].toLowerCase()+".gif)");c.mouseover(function(f){WH.Tooltip.showAtCursor(f,g_gatheredcurrencies[b.project.currency]["name_"+Locale.getName()],0,0,"q")});c.mousemove(WH.Tooltip.cursorUpdate);c.mouseout(WH.Tooltip.hide);$(d).append(c)}},sortFunc:function(d,c,f){if(!d.project||!c.project){return(d.project?1:(c.project?-1:0))}return WH.stringCompare(d.project.ncurrency,c.project.ncurrency)||WH.stringCompare(d.project.currency,c.project.currency)}},{id:"keystone",name:LANG.keystone,type:"text",width:"10%",hidden:true,compute:function(b,f){if(b.project&&b.project.nkeystones&&g_items[b.project.keystone]){f.style.padding="0";var c=WH.ce("div");c.style.width="44px";c.style.margin="0 auto";WH.ae(c,g_items.createIcon(b.project.keystone,1,b.project.nkeystones));WH.ae(f,c)}},getVisibleText:function(b){if(b.project&&b.project.nkeystones&&g_items[b.project.keystone]){return g_items[b.project.keystone]["name_"+Locale.getName()]}},sortFunc:function(d,c,h){if(!d.project||!c.project){return(d.project?1:(c.project?-1:0))}var g=d.project.nkeystones&&g_items[d.project.keystone]?g_items[d.project.keystone]["name_"+Locale.getName()]:"";var f=c.project.nkeystones&&g_items[c.project.keystone]?g_items[c.project.keystone]["name_"+Locale.getName()]:"";return WH.stringCompare(g,f)||WH.stringCompare(d.project.nkeystones,c.project.nkeystones)}},{id:"skill",name:LANG.skill,type:"text",width:"20%",getValue:function(b){return b.learnedat},compute:function(w,h,b,l){if(w.skill!=null){this.skillsColumn=l;var m=WH.ce("div"),u;m.className="small";for(var o=0,q=w.skill.length;o<q;++o){if(o>0){WH.ae(m,WH.ct(LANG.comma))}if(w.skill[o]==-1){WH.ae(m,WH.ct(LANG.ellipsis))}else{if(WH.inArray([-3,-5,-6,-7,11,9],w.cat)!=-1){var c="";if((w.cat==-3)&&!(w.reqclass)){for(var s=0;s<mn_spells.length;s++){if(mn_spells[s][0]==-3){for(var r=0;r<mn_spells[s][3].length;r++){for(var p=0;p<mn_spells[s][3][r][3].length;p++){if(mn_spells[s][3][r][3][p][0]==w.skill[o]){c=mn_spells[s][3][r][0]+"."}}}}}}else{if(w.reqclass){c=""+(1+Math.log(w.reqclass)/Math.LN2)+"."}}var u=WH.ce("a");u.className="q1";if(WH.inArray([-5,-6],w.cat)!=-1){u.href="/spells="+w.cat}else{u.href="/spells="+w.cat+"."+c+w.skill[o]}var t=WH.getGets();var g=(t.spells?t.spells.split("."):[false,false]);if(w.reqclass&&(w.cat==7||w.cat==-2)){if(o<1&&((1+Math.log(w.reqclass)/Math.LN2)!=g[1])){var v=WH.ce("a");v.className="q0";v.href="/spells="+w.cat+"."+(1+Math.log(w.reqclass)/Math.LN2);WH.ae(v,WH.ct(g_chr_classes[(1+Math.log(w.reqclass)/Math.LN2)]));WH.ae(m,v);WH.ae(m,WH.ce("br"))}}WH.ae(u,WH.ct(g_spell_skills[w.skill[o]]));WH.ae(m,u)}else{if(WH.inArray([-2,7],w.cat)!=-1){var u=WH.ce("a");u.className="q1";u.href="/spells="+w.cat+"."+(w.reqclass?(1+Math.log(w.reqclass)/Math.LN2):"");WH.ae(u,WH.ct(g_spell_skills[w.skill[o]]));WH.ae(m,u)}else{WH.ae(m,WH.ct(g_spell_skills[w.skill[o]]))}}}}if(w.specialization&&g_skill_specializations[w.specialization]){var f=u.href;if(f){u=WH.ce("a");u.className="q1";u.href=f+"."+w.specialization;WH.ae(m,WH.ct(": "));WH.ae(u,WH.ct(g_skill_specializations[w.specialization]));WH.ae(m,u)}else{WH.ae(m,WH.ct(": "+g_skill_specializations[w.specialization]))}}if(w.learnedat>0){WH.ae(m,WH.ct(" ("));var k=WH.ce("span");if(w.learnedat==9999){k.className="q0";WH.ae(k,WH.ct("??"))}else{if(w.learnedat>0){WH.ae(k,WH.ct(w.learnedat));k.style.fontWeight="bold"}}WH.ae(m,k);WH.ae(m,WH.ct(")"))}WH.ae(h,m);if(w.colors!=null){this.columns[l].type=null;var j=w.colors,n=0;for(var o=0;o<j.length;++o){if(j[o]>0){++n;break}}if(n>0){n=0;m=WH.ce("div");m.className="small";m.style.fontWeight="bold";for(var o=0;o<j.length;++o){if(j[o]>0){if(n++>0){WH.ae(m,WH.ct(" "))}var d=WH.ce("span");d.className="r"+(o+1);WH.ae(d,WH.ct(j[o]));WH.ae(m,d)}}WH.ae(h,m)}}}else{if((w.reqclass)&&(WH.inArray([-2,7],w.cat)!=-1)){var m=WH.ce("div"),u;m.className="small";var u=WH.ce("a");u.className="q1";u.href="/spells="+w.cat+"."+(w.reqclass?(1+Math.log(w.reqclass)/Math.LN2):"");WH.ae(u,WH.ct(g_chr_classes[(1+Math.log(w.reqclass)/Math.LN2)]));WH.ae(m,u);WH.ae(h,m)}}},getVisibleText:function(b){var c=Listview.funcBox.arrayText(b.skill,g_spell_skills);if(b.specialization){c+=" "+(g_skill_specializations[b.specialization])}if(b.learnedat>0){c+=" "+(b.learnedat==9999?"??":b.learnedat)}return c},sortFunc:function(g,c){if(g.reqclass&&c.reqclass){var f=WH.stringCompare(g_chr_classes[(1+Math.log(g.reqclass)/Math.LN2)],g_chr_classes[(1+Math.log(c.reqclass)/Math.LN2)]);if(f){return f}}var d=[g.learnedat,c.learnedat];for(var j=0;j<2;++j){var k=(j==0?g:c);if(d[j]==9999&&k.colors!=null){var h=0;while(k.colors[h]==0&&h<k.colors.length){h++}if(h<k.colors.length){d[j]=k.colors[h]}}}var l=WH.stringCompare(d[0],d[1]);if(l!=0){return l}if(g.colors!=null&&c.colors!=null){for(var h=0;h<4;++h){if(g.hasOwnProperty("colors")&&c.hasOwnProperty("colors")&&g.colors.hasOwnProperty(h)&&c.colors.hasOwnProperty(h)){l=WH.stringCompare(g.colors[h],c.colors[h])}if(l!=0){return l}}}return Listview.funcBox.assocArrCmp(g.skill,c.skill,g_spell_skills)}},{id:"skillup",name:LANG.skillpoints,width:"10%",value:"nskillup",compute:function(b,c){if(b.nskillup>0){return b.nskillup}},hidden:true},{id:"completed",name:LANG.completion,hidden:true,compute:function(b,f,d,c){if(!b.hasOwnProperty("cat")||!Listview.templates.spell._validCompletionCategory(b.cat)){return}WH.addCompletionIcons(f,"spell",b.id)},sortFunc:function(d,c,f){return WH.stringCompare(WH.getCompletionFlags("spell",d.id),WH.getCompletionFlags("spell",c.id))},getValue:function(d){var g=0;var f=g_completion.spell;if((!d.hasOwnProperty("cat"))||(!Listview.templates.spell._validCompletionCategory(d.cat))){return -1}for(var h in g_user.lists){var b=g_user.lists[h];if(!(b.id in f)){continue}if(WH.inArray(f[b.id],d.id)!=-1){g++}}return g}}],getItemLink:function(b){return"/spell="+b.id},_validCompletionCategory:function(b){return WH.inArray(g_completion_categories[6],b)!=-1},createCbControls:function(d,c){if(!c){return}var b=WH.ce("input");b.type="button";b.value=(!this.characterSettings||!this.characterSettings.editable?LANG.li_addtolist:LANG.li_addtoanotherlist);b.onclick=(function(f){Listview.cbAddToList.call(this,f,"spell")}).bind(this);WH.ae(d,b)},createTooltipToggle:function(c,b){if(!b){return}this.addTooltipToggle(c,g_spells)},onBeforeCreate:function(){for(var b in this.columns){if((this.columns[b].id=="completed")&&(this.columns[b].hidden)){if(!(this.hasOwnProperty("completionMode")&&this.completionMode)&&WH.isSet("g_user")&&"lists" in g_user&&"spell" in g_completion&&WH.inArray(this.hiddenCols,this.columns[b].id)==-1){var c=0;for(var d in this.data){if(this.data[d].hasOwnProperty("cat")&&Listview.templates.spell._validCompletionCategory(this.data[d].cat)){c++}}if(c>(this.data.length*0.1)){this.visibility.push(parseInt(b))}}}}}};Listview.templates.pet={sort:[1],nItemsPerPage:-1,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",span:2,compute:function(b,l,h){var f=WH.ce("td");f.style.width="1px";f.style.paddingRight="0";f.style.borderRight="none";WH.ae(f,Icon.create(b.icon,0));WH.ae(h,f);l.style.borderLeft="none";var k=WH.ce("div");var c=WH.ce("a");c.className="listview-cleartext";c.href=this.getItemLink(b);WH.ae(c,WH.ct(b.name));if(b.expansion){var g=WH.ce("span");g.className=WH.getExpansionClassName(b.expansion);WH.ae(g,c);WH.ae(k,g)}else{WH.ae(k,c)}if(b.exotic){k.style.position="relative";var j=WH.ce("div");j.className="listview-name-info q1";var c=WH.ce("a");c.href="/spell=53270";WH.ae(c,WH.ct(LANG.lvpet_exotic));WH.ae(j,c);WH.ae(k,j)}WH.ae(l,k)},getVisibleText:function(b){var c=b.name+Listview.funcBox.getExpansionText(b);if(b.exotic){c+=" "+LANG.lvpet_exotic}return c}},{id:"level",name:LANG.level,type:"range",getMinValue:function(b){return b.minlevel},getMaxValue:function(b){return b.maxlevel},compute:function(b,c){if(b.minlevel>0&&b.maxlevel>0){if(b.minlevel!=b.maxlevel){return b.minlevel+LANG.hyphen+b.maxlevel}else{return b.minlevel}}else{return -1}},sortFunc:function(d,c,f){if(f>0){return WH.stringCompare(d.minlevel,c.minlevel)||WH.stringCompare(d.maxlevel,c.maxlevel)}else{return WH.stringCompare(d.maxlevel,c.maxlevel)||WH.stringCompare(d.minlevel,c.minlevel)}}},{id:"abilities",name:LANG.abilities,type:"text",getValue:function(c){if(!c.spells){return""}if(c.spells.length>0){var d="";for(var f=0,b=c.spells.length;f<b;++f){if(c.spells[f]){d+=g_spells[c.spells[f]]["name_"+Locale.getName()]}}return d}},compute:function(b,c){if(!b.spells){return""}if(b.spells.length>0){c.style.padding="0";Listview.funcBox.createCenteredIcons(b.spells,c,"",1)}},sortFunc:function(d,c){if(!d.spells||!c.spells){return 0}return WH.stringCompare(d.spellCount,c.spellCount)||WH.stringCompare(d.spells,c.spells)},hidden:true},{id:"diet",name:LANG.diet,type:"text",compute:function(b,g){if(g){g.className="small";g.style.minWidth="110px"}var c=0,d="";for(var f in g_pet_foods){if(b.diet&f){if(c++>0){d+=LANG.comma}d+=g_pet_foods[f]}}return d},sortFunc:function(d,c){return WH.stringCompare(c.foodCount,d.foodCount)||Listview.funcBox.assocArrCmp(d.diet,c.diet,g_pet_foods)}},{id:"type",name:LANG.type,type:"text",compute:function(b,d){if(b.type!=null){d.className="small q1";var c=WH.ce("a");c.href="/pets="+b.type;WH.ae(c,WH.ct(g_pet_types[b.type]));WH.ae(d,c)}},getVisibleText:function(b){if(b.type!=null){return g_pet_types[b.type]}},sortFunc:function(d,c,f){return WH.stringCompare(g_pet_types[d.type],g_pet_types[c.type])}}],getItemLink:function(b){return"/pet="+b.id},getStatPct:function(b){var c=WH.ce("span");if(!isNaN(b)&&b>0){c.className="q2";WH.ae(c,WH.ct("+"+b+"%"))}else{if(!isNaN(b)&&b<0){c.className="q10";WH.ae(c,WH.ct(b+"%"))}}return c}};Listview.templates["pet-ability"]={sort:[1],nItemsPerPage:100,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",span:2,compute:function(g,f,d){var c=WH.ce("td");c.style.width="1px";c.style.padding="3px 0 3px 12px";c.style.borderRight="none";if(g.icon){WH.ae(c,Icon.create(g.icon,(this.iconSize==null?1:this.iconSize),null,"/pet-ability="+g.id))}else{WH.ae(c,Icon.create("inv_misc_questionmark",(this.iconSize==null?1:this.iconSize),null,"/pet-ability="+g.id))}WH.ae(d,c);f.style.borderLeft="none";var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(g);WH.ae(b,WH.ct(g.name));WH.ae(f,b)},getVisibleText:function(c){var b=c.name;return b},sortFunc:function(d,c,f){return WH.stringCompare(d.name,c.name)}},{id:"level",name:LANG.level,value:"level",hidden:true},{id:"damage",name:LANG.damage,value:"damage"},{id:"healing",name:LANG.healing,value:"healing"},{id:"duration",name:LANG.duration,value:"duration",compute:function(c,b){if(c.duration){return WH.sprintf(LANG.durationturns_format,c.duration)}}},{id:"cooldown",name:LANG.cooldown,value:"cooldown",compute:function(c,b){if(c.cooldown){return WH.sprintf(LANG.cooldownturns_format,c.cooldown)}}},{id:"accuracy",name:LANG.accuracy,value:"accuracy",compute:function(c,b){if(c.accuracy){return WH.sprintf(LANG.accuracy_format,c.accuracy)}}},{id:"type",name:LANG.type,type:"text",width:"12%",compute:function(f,d){d.className="small q1";var b=WH.ce("a");b.href="/pet-abilities="+f.type;var c=f.type!=-1?g_battlepetability_types[f.type+1]:"Aura";WH.ae(b,WH.ct(c));WH.ae(d,b)},getVisibleText:function(b){return g_battlepetability_types[b.type+1]},sortFunc:function(d,c,f){return WH.stringCompare(g_battlepetability_types[d.type+1],g_battlepetability_types[c.type+1])}}],getItemLink:function(b){return"/pet-ability="+b.id}};Listview.templates.petability=Listview.templates["pet-ability"];Listview.templates["pet-species"]={sort:[1],mode:1,nItemsPerPage:100,searchable:1,filtrable:1,completionText:LANG.lvcompletion_battlepet,columns:[{id:"name",name:LANG.name,type:"text",align:"left",span:2,compute:function(o,f,l){var j=WH.validateBpet(o,o.bpet),h=WH.calcBattlePetStats(o,j.breed,j.quality,j.level,o.elite);var g=WH.ce("td");g.style.width="1px";g.style.padding="3px 0 3px 3px";g.style.borderRight="none";WH.ae(g,Icon.create(o.icon,1,null,this.getItemLink(o)));WH.ae(l,g);f.style.borderLeft="none";if(o.elite){f.className="icon-boss-padded"}var b=WH.ce("div");b.className="expanded-pet-view-wrapper";var n=WH.ce("span");var m=WH.ce("a");m.className="q"+j.quality+" listview-cleartext";m.href=this.getItemLink(o);if(o.name&&o.name!=o.npc.name){WH.ae(m,WH.ct(o.name+" <"+o.npc.name+">"))}else{WH.ae(m,WH.ct(o.npc.name))}WH.ae(n,m);if(o.expansion){var c=WH.ce("span");c.className=WH.getExpansionClassName(o.expansion);WH.ae(c,n);WH.ae(b,c)}else{WH.ae(b,n)}if(o.untameable){var k=WH.ce("div");k.className="listview-name-info q10";WH.ae(k,WH.ct(LANG.lvspecies_untameable));WH.aef(b,k)}else{if(o.companion){var k=WH.ce("div");k.className="listview-name-info q1";WH.ae(k,WH.ct(LANG.lvspecies_companion));WH.aef(b,k)}}if(j.hasOwnProperty("team")&&j.team){var k=WH.ce("div");k.className="listview-name-info fa fa-users";WH.Tooltip.simple(k,LANG.filters_pet_abilities.team);WH.aef(b,k)}if(j.hasOwnProperty("favorite")&&j.favorite){var k=WH.ce("div");k.className="listview-name-info fa fa-star";WH.Tooltip.simple(k,LANG.favorite);WH.aef(b,k)}WH.ae(f,b)},getVisibleText:function(b){var c="";if(b.name&&b.name!=b.npc.name){c+=b.name+" <"+b.npc.name+">"}else{c+=b.npc.name}c+=Listview.funcBox.getExpansionText(b);if(b.companion){c+=" "+LANG.lvspecies_companion}if(b.untameable){c+=" "+LANG.lvspecies_untameable}if(b.elite){c+=" "+LANG.lvspecies_elite}return c},sortFunc:function(d,c){return WH.stringCompare(d.name,c.name)||WH.stringCompare(d.npc.name,c.npc.name)}},{id:"level",name:LANG.level,getValue:function(c){var b=WH.validateBpet(c,c.bpet);return b.level},compute:function(c,f){var b=WH.validateBpet(c,c.bpet);if(c.elite){WH.ae(f,WH.ct(b.level));var d=WH.ce("div");d.className="small";d.innerHTML=LANG.lvspecies_elite;WH.ae(f,d);return}return b.level},sortFunc:function(d,c){var g=WH.validateBpet(d,d.bpet);var f=WH.validateBpet(c,c.bpet);return WH.stringCompare(g.level,f.level)}},{id:"health",name:LANG.health,getValue:function(d){var b=WH.validateBpet(d,d.bpet),c=WH.calcBattlePetStats(d,b.breed,b.quality,b.level,d.elite);return c.health},compute:function(d,f){if(d.companion){return}var b=WH.validateBpet(d,d.bpet),c=WH.calcBattlePetStats(d,b.breed,b.quality,b.level,d.elite);return c.health},sortFunc:function(d,c){var j=WH.validateBpet(d,d.bpet);var h=WH.validateBpet(c,c.bpet);var g=WH.calcBattlePetStats(d,j.breed,j.quality,j.level,d.elite);var f=WH.calcBattlePetStats(c,h.breed,h.quality,h.level,c.elite);return WH.stringCompare(g.health,f.health)}},{id:"power",name:LANG.power,getValue:function(d){var b=WH.validateBpet(d,d.bpet),c=WH.calcBattlePetStats(d,b.breed,b.quality,b.level,d.elite);return c.power},compute:function(d,f){if(d.companion){return}var b=WH.validateBpet(d,d.bpet),c=WH.calcBattlePetStats(d,b.breed,b.quality,b.level,d.elite);return c.power},sortFunc:function(d,c){var j=WH.validateBpet(d,d.bpet);var h=WH.validateBpet(c,c.bpet);var g=WH.calcBattlePetStats(d,j.breed,j.quality,j.level,d.elite);var f=WH.calcBattlePetStats(c,h.breed,h.quality,h.level,c.elite);return WH.stringCompare(g.power,f.power)}},{id:"speed",name:LANG.speed,getValue:function(d){var b=WH.validateBpet(d,d.bpet),c=WH.calcBattlePetStats(d,b.breed,b.quality,b.level,d.elite);return c.speed},compute:function(d,f){if(d.companion){return}var b=WH.validateBpet(d,d.bpet),c=WH.calcBattlePetStats(d,b.breed,b.quality,b.level,d.elite);return c.speed},sortFunc:function(d,c){var j=WH.validateBpet(d,d.bpet);var h=WH.validateBpet(c,c.bpet);var g=WH.calcBattlePetStats(d,j.breed,j.quality,j.level,d.elite);var f=WH.calcBattlePetStats(c,h.breed,h.quality,h.level,c.elite);return WH.stringCompare(g.speed,f.speed)}},{id:"breeds",name:LANG.breed,compute:function(k,b){if(k.companion){return}var h=WH.validateBpet(k,k.bpet);var l=[];for(var c=1;c<=10;c++){if(k.breeds&1<<c-1){l.push(c+2)}}if(l.length==0){return}if(l.length==1){return"#"+l[0]+(g_pet_breed_abbrev[l[0]]?(" "+g_pet_breed_abbrev[l[0]]):"")}var j;if(!(j=b.getElementsByTagName("span")[0])){j=WH.ce("span");j.style.borderBottom="1px dotted";WH.aE(j,"mouseover",function(m){Menu.showAtCursor(this.menu,m)});WH.aE(j,"mouseout",function(m){Menu.hide()});WH.ae(b,j)}var g=this,d=false;j.menu=[[,LANG.breed]];for(var c in l){var f="#"+l[c]+(g_pet_breed_abbrev[l[c]]?(" "+g_pet_breed_abbrev[l[c]]):"");j.menu.push([l[c],f,(function(m){return function(){if(!k.bpet){k.bpet={}}k.bpet.breed=m;delete k.__tr;g.refreshRows()}})(l[c])]);if(h.breed==l[c]){WH.ee(j);WH.ae(j,WH.ct(f));d=true}}if((!d)&&l[0]){WH.ee(j);WH.ae(j,WH.ct("#"+l[0]+(g_pet_breed_abbrev[l[0]]?(" "+g_pet_breed_abbrev[l[0]]):"")))}},getValue:function(c){var b=WH.validateBpet(c,c.bpet);return b.breed},sortFunc:function(d,c){var g=WH.validateBpet(d,d.bpet);var f=WH.validateBpet(c,c.bpet);return WH.stringCompare(g.breed,f.breed)}},{id:"abilities",name:LANG.abilities,type:"text",compute:function(d,f){f.style.padding="0";if(!d.abilities){return}var b=[];for(var c=0;c<d.abilities.length;c++){b.push(d.abilities[c])}Listview.funcBox.createCenteredIcons(b,f,"",3)},getVisibleText:function(d){var f="";if(!d.abilities){return f}for(var c=0,b=d.abilities.length;c<b;++c){if(g_petabilities[d.abilities[c]]){f+=" "+g_petabilities[d.abilities[c]]["name_"+Locale.getName()]}}return f},sortFunc:function(d,c){var f=d.abilities?d.abilities.length:0;var g=c.abilities?c.abilities.length:0;return WH.stringCompare(f,g)}},{id:"source",name:LANG.source,type:"text",compute:function(c,g){WH.noWrap(g);WH.ae(g,WH.ct(g_battlepet_sources[c.category]));var f=WH.ce("div");f.className="small2";if(c.category==4&&c.npc){Listview.funcBox.location(c.npc,f,2)}else{if(c.source!=null){var d=(c.sourcemore?c.sourcemore[0]:{});if(d.t){var b=WH.ce("a");if(d.q!=null){b.className="q"+d.q}else{b.className="q1"}b.href="/"+g_types[d.t]+"="+d.ti;b.style.whiteSpace="nowrap";if(d.icon){b.className+=" icontiny tinyspecial";b.style.backgroundImage='url("'+g_staticUrl+"/images/wow/icons/tiny/"+d.icon.toLowerCase()+'.gif")'}WH.ae(b,WH.ct(d.n));WH.ae(f,b)}}}if(!$(f).is(":empty")){WH.ae(g,f)}},getVisibleText:function(b){var d="";d+=g_battlepet_sources[b.category];if(b.category==4&&b.npc){d+=Listview.funcBox.arrayText(b.npc.location,g_zones)}else{if(b.source!=null){var c=(b.sourcemore?b.sourcemore[0]:{});if(c.t){d+=" "+c.n}}}return d},sortFunc:function(d,c){return WH.stringCompare(g_battlepet_sources[d.category],g_battlepet_sources[c.category])}},{id:"type",name:LANG.type,type:"text",compute:function(c,d){d.className="small q1";var b=WH.ce("a");b.href="/pet-species="+c.type;WH.ae(b,WH.ct(g_battlepetability_types[c.type]));WH.ae(d,b)},getVisibleText:function(b){return g_battlepetability_types[b.type]},sortFunc:function(d,c,f){return WH.stringCompare(g_battlepetability_types[d.type],g_battlepetability_types[c.type])}},{id:"completed",name:LANG.completion,hidden:true,compute:function(b,c){WH.addCompletionIcons(c,"npc",b.npc.id)},sortFunc:function(d,c,f){return WH.stringCompare(WH.getCompletionFlags("npc",d.npc.id),WH.getCompletionFlags("npc",c.npc.id))},getValue:function(d){var g=0;var f=g_completion.npc;for(var h in g_user.lists){var b=g_user.lists[h];if(!(b.id in f)){continue}if(WH.inArray(f[b.id],d.npc.id)!=-1){g++}}return g}}],getItemLink:function(b){return"/npc="+(b.npc?b.npc.id:b.id)},createCbControls:function(d,c){if(!c){return}var b=WH.ce("input");b.type="button";b.value=(!this.characterSettings||!this.characterSettings.editable?LANG.li_addtolist:LANG.li_addtoanotherlist);b.onclick=(function(f){Listview.cbAddToList.call(this,f,"npc")}).bind(this);WH.ae(d,b)},onBeforeCreate:function(){for(var b in this.columns){if((this.columns[b].id=="completed")&&(this.columns[b].hidden)){if((!(this.hasOwnProperty("completionMode")&&this.completionMode))&&WH.isSet("g_user")&&("lists" in g_user)&&("npc" in g_completion)&&(WH.inArray(this.hiddenCols,this.columns[b].id)==-1)){this.visibility.push(parseInt(b))}}}}};Listview.templates.petspecies=Listview.templates["pet-species"];Listview.templates["pet-species-gallery"]={sort:[1],mode:3,nItemsPerPage:40,nItemsPerRow:4,searchable:1,poundable:1,sortOptions:[{id:"name",name:LANG.name,type:"text",sortFunc:function(d,c){return WH.stringCompare(d.name,c.name)}},{id:"level",name:LANG.level,getValue:function(c){var b=WH.validateBpet(c,c.bpet);return b.level},sortFunc:function(d,c){var g=WH.validateBpet(d,d.bpet);var f=WH.validateBpet(c,c.bpet);return WH.stringCompare(g.level,f.level)}},{id:"health",name:LANG.health,getValue:function(d){var b=WH.validateBpet(d,d.bpet),c=WH.calcBattlePetStats(d,b.breed,b.quality,b.level,d.elite);return c.health},sortFunc:function(d,c){var j=WH.validateBpet(d,d.bpet);var h=WH.validateBpet(c,c.bpet);var g=WH.calcBattlePetStats(d,j.breed,j.quality,j.level,d.elite);var f=WH.calcBattlePetStats(c,h.breed,h.quality,h.level,c.elite);return WH.stringCompare(g.health,f.health)}},{id:"power",name:LANG.power,getValue:function(d){var b=WH.validateBpet(d,d.bpet),c=WH.calcBattlePetStats(d,b.breed,b.quality,b.level,d.elite);return c.power},sortFunc:function(d,c){var j=WH.validateBpet(d,d.bpet);var h=WH.validateBpet(c,c.bpet);var g=WH.calcBattlePetStats(d,j.breed,j.quality,j.level,d.elite);var f=WH.calcBattlePetStats(c,h.breed,h.quality,h.level,c.elite);return WH.stringCompare(g.power,f.power)}},{id:"speed",name:LANG.speed,getValue:function(d){var b=WH.validateBpet(d,d.bpet),c=WH.calcBattlePetStats(d,b.breed,b.quality,b.level,d.elite);return c.speed},sortFunc:function(d,c){var j=WH.validateBpet(d,d.bpet);var h=WH.validateBpet(c,c.bpet);var g=WH.calcBattlePetStats(d,j.breed,j.quality,j.level,d.elite);var f=WH.calcBattlePetStats(c,h.breed,h.quality,h.level,c.elite);return WH.stringCompare(g.speed,f.speed)}},{id:"breeds",name:LANG.breed,getValue:function(c){var b=WH.validateBpet(c,c.bpet);return b.breed},sortFunc:function(d,c){var g=WH.validateBpet(d,d.bpet);var f=WH.validateBpet(c,c.bpet);return WH.stringCompare(g.breed,f.breed)}},{id:"abilities",name:LANG.abilities,type:"text",sortFunc:function(d,c){var f=d.abilities?d.abilities.length:0;var g=c.abilities?c.abilities.length:0;return WH.stringCompare(f,g)}},{id:"source",name:LANG.source,type:"text",sortFunc:function(d,c){return WH.stringCompare(g_battlepet_sources[d.category],g_battlepet_sources[c.category])}},{id:"type",name:LANG.type,type:"text",sortFunc:function(d,c,f){return WH.stringCompare(g_battlepetability_types[d.type],g_battlepetability_types[c.type])}},{id:"completed",name:LANG.completion,type:"text",hidden:true,sortFunc:function(d,c,f){return WH.stringCompare(WH.getCompletionFlags("npc",d.npc.id),WH.getCompletionFlags("npc",c.npc.id))}}],columns:[{value:"name",sortFunc:function(d,c){return Listview.templates.petspeciesgallery.sortFunc(d,c)}}],compute:function(k,j,q){j.className="bpet-listview-cell";j.vAlign="bottom";var n=WH.validateBpet(k,k.bpet),s=WH.calcBattlePetStats(k,n.breed,n.quality,n.level,k.elite);var g=WH.ce("div");g.className="cell-wrapper";if(this.createModifyButton){var r=WH.ce("a");r.href="javascript:;";r.className="modify-cell icon-edit";r.innerHTML=LANG.li_menu_modify;WH.ae(g,this.createModifyButton(k,r))}var o=WH.ce("div");o.className="preview-wrapper";if(k.compare){WH.ae(o,Listview.funcBox.getComparisonText(k.compare,this.completionMode,this.dataSource,this.completionText))}var h=WH.ce("div");h.className="expand-wrapper expanded-pet-view-wrapper";var u=WH.ce("img");u.src=g_staticUrl+ModelViewer.getStaticBase()+"/thumbs/npc/"+k.model+".png";u.height=u.width=150;WH.ae(h,u);if(k.elite||k.untameable||k.companion){var m="untameable";if(k.companion){m="companion"}var p=WH.ce("span");p.className="banner";p.style.backgroundImage="url("+g_staticUrl+"/images/"+Locale.getName()+"/banner-"+m+".png)";WH.ae(h,p)}if(g_battlepetability_types[k.type]&&k.npc){Listview.funcBox.addBattlePetExpandedView.call(this,h,k,n,s)}WH.ae(o,h);if(this.showSideData&&k.npc){var l={family:k.type};if(!k.companion){l.breed="#"+n.breed;l.level=LANG.lvspecies_sidelevel+n.level;l.health=s.health;l.power=s.power;l.speed=s.speed}if(!$.isEmptyObject(l)){var b=WH.ce("div");var f=WH.ce("div");b.className="side-left";f.className="side-right";var d=0;for(var q in l){d++;p=WH.ce("span");p.className="side-"+q;if(q=="family"){var c=g_battlepetability_types[l[q]]+(k.companion?" "+LANG.lvspecies_companion:"");p.style.backgroundPosition=((l[q]-1)*-16)+"px 0"}else{if(q=="breed"){var c=WH.sprintf(LANG.lvspecies_breedtip,n.breed,WH.battlePetBreedStats[n.breed][0]*50+"%",WH.battlePetBreedStats[n.breed][1]*50+"%",WH.battlePetBreedStats[n.breed][2]*50+"%");p.className+=" tip";p.innerHTML=l[q]}else{var c=LANG[q];p.innerHTML=l[q]}}p.onmouseover=(function(w,v){WH.Tooltip.showAtCursor(v,w,0,0,"q")}).bind(null,c);p.onmousemove=WH.Tooltip.cursorUpdate;p.onmouseout=WH.Tooltip.hide;WH.ae(d>3?f:b,p)}WH.ae(o,b);WH.ae(o,f)}}WH.ae(g,o);var t=WH.ce("div");t.className="name";if(k.elite){u=WH.ce("img");u.src=g_staticUrl+"/images/icons/boss.gif";u.height=16;u.width=12;u.style.verticalAlign="middle";u.onmouseover=function(v){WH.Tooltip.showAtCursor(v,LANG.lvspecies_elite,0,0,"q")};u.onmousemove=WH.Tooltip.cursorUpdate;u.onmouseout=WH.Tooltip.hide;WH.ae(t,u);WH.ae(t,WH.ct(" "))}r=WH.ce("a");r.href=this.getItemLink(k);r.className="q"+n.quality;r.innerHTML=k.name;WH.ae(t,r);WH.ae(g,t);WH.ae(j,g)},getVisibleText:function(d){var f=d.name;if(g_battlepetability_types[d.type]&&d.npc){f+=" "+g_battlepetability_types[d.type]+" "+d.npc.name}if(d.companion){f+=" "+LANG.lvspecies_companion}if(d.untameable){f+=" "+LANG.lvspecies_untameable}if(d.elite){f+=" "+LANG.lvspecies_elite}if(!d.abilities){return f}for(var c=0,b=d.abilities.length;c<b;++c){if(g_petabilities[d.abilities[c]]){f+=" "+g_petabilities[d.abilities[c]]["name_"+Locale.getName()]}}return f},sortFunc:function(d,c){return WH.stringCompare(d.name,c.name)},getItemLink:function(b){return"/npc="+(b.npc?b.npc.id:b.id)}};Listview.templates.petspeciesgallery=Listview.templates["pet-species-gallery"];Listview.templates.achievement={sort:[1,2],mode:1,nItemsPerPage:100,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",span:2,compute:function(c,k,h){var b=null;if(c.who&&c.completed){b="who="+c.who+"&when="+c.completed.getTime()}var g=WH.ce("td");g.style.width="1px";g.style.paddingRight="0";g.style.borderRight="none";WH.ae(g,g_achievements.createIcon(c.id,1));Icon.getLink(g.firstChild).href=this.getItemLink(c);Icon.getLink(g.firstChild).rel=b;WH.ae(h,g);k.style.borderLeft="none";var f=WH.ce("a");f.className="listview-cleartext";f.href=this.getItemLink(c);f.rel=b;WH.ae(f,WH.ct(c.name));WH.ae(k,f);if(c.description!=null){var j=WH.ce("div");j.className="listview-blurb small";WH.ae(j,WH.ct(c.description));WH.ae(k,j)}},getVisibleText:function(b){var c=b.name;if(b.description){c+=" "+b.description}return c}},{id:"side",name:LANG.side,type:"text",compute:function(b,d){if(b.side&&b.side!=3){var c=WH.ce("span");c.className=(b.side==1?"icon-alliance":"icon-horde");c.onmouseover=function(f){WH.Tooltip.showAtCursor(f,g_sides[b.side],0,0,"q")};c.onmousemove=WH.Tooltip.cursorUpdate;c.onmouseout=WH.Tooltip.hide;WH.ae(d,c)}},getVisibleText:function(b){if(b.side){return g_sides[b.side]}},sortFunc:function(d,c,f){return WH.stringCompare(g_sides[d.side],g_sides[c.side])}},{id:"points",name:LANG.points,type:"number",width:"10%",value:"points",compute:function(b,c){if(b.points){Listview.funcBox.appendMoney(c,0,null,0,0,b.points)}}},{id:"rewards",name:LANG.rewards,type:"text",width:"20%",compute:function(m,c){if(m.rewards){var f=[];var h=[];var j=[];var b=[];for(var d=0;d<m.rewards.length;d++){if(m.rewards[d][0]==11){j.push(m.rewards[d][1])}else{if(m.rewards[d][0]==3){f.push(m.rewards[d][1])}else{if(m.rewards[d][0]==6){h.push(m.rewards[d][1])}else{if(m.rewards[d][0]==21){b.push(m.rewards[d][1])}}}}}if(f.length>0){for(var d=0;d<f.length;d++){if(!g_items[f[d]]){return}var o=g_items[f[d]];var l=WH.ce("a");l.href="/item="+f[d];l.className="q"+o.quality+" icontiny tinyspecial";l.style.backgroundImage="url("+g_staticUrl+"/images/wow/icons/tiny/"+o.icon.toLowerCase()+".gif)";WH.ae(l,WH.ct(o["name_"+Locale.getName()]));var n=WH.ce("span");WH.ae(n,l);WH.ae(c,n);WH.ae(c,WH.ce("br"))}}if(h.length>0){for(var d=0;d<h.length;d++){if(!g_spells[h[d]]){return}var o=g_spells[h[d]];var l=WH.ce("a");l.href="/spell="+h[d];l.className="q13 icontiny tinyspecial";l.style.backgroundImage="url("+g_staticUrl+"/images/wow/icons/tiny/"+o.icon.toLowerCase()+".gif)";WH.ae(l,WH.ct(o["name_"+Locale.getName()]));var n=WH.ce("span");WH.ae(n,l);WH.ae(c,n);WH.ae(c,WH.ce("br"))}}if(j.length>0){for(var d=0;d<j.length;d++){if(!g_titles[j[d]]){return}var k=g_titles[j[d]]["name_"+Locale.getName()];k=k.replace("%s",'<span class="q0">&lt;'+LANG.name+"&gt;</span>");var n=WH.ce("a");n.className="q1";n.href="/title="+j[d];n.innerHTML=k;WH.ae(c,n);WH.ae(c,WH.ce("br"))}}if(b.length>0){for(var d=0;d<b.length;d++){if(!g_followers[b[d]]){return}var g=g_followers[b[d]]["name_"+Locale.getName()];var n=WH.ce("a");n.className="q1";n.href="/follower="+b[d];n.innerHTML=g;WH.ae(c,n);WH.ae(c,WH.ce("br"))}}}else{if(m.reward){var n=WH.ce("span");n.className="q1";WH.ae(n,WH.ct(m.reward));WH.ae(c,n)}}},getVisibleText:function(b){var d="";if(b.rewards){for(var c=0;c<b.rewards.length;c++){if(b.rewards[c][0]==11&&g_titles[b.rewards[c][1]]){d+=" "+g_titles[b.rewards[c][1]]["name_"+Locale.getName()].replace("%s","<"+LANG.name+">")}else{if(b.rewards[c][0]==3&&g_items[b.rewards[c][1]]){d+=" "+g_items[b.rewards[c][1]]["name_"+Locale.getName()]}else{if(b.rewards[c][0]==6&&g_spells[b.rewards[c][1]]){d+=" "+g_spells[b.rewards[c][1]]["name_"+Locale.getName()]}}}}}else{if(b.reward){d+=" "+b.reward}}return d},sortFunc:function(d,c){var g=this.getVisibleText(d);var f=this.getVisibleText(c);if(g!=""&&f==""){return -1}if(f!=""&&g==""){return 1}return WH.stringCompare(g,f)}},{id:"category",name:LANG.category,type:"text",width:"15%",compute:function(c,h){h.className="small";var f={"1":-1,"2":1,"3":15076},g="/achievements=";if(c.category!=f[c.type]&&c.parentcat!=f[c.type]){var b=WH.ce("a");b.className="q0";b.href="/achievements="+c.type+"."+c.parentcat;WH.ae(b,WH.ct(g_achievement_categories[c.parentcat]));WH.ae(h,b);WH.ae(h,WH.ce("br"));g=b.href+"."}var d=WH.ce("a");d.className="q1";d.href=g+c.category;WH.ae(d,WH.ct(g_achievement_categories[c.category]));WH.ae(h,d)},getVisibleText:function(b){return g_achievement_categories[b.category]},sortFunc:function(d,c,f){return WH.stringCompare(g_achievement_categories[d.category],g_achievement_categories[c.category])},hidden:true},{id:"completed",name:LANG.completion,hidden:true,compute:function(b,c){WH.addCompletionIcons(c,"achievement",b.id)},sortFunc:function(d,c,f){return WH.stringCompare(this._achievementDoneFlags(d.id),this._achievementDoneFlags(c.id))},getValue:function(d){var g=0;var f=g_completion.achievement;for(var h in g_user.lists){var b=g_user.lists[h];if(!(b.id in f)){continue}if(WH.inArray(f[b.id],d.id)!=-1){g++}}return g},_achievementDoneFlags:function(b){return WH.getCompletionFlags("achievement",b)}}],getItemLink:function(b){return"/achievement="+b.id},createCbControls:function(d,c){if(!c){return}var b=WH.ce("input");b.type="button";b.value=(!this.characterSettings||!this.characterSettings.editable?LANG.li_addtolist:LANG.li_addtoanotherlist);b.onclick=(function(f){Listview.cbAddToList.call(this,f,"achievement")}).bind(this);WH.ae(d,b)},onBeforeCreate:function(){for(var b in this.columns){if((this.columns[b].id=="completed")&&(this.columns[b].hidden)){if((!(this.hasOwnProperty("completionMode")&&this.completionMode))&&WH.isSet("g_user")&&("lists" in g_user)&&("achievement" in g_completion)&&(WH.inArray(this.hiddenCols,this.columns[b].id)==-1)){this.visibility.push(parseInt(b))}}}}};Listview.templates.title={sort:[1],mode:1,nItemsPerPage:-1,searchable:1,filtrable:1,completionText:LANG.lvcompletion_collection,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",compute:function(g,j,f){var d=WH.ce("a"),h=WH.ce("span"),c=WH.ct(WH.stringReplace(g.name,"%s",""));d.className="listview-cleartext";d.href=this.getItemLink(g);if(g.who){WH.ae(h,WH.ct(g.who))}else{WH.ae(h,WH.ct("<"+LANG.name+">"));h.className="q0"}if(g.name.indexOf("%s")>0){WH.ae(d,c);WH.ae(d,h)}else{if(g.name.indexOf("%s")==0){WH.ae(d,h);WH.ae(d,c)}}if(g.expansion){var b=WH.ce("span");b.className=WH.getExpansionClassName(g.expansion);WH.ae(b,d);WH.ae(j,b)}else{WH.ae(j,d)}},sortFunc:function(d,c,f){var g=WH.trim(d.name.replace("%s","").replace(/^[\s,]*(,|the |of the |of )/i,""));bName=WH.trim(c.name.replace("%s","").replace(/^[\s,]*(,|the |of the |of )/i,""));return WH.stringCompare(g,bName)},getVisibleText:function(b){var c=b.name+Listview.funcBox.getExpansionText(b);return c}},{id:"gender",name:LANG.gender,type:"text",value:"gender",compute:function(d,f){if(d.gender&&d.gender!=3){var b=g_file_genders[d.gender-1];var c=WH.ce("span");c.className="icon-"+b;c.onmouseover=function(g){WH.Tooltip.showAtCursor(g,LANG[b],0,0,"q")};c.onmousemove=WH.Tooltip.cursorUpdate;c.onmouseout=WH.Tooltip.hide;WH.ae(f,c)}},getVisibleText:function(b){if(b.gender&&b.gender!=3){return LANG[g_file_genders[b.gender-1]]}},sortFunc:function(d,c,f){return WH.stringCompare(d.gender,c.gender)}},{id:"side",name:LANG.side,type:"text",compute:function(c,d){if(c.side&&c.side!=3){var b=WH.ce("span");b.className=(c.side==1?"icon-alliance":"icon-horde");b.onmouseover=function(f){WH.Tooltip.showAtCursor(f,g_sides[c.side],0,0,"q")};b.onmousemove=WH.Tooltip.cursorUpdate;b.onmouseout=WH.Tooltip.hide;WH.ae(d,b)}},getVisibleText:function(b){if(b.side){return g_sides[b.side]}},sortFunc:function(d,c,f){return WH.stringCompare(g_sides[d.side],g_sides[c.side])}},{id:"source",name:LANG.source,type:"text",compute:function(k,d){if(k.source){WH.noWrap(d);d.className="small";d.style.lineHeight="18px";var b=0;for(var l in k.source){k.source[l].sort(function(n,m){return m.s-n.s});for(var f=0,g=k.source[l].length;f<g;++f){var c=k.source[l][f];var h=0;if(k.faction&&typeof c!="string"&&c.s!==undefined&&c.s!=-1&&c.s!=2-k.faction){continue}if(b>0){WH.ae(d,WH.ce("br"))}if(typeof c=="string"){WH.ae(d,WH.ct(c))}else{if(c.t&&c.n){h=c.t;var j=WH.ce("a");j.href="/"+g_types[c.t]+"="+c.ti;j.className="q1";if(c.s==1){j.className+=" icon-alliance"}if(c.s==0){j.className+=" icon-horde"}if(c.t==5){j.className+=" icontiny tinyspecial";j.style.backgroundImage="url("+g_staticUrl+"/images/wow/icons/tiny/quest_start.gif)"}WH.ae(j,WH.ct(c.n));WH.ae(d,j)}else{continue}}b++}}}},getVisibleText:function(f){var h="";if(f.source){for(var d in f.source){for(var c=0,b=f.source[d].length;c<b;++c){var g=f.source[d][c];if(typeof g=="string"){h+=" "+g}else{if(g.t){h+=" "+g.n}}}}}return h},sortFunc:function(d,c,f){return WH.stringCompare(this.getVisibleText(d),this.getVisibleText(c))}},{id:"category",name:LANG.category,type:"text",width:"15%",compute:function(c,d){WH.noWrap(d);d.className="small q1";var b=WH.ce("a");b.href="/titles="+c.category;WH.ae(b,WH.ct(g_title_categories[c.category]));WH.ae(d,b)},getVisibleText:function(b){return g_title_categories[b.category]},sortFunc:function(d,c,f){return WH.stringCompare(g_title_categories[d.category],g_title_categories[c.category])},hidden:true},{id:"completed",name:LANG.completion,hidden:true,compute:function(b,c){WH.addCompletionIcons(c,"title",b.id)},sortFunc:function(d,c,f){return WH.stringCompare(this._titleDoneFlags(d.id),this._titleDoneFlags(c.id))},getValue:function(d){var g=0;var f=g_completion.title;for(var h in g_user.lists){var b=g_user.lists[h];if(!(b.id in f)){continue}if(WH.inArray(f[b.id],d.id)!=-1){g++}}return g},_titleDoneFlags:function(b){return WH.getCompletionFlags("title",b)}}],getItemLink:function(b){return"/title="+b.id},createCbControls:function(d,c){if(!c){return}var b=WH.ce("input");b.type="button";b.value=(!this.characterSettings||!this.characterSettings.editable?LANG.li_addtolist:LANG.li_addtoanotherlist);b.onclick=(function(f){Listview.cbAddToList.call(this,f,"title")}).bind(this);WH.ae(d,b)},onBeforeCreate:function(){for(var b in this.columns){if((this.columns[b].id=="completed")&&(this.columns[b].hidden)){if((!(this.hasOwnProperty("completionMode")&&this.completionMode))&&WH.isSet("g_user")&&("lists" in g_user)&&("title" in g_completion)&&(WH.inArray(this.hiddenCols,this.columns[b].id)==-1)){this.visibility.push(parseInt(b))}}}}};Listview.templates["class"]={sort:[1],searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",span:2,value:"name",compute:function(c,l,h){var f=WH.ce("td");f.style.width="1px";f.style.paddingRight="0";f.style.borderRight="none";WH.ae(f,Icon.create("class_"+g_file_classes[c.id],0,null,this.getItemLink(c)));WH.ae(h,f);l.style.borderLeft="none";var k=WH.ce("div");var b=WH.ce("a");b.className="c"+c.id+" listview-cleartext";b.href=this.getItemLink(c);WH.ae(b,WH.ct(c.name));if(c.expansion){var g=WH.ce("span");g.className=WH.getExpansionClassName(c.expansion);WH.ae(g,b);WH.ae(k,g)}else{WH.ae(k,b)}if(c.hero){k.style.position="relative";var j=WH.ce("div");j.className="listview-name-info";WH.ae(j,WH.ct(LANG.lvclass_hero));WH.aef(k,j)}WH.ae(l,k)}},{id:"races",name:LANG.races,type:"text",compute:function(d,h){if(d.races){var g=Listview.funcBox.assocBinFlags(d.races,g_chr_races);h.className="q1";for(var f=0,b=g.length;f<b;++f){if(f>0){WH.ae(h,WH.ct(LANG.comma))}var c=WH.ce("a");c.href="/race="+g[f];WH.ae(c,WH.ct(g_chr_races[g[f]]));WH.ae(h,c)}}},getVisibleText:function(b){if(b.races){return Listview.funcBox.arrayText(Listview.funcBox.assocBinFlags(b.races,g_chr_races),g_chr_races)}},sortFunc:function(d,c,f){return Listview.funcBox.assocArrCmp(Listview.funcBox.assocBinFlags(d.races,g_chr_races),Listview.funcBox.assocBinFlags(c.races,g_chr_races),g_chr_races)}}],getItemLink:function(b){return"/class="+b.id}};Listview.templates.classs=Listview.templates["class"];Listview.templates.race={sort:["side","name"],searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",span:2,value:"name",compute:function(h,f,k){var j=WH.ce("div");j.style.margin="0 auto";j.style.textAlign="left";j.style.width="52px";if(g_npc_races.indexOf(parseInt(h.id))===-1){var l=Icon.create("race_"+g_file_races[h.id]+"_"+g_file_genders[0],0,null,this.getItemLink(h));l.style.cssFloat=l.style.styleFloat="left";WH.ae(j,l);l=Icon.create("race_"+g_file_races[h.id]+"_"+g_file_genders[1],0,null,this.getItemLink(h));l.style.cssFloat=l.style.styleFloat="left";WH.ae(j,l)}var g=WH.ce("td");g.style.width="1px";g.style.paddingRight="0";g.style.borderRight="none";WH.ae(g,j);WH.ae(k,g);f.style.borderLeft="none";var b=WH.ce("div");var m=WH.ce("a");m.className="listview-cleartext";m.href=this.getItemLink(h);WH.ae(m,WH.ct(h.name));if(h.expansion){var c=WH.ce("span");c.className=WH.getExpansionClassName(h.expansion);WH.ae(c,m);WH.ae(b,c)}else{WH.ae(b,m)}WH.ae(f,b)}},{id:"side",name:LANG.side,type:"text",compute:function(c,f){var b=parseInt(c.side||g_file_racefactions[c.id]);switch(b){case 1:case 2:var d=WH.ce("span");d.className=(b===1?"icon-alliance":"icon-horde");d.onmouseover=function(g){WH.Tooltip.showAtCursor(g,g_sides[b],0,0,"q")};d.onmousemove=WH.Tooltip.cursorUpdate;d.onmouseout=WH.Tooltip.hide;WH.ae(f,d);break;case 3:WH.st(f,WH.TERMS.both);break;default:WH.st(f,LANG.types[1][0])}},getVisibleText:function(c){var b=parseInt(c.side||g_file_racefactions[c.id])||0;if(b){return g_sides[b]}else{return LANG.types[1][0]}},sortFunc:function(d,c,f){return WH.stringCompare(WH.getRaceSideSortString(d),WH.getRaceSideSortString(c))}},{id:"classes",name:LANG.classes,type:"text",compute:function(c,k){if(c.classes instanceof Array&&c.classes.length){var j=WH.ce("div");j.style.width=(26*c.classes.length)+"px";j.style.margin="0 auto";for(var b=0,g;g=c.classes[b];b++){var f=Icon.create("class_"+g_file_classes[g],0,null,"/class="+g);var h=g_chr_classes[g];$(f).mouseover((function(l,d){WH.Tooltip.showAtCursor(d,l,0,0,"q")}).bind(f,h)).mousemove(function(d){WH.Tooltip.cursorUpdate(d)}).mouseout(function(){WH.Tooltip.hide()}).css("float","left").appendTo(j)}WH.ae(k,j)}else{if(g_npc_races.indexOf(parseInt(c.id))===-1){WH.st(k,WH.TERMS.unknown)}}},getVisibleText:function(b){if(b.classes){return Listview.funcBox.arrayText(Listview.funcBox.assocBinFlags(b.classes,g_chr_classes),g_chr_classes)}},sortFunc:function(d,c,f){return Listview.funcBox.assocArrCmp(Listview.funcBox.assocBinFlags(d.classes,g_chr_classes),Listview.funcBox.assocBinFlags(c.classes,g_chr_classes),g_chr_classes)}}],getItemLink:function(b){return"/race="+b.id}};Listview.templates.betatalents={nItemsPerPage:100,mode:Listview.MODE_CHECKBOX,sortable:false,columns:[{id:"row",name:"Row",value:"row",compute:function(b,c){$(c).html(parseInt(b.row)+1)}},{id:"col",name:"Column",value:"col",compute:function(b,c){$(c).html(parseInt(b.col)+1)}},{id:"name",name:LANG.name,type:"text",align:"left",value:"name_enus",span:2,compute:function(d,f,c){var b=d.tooltip_enus;$(f).mouseover((function(g,h){WH.Tooltip.showAtCursor(h,g,0,0)}).bind(f,b));$(f).mousemove(function(g){WH.Tooltip.cursorUpdate(g)}).mouseout(function(){WH.Tooltip.hide()});$(f).html(d.name_enus)}}],createCbControls:function(c){var b=WH.ce("input");b.type="button";b.value="Edit";b.onclick=(function(){var d=this.getCheckedRows();if(!d.length){alert("No talent selected.")}else{if(d.length>1){alert("You can only edit one talent at a time.")}else{if(confirm("Are you sure that you want to edit this talent?")){enableEditMode(d[0])}}}}).bind(this);WH.ae(c,b);var b=WH.ce("input");b.type="button";b.value="Delete";b.onclick=(function(){var f=this.getCheckedRows();if(!f.length){alert("No talents selected.")}else{if(confirm("Are you sure that you want to delete "+(f.length==1?"this talent":"these "+f.length+" talents")+"?")){var d="";WH.arrayWalk(f,function(g){d+=g.id+","});d=WH.rtrim(d,",");if(d!=""){$.post("/admin=beta-talents&delete="+d+"&classid="+f[0].classid)}this.deleteRows(f);this.resetCheckedRows()}}}).bind(this);WH.ae(c,b)}};Listview.templates.item={sort:[-2],mode:1,searchable:1,filtrable:1,completionText:LANG.lvcompletion_collection,sortNameUseQuality:true,beforeSort:function(){var d,c;for(var b=0;!d&&b<this.columns.length;b++){if(this.columns[b].id=="name"){d=this.columns[b];c=b+1}}var f=c-1;if(Listview.sort.length&&(Listview.sort[0]==c)){this.template.sortNameUseQuality=!this.template.sortNameUseQuality;d.name=this.template.sortNameUseQuality?(LANG.name+" + "+LANG.quality):LANG.name;if(!this.thead){return}if(this.mode==Listview.MODE_CHECKBOX&&f<this.thead.firstChild.childNodes.length-1){f+=1}var g=this.thead.firstChild.childNodes[f].firstChild.firstChild.firstChild.firstChild;WH.st(g,d.name)}},columns:[{id:"name",name:LANG.name,type:"text",align:"left",span:2,value:"name",compute:function(u,l,b){if(u.upgraded){b.className="upgraded"}u=WH.applyStatModifications(u,null,null,null,Listview.funcBox.getCurrentItemBonuses.call(this,u));var q=WH.ce("td");q.style.width="1px";q.style.padding="4px 0 4px 10px";q.style.borderRight="none";var k=null,m=null;if(u.stack!=null){k=Listview.funcBox.createTextRange(u.stack[0],u.stack[1])}if(u.avail!=null){m=u.avail}if(u.id){WH.ae(q,g_items.createIcon(u.id,(this.iconSize==null?1:this.iconSize),k,m,u.bonuses))}WH.ae(b,q);l.style.borderLeft="none";var z,o;if(typeof u.name==="string"&&!isNaN(parseInt(u.name.charAt(0)))){z=u.name.substring(1);o=8-parseInt(u.name.charAt(0))}else{if(typeof u.name==="string"){z=u.name}else{if(u.id){z=LANG.parens_open+LANG.types[3][0]+" #"+u.id+LANG.parens_close}else{z=LANG.parens_open+WH.TERMS.unknownEntity_format.replace("%s",LANG.types[3][0])+LANG.parens_close}}o=1;if(u.hasOwnProperty("quality")){o=u.quality}}var y=WH.ce("a");y.className="q"+o+" listview-cleartext";y.href=this.getItemLink(u);if(u.frommerge==1){y.className+=" icon-merge-right"}if(u.rel){Icon.getLink(q.firstChild).rel=u.rel;y.rel=u.rel}var f="";if(u.nameSuffix){f=" "+u.nameSuffix}WH.ae(y,WH.ct(z+f));var h=WH.ce("div");WH.ae(h,y);if(u.reqclass){var v=WH.ce("div");v.className="small2";var w=Listview.funcBox.assocBinFlags(u.reqclass,g_chr_classes);for(var q=0,r=w.length;q<r;++q){if(q>0){WH.ae(v,WH.ct(", "))}var y=WH.ce("a");y.href="/class="+w[q];y.className="c"+w[q];WH.st(y,g_chr_classes[w[q]]);WH.ae(v,y)}WH.ae(h,v)}var c=typeof Filter!="undefined"?Filter.listview_getExtraItemColumnCount():null;if(typeof c=="number"&&c>=5){if(u.source!=null&&u.source.length==1){if(u.reqclass){WH.ae(v,WH.ct(LANG.dash))}else{var v=WH.ce("div");v.className="small2"}var t=(u.sourcemore?u.sourcemore[0]:{});var g=0;if(t.t){g=t.t;var y=WH.ce("a");if(t.q!=null){y.className="q"+t.q}else{y.className="q1"}y.href="/"+g_types[t.t]+"="+t.ti;if(t.n.length<=30){WH.ae(y,WH.ct(t.n))}else{y.title=t.n;WH.ae(y,WH.ct(WH.trim(t.n.substr(0,27))+"..."))}WH.ae(v,y)}else{WH.ae(v,WH.ct(Listview.funcBox.getUpperSource(u.source[0],t)))}var j=Listview.funcBox.getLowerSource(u.source[0],t,g);if(j!=null){WH.ae(v,WH.ct(LANG.hyphen));if(j.pretext){WH.ae(v,WH.ct(j.pretext))}if(j.url){var y=WH.ce("a");y.className="q1";y.href=j.url;WH.ae(y,WH.ct(j.text));WH.ae(v,y)}else{WH.ae(v,WH.ct(j.text))}if(j.posttext){WH.ae(v,WH.ct(j.posttext))}}WH.ae(h,v)}}if(u.namedesc||u.heroic||u.reqrace||u.raidfinder||u.thunderforged||u.warforged||u.flexible){h.style.position="relative";var v=WH.ce("div");v.className="listview-name-info";var p=WH.ce("span");p.className="q2";if(u.namedesc){WH.ae(p,WH.ct(u.namedesc))}else{if(u.raidfinder){WH.ae(p,WH.ct(LANG.lvitem_raidfinderitem))}else{if(u.flexible){WH.ae(p,WH.ct(LANG.lvitem_flexibleitem))}else{if(u.thunderforged){if(u.heroic){WH.ae(p,WH.ct(LANG.lvitem_heroicitem+" "+LANG.lvitem_thunderforgeditem))}else{WH.ae(p,WH.ct(LANG.lvitem_thunderforgeditem))}}else{if(u.warforged){if(u.heroic){WH.ae(p,WH.ct(LANG.lvitem_heroicitem+" "+LANG.lvitem_warforgeditem))}else{WH.ae(p,WH.ct(LANG.lvitem_warforgeditem))}}else{if(u.heroic){WH.ae(p,WH.ct(LANG.lvitem_heroicitem))}}}}}}if(!$(p).is(":empty")){WH.ae(v,p)}if(u.reqrace){if((u.reqrace&1791)!=1101&&(u.reqrace&1791)!=690){if(u.namedesc||u.heroic||u.raidfinder||u.thunderforged||u.warforged||u.flexible){WH.ae(v,WH.ce("br"));v.style.bottom="-6px"}var n=Listview.funcBox.assocBinFlags(u.reqrace,g_chr_races);for(var q=0,r=n.length;q<r;++q){if(q>0){WH.ae(v,WH.ct(", "))}var y=WH.ce("a");y.href="/race="+n[q];WH.st(y,g_chr_races[n[q]]);WH.ae(v,y)}v.className+=" q1"}}WH.aef(h,v)}WH.ae(l,h)},getVisibleText:function(g){var c,k;if(!isNaN(parseInt(g.name.charAt(0)))){c=g.name.substring(1);k=8-parseInt(g.name.charAt(0))}else{c=g.name;k=1;if(g.hasOwnProperty("quality")){k=g.quality}}var j=c;g=WH.applyStatModifications(g,null,null,null,Listview.funcBox.getCurrentItemBonuses.call(this,g));if(g.nameSuffix){j+=" "+g.nameSuffix}if(g.namedesc){j+=" "+g.namedesc}else{if(g.heroic){j+=" "+LANG.lvitem_heroicitem}if(g.warforged){j+=" "+LANG.lvitem_warforgeditem}if(g.thunderforged){j+=" "+LANG.lvitem_thunderforgeditem}if(g.raidfinder){j+=" "+LANG.lvitem_raidfinderitem}if(g.flexible){j+=" "+LANG.lvitem_flexibleitem}}if(g.reqrace){j+=" "+Listview.funcBox.arrayText(Listview.funcBox.assocBinFlags(g.reqrace,g_chr_races),g_chr_races)}if(g.reqclass){j+=" "+Listview.funcBox.arrayText(Listview.funcBox.assocBinFlags(g.reqclass,g_chr_classes),g_chr_classes)}var d=typeof Filter!="undefined"?Filter.listview_getExtraItemColumnCount():null;if(typeof d=="number"&&d>=5){if(g.source!=null&&g.source.length==1){var h=(g.sourcemore?g.sourcemore[0]:{});var f=0;if(h.t){f=h.t;j+=" "+h.n}else{j+=" "+Listview.funcBox.getUpperSource(g.source[0],h)}var b=Listview.funcBox.getLowerSource(g.source[0],h,f);if(b!=null){if(b.pretext){j+=" "+b.pretext}j+=" "+b.text;if(b.posttext){j+=" "+b.posttext}}}}return j},sortFunc:function(f,d){var c=this.template.sortNameUseQuality?0:1;return WH.stringCompare(f.name.substr(c),d.name.substr(c))}},{id:"level",name:LANG.itemlevelshort,type:"range",getMinValue:function(b){if(this.ilvlOverride){return typeof this.ilvlOverride.value=="function"?this.ilvlOverride.value.call(this,b):this.ilvlOverride.value}return b.minlevel?b.minlevel:Listview.funcBox.getItemLevelWithBonuses.call(this,b)},getMaxValue:function(b){if(this.ilvlOverride){return typeof this.ilvlOverride.value=="function"?this.ilvlOverride.value.call(this,b):this.ilvlOverride.value}return b.maxlevel?b.maxlevel:Listview.funcBox.getItemLevelWithBonuses.call(this,b)},compute:function(b,c){if(this.ilvlOverride){return typeof this.ilvlOverride.value=="function"?this.ilvlOverride.value.call(this,b):this.ilvlOverride.value}if(b.minlevel&&b.maxlevel){if(b.minlevel!=b.maxlevel){return b.minlevel+LANG.hyphen+b.maxlevel}else{return b.minlevel}}else{return Listview.funcBox.getItemLevelWithBonuses.call(this,b)}},sortFunc:function(d,c,f){if(f>0){return WH.stringCompare(d.minlevel,c.minlevel)||WH.stringCompare(d.maxlevel,c.maxlevel)||WH.stringCompare(Listview.funcBox.getItemLevelWithBonuses.call(this,d),Listview.funcBox.getItemLevelWithBonuses.call(this,c))}else{return WH.stringCompare(d.maxlevel,c.maxlevel)||WH.stringCompare(d.minlevel,c.minlevel)||WH.stringCompare(Listview.funcBox.getItemLevelWithBonuses.call(this,d),Listview.funcBox.getItemLevelWithBonuses.call(this,c))}}},{id:"reqlevel",name:LANG.req,tooltip:LANG.tooltip_reqlevel,value:"reqlevel",compute:function(b,c){b=WH.applyStatModifications(b,null,null,null,Listview.funcBox.getCurrentItemBonuses.call(this,b));if(b.reqlevel>1){return b.reqlevel}}},{id:"bonuses",name:LANG.versions,compute:function(t,g){var d=[];var r=(t.bonustrees!=null&&t.bonustrees.length>0);var q=false;var j=0;if(r&&WH.isSet("g_item_bonuscontexts")){var c=[];for(var l in t.bonustrees){var u=t.bonustrees[l];for(var m in g_item_bonuscontexts){var p=g_item_bonuscontexts[m];for(var h in p){var o=p[h];if(o[0]==u&&o[1]!=0){c.push([o[1]]);switch(m){case"1":case"3":q=true;break;case"2":j=2;break;case"5":case"6":case"4":j=3;break;default:break}}}}}if(!q&&j){c.push(0)}c.sort();var f={},s=0;for(var l=0;l<c.length;++l){if(f.hasOwnProperty(c[l][0])){continue}f[c[l][0]]=true;var b=$.extend({},t);b.bonuses=c[l];var n=this.getItemLink(b);d.push({0:g_items.getIcon(t.id,c[l]),1:1,2:n});if(++s>=4){break}}}else{if(t.heirloombonuses){for(var l=0;l<t.heirloombonuses.length;++l){var b=$.extend({},t);b.bonuses=[t.heirloombonuses[l]];var n=this.getItemLink(b);d.push({0:g_items.getIcon(t.id,[t.heirloombonuses[l]]),1:1,2:n})}}else{if(WH.isSet("g_artifact_bonuses")&&g_artifact_bonuses.hasOwnProperty(t.id)){for(var l=0;l<g_artifact_bonuses[t.id].length;++l){var b=$.extend({},t);b.bonuses=[g_artifact_bonuses[t.id][l]];var n=this.getItemLink(b);d.push({0:g_items.getIcon(t.id,[g_artifact_bonuses[t.id][l]]),1:1,2:n})}}}}Listview.funcBox.createCenteredIcons(d,g,null,null,null,8)},sortFunc:function(d,c,f){var h=d.bonustrees?d.bonustrees.length:0;var g=c.bonustrees?c.bonustrees.length:0;return WH.stringCompare(h,g)}},{id:"side",name:LANG.side,type:"text",compute:function(b,d){if(b.side&&b.side!=3){var c=WH.ce("span");c.className=(b.side==1?"icon-alliance":"icon-horde");c.onmouseover=function(f){WH.Tooltip.showAtCursor(f,g_sides[b.side],0,0,"q")};c.onmousemove=WH.Tooltip.cursorUpdate;c.onmouseout=WH.Tooltip.hide;WH.ae(d,c)}},getVisibleText:function(b){if(b.side){return g_sides[b.side]}},sortFunc:function(d,c,f){return WH.stringCompare(g_sides[d.side],g_sides[c.side])}},{id:"dps",name:LANG.dps,value:"dps",compute:function(b,c){return(b.dps||0).toFixed(2)},hidden:true},{id:"speed",name:LANG.speed,value:"speed",compute:function(b,c){return(b.speed||0).toFixed(2)},hidden:true},{id:"armor",name:LANG.armor,value:"armor",compute:function(b,d){var c=this.ilvlOverride?(typeof this.ilvlOverride.value=="function"?this.ilvlOverride.value.call(this,b):this.ilvlOverride.value):null;b=WH.applyStatModifications(b,null,null,c,Listview.funcBox.getCurrentItemBonuses.call(this,b));if(b.armor>0){return b.armor}},hidden:true},{id:"slot",name:LANG.slot,type:"text",compute:function(b,c){WH.noWrap(c);return g_item_slots[b.slot]},getVisibleText:function(b){return g_item_slots[b.slot]},sortFunc:function(d,c,f){return WH.stringCompare(g_item_slots[d.slot],g_item_slots[c.slot])}},{id:"slots",name:LANG.slots,value:"nslots",hidden:true},{id:"skill",name:LANG.skill,value:"skill",hidden:true},{id:"glyph",name:LANG.glyphtype,type:"text",value:"glyph",compute:function(b,c){if(b.glyph){return g_item_glyphs[b.glyph]}},getVisibleText:function(b){return g_item_glyphs[b.glyph]},sortFunc:function(d,c,f){return WH.stringCompare(g_item_glyphs[d.glyph],g_item_glyphs[c.glyph])},hidden:true},{id:"source",name:LANG.source,type:"text",compute:function(m,d){if(this.iconSize==0){d.className="small"}if(m.attainable){return LANG.unavailable}else{if(m.source!=null){if(m.source.length==1){WH.noWrap(d);var c=(m.sourcemore?m.sourcemore[0]:{});var j=0;if(c.t){j=c.t;var k=WH.ce("a");if(c.q!=null){k.className="q"+c.q}else{k.className="q1"}k.href="/"+g_types[c.t]+"="+c.ti;k.style.whiteSpace="nowrap";if(c.icon){k.className+=" icontiny tinyspecial";k.style.backgroundImage='url("'+g_staticUrl+"/images/wow/icons/tiny/"+c.icon.toLowerCase()+'.gif")'}WH.ae(k,WH.ct(c.n));WH.ae(d,k)}else{WH.ae(d,WH.ct(Listview.funcBox.getUpperSource(m.source[0],c)))}var g=Listview.funcBox.getLowerSource(m.source[0],c,j);if(this.iconSize!=0&&g!=null){var b=WH.ce("div");b.className="small2";if(g.pretext){WH.ae(b,WH.ct(g.pretext))}if(g.url){var k=WH.ce("a");k.className="q1";k.href=g.url;WH.ae(k,WH.ct(g.text));WH.ae(b,k)}else{WH.ae(b,WH.ct(g.text))}if(g.posttext){WH.ae(b,WH.ct(g.posttext))}WH.ae(d,b)}}else{var l="";for(var f=0,h=m.source.length;f<h;++f){if(f>0){l+=LANG.comma}l+=g_sources[m.source[f]]}return l}}}},getVisibleText:function(d){if(d.attainable){return LANG.unavailable}else{if(d.source!=null){if(d.source.length==1){var g="";var f=(d.sourcemore?d.sourcemore[0]:{});var c=0;if(f.t){c=f.t;g+=" "+f.n}else{g+=" "+Listview.funcBox.getUpperSource(d.source[0],f)}var b=Listview.funcBox.getLowerSource(d.source[0],f,c);if(b!=null){if(b.pretext){g+=" "+b.pretext}g+=" "+b.text;if(b.posttext){g+=" "+b.posttext}}return g}else{return Listview.funcBox.arrayText(d.source,g_sources)}}}},sortFunc:function(g,d){var h=Listview.funcBox.assocArrCmp(g.source,d.source,g_sources);if(h!=0){return h}var f=(g.sourcemore&&g.source.length==1?g.sourcemore[0].n:null),c=(d.sourcemore&&d.source.length==1?d.sourcemore[0].n:null);return WH.stringCompare(f,c)}},{id:"type",name:LANG.type,type:"text",compute:function(s,f){f.className="small q1";WH.noWrap(f);var q=WH.ce("a");var n=Listview.funcBox.getItemType(s.classs,s.subclass,s.subsubclass);q.href=n.url;WH.ae(q,WH.ct(n.text));if(this.classFilter!==null){var p=parseInt($("#class-selector div.active a").attr("data-classid"));var r=null;var h=[];var o=[];var d=Menu.findItem(mn_spells,[-12]);for(var m in s.specs){if(WH.inArray(g_chr_specs_by_class[p],s.specs[m])!=-1){if(!r&&d){for(var l in d[3]){if(d[3][l][0]==p){r=d[3][l];break}}}var c="";var b="";for(var g in r){if(r[3][g][0]==s.specs[m]){c=r[3][g][4].tinyIcon.toLowerCase();b=r[3][g][1];break}}o.push({0:c,1:null,2:"/spells=-12."+p+"."+s.specs[m]});h.push(b)}}Listview.funcBox.createCenteredIcons(o,f);$(f).find("div.iconsmall").each(function(j){$(this).bind("mouseover",function(k){WH.Tooltip.showAtCursor(k,h[j],0,0,"q")});$(this).bind("mouseout",function(k){WH.Tooltip.hide()})})}WH.ae(f,q)},getVisibleText:function(b){return Listview.funcBox.getItemType(b.classs,b.subclass,b.subsubclass).text},sortFunc:function(d,c,g){var f=Listview.funcBox.getItemType;return WH.stringCompare(f(d.classs,d.subclass,d.subsubclass).text,f(c.classs,c.subclass,c.subsubclass).text)}},{id:"qty",name:LANG.amount,tooltip:LANG.amount,value:"qty",compute:function(b,c){return(b.qty||1)},hidden:true},{id:"completed",name:LANG.completion,hidden:true,compute:function(d,g,f,c){var b=!d.hasOwnProperty("classs")||!Listview.templates.item._validCompletionCategory(d.classs,d.subclass,isNaN(parseInt(d.name.charAt(0)))?d.quality:7-parseInt(d.name.charAt(0)));WH.addCompletionIcons(g,"item",d.id,b)},sortFunc:function(d,c,f){return WH.stringCompare(Listview.templates.item._itemCompletedFlags(d.id),Listview.templates.item._itemCompletedFlags(c.id))},getValue:function(d){var g=0;var f=g_completion.item;if(!d.hasOwnProperty("classs")||!Listview.templates.item._validCompletionCategory(d.classs,d.subclass,isNaN(parseInt(d.name.charAt(0)))?d.quality:7-parseInt(d.name.charAt(0)))){return -1}for(var h in g_user.lists){var b=g_user.lists[h];if(!(b.id in f)){continue}if(WH.inArray(f[b.id],d.id)!=-1){g++}}return g}}],getItemLink:function(c){var f=Listview.funcBox.getCurrentItemBonuses.call(this,c);var b=f.length>0?("&bonus="+f.join(":")):"";var d="";if(this.ilvlOverride){d="&"+this.ilvlOverride.name}else{if(this.addIlvlToLinks){d="&ilvl="+Listview.funcBox.getItemLevelWithBonuses(c)}}return"/item="+c.id+b+d},_itemCompletedFlags:function(b){return WH.getCompletionFlags("item",b)},_validCompletionCategory:function(b,d,c){return(WH.inArray(g_completion_categories[3],b)!=-1)||(WH.inArray(g_completion_categories[3],""+b+"-"+d)!=-1)||(WH.inArray(g_completion_categories[3],""+b+"q"+c)!=-1)},onBeforeCreate:function(){var d=false;for(var f=0,c=this.data.length;f<c;++f){var h=this.data[f];if((h.slot>0&&h.slot!=18)||(WH.inArray(ModelViewer.validSlots,h.slotbak)>=0&&h.displayid>0)||h.modelviewer){++d}}if(d>0){this.mode=1;this._nComparable=d}for(var b in this.columns){if((this.columns[b].id=="completed")&&(this.columns[b].hidden)){if(!(this.hasOwnProperty("completionMode")&&this.completionMode)&&WH.isSet("g_user")&&"lists" in g_user&&"item" in g_completion&&WH.inArray(this.hiddenCols,this.columns[b].id)==-1){var g=0;for(var j in this.data){if(this.data[j].hasOwnProperty("classs")&&Listview.templates.item._validCompletionCategory(this.data[j].classs,this.data[j].subclass,isNaN(parseInt(this.data[j].name.charAt(0)))?this.data[j].quality:7-parseInt(this.data[j].name.charAt(0)))){g++}}if(g>(this.data.length*0.1)){this.visibility.push(parseInt(b))}}}}},createCbControls:function(h,g){if(!g){return}var f=WH.ce("input"),c=WH.ce("input"),d=WH.ce("input"),b=WH.ce("input");f.type=c.type=d.type=b.type="button";f.value=LANG.button_compare;c.value=(!this.characterSettings||!this.characterSettings.editable?LANG.li_addtolist:LANG.li_addtoanotherlist);d.value=LANG.button_viewin3d;b.value=LANG.button_scaleilvl;f.onclick=this.template.compareItems.bind(this);c.onclick=(function(j){Listview.cbAddToList.call(this,j,"item")}).bind(this);d.onclick=this.template.viewIn3d.bind(this);this.template.buildScalingMenu.call(this,b);if(this._nComparable==0||typeof this._nComparable=="undefined"){f.disabled="disabled";d.disabled="disabled"}WH.ae(h,f);WH.ae(h,c);WH.ae(h,d);WH.ae(h,b)},createTooltipToggle:function(c,b){if(!b){return}this.addTooltipToggle(c,g_items)},compareItems:function(){var c=this.getCheckedRows();if(!c.length){return}var b="";var d=this;WH.arrayWalk(c,function(f){if(f.slot==0||f.slot==18){return}b+=f.id;var j=Listview.funcBox.getCurrentItemBonuses.call(d,f);var g=[];while(g.length<9){g.push(0)}for(var h=0;h<j.length;++h){g.push(j[h])}b+="."+g.join(".");b+=";"});su_addToSaved(WH.rtrim(b,";"),c.length)},buildScalingMenu:function(f){var b=[{name:LANG.normal,mode:null},{name:g_difficulty_names[24]+" "+LANG.su_note_wotlk,mode:{name:"twwotlk",value:function(h){var j=Listview.funcBox.getItemLevelWithBonuses.call(this,h);if(j>WH.applyStatModifications.ITEM_TIMEWALKINGMODE_WOTLK_LEVEL){return WH.applyStatModifications.ITEM_TIMEWALKINGMODE_WOTLK_LEVEL}return j}}},{name:g_difficulty_names[24]+" "+LANG.su_note_bc,mode:{name:"twtbc",value:function(h){var j=Listview.funcBox.getItemLevelWithBonuses.call(this,h);if(j>WH.applyStatModifications.ITEM_TIMEWALKINGMODE_TBC_LEVEL){return WH.applyStatModifications.ITEM_TIMEWALKINGMODE_TBC_LEVEL}return j}}},{name:g_difficulty_names[24]+" "+LANG.su_note_cata,mode:{name:"twcata",value:function(h){var j=Listview.funcBox.getItemLevelWithBonuses.call(this,h);if(j>WH.applyStatModifications.ITEM_TIMEWALKINGMODE_CATA_LEVEL){return WH.applyStatModifications.ITEM_TIMEWALKINGMODE_CATA_LEVEL}return j}}},{name:g_difficulty_names[24]+" "+LANG.su_note_mists,mode:{name:"twmists",value:function(h){var j=Listview.funcBox.getItemLevelWithBonuses.call(this,h);if(j>WH.applyStatModifications.ITEM_TIMEWALKINGMODE_MISTS_LEVEL){return WH.applyStatModifications.ITEM_TIMEWALKINGMODE_MISTS_LEVEL}return j}}},{name:LANG.su_menu_pvpmode+LANG.wordspace+LANG.parens_open+WH.sprintf(LANG.level_format.replace("%s","$1"),100)+LANG.parens_close,mode:{name:"pvp",value:function(h){var j=Listview.funcBox.getItemLevelWithBonuses.call(this,h);var k=j;if(h.pvpUpgrade){k=j+h.pvpUpgrade}else{if(j>=560&&j<=690){k=690}else{if(j>715){k=715}}}return k}}}];var g=[];var c=this;for(var d=0;d<b.length;++d){g.push([d,b[d].name,(function(h){return function(){this.checked=true;if(WH.isSet("g_listviews")&&g_listviews){for(var k in g_listviews){var j=g_listviews[k];j.ilvlOverride=h;Filter.listview_computeItemScores(j);j.applySort();j.updateFilters(1)}}}})(b[d].mode),null,{checkedFunc:function(h){var j=b[h[0]].mode;if(!j&&!c.ilvlOverride){return true}return j&&c.ilvlOverride&&j.name==c.ilvlOverride.name}}])}Menu.add(f,g)},viewIn3d:function(){var l=this.getCheckedRows();if(!l.length){return}var c=this;var n=false,j=false,k=false;var g={};var h=null;WH.arrayWalk(l,function(o){o.currentDisplayId=o.displayid;var q=Listview.funcBox.getCurrentItemBonuses.call(c,o);var p=g_items.getAppearance(o.id,q);if(p!=null&&p[0]){o.currentDisplayId=p[0]}if(WH.inArray(ModelViewer.validSlots,o.slotbak)>=0&&o.currentDisplayId>0){var r=ModelViewer.slotMap[o.slotbak];if(g[r]){j=true}g[r]={displayId:o.currentDisplayId,typeId:o.id,bonus:q.length?q[0]:0};n=true}else{if(o.modelviewer){h=o.modelviewer}else{k=true}}});var m=null;if(h){if(n||k){m=LANG.dialog_cantdisplay}ModelViewer.show({type:h.type,displayId:h.displayid,slot:h.slot,message:m})}else{if(j||k){m=LANG.dialog_cantdisplay}var b=[];var d=[];for(var f in g){b.push(parseInt(f));b.push(g[f].displayId);d.push([g[f].typeId,g[f].bonus,parseInt(f)])}if(b.length>0){ModelViewer.show({type:4,equipList:b,message:m,itemData:d})}else{alert(LANG.message_nothingtoviewin3d)}}}};Listview.templates["item-set"]={sort:[-2,-4,-5,1],nItemsPerPage:75,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",compute:function(f,j){var b=WH.ce("a");b.className="q"+(8-parseInt(f.name.charAt(0)))+" listview-cleartext";b.href=this.getItemLink(f);WH.ae(b,WH.ct(f.name.substring(1)));var h=WH.ce("div");h.style.position="relative";WH.ae(h,b);var g=WH.ce("div");g.className="listview-name-info q2";var c="";if(f.heroic){c=LANG.lvitem_heroicitem}else{if(f.elite){c=LANG.lvitem_eliteitem}else{if(f.raidfinder){c=LANG.lvitem_raidfinderitem}else{if(f.flexible){c=LANG.lvitem_flexibleitem}}}}if(c!=""){WH.ae(g,WH.ct(c));WH.ae(h,g)}WH.ae(j,h);if(f.note){var g=WH.ce("div");g.className="small";WH.ae(g,WH.ct(g_itemset_notes[f.note]));WH.ae(j,g)}},getVisibleText:function(b){var c=b.name.substring(1);if(b.note){c+=" "+g_itemset_notes[b.note]}return c}},{id:"level",name:LANG.level,type:"range",getMinValue:function(b){return b.minlevel},getMaxValue:function(b){return b.maxlevel},compute:function(b,c){if(b.minlevel>0&&b.maxlevel>0){if(b.minlevel!=b.maxlevel){return b.minlevel+LANG.hyphen+b.maxlevel}else{return b.minlevel}}else{return -1}},sortFunc:function(d,c,f){if(f>0){return WH.stringCompare(d.minlevel,c.minlevel)||WH.stringCompare(d.maxlevel,c.maxlevel)}else{return WH.stringCompare(d.maxlevel,c.maxlevel)||WH.stringCompare(d.minlevel,c.minlevel)}}},{id:"pieces",name:LANG.pieces,getValue:function(b){return b.pieces.length},compute:function(g,k){k.style.padding="0";var b=(g.pieces!=null&&g.pieces.length>0);if(b){var f=Listview.funcBox.getCurrentItemBonuses(g);var c=f.length>0?("&bonus="+f.join(":")):"";var h=[];for(var d=0;d<g.pieces.length;++d){var j=g.pieces[d];h.push({0:g_items.getIcon(j,f),1:1,2:"/item="+j+c})}Listview.funcBox.createCenteredIcons(h,k)}},sortFunc:function(d,c){var g=(d.pieces!=null?d.pieces.length:0);var f=(c.pieces!=null?c.pieces.length:0);return WH.stringCompare(g,f)}},{id:"type",name:LANG.type,type:"text",compute:function(b,c){return g_itemset_types[b.type]},sortFunc:function(d,c,f){return WH.stringCompare(g_itemset_types[d.type],g_itemset_types[c.type])}},{id:"classes",name:LANG.classes,type:"text",width:"20%",getVisibleText:function(f){var g="";if(f.reqclass){var d=Listview.funcBox.assocBinFlags(f.reqclass,g_chr_classes);for(var c=0,b=d.length;c<b;++c){if(c>0){g+=LANG.comma}g+=g_chr_classes[d[c]]}}return g},compute:function(j,l){if(j.reqclass){var f=Listview.funcBox.assocBinFlags(j.reqclass,g_chr_classes);var k=WH.ce("div");k.style.width=(26*f.length)+"px";k.style.margin="0 auto";for(var c=0,b=f.length;c<b;++c){var h=Icon.create("class_"+g_file_classes[f[c]],0,null,"/class="+f[c]);h.style.cssFloat=h.style.styleFloat="left";var g=g_chr_classes[f[c]];$(h).mouseover((function(d){return function(m){WH.Tooltip.showAtCursor(m,d,0,0,"q")}})(g)).mousemove(function(d){WH.Tooltip.cursorUpdate(d)}).mouseout(function(){WH.Tooltip.hide()});WH.ae(k,h)}WH.ae(l,k)}},sortFunc:function(d,c,f){return Listview.funcBox.assocArrCmp(Listview.funcBox.assocBinFlags(d.reqclass,g_chr_classes),Listview.funcBox.assocBinFlags(c.reqclass,g_chr_classes),g_chr_classes)}}],getItemLink:function(b){return"/item-set="+b.id}};Listview.templates.itemset=Listview.templates["item-set"];Listview.templates["transmog-set"]={sort:[1],nItemsPerPage:75,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",compute:function(f,j){var b=WH.ce("a");b.className="q"+(8-parseInt(f.name.charAt(0)))+" listview-cleartext";b.href=this.getItemLink(f);WH.ae(b,WH.ct(f.name.substring(1)));var h=WH.ce("div");h.style.position="relative";WH.ae(h,b);var g=WH.ce("div");g.className="listview-name-info q2";var c="";if(f.heroic){c=LANG.lvitem_heroicitem}else{if(f.elite){c=LANG.lvitem_eliteitem}else{if(f.raidfinder){c=LANG.lvitem_raidfinderitem}}}if(c!=""){WH.ae(g,WH.ct(c));WH.ae(h,g)}j.className="listview-blurb";WH.ae(j,h);if(f.note||f._note){var g=WH.ce("div");g.className="small";if(f.note){WH.ae(g,WH.ct(f.note))}else{WH.ae(g,WH.ct(g_itemset_notes[f._note]))}WH.ae(j,g)}},getVisibleText:function(b){var c=b.name.substring(1);if(b.note){c+=" "+b.note}else{if(b._note){c+=" "+g_itemset_notes[b._note]}}return c},sortFunc:function(f,d,g){var c=(8-parseInt(f.name.charAt(0)));var h=(8-parseInt(d.name.charAt(0)));if(c==4){c=3}if(h==4){h=3}if(c!=h){return WH.stringCompare(h,c)}return WH.stringCompare(f.name.substring(1),d.name.substring(1))}},{id:"level",name:LANG.req,tooltip:LANG.tooltip_reqlevel,type:"range",getMinValue:function(b){return b.maxlevel},getMaxValue:function(b){return b.maxlevel},compute:function(b,c){if(b.maxlevel>0){return b.maxlevel}else{return -1}},sortFunc:function(d,c,f){return WH.stringCompare(d.maxlevel,c.maxlevel)}},{id:"pieces",name:LANG.pieces,getValue:function(b){return b.pieces.length},compute:function(h,k){k.style.padding="0";var b=(h.pieces!=null&&h.pieces.length>0);if(b){var g=[];for(var d=0;d<h.pieces.length;++d){var j=h.pieces[d];var f=h.pcbonus?h.pcbonus[d]:[];var c=f.length>0?("&bonus="+f.join(":")):"";g.push({0:g_items.getIcon(j,f),1:1,2:"/item="+j+c})}Listview.funcBox.createCenteredIcons(g,k)}},sortFunc:function(d,c){var g=(d.pieces!=null?d.pieces.length:0);var f=(c.pieces!=null?c.pieces.length:0);return WH.stringCompare(g,f)}},{id:"armortype",name:LANG.type,type:"text",width:"15%",getVisibleText:function(b){return b.armorType?g_itemset_types[b.armorType]:"???"},compute:function(b){return b.armorType?g_itemset_types[b.armorType]:"???"},sortFunc:function(d,c){return WH.stringCompare(d.armorType,c.armorType)}},{id:"style",name:LANG.style,type:"text",getVisibleText:function(b){return g_transmog_notes_to_styles[b._note]?g_transmog_styles[g_transmog_notes_to_styles[b._note]]:"???"},compute:function(b){return g_transmog_notes_to_styles[b._note]?g_transmog_styles[g_transmog_notes_to_styles[b._note]]:"???"},sortFunc:function(d,c){return WH.stringCompare(g_transmog_notes_to_styles[d._note],g_transmog_notes_to_styles[c._note])}}],getItemLink:function(b){return"/transmog-set="+b.id}};Listview.templates.transmogset=Listview.templates["transmog-set"];Listview.templates.outfit={sort:[-6,1],searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",compute:function(d,g,c){var f=WH.ce("div");var b=WH.ce("a");WH.ae(f,b);b.className=(d.classs?"c"+d.classs:"q0")+" listview-cleartext";WH.st(b,d.name);b.href=this.getItemLink(d);if(d.nvotes<5){b.className+=" guide-new"}WH.ae(g,f)},getVisibleText:function(b){return b.name},sortFunc:function(f,d,g){var c,h;c=f.name.toString().replace(/^\s*[\[\(]+[^\]\)]*[\]\)]/,"").replace(/^\W+/,"").replace(/^An?\s+/,"");h=d.name.toString().replace(/^\s*[\[\(]+[^\]\)]*[\]\)]/,"").replace(/^\W+/,"").replace(/^An?\s+/,"");if(c==""){c=f.name}if(h==""){h=d.name}return WH.stringCompare(c,h)||WH.stringCompare(f.name,d.name)}},{id:"classs",name:LANG.classs,type:"text",compute:function(g,j){if(g.classs){var h=WH.ce("div"),f=WH.ce("div"),c;c=Icon.create("class_"+g_file_classes[g.classs],0,null,"/class="+g.classs);var b=Icon.getLink(c);WH.Tooltip.simple(b,g_chr_classes[g.classs],"c"+g.classs,true);c.style.cssFloat=c.style.syleFloat="left";h.style.margin="0 auto";h.style.textAlign="left";h.style.width="26px";f.className="clear";WH.ae(h,c);WH.ae(j,h);WH.ae(j,f)}},getVisibleText:function(b){return b.classs?g_chr_classes[b.classs]:""},sortFunc:function(d,c,f){return WH.stringCompare(d.classs?g_chr_classes[d.classs]:"",c.classs?g_chr_classes[c.classs]:"")}},{id:"race",name:LANG.race,type:"text",compute:function(g,j){if(g.race){var h=WH.ce("div"),f=WH.ce("div"),c;c=Icon.create("race_"+g_file_races[g.race]+"_"+g_file_genders[g.gender||0],0,null,"/race="+g.race);var b=Icon.getLink(c);WH.Tooltip.simple(b,g_chr_races[g.race],"q",true);c.style.cssFloat=c.style.syleFloat="left";h.style.margin="0 auto";h.style.textAlign="left";h.style.width="26px";f.className="clear";WH.ae(h,c);WH.ae(j,h);WH.ae(j,f)}},getVisibleText:function(b){return b.race?g_chr_races[b.race]:""},sortFunc:function(d,c,f){return WH.stringCompare(d.race?g_chr_races[d.race]:"",c.race?g_chr_races[c.race]:"")}},{id:"style",name:LANG.style,type:"text",compute:function(b,c){$(c).append($("<a/>",{html:WH.data.outfitStyles[b.style],href:"/outfits&filter=style="+b.style}))},getVisibleText:function(b){return WH.data.outfitStyles[b.style]},sortFunc:function(d,c){return WH.stringCompare(WH.data.outfitStyles[d.style],WH.data.outfitStyles[c.style])}},{id:"user",name:LANG.author,type:"text",hidden:true,compute:function(c,f){var d=$("<a/>",{html:c.user,href:"/user="+c.user+"#outfits"});var b=WH.getStaffColorFromRoles(c.userroles|0);if(b!=""){d.addClass(b)}else{d.css("color","white")}$(f).append(d)},getVisibleText:function(b){return b.user},sortFunc:function(d,c){return WH.stringCompare(d.user,c.user)}},{id:"rating",name:LANG.rating,value:"score"},{id:"views",name:LANG.views,value:"nviews",type:"text",compute:function(c,d){var b=$("<span>");b.text(WH.getN5(c.nviews));Listview.funcBox.viewColors(b,c.nviews);$(d).append(b)}},{id:"comments",name:LANG.comments,value:"ncomments",compute:function(b){return WH.getN5(b.ncomments|0)}}],getItemLink:function(b){return"/outfit="+b.id+"/"+b.url}};Listview.templates["outfit-gallery"]={sort:[-1,4],mode:3,nItemsPerPage:40,nItemsPerRow:4,poundable:1,sortOptions:[{id:"rating",name:LANG.rating,type:"number",value:"score",sortFunc:function(d,c){return d.score<c.score?-1:1}},{id:"name",name:LANG.name,type:"text",value:"name",sortFunc:function(f,d){var c,g;c=f.name.toString().replace(/^\s*[\[\(]+[^\]\)]*[\]\)]/,"").replace(/^\W+/,"").replace(/^An?\s+/,"");g=d.name.toString().replace(/^\s*[\[\(]+[^\]\)]*[\]\)]/,"").replace(/^\W+/,"").replace(/^An?\s+/,"");if(c==""){c=f.name}if(g==""){g=d.name}return WH.stringCompare(c,g)||WH.stringCompare(f.name,d.name)}},{id:"style",name:LANG.style,type:"text",value:"style",sortFunc:function(d,c){return WH.stringCompare(WH.data.outfitStyles[d.style]||"",WH.data.outfitStyles[c.style]||"")}},{id:"id",name:LANG.date,type:"text",value:"id",sortFunc:function(d,c){return d.id<c.id?-1:1}},{id:"class",name:LANG.classs,type:"text",value:"name",sortFunc:function(d,c){return WH.stringCompare(d.classs?g_chr_classes[d.classs]:"",c.classs?g_chr_classes[c.classs]:"")}},{id:"race",name:LANG.race,type:"text",value:"name",sortFunc:function(d,c){return WH.stringCompare(d.race?g_chr_races[d.race]:"",c.race?g_chr_races[c.race]:"")}}],columns:[],compute:function(f,h,j){h.className="screenshot-cell";h.vAlign="bottom";var m=WH.ce("a");m.href=this.getItemLink(f);var k=WH.ce("img");if(f.screenshot){k.src=g_staticUrl+"/uploads/screenshots/small/"+f.screenshot+".jpg"}m.style.position="relative";var g=WH.ce("small",{innerHTML:LANG.rating+LANG.colon+f.score});g.style.color="#666";g.style.position="absolute";g.style.bottom="10px";g.style.right="5px";WH.ae(m,g);WH.ae(m,k);WH.ae(h,m);var l=WH.ce("div");l.className="screenshot-caption-wrapper";var b=WH.ce("div");b.className="screenshot-caption";WH.aE(h,"mouseover",Listview.funcBox.ssCellOver.bind(b));WH.aE(h,"mouseout",Listview.funcBox.ssCellOut.bind(b));var c=WH.ce("a");c.href=this.getItemLink(f);WH.st(c,f.name);WH.ae(b,c);WH.ae(l,b);WH.ae(h,l)},sortFunc:function(f,d,g){var c,h;c=f.name.toString().replace(/^\s*[\[\(]+[^\]\)]*[\]\)]/,"").replace(/^\W+/,"").replace(/^An?\s+/,"");h=d.name.toString().replace(/^\s*[\[\(]+[^\]\)]*[\]\)]/,"").replace(/^\W+/,"").replace(/^An?\s+/,"");if(c==""){c=f.name}if(h==""){h=d.name}return WH.stringCompare(c,h)||WH.stringCompare(f.name,d.name)},getItemLink:function(b){return"/outfit="+b.id+"/"+b.url}};Listview.templates.outfitgallery=Listview.templates["outfit-gallery"];Listview.templates.bagscan={sort:[1],columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",compute:function(g,j,c){var h=WH.ce("div");var b=WH.ce("a");b.href=this.getItemLink(g);b.className="listview-cleartext";WH.ae(b,WH.ct(g.name));WH.ae(h,b);if(g["private"]){h.style.position="relative";var f=WH.ce("div");f.className="listview-name-info q0";WH.ae(f,WH.ct(LANG["private"]));WH.aef(h,f)}WH.ae(j,h)}},{id:"backpack",name:LANG.backpack,type:"number",value:"backpack"},{id:"bank",name:LANG.bank,type:"number",value:"bank"},{id:"voidstorage",name:LANG.voidstorage,type:"number",value:"voidstorage"},{id:"guildbank",name:LANG.guildbank,type:"number",value:"guild"},{id:"posted",name:LANG.posted,type:"text",compute:function(d,f){var c=new Date(parseInt(d.when)),b=(g_serverTime-c)/1000;a=WH.ce("span");WH.formatDate(a,b,c);WH.ae(f,a)},sortFunc:function(d,c){if(d.when==c.when){return 0}return d.when<c.when?1:-1}},{id:"delete",name:LANG["delete"],type:"text",hidden:true,compute:function(c,d){var b=WH.ce("a");b.className="fa fa-times";WH.st(b,LANG["delete"]);b.href="javascript:;";WH.aE(b,"click",DeleteBagScan.bind(c));WH.ae(d,b)}}],getItemLink:function(b){return"/bagscanner="+b.id}};Listview.templates["transmog-set-gallery"]={sort:[1],mode:3,nItemsPerPage:40,nItemsPerRow:4,poundable:1,sortOptions:[{id:"name",name:LANG.name,type:"text",value:"name",sortFunc:function(f,d){var c=(8-parseInt(f.name.charAt(0)));var g=(8-parseInt(d.name.charAt(0)));if(c==4){c=3}if(g==4){g=3}if(c!=g){return WH.stringCompare(g,c)}return WH.stringCompare(f.name.substring(1),d.name.substring(1))}},{id:"level",name:LANG.tooltip_reqlevel,type:"range",sortFunc:function(d,c){return WH.stringCompare(d.maxlevel,c.maxlevel)}},{id:"pieces",name:LANG.pieces,getValue:function(b){return b.pieces.length},sortFunc:function(d,c){var g=(d.pieces!=null?d.pieces.length:0);var f=(c.pieces!=null?c.pieces.length:0);return WH.stringCompare(g,f)}},{id:"armortype",name:LANG.type,type:"text",sortFunc:function(d,c){return WH.stringCompare(d.armorType,c.armorType)}},{id:"style",name:LANG.style,getValue:function(b){return g_transmog_notes_to_styles[b._note]},sortFunc:function(d,c){return WH.stringCompare(g_transmog_notes_to_styles[d._note],g_transmog_notes_to_styles[c._note])}}],columns:[],compute:function(n,f,g){f.className="screenshot-cell";f.vAlign="bottom";var l=WH.ce("a");l.href="/transmog-set="+n.id;var m=WH.getPreferredTransmogRace();var h=WH.ce("img");h.src=g_staticUrl+ModelViewer.getStaticBase()+"/transmog/"+m.race+"/"+(m.gender-1)+"/"+n.id+".jpg";WH.ae(l,h);WH.ae(f,l);if(true){var j=WH.ce("div");j.className="screenshot-caption-wrapper screenshot-caption-clickable";var b=WH.ce("div");b.className="screenshot-caption";$(b).click(function(){location.href="/transmog-set="+n.id});WH.aE(f,"mouseover",Listview.funcBox.ssCellOver.bind(b));WH.aE(f,"mouseout",Listview.funcBox.ssCellOut.bind(b));var k=WH.ce("span");var c=WH.sprintf("[color=q$1]$2[/color]",8-parseInt(n.name.charAt(0)),n.name.substring(1));k.innerHTML=WH.markup.getHtml(c,{mode:WH.markup.MODE.ARTICLE});WH.ae(b,k);WH.ae(j,b);WH.ae(f,j)}},sortFunc:function(f,d,g){var c=(8-parseInt(f.name.charAt(0)));var h=(8-parseInt(d.name.charAt(0)));if(c==4){c=3}if(h==4){h=3}if(c!=h){return WH.stringCompare(h,c)}return WH.stringCompare(f.name.substring(1),d.name.substring(1))}};Listview.templates.transmogsetgallery=Listview.templates["transmog-set-gallery"];Listview.templates["icon-gallery"]={sort:[1],mode:Listview.MODE_FLEXGRID,clickable:false,nItemsPerPage:170,cellMinWidth:88,poundable:1,sortOptions:[{id:"name",name:LANG.name,sortFunc:function(d,c){return WH.stringCompare(d.name,c.name)}}],columns:[],value:"name",compute:function(n,s,k){var l=WH.ce("div");l.className="icon-cell";$(l).mouseenter(function(){setTimeout((function(){this.className+=" animate"}).bind(this),1)}).mouseleave(function(){this.className=this.className.replace(/ *animate\b/,"")});WH.ae(l,Icon.create(n.icon,2,null,this.getItemLink(n)));var f=WH.ce("div",{className:"icon-cell-overlay"});$(f).mouseleave(function(){$(".fa-check",this).removeClass("fa-check").addClass("fa-clipboard")});WH.ae(f,Icon.create(n.icon,2,null,this.getItemLink(n)));var q=WH.ce("div",{className:"icon-cell-overlay-name"});var t=function(){this.focus();this.select()};WH.ae(q,WH.ce("input",{type:"text",value:n.name,onclick:t,onfocus:t}));WH.ae(q,WH.createButton(null,null,{"class":"fa fa-fw fa-clipboard","float":false,"no-margin":true,click:function(){var u=$(this);var w=u.siblings('input[type="text"]');w.focus().select();var v=false;try{if(!document.execCommand("copy")){v=true}}catch(d){v=true}w.blur();if(v){u.css({"pointer-events":"none"}).removeClass("fa-clipboard").addClass("fa-exclamation-triangle").blur().effect("shake",{distance:5});setTimeout(function(){$(".icon-cell-overlay-name .btn").fadeOut(1000)},600)}else{u.removeClass("fa-clipboard").addClass("fa-check")}}}));WH.ae(f,q);var p=WH.ce("div",{className:"icon-cell-overlay-counts"});var m=[3,6,10,1,200,17,22,20,9,26,13];var j=0;for(var h=0,b;b=m[h];h++){var r=g_types[b]+"count";if(n[r]){j+=n[r];var g=g_types[b];var o=n[r]==1?LANG.types[b][1]:LANG.types[b][3];if(b==1){g="battlepet";o=n[r]==1?LANG.battlepet_lc:LANG.battlepets_lc}WH.ae(p,WH.ce("div",null,WH.ce("a",{href:this.getItemLink(n)+"#used-by-"+g,innerHTML:WH.sprintf(LANG.entitycount,n[r],o)})))}}if(!j){WH.ae(p,WH.ce("div",{innerHTML:LANG.unused}))}WH.ae(f,p);var c=WH.ce("div",{className:"icon-cell-overlay-placer"},f);WH.ae(l,c);WH.ae(s,l)},sortFunc:function(d,c){return WH.stringCompare(d.name,c.name)},getItemLink:function(b){return"/icon="+b.id+"/"+WH.urlize(b.name)}};Listview.templates.icongallery=Listview.templates["icon-gallery"];Listview.templates.guide={sort:["rating"],searchable:1,filtrable:1,columns:[{id:"title",name:"Title",type:"text",align:"left",value:"title",compute:function(b,h,d){if(b.status==5){$(d).addClass("outofdate")}if(!b.title){b.title=b.url}var g=$("<a>").text(b.title).attr("class","listview-cleartext").attr("href",b.url);if(b.sticky){g.addClass("guide-sticky")}else{if(b.nvotes<5){g.addClass("guide-new")}}if(!b.featuredimage){$(h).addClass("guides-list-cell-nameonly").append(g)}else{if(b.hasOwnProperty("spec")&&b.spec){for(var c in g_chr_specs_by_class){if(g_chr_specs_by_class.hasOwnProperty(c)&&WH.inArray(g_chr_specs_by_class[c],b.spec)>=0){g.addClass("c"+c);break}}}var f=$("<table/>",{"class":"guides-list-name"+(b.title.length>=60?" long-name":"")}).append($("<tr/>").append($("<td/>").append(g)));$(h).addClass("guides-list-cell").append($("<div/>").append($("<div/>",{"class":"guides-list-bg",style:"background-image:url("+g_staticUrl+"/uploads/guide/featuredguides/"+b.featuredimage+")",html:"<div></div>"})).append(f))}},getVisibleText:function(b){return b.title}},{id:"status",name:"Status",type:"text",hidden:1,compute:function(b,d){var c=$("<span>").text(l_guide_states[b.status]).css("color",l_guide_states_color[b.status]);$(d).append(c)},getVisibleText:function(b){return l_guide_states[b.status]},sortFunc:function(d,c){if(d.status==c.status){return 0}return d.status<c.status?-1:1}},{id:"category",name:"Category",type:"text",compute:function(b,c){$(c).append($("<a>").attr("href","/guides="+b.category).text(l_guide_categories[b.category]).css("color","white"))},getVisibleText:function(b){return l_guide_categories[b.category]},sortFunc:function(d,c){if(d.category==c.category){return 0}return d.category<c.category?-1:1}},{id:"author",name:"Author",type:"text",compute:function(b,f){var d=$("<a>").attr("href","/user="+b.author).text(b.author);var c=WH.getStaffColorFromRoles(b.authorroles);if(c!=""){d.addClass(c)}else{d.css("color","white")}$(f).append(d)},getVisibleText:function(b){return b.author},sortFunc:function(d,c){return WH.stringCompare(d.author,c.author)}},{id:"rating",name:"Rating",type:"range",width:"200px",compute:function(b,d){$(d).append(GetStars(b.rating));var c=$("<span>").css("font-size","85%");if(b.rating<0){c.text((5-b.nvotes===1?LANG.needsvote:LANG.needsvotes).replace("%s",5-b.nvotes))}else{c.text((b.nvotes===1?LANG.outofvote:LANG.outofvotes).replace("%s",WH.getN5(b.nvotes)))}$(d).append(c)},getMinValue:function(b){return guide.rating},getMaxValue:function(b){return guide.rating},sortFunc:function(d,c,f){if(d.sticky&&!c.sticky){return -1}else{if(!d.sticky&&c.sticky){return 1}}var h=d.rating==-1&&d.author!="Wowhead";var g=c.rating==-1&&c.author!="Wowhead";if(h&&!g){return -1}else{if(g&&!h){return 1}}if(d.rating==c.rating){return 0}return d.rating<c.rating?1:-1}},{id:"comments",name:"Comments",type:"text",width:"120px",compute:function(b){return WH.getN5(b.comments)},sortFunc:function(d,c){if(d.comments==c.comments){return 0}return d.comments<c.comments?-1:1}},{id:"patch",name:"Expansion",type:"text",width:"120px",compute:function(b,d){var c=WH.ce("span");c.className=WH.getExpansionClassName(Math.floor(b.patch/10000)-1);if(c.className.substr(0,12)=="icon-unknown"){c.innerHTML=WH.Wow.getVersionStrFromNum(b.patch)}else{c.title=WH.Wow.getVersionStrFromNum(b.patch)}WH.ae(d,c)},sortFunc:function(d,c){if(d.patch==c.patch){return 0}return d.patch<c.patch?-1:1}}],getItemLink:function(b){return b.url}};Listview.templates.topusers={sort:["reputation"],searchable:1,filtrable:0,columns:[{id:"username",name:LANG.username,type:"text",align:"left",compute:function(c,f){var d=$("<a>");var b=WH.getStaffColorFromRoles(c.groups);if(b!=""){d.addClass(b)}else{d.css("color","white")}d.text(c.username);d.addClass("listview-cleartext");d.attr("href","/user="+c.username);$(f).append(d);return},getVisibleText:function(b){return b.username},sortFunc:function(d,c){return WH.stringCompare(d.username,c.username)},getItemLink:function(b){return"/user="+user.username}},{id:"reputation",name:LANG.reputation,type:"text",compute:function(b,c){$(c).append(WH.numberFormat(b.reputation));return},sortFunc:function(d,c){if(d.reputation==c.reputation){return 0}return d.reputation<c.reputation?1:-1}},{id:"achievements",name:LANG.achievements,type:"text",compute:function(b,f){var c=$("<span>").addClass("wsach-pts").css("font-size","inherit");var d="";if(b.gold){d+="<i>"+b.gold+"</i>&middot;"}if(b.silver){d+="<b>"+b.silver+"</b>&middot;"}d+="<u>"+b.copper+"</u>";c.html(d);$(f).append(c);return},sortFunc:function(d,c){var g=(d.gold*1000*1000)+(d.silver*1000)+d.copper;var f=(c.gold*1000*1000)+(c.silver*1000)+c.copper;if(g==f){return 0}return g<f?1:-1}},{id:"comments",name:LANG.comments,type:"text",compute:function(b,c){$(c).append(WH.numberFormat(b.comments));return},sortFunc:function(d,c){if(d.comments==c.comments){return 0}return d.comments<c.comments?1:-1}},{id:"posts",name:LANG.posts,type:"text",compute:function(b,c){$(c).append(WH.numberFormat(b.posts));return},sortFunc:function(d,c){if(d.posts==c.posts){return 0}return d.posts<c.posts?1:-1}},{id:"screenshots",name:LANG.screenshots,type:"text",compute:function(b,c){$(c).append(WH.numberFormat(b.screenshots));return},sortFunc:function(d,c){if(d.screenshots==c.screenshots){return 0}return d.screenshots<c.screenshots?1:-1}},{id:"reports",name:LANG.reports,type:"text",compute:function(b,c){$(c).append(WH.numberFormat(b.reports));return},sortFunc:function(d,c){if(d.reports==c.reports){return 0}return d.reports<c.reports?1:-1}},{id:"votes",name:LANG.votes,type:"text",compute:function(b,c){$(c).append(WH.numberFormat(b.votes));return},sortFunc:function(d,c){if(d.votes==c.votes){return 0}return d.votes<c.votes?1:-1}},{id:"uploads",name:LANG.uploads,type:"text",compute:function(b,c){$(c).append(WH.numberFormat(b.uploads));return},sortFunc:function(d,c){if(d.uploads==c.uploads){return 0}return d.uploads<c.uploads?1:-1}},{id:"created",name:LANG.created,type:"text",hidden:1,compute:function(d,f){var c=new Date(d.creation),b=(g_serverTime-c)/1000;a=WH.ce("span");WH.formatDate(a,b,c);WH.ae(f,a)},sortFunc:function(d,c){if(d.creation==c.creation){return 0}return d.creation<c.creation?1:-1}}],getItemLink:function(b){return"/user="+b.username}};Listview.templates.reputationhistory={sort:["when"],searchable:0,filtrable:0,columns:[{id:"action",value:"action",name:LANG.reputationaction,type:"text",align:"left",compute:function(c,d){if(c.param&&c.param>0){var b=$("<a>").addClass("listview-cleartext").attr("href","/go-to-comment&id="+c.param).text(l_reputation_names[c.action]);if(c.action==11||c.action==12||c.action==13){b.attr("href","/website-achievement="+c.param+(g_user.name?("#user:"+g_user.name):""))}$(d).append(b)}else{$(d).append(l_reputation_names[c.action])}},getVisibleText:function(b){return l_reputation_names[b.action]},sortFunc:function(d,c){return WH.stringCompare(l_reputation_names[d.action],l_reputation_names[c.action])}},{id:"amount",value:"amount",name:LANG.amount,type:"text",width:"250px",compute:function(c,d){var b=$("<span>").text(c.amount);if(c.amount>0){b.addClass("q2").prepend("+")}else{if(c.amount<0){b.addClass("q10")}}$(d).append(b)},getVisibleText:function(b){return b.amount}},{id:"when",name:LANG.date,type:"text",width:"250px",compute:function(d,f){var c=new Date(d.when),b=(g_serverTime-c)/1000;a=WH.ce("span");WH.formatDate(a,b,c);WH.ae(f,a)},sortFunc:function(d,c){var g=new Date(d.when);var f=new Date(c.when);if(g==f){return 0}return g<f?1:-1}}]};Listview.templates.twitchstream={sort:[-2,1],searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",span:2,compute:function(h,j,g){var c=WH.ce("td");c.style.width="1px";c.style.paddingRight="0";c.style.borderRight="none";WH.ae(g,c);if(("logo" in h.channel)&&(h.channel.logo)){var f=Icon.create(h.channel.logo,1,null,this.getItemLink(h));f.getElementsByTagName("ins")[0].style.backgroundSize="36px 36px";WH.ae(c,f)}else{WH.ae(c,Icon.create("inv_misc_questionmark",1,null,this.getItemLink(h)))}j.style.borderLeft="none";var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(h);var d=WH.ce("span");WH.st(d,h.channel.display_name);WH.ae(b,d);WH.ae(j,b);if(h.channel.status){WH.ae(j,WH.ce("br"));var d=WH.ce("span");d.className="small q0";WH.st(d,h.channel.status);WH.ae(j,d)}},getVisibleText:function(b){return b.channel.display_name},sortFunc:function(d,c,f){return WH.stringCompare(d.channel.display_name,c.channel.display_name)}},{id:"viewers",name:"Viewers",type:"number",value:"viewers",compute:function(c,d,b){WH.st(d,WH.getN5(c.viewers))}}],getItemLink:function(b){return"/streams#"+b.channel.name}};Listview.templates.comment={sort:[-5,4,6,-3,2],mode:2,nItemsPerPage:40,poundable:2,columns:[{value:"number"},{value:"id"},{value:"rating"},{value:"deleted"},{value:"sticky"},{value:"outofdate"}],compute:function(g,f,c){var b=$("<div></div>");var d=(g.__minPatch&&(g.__minPatch>new Date(g.date)));g.locale=(this.id=="english-comments"?"www":"");b.append('<table><tr><td class="vote-column"><p class="upvote"><span class="fa fa-chevron-up"></span></p><div class="rating-container"></div><p class="downvote"><span class="fa fa-chevron-down"></span></p><p class="comment-sticky" title="'+LANG.stickycomment_tip+'">STICKY</p></td><td class="main-body"><div class="comment-header"><table><tr><td class="comment-author"></td><td class="comment-controls"></td><td class="comment-notification"></td></tr></table></div><div class="text comment-body"></div><div class="comment-replies"></div><p class="comment-replies-control" style="display: none"></p></td></tr></table>');g.colorClass="comment"+(c%2);b.addClass("comment").addClass(g.colorClass);if(g.rating<-4){b.addClass("comment-lowrated")}if(g.deleted){b.addClass("comment-deleted")}if(g.outofdate){b.addClass("comment-outofdate")}g.container=b;g.voteCell=b.find(".vote-column");g.commentCell=b.find(".main-body");g.repliesCell=b.find(".comment-replies");g.repliesControl=b.find(".comment-replies-control");g.headerCell=b.find(".comment-header");g.commentBody=b.find(".comment-body");g.commentAuthor=b.find(".comment-author");g.commentControls=b.find(".comment-controls");this.template.updateVoteCell(g);this.template.updateCommentCell(g);this.template.updateStickyStatus(g);this.template.updateReplies(g);if(g.deleted||g.rating<-4){g.headerCell.css("cursor","pointer");g.headerCell.bind("click",function(){g.voteCell.toggle();g.repliesCell.toggle();g.commentBody.toggle()})}$(f).addClass("comment-wrapper").html(b);if(d){$(f).hide()}else{$(f).show()}},updateReplies:function(f){this.updateRepliesCell(f);this.updateRepliesControl(f);SetupReplies(f.container,f);if(!f.alreadyLoadedBefore){f.alreadyLoadedBefore=true;var d=location.hash.match("#comments:id=([0-9]+):reply=([0-9]+)");if(d){var c=d[1];var b=d[2];if(f.id==c){this.highlightReply(f,b)}}}},highlightReply:function(j,c,d){var g=null;for(var b in j.replies){if(j.replies[b].id==c){g=j.replies[b];break}}if(!g){if(d){return}$.ajax({type:"GET",url:"/comment=show-replies",data:{id:j.id},success:function(k){j.replies=k;Listview.templates.comment.updateReplies(j);Listview.templates.comment.highlightReply(j,c,true)},dataType:"json"});return}var f=j.repliesCell.find(".comment-reply-row[data-replyid="+c+"]");var h="#242424";if(j.deleted){h="#402424"}else{if(j.outofdate){h="#322C1C"}}f.css("background-color","#581111");setTimeout(function(){f.animate({backgroundColor:h},1500)},1500)},updateStickyStatus:function(b){if(b.sticky){b.voteCell.find(".comment-sticky").show()}else{b.voteCell.find(".comment-sticky").hide()}},updateRepliesCell:function(l){var c=l.repliesCell;var q=$("<table></table>");c.html("");if(!l.replies.length){c.append(q).hide();return}for(var j=0;j<l.replies.length;++j){var f=l.replies[j];var r=$('<tr class="comment-reply-row"><td class="reply-controls"><p class="reply-upvote"><span class="fa fa-chevron-up"></span></p><p class="reply-rating"></p><p class="reply-downvote"><span class="fa fa-chevron-down"></span></p></td><td class="reply-text"></td></tr>');var s=$('<p class="comment-reply-author"></p>');var p=$("<a></a>");var h=new Date(f.creationdate);var o=(g_serverTime-h)/1000;var n=r.find(".reply-upvote");var m=r.find(".reply-downvote");var b=(g_user.name==f.username)||(g_user.roles&U_GROUP_COMMENTS_MODERATOR)!=0;var d=b;r.attr("data-replyid",f.id);r.attr("data-idx",j);r.find(".reply-text").addClass(WH.getStaffColorFromRoles(f.roles));var k=$("<a></a>");k.text(WH.formatDate(null,o,h));k.attr("href","#comments:id="+l.id+":reply="+f.id);k.attr("id","comments:id="+l.id+":reply="+f.id);k.addClass("when");p.attr("href","/user="+f.username);p.text(f.username);s.append(p).append(" ").append(k).append(" ").append(WH.sprintf(LANG.lvcomment_patch,WH.Wow.getVersionStringFromTimestamp(h)));var g=WH.markup.getHtml(f.body,{allow:WH.markup.CLASS.USER,mode:WH.markup.MODE.REPLY,roles:0,locale:l.locale});if(g_user.canUpvote&&g_user.name!=f.username&&!f.reportedByUser){g+=' <span class="reply-report title="'+LANG.reportthisreply_stc+'"><span class="fa fa-warning"></span></span>'}if(d){g+=' <span class="reply-edit title="'+LANG.editthisreply_stc+'"><span class="fa fa-pencil"></span></span>'}if(b){g+=' <span class="reply-delete title="'+LANG.deletethisreply_stc+'"><span class="fa fa-times"></span></span>'}r.find(".reply-text").html(s).append(g);r.find(".reply-rating").text(f.rating);if(f.votedByUser){n.attr("data-hasvoted","true")}if(g_user.canUpvote&&g_user.name!=f.username&&!f.votedByUser&&!f.downvotedByUser){n.attr("data-canvote","true")}if(f.downvotedByUser){m.attr("data-hasvoted","true")}if(g_user.canDownvote&&g_user.name!=f.username&&!f.votedByUser&&!f.downvotedByUser){m.attr("data-canvote","true")}q.append(r)}c.html(q);if(l.deleted||l.rating<-4){l.repliesCell.hide()}},updateRepliesControl:function(d){var c=d.repliesControl;c.html("").hide().unbind().attr("class","comment-replies-control");var b=Math.max(d.nreplies-d.replies.length,0);if((d.deleted||d.outofdate||d.rating<-4)||(!g_user.canPostReplies&&!b)){return}if(g_user.canPostReplies){if(!b){c.text(LANG.addreply_stc).addClass("add-reply")}else{c.text(WH.sprintf(b==1?LANG.addshow1morereply_stc:LANG.addshowmorereplies_format,b)).addClass("show-more-replies")}}else{c.text(WH.sprintf(b==1?LANG.show1morereply_stc:LANG.showmorereplies_format,b)).addClass("show-more-replies")}c.addClass("btn btn-small");c.show()},updateCommentCell:function(b){b.commentCell.find(".comment-edit").remove();this.updateCommentBody(b,b.commentBody);this.updateCommentAuthor(b,b.commentAuthor);this.updateCommentControls(b,b.commentControls)},updateCommentAuthor:function(g,d){var f=g_users[g.user];var c=new Date(g.date);var b=(g_serverTime-c)/1000;d.html("");d.append(LANG.lvcomment_by);d.append(WH.sprintf('<a href="/user=$1">$2</a>',g.user,g.user));if(f){d.append(WH.getReputationPlusAchievementText(f.gold,f.silver,f.copper,f.reputation))}d.append(WH.sprintf(' <a class="q0" id="comments:id=$1" href="#comments:id=$2">$3</a>',g.id,g.id,WH.formatDate(null,b,c)));d.append(WH.sprintf(LANG.lvcomment_patch,WH.Wow.getVersionStringFromTimestamp(c)))},updateCommentControls:function(j,c){var m=[];var d=(g_user.roles&U_GROUP_COMMENTS_MODERATOR)!=0||(j.user.toLowerCase()==g_user.name.toLowerCase()&&!g_user.commentban);var b=(g_user.roles&U_GROUP_COMMENTS_MODERATOR)!=0||(j.user.toLowerCase()==g_user.name.toLowerCase()&&!g_user.commentban);var k=(g_user.roles&U_GROUP_COMMENTS_MODERATOR)!=0;if(d){if(!j.outofdate&&!j.deleted){m.push({extraClass:"fa fa-pencil",name:LANG.lvcomment_edit,func:Listview.funcBox.coEdit.bind(this,j,0,false)})}}if(b&&!j.deleted){m.push({extraClass:"fa fa-times delete",name:LANG.lvcomment_delete,func:Listview.funcBox.coDelete.bind(this,j)})}if(k&&j.deleted){m.push({extraClass:"fa fa-times undelete",name:LANG.lvcomment_undelete,func:Listview.funcBox.coUndelete.bind(this,j)})}if(k&&j.outofdate){m.push({extraClass:"fa fa-clock-o uptodate",name:LANG.lvcomment_uptodate,func:Listview.funcBox.coFlagUpOfDate.bind(this,j)})}if(g_user.id!=0&&!j.outofdate&&!j.deleted){m.push({extraClass:"fa fa-clock-o outofdate",name:LANG.lvcomment_outofdate,func:Listview.funcBox.coFlagOutOfDate.bind(this,j)})}if(k&&!j.sticky&&!j.outofdate&&!j.deleted){m.push({extraClass:"fa fa-thumb-tack sticky",name:"Sticky",func:this.sticky.bind(this,j)})}if(k&&j.sticky&&!j.outofdate&&!j.deleted){m.push({extraClass:"fa fa-thumb-tack unsticky",name:"Unsticky",func:this.sticky.bind(this,j)})}if(!j.outofdate&&!j.deleted){m.push({extraClass:"fa fa-warning",tooltip:LANG.report_tooltip,name:LANG.lvcomment_report,func:ContactTool.show.bind(ContactTool,{mode:1,comment:j})})}c.html("");for(var l in m){var h=m[l];var g=$("<a></a>");var f=$("<span></span>");g.click(h.func);if(h.extraClass){g.addClass(h.extraClass)}if(h.tooltip){WH.Tooltip.simple(g.get(0),h.tooltip,"q2")}else{if(h.name){WH.Tooltip.simple(g.get(0),h.name,"q2")}}f.append(g);c.append(f)}},updateCommentBody:function(f,c){var d=WH.markup.rolesToClass(f.roles);c.removeClass("comment-green");c.addClass(Listview.funcBox.coGetColor(f));c.html(WH.markup.getHtml(f.body,{allow:d,mode:WH.markup.MODE.COMMENT,roles:f.roles,locale:f.locale}));if(f.response){var b=$("<div></div>");b.addClass("text comment-body");b.html(WH.markup.getHtml("[div][/div][wowheadresponse="+f.responseuser+" roles="+f.responseroles+"]"+f.response+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,roles:f.responseroles,uid:"resp-"+f.id}));c.append(b)}if(f.lastEdit){this.addEditedByOrDeletedByText(c,LANG.lvcomment_lastedit,f.lastEdit[2],f.lastEdit[0])}if(f.deletedInfo){this.addEditedByOrDeletedByText(c,LANG.lvcomment_deletedby,f.deletedInfo[1],f.deletedInfo[0])}f.divBody=c[0];if(f.deleted||f.rating<-4){c.hide()}},addEditedByOrDeletedByText:function(g,h,j,b){var d=new Date(b);var c=(g_serverTime-d)/1000;var f=$("<div></div>");f.addClass("comment-lastedit");f.html(WH.sprintf("$1 <a></a> $2 $3",h,WH.formatDate(null,c,d),WH.sprintf(LANG.lvcomment_patch,WH.Wow.getVersionStringFromTimestamp(d))));f.find("a").text(j).attr("href","/user="+j);g.append(f)},updateVoteCell:function(j){var c=j.voteCell.find(".upvote");var d=j.voteCell.find(".downvote");var h=j.voteCell.find(".rating-container");var b=$('<p class="rating"></p>');var f=this;h.html(b);var g=j.hasOwnProperty("langOverride")?j.langOverride:LANG;if(j.userRating>0){c.attr("data-hasvoted","true").attr("title",g.upvoted_tip)}else{c.attr("data-hasvoted","false").attr("title",g.upvote_tip)}if(j.userRating<0){d.attr("data-hasvoted","true").attr("title",g.downvoted_tip)}else{d.attr("data-hasvoted","false").attr("title",g.downvote_tip)}b.unbind();c.unbind();d.unbind();b.text(j.rating);b.click(function(){f.showVoteBreakdown(j,h)});c.click(function(){f.vote(j,1)});d.click(function(){f.vote(j,-1)});if(j.deleted||j.rating<-4){j.voteCell.hide()}},vote:function(j,f){if(!f){return}var g=j.hasOwnProperty("langOverride")?j.langOverride:LANG;if(!g_user.id){this.voteError(j,g.votelogin_tip);return}if(j.deleted){this.voteError(j,g.votedeleted_tip);return}if(g_user.name==j.user){this.voteError(j,g.voteself_tip);return}if(!g_user.canUpvote&&f>0){this.voteError(j,WH.sprintf(g.upvotenorep_tip,g_user.upvoteRep));return}if(!g_user.canDownvote&&f<0){this.voteError(j,WH.sprintf(g.downvotenorep_tip,g_user.downvoteRep));return}if(f>0){f=g_user.superCommentVotes?2:1}else{if(f<0){f=g_user.superCommentVotes?-2:-1}else{return}}var h=j.rating;var c=j.userRating;var d=this;if((j.userRating>0&&f>0)||(j.userRating<0&&f<0)){j.rating-=j.userRating;j.userRating=0}else{j.rating-=j.userRating;j.rating+=f;j.userRating=f}this.updateVoteCell(j);var b="/comment=vote";if(j.hasOwnProperty("voteUrl")){b=j.voteUrl}$.get(b,{id:j.id,rating:f},function(k){if(k.error){j.rating=h;j.userRating=c;d.updateVoteCell(j)}if(k.message){d.voteError(j,k.message)}},"json")},voteError:function(c,b){MessageBox(c.voteCell,b)},showVoteBreakdown:function(d,c){c.find("p").html('<img src="'+g_staticUrl+'/images/icons/ajax.gif" />');var b="/comment=rating";if(d.hasOwnProperty("ratingUrl")){b=d.ratingUrl}$.get(b+"&id="+d.id,null,function(f){if(f.success){c.html(WH.sprintf('<p class="rating-up">$1</p><div class="rating-separator"></div><p class="rating-down">$2</p>',(f.up?("+"+f.up):0),-f.down))}else{MessageBox(c,"An error has occurred while fetching vote counts. Try refreshing the page.")}},"json")},sticky:function(c){var b=c.commentCell.find(".comment-notification");c.sticky=!c.sticky;this.updateStickyStatus(c);this.updateCommentCell(c);if(c.sticky){MessageBox(b,"This comment is now sticky.")}else{MessageBox(b,"This comment is no longer sticky.")}$.post("/comment=sticky",{id:c.id,sticky:c.sticky?1:0})},createNote:function(c){var h=WH.ce("small");if(!g_user.commentban){var q=WH.ce("a");if(g_user.id>0){q.href="javascript:;";q.onclick=co_addYourComment}else{q.href="/account=signin"}WH.ae(q,WH.ct(LANG.lvcomment_add));WH.ae(h,q);var g=WH.ce("span");g.style.padding="0 5px";g.style.color="white";WH.ae(g,WH.ct("|"));WH.ae(h,g)}WH.ae(h,WH.ct(LANG.sort+": "));var t=WH.ce("a");t.href="javascript:;";WH.ae(t,WH.ct(LANG.newestfirst_stc));t.onclick=Listview.funcBox.coSortNewestFirst.bind(this,t);WH.ae(h,t);WH.ae(h,WH.ct(LANG.comma));var s=WH.ce("a");s.href="javascript:;";WH.ae(s,WH.ct(LANG.oldestfirst_stc));s.onclick=Listview.funcBox.coSortOldestFirst.bind(this,s);WH.ae(h,s);WH.ae(h,WH.ct(LANG.comma));var r=WH.ce("a");r.href="javascript:;";WH.ae(r,WH.ct(LANG.highestrated_stc));r.onclick=Listview.funcBox.coSortHighestRatedFirst.bind(this,r);WH.ae(h,r);var j=WH.getCookies()["comments_sort"];switch(j){case"1":t.onclick();break;case"2":s.onclick();break;default:case"3":r.onclick();break}var g=WH.ce("span");g.style.padding="0 5px";g.style.color="white";WH.ae(g,WH.ct("|"));WH.ae(h,g);var o=WH.ce("select");var l=WH.ce("option");l.value=0;l.selected="selected";WH.ae(o,l);var n={};for(var m=0;m<this.data.length;++m){var k=WH.Wow.getPatchVersionObject(new Date(this.data[m].date).getTime());if(k){n[k.build]=k}}var b=[];for(var f in n){b.push(f)}b.sort(function(p,d){return d-p});for(var f=0;f<b.length;++f){var l=WH.ce("option");l.value=n[b[f]].timestamp;WH.ae(l,WH.ct(n[b[f]].version));WH.ae(o,l)}o.onchange=Listview.funcBox.coFilterByPatchVersion.bind(this,o);WH.ae(h,WH.ct(LANG.lvcomment_patchfilter));WH.ae(h,o);WH.ae(c,h);if(this.tabClick){$("a, select",h).click(this.tabClick)}},onNoData:function(d){var b="<b>"+LANG.lvnodata_co1+'</b><div class="pad2"></div>';if(g_user.id>0){var c=LANG.lvnodata_co2;c=c.replace("<a>",'<a href="javascript:;" onclick="co_addYourComment()" onmousedown="return false">');b+=c}else{var c=LANG.lvnodata_co3;c=c.replace("<a>",'<a href="/account=signin">');c=c.replace("<a>",'<a href="/account=signup">');b+=c}d.style.padding="1.5em 0";d.innerHTML=b},onBeforeCreate:function(){if(location.hash&&location.hash.match(/:id=([0-9]+)/)!=null){var b=WH.getCookies()["comments_sort"];switch(b){case"1":this.setSort([-5,4,-1,-2],false,false);break;case"2":this.setSort([-5,4,1,2],false,false);break;default:case"3":this.setSort([-5,4,-3,2],false,false);break}var c=WH.inArray(this.data,parseInt(RegExp.$1),function(d){return d.id});this.rowOffset=this.getRowOffset(c);return this.data[c]}},onAfterCreate:function(b){if(b!=null){var c=b.__div;this.tabs.__st=c}}};Listview.templates.commentpreview={sort:[4],nItemsPerPage:75,columns:[{id:"subject",name:LANG.subject,align:"left",value:"subject",compute:function(g,f){var b=WH.ce("a");b.className="listview-cleartext"+(typeof g.quality=="number"?" q"+g.quality:"");b.href=this.getItemLink(g);if(g.icon){b.className+=" icontiny tinyspecial";b.style.backgroundImage='url("'+g_staticUrl+"/images/wow/icons/tiny/"+g.icon.toLowerCase()+'.gif")'}WH.ae(b,WH.ct(g.subject));WH.ae(f,b);if(LANG.types[g.type]){var c=WH.ce("div");c.className="small";WH.ae(c,WH.ct(LANG.types[g.type][0]));WH.ae(f,c)}}},{id:"preview",name:LANG.preview,align:"left",width:"50%",value:"preview",compute:function(j,h,c){var f=WH.ce("div");f.className="crop";if(j.rating>=10){f.className+=" comment-green"}WH.ae(f,WH.ct(WH.markup.stripTags(j.preview,{mode:WH.markup.MODE.ARTICLE})));WH.ae(h,f);f=WH.ce("div");f.className="small3";if(j.rating){WH.ae(f,WH.ct(LANG.lvcomment_rating+(j.rating>0?"+":"")+j.rating))}var b=WH.ce("span"),g="";b.className="q10";if(j.deleted){g=LANG.lvcomment_deleted}WH.ae(b,WH.ct(g));WH.ae(f,b);c.__status=b;WH.ae(h,f)}},{id:"author",name:LANG.author,value:"user",compute:function(d,c){c.className="q1";var b=WH.ce("a");b.href="/user="+d.user;WH.ae(b,WH.ct(d.user));WH.ae(c,b)}},{id:"posted",name:LANG.posted,width:"16%",value:"elapsed",compute:function(g,f){var c=new Date(g.date),b=(g_serverTime-c)/1000;var d=WH.ce("span");WH.formatDate(d,b,c,0,1);WH.ae(f,d)}}],getItemLink:function(c){var b=WH.getCommentDomain(c.domain);if(b==""&&c.hasOwnProperty("locale")&&c.locale!=Locale.getId()){b="//"+Locale.locales[c.locale].domain}if(c.url){return b+"/"+c.url}if(!g_types[c.type]){return b+"/go-to-comment&id="+c.id}return b+"/"+g_types[c.type]+"="+c.typeId+(c.id!=null?"#comments:id="+c.id:"")}};Listview.templates.replypreview={sort:[4],nItemsPerPage:75,columns:[{id:"subject",name:LANG.subject,align:"left",value:"subject",compute:function(c,g){var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(c);WH.ae(b,WH.ct(c.subject));WH.ae(g,b);if(LANG.types[c.type]){var f=WH.ce("div");f.className="small";WH.ae(f,WH.ct(LANG.types[c.type][0]));WH.ae(g,f)}}},{id:"preview",name:LANG.preview,align:"left",width:"50%",value:"preview",compute:function(c,j,f){var g=WH.ce("div");g.className="crop";if(c.rating>=10){g.className+=" comment-green"}WH.ae(g,WH.ct(WH.markup.stripTags(c.preview,{mode:WH.markup.MODE.ARTICLE})));WH.ae(j,g);g=WH.ce("div");g.className="small3";if(c.rating){WH.ae(g,WH.ct(LANG.lvcomment_rating+(c.rating>0?"+":"")+c.rating))}var b=WH.ce("span"),h="";if(c.deleted){h=LANG.lvcomment_deleted}b.className="q10";WH.ae(b,WH.ct(h));WH.ae(g,b);f.__status=b;WH.ae(j,g)}},{id:"author",name:LANG.author,value:"user",compute:function(c,d){d.className="q1";var b=WH.ce("a");b.href="/user="+c.user;WH.ae(b,WH.ct(c.user));WH.ae(d,b)}},{id:"posted",name:LANG.posted,width:"16%",value:"elapsed",compute:function(f,g){var c=new Date(f.date),b=(g_serverTime-c)/1000;var d=WH.ce("span");WH.formatDate(d,b,c,0,1);WH.ae(g,d)}}],getItemLink:function(b){var c=WH.getCommentDomain(b.domain);if(c==""&&b.hasOwnProperty("locale")&&b.locale!=Locale.getId()){c="//"+Locale.locales[b.locale].domain}if(b.url){return c+"/"+b.url}if(!g_types[b.type]){return c+"/go-to-reply&id="+b.id}return WH.sprintf("$1/$2=$3#comments:id=$4:reply=$5",c,g_types[b.type],b.typeId,b.commentid,b.id)}};Listview.templates.screenshot={sort:[],mode:3,nItemsPerPage:40,nItemsPerRow:4,poundable:2,columns:[],compute:function(m,g,l){var t;g.className="screenshot-cell screenshot-cell-clickable";g.vAlign="bottom";var r=WH.ce("a");r.href=WH.getScreenshotUrl(m.id,"normal",ScreenshotViewer.getScreenshotDescription(m));r.onclick=(function(s,d,y){y.stopPropagation();if(WH.isLeftClick(y)){ScreenshotViewer.show({screenshots:this.data,pos:l});y.preventDefault();return false}}).bind(this,this.id,m.id);var w=WH.ce("img"),u=Math.min(150/m.width,150/m.height);w.src=WH.getScreenshotUrl(m.id,"small");WH.ae(r,w);WH.ae(g,r);var p=WH.ce("div");p.className="screenshot-cell-user";var n=(m.user!=null&&m.user.length);if(n){r=WH.ce("a");r.href="/user="+m.user;WH.ae(r,WH.ct(m.user));WH.ae(p,WH.ct(LANG.lvscreenshot_from));WH.ae(p,r);WH.ae(p,WH.ct(" "))}if(m.date){var q=new Date(m.date);var k=WH.ce("span");if(n){WH.formatDate(k,(g_serverTime-q)/1000,q)}else{WH.formatDate(k,(g_serverTime-q)/1000,q,0,1)}WH.ae(p,k);WH.ae(p,WH.ct(" "+LANG.dash+" "));var r=WH.ce("a");r.href="javascript:;";r.className="icon-report";if((typeof this.deletefunction!="function")||(!this.deletefunction)){r.onclick=ContactTool.show.bind(ContactTool,{mode:3,screenshot:m});WH.Tooltip.simple(r,LANG.report_tooltip,"q2");WH.ae(r,WH.ct(LANG.report))}else{WH.aE(r,"click",(function(d,s){return function(){d(s)}})(this.deletefunction,m));WH.ae(r,WH.ct("Delete"))}WH.ae(p,r)}WH.ae(g,p);p=WH.ce("div");p.className="screenshot-caption-wrapper";if(Locale.getId()!=LOCALE_ENUS&&m.caption){m.caption=""}var b=(m.caption!=null&&m.caption.length);var j=(m.subject!=null&&m.subject.length);if(b||j){var v=WH.ce("div");v.className="screenshot-caption";if(j){var f=WH.ce("small");var h=LANG.types.hasOwnProperty(m.type)?LANG.types[m.type][0]:("Entity "+m.type);WH.ae(f,WH.ct(h+LANG.colon));var c=WH.ce("a");if(m.hasOwnProperty("subjectQuality")){c.className="q"+m.subjectQuality}if(m.hasOwnProperty("subjectRel")){c.rel=m.subjectRel}WH.ae(c,WH.ct(m.subject));c.href=WH.getCommentDomain(m.domain)+"/"+g_types[m.type]+"="+m.typeId;WH.ae(f,c);WH.ae(v,f);if(b&&m.caption.length){WH.ae(f,WH.ct(" (...)"))}WH.ae(f,WH.ce("br"))}if(b){WH.aE(g,"mouseover",Listview.funcBox.ssCellOver.bind(v));WH.aE(g,"mouseout",Listview.funcBox.ssCellOut.bind(v));var o=WH.ce("span");o.innerHTML=WH.markup.getHtml(m.caption,{mode:WH.markup.MODE.SIGNATURE});WH.ae(v,o)}WH.ae(p,v)}WH.aE(g,"click",Listview.funcBox.ssCellClick.bind(this,l));WH.ae(g,p)},createNote:function(d){if(typeof g_pageInfo=="object"&&g_pageInfo.type>0&&g_pageInfo.type!=150){var c=WH.ce("small");var b=WH.ce("a");if(g_user.id>0){b.href="javascript:;";b.onclick=ss_submitAScreenshot}else{b.href="/account=signin"}WH.ae(b,WH.ct(LANG.lvscreenshot_submit));WH.ae(c,b);WH.ae(d,c)}},onNoData:function(d){if(typeof g_pageInfo=="object"&&g_pageInfo.type>0){var b="<b>"+LANG.lvnodata_ss1+'</b><div class="pad2"></div>';if(g_user.id>0){var c=LANG.lvnodata_ss2;c=c.replace("<a>",'<a href="javascript:;" onclick="ss_submitAScreenshot()" onmousedown="return false">');b+=c}else{var c=LANG.lvnodata_ss3;c=c.replace("<a>",'<a href="/account=signin">');c=c.replace("<a>",'<a href="/account=signup">');b+=c}d.style.padding="1.5em 0";d.innerHTML=b}else{return -1}},onBeforeCreate:function(){if(location.hash&&location.hash.match(/:id=([0-9]+)/)!=null){var b=WH.inArray(this.data,parseInt(RegExp.$1),function(c){return c.id});this.rowOffset=this.getRowOffset(b);return b}},onAfterCreate:function(b){if(b!=null){setTimeout((function(){ScreenshotViewer.show({screenshots:this.data,pos:b})}).bind(this),1)}}};Listview.templates.video={sort:[],mode:3,nItemsPerPage:40,nItemsPerRow:4,poundable:2,columns:[],compute:function(c,f,h){var r,k=new Date(c.date),t=(g_serverTime-k)/1000;f.className="screenshot-cell screenshot-cell-clickable";f.vAlign="bottom";var q=WH.ce("a");q.href="#videos:id="+c.id;q.onclick=WH.rfWithoutControlKey;var j=WH.ce("img");j.src=WH.sprintf(vi_thumbnails[c.videoType],c.videoId);WH.ae(q,j);WH.ae(f,q);var m=WH.ce("div");m.className="screenshot-cell-user";var u=(c.user!=null&&c.user.length);if(u){q=WH.ce("a");q.href="/user="+c.user;WH.ae(q,WH.ct(c.user));WH.ae(m,WH.ct(LANG.lvvideo_from));WH.ae(m,q);WH.ae(m,WH.ct(" "))}var v=WH.ce("span");if(u){WH.formatDate(v,t,k)}else{WH.formatDate(v,t,k,0,1)}WH.ae(m,v);WH.ae(f,m);m=WH.ce("div");m.className="screenshot-caption-wrapper";if(Locale.getId(true)!=LOCALE_ENUS&&c.caption){c.caption=""}var l=(c.caption!=null&&c.caption.length);var g=(c.subject!=null&&c.subject.length);if(l||g){var b=WH.ce("div");b.className="screenshot-caption";if(g){var p=WH.ce("small");WH.ae(p,WH.ct(LANG.types[c.type][0]+LANG.colon));var o=WH.ce("a");WH.ae(o,WH.ct(c.subject));o.href=WH.getCommentDomain(c.domain)+"/"+g_types[c.type]+"="+c.typeId;WH.ae(p,o);WH.ae(b,p);if(l&&c.caption.length){WH.ae(p,WH.ct(" (...)"))}WH.ae(p,WH.ce("br"))}if(l){WH.aE(f,"mouseover",Listview.funcBox.ssCellOver.bind(b));WH.aE(f,"mouseout",Listview.funcBox.ssCellOut.bind(b));var n=WH.ce("span");n.innerHTML=WH.markup.getHtml(c.caption,{mode:WH.markup.MODE.SIGNATURE});WH.ae(b,n)}WH.ae(m,b)}WH.aE(f,"click",Listview.funcBox.viCellClick.bind(this,h));WH.ae(f,m)},createNote:function(d){if(g_user&&g_user.roles&(U_GROUP_ADMIN|U_GROUP_BUREAU|U_GROUP_VIDEO)){if(typeof g_pageInfo=="object"&&g_pageInfo.type>0){var c=WH.ce("small");var b=WH.ce("a");if(g_user.id>0){b.href="javascript:;";b.onclick=vi_submitAVideo}else{b.href="/account=signin"}WH.ae(b,WH.ct(LANG.lvvideo_suggest));WH.ae(c,b);WH.ae(d,c)}}},onNoData:function(d){if(typeof g_pageInfo=="object"&&g_pageInfo.type>0){var b="<b>"+LANG.lvnodata_vi1+'</b><div class="pad2"></div>';if(g_user.id>0){var c=LANG.lvnodata_vi2;c=c.replace("<a>",'<a href="javascript:;" onclick="vi_submitAVideo()" onmousedown="return false">');b+=c}else{var c=LANG.lvnodata_vi3;c=c.replace("<a>",'<a href="/account=signin">');c=c.replace("<a>",'<a href="/account=signup">');b+=c}d.style.padding="1.5em 0";d.innerHTML=b}else{return -1}},onBeforeCreate:function(){if(location.hash&&location.hash.match(/:id=([0-9]+)/)!=null){var b=WH.inArray(this.data,parseInt(RegExp.$1),function(c){return c.id});this.rowOffset=this.getRowOffset(b);return b}},onAfterCreate:function(b){if(b!=null){setTimeout((function(){VideoViewer.show({videos:this.data,pos:b,displayAd:true})}).bind(this),1)}}};Listview.templates.model={sort:[],mode:3,nItemsPerPage:40,nItemsPerRow:4,poundable:2,columns:[],compute:function(f,l,g){l.className="screenshot-cell screenshot-cell-clickable";l.vAlign="bottom";var b=WH.ce("a");b.href="javascript:;";b.onclick=this.template.modelShow.bind(this.template,f.npcId,f.displayId,false);var c=WH.ce("img");c.src=g_staticUrl+ModelViewer.getStaticBase()+"/thumbs/npc/"+f.displayId+".png";WH.ae(b,c);WH.ae(l,b);var k=WH.ce("div");k.className="screenshot-cell-user";b=WH.ce("a");b.href="/npcs=1?filter="+(f.family?"fa="+f.family+";":"")+"minle=1;cr=35;crs=0;crv="+f.skin;WH.ae(b,WH.ct(f.skin));WH.ae(k,b);WH.ae(k,WH.ct(" ("+f.count+")"));WH.ae(l,k);k=WH.ce("div");k.className="screenshot-caption-wrapper";var j=WH.ce("div");j.className="screenshot-caption";var h=WH.ce("small");WH.ae(h,WH.ct(LANG.level+": "));WH.ae(h,WH.ct((f.minLevel==9999?"??":f.minLevel)+(f.minLevel==f.maxLevel?"":LANG.hyphen+(f.maxLevel==9999?"??":f.maxLevel))));WH.ae(h,WH.ce("br"));WH.ae(j,h);WH.ae(k,j);WH.ae(l,k);WH.aE(l,"click",this.template.modelShow.bind(this.template,f.npcId,f.displayId,true))},modelShow:function(f,c,g,h){if(g){h=WH.normalizeEvent(h);if(h.shiftKey||h.ctrlKey){return}var b=0,d=h._target;while(d&&b<3){if(d.nodeName=="A"){return}if(d.nodeName=="IMG"){break}d=d.parentNode}}ModelViewer.show({type:1,typeId:f,displayId:c,noPound:1})}};Listview.templates.genericmodel={sort:[1],mode:3,nItemsPerPage:40,nItemsPerRow:4,poundable:2,columns:[{value:"name",sortFunc:function(d,c){return Listview.templates.genericmodel.sortFunc(d,c)}}],compute:function(k,g,j){g.className="screenshot-cell";g.vAlign="bottom";var o,t,s,r,m;var q="";var f=("modelviewer" in k)?k.modelviewer:k;if("modelviewer" in k){o=k.modelviewer.displayid;m=k.modelviewer.typeid;t=k.modelviewer.type;r=k.slot}else{if("npcmodel" in k){o=k.npcmodel;m=k.id;t=1}else{if("displayid" in k){o=k.displayid;m=k.id;t=3;r=k.slotbak||k.slot;var c=Listview.funcBox.getCurrentItemBonuses.call(this,k);if(c.length>0){q="&bonus="+c.join(":")}var l=g_items.getAppearance(k.id,c);if(l!=null&&l[0]){o=l[0]}}}}switch(t){case 1:s="npc";break;case 3:s="item";break;default:s="item";break}if(o){var p=WH.ce("a");p.href="javascript:;";p.rel=this.genericlinktype+"="+k.id+q;p.onclick=this.template.modelShow.bind(this.template,t,m,o,r,false);var h=WH.ce("img");h.src=g_staticUrl+ModelViewer.getStaticBase()+"/thumbs/"+s+"/"+o+".png";h.onerror=function(){this.parentNode.className="model-image-load-failed"};WH.ae(p,h);WH.ae(g,p)}var n=WH.ce("div");n.className="screenshot-caption-wrapper";var b=WH.ce("div");b.className="screenshot-caption";var p=WH.ce("a");p.className="q"+((this.genericlinktype=="item")?g_items[k.id].quality:"");p.href="/"+this.genericlinktype+"="+k.id+q;WH.ae(p,WH.ct(k.name.substr(1)));WH.ae(b,p);WH.ae(n,b);WH.ae(g,n);if(o){g.className+=" screenshot-cell-clickable";WH.aE(g,"click",this.template.modelShow.bind(this.template,t,m,o,r,true))}},modelShow:function(b,l,d,m,c,k){if(c){k=WH.normalizeEvent(k);if(k.shiftKey||k.ctrlKey){return}var h=0,g=k._target;while(g&&h<3){if(g.nodeName=="A"){return}if(g.nodeName=="IMG"){break}g=g.parentNode}}var f={type:b,typeId:l,displayId:d,noPound:1};if(typeof m!="undefined"){f.slot=m}ModelViewer.show(f)},sortFunc:function(d,c,f){return(WH.stringCompare(d.hasOwnProperty("slot")?Listview.templates.genericmodel.translateSlot(d.slot):0,c.hasOwnProperty("slot")?Listview.templates.genericmodel.translateSlot(c.slot):0)||WH.stringCompare(d.hasOwnProperty("classs")?d.classs:0,c.hasOwnProperty("classs")?c.classs:0)||WH.stringCompare(d.hasOwnProperty("subclass")?d.subclass:0,c.hasOwnProperty("subclass")?c.subclass:0)||WH.stringCompare(d.displayid,c.displayid)||WH.stringCompare(d.name,c.name)||-WH.stringCompare(d.level,c.level))},translateSlot:function(b){if(g_item_slots_to_character_slots.hasOwnProperty(b)){if(WH.isArray(g_item_slots_to_character_slots[b])){return parseInt(g_item_slots_to_character_slots[b][0],10)}return parseInt(g_item_slots_to_character_slots[b])}return 0},nextRowCheckTypeOrSlot:function(d,f){if(!f||!d){return false}var c,b;c=d.hasOwnProperty("slot")?Listview.templates.genericmodel.translateSlot(d.slot):0;b=f.hasOwnProperty("slot")?Listview.templates.genericmodel.translateSlot(f.slot):0;if(c!=b){return true}c=d.hasOwnProperty("classs")?d.classs:0;b=f.hasOwnProperty("classs")?f.classs:0;if(c!=b){return true}if(c==4){if(d.hasOwnProperty("subclass")){if(!(f.hasOwnProperty("subclass")&&d.subclass==f.subclass)&&(this.breakCosmetic||(d.subclass!=5&&f.subclass!=5))){return true}}}return false}};Listview.templates.changelog={nItemsPerPage:100,sortable:false,columns:[{id:"name",name:"Name",compute:function(b,d){var c=$(b.tooltip).find("b").first().text();$(d).html(c);d.className+=" listview-cleartext"}},{id:"version",name:"Version (mouseover to see tooltip)",compute:function(g,j){var d=g.tooltip;$(j).mouseover((function(k,l){WH.Tooltip.showAtCursor(l,k,0,0)}).bind(j,d));$(j).mousemove(function(k){WH.Tooltip.cursorUpdate(k)}).mouseout(function(){WH.Tooltip.hide()});if(!WH.Wow.getPatchVersionObject.hasOwnProperty("parsed")){WH.Wow.getPatchVersionObject()}var h=(g.build>0?"":"Before ")+"Build "+Math.abs(g.build);if(g.version>0){var f=(parseInt(g.version/10000))+"."+((parseInt(g.version/100))%100)+"."+(g.version%100);h=f+" "+h;var c=false;for(var b in g_wow_builds){if(g_wow_builds[b].versionNum>=g.version&&(!c||c.build>g_wow_builds[b].build)){c=g_wow_builds[b]}}if(c){h=h.replace(f,f+" ("+new Date(c.timestamp).toDateString()+")")}}$(j).html(h)}}]};Listview.templates.affix={sort:[1,3],mode:0,nItemsPerPage:50,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",span:2,compute:function(c,j,g){var d=WH.ce("td");d.style.width="1px";d.style.paddingRight="0";d.style.borderRight="none";var f=Icon.create(c.icon,(this.iconSize==null?0:this.iconSize),null,this.getItemLink(c));WH.ae(d,f);WH.ae(g,d);j.style.borderLeft="none";var h=WH.ce("div");WH.ae(j,h);var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(c);WH.ae(b,WH.ct(c.name));WH.ae(h,b)},getVisibleText:function(b){return b.name}},{id:"description",name:LANG.description,type:"text",align:"left",compute:function(b,c){c.innerHTML=b.description},getVisibleText:function(b){return b.description},sortFunc:function(d,c){return WH.stringCompare(d.description,c.description)}}],getItemLink:function(b){return"/affix="+b.id}};Listview.templates["bfa-champion"]={sort:[5,1],mode:1,searchable:1,filtrable:1,completionText:LANG.lvcompletion_collection,columns:[{id:"namealliance",name:LANG.som.alliance+" "+LANG.name,type:"text",align:"left",value:"namealliance",compute:function(f,j,c){var b=WH.ce("a");b.className="q"+f.quality+" listview-cleartext";b.href=this.getItemLink(f,1);if(f.hasOwnProperty("abilities")&&WH.isArray(f.abilities)&&f.hasOwnProperty("custom")&&f.custom){b.rel="q="+f.quality+"&level="+f.level+"&abil="+f.abilities.join(":")}j.style.paddingLeft="2.5em";if(f.portraitalliance){j.style.backgroundImage='url("'+g_staticUrl+"/images/wow/garr/"+f.portraitalliance+'.png")';j.style.backgroundRepeat="no-repeat";j.style.backgroundSize="3em 3em";j.style.backgroundPosition="-0.75em -0.25em"}WH.ae(b,WH.ct(f.namealliance));var h=WH.ce("div");WH.ae(j,h);WH.ae(h,b);if(f.hasOwnProperty("active")&&!parseInt(f.active)){h.style.position="relative";var g=WH.ce("div");g.className="listview-name-info q10";WH.ae(g,WH.ct(LANG.inactive));WH.aef(h,g)}WH.ae(j,h)}},{id:"classalliance",name:LANG.som.alliance+" "+LANG.classs,type:"text",align:"left",value:"classalliance",width:"20%",compute:function(c,d,b){WH.st(d,c.classalliance)}},{id:"namehorde",name:LANG.som.horde+" "+LANG.name,type:"text",align:"left",value:"namehorde",compute:function(f,j,c){var b=WH.ce("a");b.className="q"+f.quality+" listview-cleartext";b.href=this.getItemLink(f,2);if(f.hasOwnProperty("abilities")&&WH.isArray(f.abilities)&&f.hasOwnProperty("custom")&&f.custom){b.rel="q="+f.quality+"&level="+f.level+"&abil="+f.abilities.join(":")}j.style.paddingLeft="2.5em";if(f.portraithorde){j.style.backgroundImage='url("'+g_staticUrl+"/images/wow/garr/"+f.portraithorde+'.png")';j.style.backgroundRepeat="no-repeat";j.style.backgroundSize="3em 3em";j.style.backgroundPosition="-0.75em -0.25em"}WH.ae(b,WH.ct(f.namehorde));var h=WH.ce("div");WH.ae(j,h);WH.ae(h,b);if(f.hasOwnProperty("active")&&!f.active){h.style.position="relative";var g=WH.ce("div");g.className="listview-name-info q10";WH.ae(g,WH.ct(LANG.inactive));WH.aef(h,g)}WH.ae(j,h)}},{id:"classhorde",name:LANG.som.horde+" "+LANG.classs,type:"text",align:"left",value:"classhorde",width:"20%",compute:function(c,d,b){WH.st(d,c.classhorde)}},{id:"type",name:LANG.type,type:"text",width:"10%",compute:function(c,d){var b=WH.ce("span");WH.st(b,(c.flags&1)?LANG.types[38][0]:LANG.troop);WH.ae(d,b)},sortFunc:function(d,c){return WH.stringCompare(c.flags&1,d.flags&1)}},{id:"counters",name:LANG.counters,hidden:1,type:"text",width:"168px",compute:function(b,g){if(!b.hasOwnProperty("abilities")){return}var j=b.abilities;if(!WH.isArray(j)){if((WH.inArray(this.hiddenCols,"namehorde")!=-1)&&j.hasOwnProperty("1")){j=j["1"]}else{if((WH.inArray(this.hiddenCols,"namealliance")!=-1)&&j.hasOwnProperty("2")){j=j["2"]}else{return}}}g.style.padding="0 6px";g.style.textAlign="left";for(var m=0;m<j.length;m++){var k=g_mission_abilities[j[m]];for(var f in k.counters){if(!k.counters.hasOwnProperty(f)){continue}if(!g_garrison_mechanics.hasOwnProperty(k.counters[f])){continue}var c=g_garrison_mechanics[k.counters[f]];var l=WH.ce("div");l.style.display="inline-block";if(c.hasOwnProperty("icon")){var h=Icon.create(c.icon,0,null,"/mission-ability="+k.id);h.className+=" garrison-ability";h.style.cssFloat="left";WH.ae(l,h)}WH.ae(g,l)}}},getVisibleText:function(f){var d="";if(!f.hasOwnProperty("abilities")){return d}var h=f.abilities;if(!WH.isArray(h)){if((WH.inArray(this.hiddenCols,"namehorde")!=-1)&&h.hasOwnProperty("1")){h=h["1"]}else{if((WH.inArray(this.hiddenCols,"namealliance")!=-1)&&h.hasOwnProperty("2")){h=h["2"]}else{return d}}}for(var b=0;b<h.length;b++){var c=g_mission_abilities[h[b]];for(var g in c.counters){if(!c.counters.hasOwnProperty(g)){continue}d+=c.counters[g].name+" "}}return d}},{id:"quality",name:LANG.quality,type:"text",value:"quality",width:"10%",compute:function(c,d){var b=WH.ce("span");b.className="q"+c.quality;WH.st(b,g_item_qualities[c.quality]);WH.ae(d,b)},sortFunc:function(d,c){return WH.stringCompare(d.quality,c.quality)}},{id:"level",name:LANG.level,hidden:1,type:"number",value:"level",width:"5%"},{id:"itemlevelaverage",name:LANG.avg,type:"number",value:"avgilvl",width:"5%",hidden:1},{id:"itemlevelweapon",name:g_item_classes[2],hidden:1,type:"number",value:"itemlevelweapon",width:"5%"},{id:"itemlevelarmor",name:g_item_classes[4],hidden:1,type:"number",value:"itemlevelarmor",width:"5%"},{id:"completed",name:LANG.completion,width:"10%",hidden:true,compute:function(b,c,j,m){var h=3;if(this.hiddenCols){for(var l=0;l<this.hiddenCols.length;l++){if(this.hiddenCols[l]=="namealliance"){h=2;break}if(this.hiddenCols[l]=="namehorde"){h=1;break}}}if(b.npcalliance==b.npchorde){h=false}for(var f in g_user.lists){var g=g_user.lists[f];if(!(g.id in g_completion["bfa-champion"])||!g.character){continue}var d=(WH.inArray(g_completion["bfa-champion"][g.id],b.id)!=-1);if(h){if(h!=3){d|=(WH.inArray(g_completion["bfa-champion"][g.id],""+b.id+"."+h)!=-1)}else{d|=(WH.inArray(g_completion["bfa-champion"][g.id],""+b.id+".1")!=-1);d|=(WH.inArray(g_completion["bfa-champion"][g.id],""+b.id+".2")!=-1)}}var k=WH.ce("a");k.href="/list="+g.id+"/"+g.url;k.className="progress-icon "+(d?"progress-8":"progress-0");WH.Tooltip.simple(k,WH.getCompletionTooltip(g,d),"",true);WH.ae(c,k)}},sortFunc:function(g,f,h){var j=3;if(this.hiddenCols){for(var d=0;d<this.hiddenCols.length;d++){if(this.hiddenCols[d]=="namealliance"){j=2;break}if(this.hiddenCols[d]=="namehorde"){j=1;break}}}var c=j,l=j;if(g.npcalliance==g.npchorde){c=false}if(f.npcalliance==f.npchorde){l=false}var k=function(q,n){var b=0;if(!g_user.lists){return b}for(var m=g_user.lists.length-1;m>=0;m--){var p=g_user.lists[m];if(!(p.id in g_completion["bfa-champion"])||!p.character){continue}var o=WH.inArray(g_completion["bfa-champion"][p.id],q)!=-1;if(n){if(n!=3){o|=(WH.inArray(g_completion["bfa-champion"][p.id],""+q+"."+n)!=-1)}else{o|=(WH.inArray(g_completion["bfa-champion"][p.id],""+q+".1")!=-1);o|=(WH.inArray(g_completion["bfa-champion"][p.id],""+q+".2")!=-1)}}b=(b<<1)|(o?1:0)}return b};return WH.stringCompare(k(g.id,c),k(f.id,l))}}],getItemLink:function(d,c){if(!c&&this.hiddenCols){for(var b=0;b<this.hiddenCols.length;b++){if(this.hiddenCols[b]=="namealliance"){c=2;break}if(this.hiddenCols[b]=="namehorde"){c=1;break}}}if(d.npcalliance==d.npchorde){c=false}return"/bfa-champion="+d.id+(c?("."+c):"")},onBeforeCreate:function(){for(var b in this.columns){if((this.columns[b].id=="completed")&&(this.columns[b].hidden)){if((!(this.hasOwnProperty("completionMode")&&this.completionMode))&&WH.isSet("g_user")&&("lists" in g_user)&&("bfa-champion" in g_completion)&&(WH.inArray(this.hiddenCols,this.columns[b].id)==-1)){this.visibility.push(parseInt(b));break}}}}};Listview.templates["bfa-champion-gallery"]={sort:[1,2],mode:3,nItemsPerPage:48,nItemsPerRow:4,poundable:1,sortOptions:[{id:"name",name:LANG.name,sortFunc:function(d,c){var f=this.id.indexOf("horde")>=0?"horde":"alliance";return WH.stringCompare(d["name"+f],c["name"+f])}},{id:"level",name:LANG.level,value:"level"}],columns:[],value:"name",compute:function(c,h,k){var n=this.id.indexOf("horde")>=0?"horde":"alliance";var f=(n=="horde"?"2":"1");h.className="follower-cell";var o=WH.ce("a");o.className="follower-cell-follower";o.href="/bfa-champion="+c.id+"."+f;var p=224;var g=160;var m=(p/g)*100;var j=WH.ce("span");j.style.backgroundImage='url("'+g_staticUrl+"/images/wow/garr/npcmodels/"+c["npc"+n]+'.jpg"),url("'+g_staticUrl+"/images/wow/garr/"+c["portrait"+n]+'.png")';j.style.backgroundSize="cover, 80% auto";j.style.backgroundPosition="center";j.style.width=g+"px";var q=WH.ce("span");q.style.display="block";q.style.paddingTop=m+"%";WH.ae(j,q);WH.ae(o,j);WH.ae(h,o);var l=WH.ce("div");l.className="follower-cell-name q"+c.quality;var b=WH.ce("div");b.className="screenshot-caption";$(b).click(function(){location.href="/bfa-champion="+c.id+"."+f});WH.aE(h,"mouseover",Listview.funcBox.ssCellOver.bind(b));WH.aE(h,"mouseout",Listview.funcBox.ssCellOut.bind(b));WH.ae(b,WH.ct(c["name"+n]));WH.ae(l,b);WH.ae(h,l)}};Listview.templates.building={sort:[1,2],searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",span:2,value:"name",compute:function(f,h,g){var d=WH.ce("td");d.style.width="1px";d.style.paddingRight="0";d.style.borderRight="none";if(f.icon){WH.ae(d,Icon.create(f.icon,(this.iconSize==null?0:this.iconSize),null,this.getItemLink(f),1))}else{WH.ae(d,Icon.create("inv_misc_questionmark",(this.iconSize==null?0:this.iconSize),null,this.getItemLink(f),1))}WH.ae(g,d);h.style.borderLeft="none";var c=f.name;if(f.levelname!=f.name){c+=" / "+f.levelname}var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(f);WH.ae(b,WH.ct(c));WH.ae(h,b)}},{id:"level",name:LANG.level,type:"number",value:"level",width:"5%"},{id:"leveldescription",name:LANG.description,type:"text",align:"left",width:"50%",sortable:false,filtrable:false,value:"leveldescription",compute:function(b,c){WH.ae(c,WH.ce("div",{className:"listview-blurb small",innerHTML:b.leveldescription}))}},{id:"plot",name:LANG.plot,type:"text",compute:function(d,h){var b=0;for(var g in d.plots){if(!d.plots.hasOwnProperty(g)){continue}if(b++>0){WH.ae(h,WH.ct(", "))}var f=d.plots[g];if(g_garrison_plots.hasOwnProperty(f.id)){var c=WH.ce("a");c.href="/buildings="+f.id;WH.st(c,g_garrison_plots[f.id])}else{var c=WH.ce("span");WH.st(c,f.plotname)}WH.ae(h,c)}},sortFunc:function(d,c,f){var g="",j="";for(var h in d.plots){if(d.plots.hasOwnProperty(h)){g=g_garrison_plots.hasOwnProperty(d.plots[h].id)?g_garrison_plots[d.plots[h].id]:d.plots[h].plotname;break}}for(var h in c.plots){if(c.plots.hasOwnProperty(h)){j=g_garrison_plots.hasOwnProperty(c.plots[h].id)?g_garrison_plots[c.plots[h].id]:c.plots[h].plotname;break}}return WH.stringCompare(g,j)}}],getItemLink:function(b){return"/building="+b.id}};Listview.templates["building-gallery"]={sort:[1,2],mode:3,nItemsPerPage:24,nItemsPerRow:3,poundable:1,sortOptions:[{id:"name",name:LANG.name,sortFunc:function(d,c){var f=this.id.indexOf("horde")>=0?"horde":"alliance";return WH.stringCompare(d[f=="alliance"?"name":"levelname"],c[f=="alliance"?"name":"levelname"])||(d.level-c.level)}},{id:"level",name:LANG.level,value:"level"},{id:"plot",name:LANG.plot,sortFunc:function(d,c,f){var g="",j="";for(var h in d.plots){if(d.plots.hasOwnProperty(h)){g=g_garrison_plots.hasOwnProperty(d.plots[h].id)?g_garrison_plots[d.plots[h].id]:d.plots[h].plotname;break}}for(var h in c.plots){if(c.plots.hasOwnProperty(h)){j=g_garrison_plots.hasOwnProperty(c.plots[h].id)?g_garrison_plots[c.plots[h].id]:c.plots[h].plotname;break}}return WH.stringCompare(g,j)}}],columns:[],value:"name",compute:function(m,f,h){var k=this.id.indexOf("horde")>=0?"horde":"alliance";f.className="building-cell";var n=WH.ce("a");n.className="building-cell-building";n.href="/building="+m.id;if(k=="horde"){n.rel="buff"}var o=parseInt(m[k+"_y2"],10)-parseInt(m[k+"_y1"],10);var c=parseInt(m[k+"_x2"],10)-parseInt(m[k+"_x1"],10);var l=(o/c)*100;var g=WH.ce("span");g.style.backgroundImage='url("'+g_staticUrl+"/images/wow/garr/"+m[k+"_file"]+'.png")';g.style.backgroundPosition="-"+m[k+"_x1"]+"px -"+m[k+"_y1"]+"px";g.style.width=c+"px";var p=WH.ce("span");p.style.display="block";p.style.paddingTop=l+"%";WH.ae(g,p);WH.ae(n,g);WH.ae(f,n);var j=WH.ce("div");j.className="building-cell-name";var b=WH.ce("div");b.className="screenshot-caption";$(b).click(function(){location.href="/building="+m.id});WH.aE(f,"mouseover",Listview.funcBox.ssCellOver.bind(b));WH.aE(f,"mouseout",Listview.funcBox.ssCellOut.bind(b));WH.ae(b,WH.ct(m[k=="alliance"?"name":"levelname"]+" "+LANG.level+" "+m.level));WH.ae(j,b);WH.ae(f,j)},sortFunc:function(d,c){return WH.stringCompare(d.name,c.name)}};Listview.templates.buildinggallery=Listview.templates["building-gallery"];Listview.templates.champion={sort:[5,1],mode:1,searchable:1,filtrable:1,completionText:LANG.lvcompletion_collection,columns:[{id:"namealliance",name:LANG.som.alliance+" "+LANG.name,type:"text",align:"left",value:"namealliance",compute:function(c,j,f){var b=WH.ce("a");b.className="q"+c.quality+" listview-cleartext";b.href=this.getItemLink(c,1);if(c.hasOwnProperty("abilities")&&WH.isArray(c.abilities)&&c.hasOwnProperty("custom")&&c.custom){b.rel="q="+c.quality+"&level="+c.level+"&abil="+c.abilities.join(":")}j.style.paddingLeft="2.5em";if(c.portraitalliance){j.style.backgroundImage='url("'+g_staticUrl+"/images/wow/garr/"+c.portraitalliance+'.png")';j.style.backgroundRepeat="no-repeat";j.style.backgroundSize="3em 3em";j.style.backgroundPosition="-0.75em -0.25em"}WH.ae(b,WH.ct(c.namealliance));var h=WH.ce("div");WH.ae(j,h);WH.ae(h,b);if(c.hasOwnProperty("active")&&!parseInt(c.active)){h.style.position="relative";var g=WH.ce("div");g.className="listview-name-info q10";WH.ae(g,WH.ct(LANG.inactive));WH.aef(h,g)}WH.ae(j,h)}},{id:"classalliance",name:LANG.som.alliance+" "+LANG.classs,type:"text",align:"left",value:"classalliance",width:"20%",compute:function(b,d,c){WH.st(d,b.classalliance)}},{id:"namehorde",name:LANG.som.horde+" "+LANG.name,type:"text",align:"left",value:"namehorde",compute:function(c,j,f){var b=WH.ce("a");b.className="q"+c.quality+" listview-cleartext";b.href=this.getItemLink(c,2);if(c.hasOwnProperty("abilities")&&WH.isArray(c.abilities)&&c.hasOwnProperty("custom")&&c.custom){b.rel="q="+c.quality+"&level="+c.level+"&abil="+c.abilities.join(":")}j.style.paddingLeft="2.5em";if(c.portraithorde){j.style.backgroundImage='url("'+g_staticUrl+"/images/wow/garr/"+c.portraithorde+'.png")';j.style.backgroundRepeat="no-repeat";j.style.backgroundSize="3em 3em";j.style.backgroundPosition="-0.75em -0.25em"}WH.ae(b,WH.ct(c.namehorde));var h=WH.ce("div");WH.ae(j,h);WH.ae(h,b);if(c.hasOwnProperty("active")&&!c.active){h.style.position="relative";var g=WH.ce("div");g.className="listview-name-info q10";WH.ae(g,WH.ct(LANG.inactive));WH.aef(h,g)}WH.ae(j,h)}},{id:"classhorde",name:LANG.som.horde+" "+LANG.classs,type:"text",align:"left",value:"classhorde",width:"20%",compute:function(b,d,c){WH.st(d,b.classhorde)}},{id:"type",name:LANG.type,type:"text",width:"10%",compute:function(c,d){var b=WH.ce("span");WH.st(b,(c.flags&1)?LANG.types[28][0]:LANG.troop);WH.ae(d,b)},sortFunc:function(d,c){return WH.stringCompare(c.flags&1,d.flags&1)}},{id:"counters",name:LANG.counters,hidden:1,type:"text",width:"168px",compute:function(c,g){if(!c.hasOwnProperty("abilities")){return}var j=c.abilities;if(!WH.isArray(j)){if((WH.inArray(this.hiddenCols,"namehorde")!=-1)&&j.hasOwnProperty("1")){j=j["1"]}else{if((WH.inArray(this.hiddenCols,"namealliance")!=-1)&&j.hasOwnProperty("2")){j=j["2"]}else{return}}}g.style.padding="0 6px";g.style.textAlign="left";for(var m=0;m<j.length;m++){var k=g_mission_abilities[j[m]];for(var f in k.counters){if(!k.counters.hasOwnProperty(f)){continue}if(!g_garrison_mechanics.hasOwnProperty(k.counters[f])){continue}var b=g_garrison_mechanics[k.counters[f]];var l=WH.ce("div");l.style.display="inline-block";if(b.hasOwnProperty("icon")){var h=Icon.create(b.icon,0,null,"/mission-ability="+k.id);h.className+=" garrison-ability";h.style.cssFloat="left";WH.ae(l,h)}WH.ae(g,l)}}},getVisibleText:function(d){var f="";if(!d.hasOwnProperty("abilities")){return f}var h=d.abilities;if(!WH.isArray(h)){if((WH.inArray(this.hiddenCols,"namehorde")!=-1)&&h.hasOwnProperty("1")){h=h["1"]}else{if((WH.inArray(this.hiddenCols,"namealliance")!=-1)&&h.hasOwnProperty("2")){h=h["2"]}else{return f}}}for(var b=0;b<h.length;b++){var c=g_mission_abilities[h[b]];for(var g in c.counters){if(!c.counters.hasOwnProperty(g)){continue}f+=c.counters[g].name+" "}}return f}},{id:"quality",name:LANG.quality,type:"text",value:"quality",width:"10%",compute:function(c,d){var b=WH.ce("span");b.className="q"+c.quality;WH.st(b,g_item_qualities[c.quality]);WH.ae(d,b)},sortFunc:function(d,c){return WH.stringCompare(d.quality,c.quality)}},{id:"level",name:LANG.level,hidden:1,type:"number",value:"level",width:"5%"},{id:"itemlevelaverage",name:LANG.avg,type:"number",value:"avgilvl",width:"5%",hidden:1},{id:"itemlevelweapon",name:g_item_classes[2],hidden:1,type:"number",value:"itemlevelweapon",width:"5%"},{id:"itemlevelarmor",name:g_item_classes[4],hidden:1,type:"number",value:"itemlevelarmor",width:"5%"},{id:"completed",name:LANG.completion,width:"10%",hidden:true,compute:function(b,c,j,m){var h=3;if(this.hiddenCols){for(var l=0;l<this.hiddenCols.length;l++){if(this.hiddenCols[l]=="namealliance"){h=2;break}if(this.hiddenCols[l]=="namehorde"){h=1;break}}}if(b.npcalliance==b.npchorde){h=false}for(var f in g_user.lists){var g=g_user.lists[f];if(!(g.id in g_completion.champion)||!g.character){continue}var d=(WH.inArray(g_completion.champion[g.id],b.id)!=-1);if(h){if(h!=3){d|=(WH.inArray(g_completion.champion[g.id],""+b.id+"."+h)!=-1)}else{d|=(WH.inArray(g_completion.champion[g.id],""+b.id+".1")!=-1);d|=(WH.inArray(g_completion.champion[g.id],""+b.id+".2")!=-1)}}var k=WH.ce("a");k.href="/list="+g.id+"/"+g.url;k.className="progress-icon "+(d?"progress-8":"progress-0");WH.Tooltip.simple(k,WH.getCompletionTooltip(g,d),"",true);WH.ae(c,k)}},sortFunc:function(g,f,h){var j=3;if(this.hiddenCols){for(var d=0;d<this.hiddenCols.length;d++){if(this.hiddenCols[d]=="namealliance"){j=2;break}if(this.hiddenCols[d]=="namehorde"){j=1;break}}}var c=j,l=j;if(g.npcalliance==g.npchorde){c=false}if(f.npcalliance==f.npchorde){l=false}var k=function(p,n){var b=0;if(!g_user.lists){return b}for(var m=g_user.lists.length-1;m>=0;m--){var q=g_user.lists[m];if(!(q.id in g_completion.champion)||!q.character){continue}var o=WH.inArray(g_completion.champion[q.id],p)!=-1;if(n){if(n!=3){o|=(WH.inArray(g_completion.champion[q.id],""+p+"."+n)!=-1)}else{o|=(WH.inArray(g_completion.champion[q.id],""+p+".1")!=-1);o|=(WH.inArray(g_completion.champion[q.id],""+p+".2")!=-1)}}b=(b<<1)|(o?1:0)}return b};return WH.stringCompare(k(g.id,c),k(f.id,l))}}],getItemLink:function(d,c){if(!c&&this.hiddenCols){for(var b=0;b<this.hiddenCols.length;b++){if(this.hiddenCols[b]=="namealliance"){c=2;break}if(this.hiddenCols[b]=="namehorde"){c=1;break}}}if(d.npcalliance==d.npchorde){c=false}return"/champion="+d.id+(c?("."+c):"")},onBeforeCreate:function(){for(var b in this.columns){if((this.columns[b].id=="completed")&&(this.columns[b].hidden)){if((!(this.hasOwnProperty("completionMode")&&this.completionMode))&&WH.isSet("g_user")&&("lists" in g_user)&&("champion" in g_completion)&&(WH.inArray(this.hiddenCols,this.columns[b].id)==-1)){this.visibility.push(parseInt(b));break}}}}};Listview.templates["champion-gallery"]={sort:[1,2],mode:3,nItemsPerPage:48,nItemsPerRow:4,poundable:1,sortOptions:[{id:"name",name:LANG.name,sortFunc:function(d,c){var f=this.id.indexOf("horde")>=0?"horde":"alliance";return WH.stringCompare(d["name"+f],c["name"+f])}},{id:"level",name:LANG.level,value:"level"}],columns:[],value:"name",compute:function(c,h,k){var n=this.id.indexOf("horde")>=0?"horde":"alliance";var f=(n=="horde"?"2":"1");h.className="follower-cell";var o=WH.ce("a");o.className="follower-cell-follower";o.href="/champion="+c.id+"."+f;var p=224;var g=160;var m=(p/g)*100;var j=WH.ce("span");j.style.backgroundImage='url("'+g_staticUrl+"/images/wow/garr/npcmodels/"+c["npc"+n]+'.jpg"),url("'+g_staticUrl+"/images/wow/garr/"+c["portrait"+n]+'.png")';j.style.backgroundSize="cover, 80% auto";j.style.backgroundPosition="center";j.style.width=g+"px";var q=WH.ce("span");q.style.display="block";q.style.paddingTop=m+"%";WH.ae(j,q);WH.ae(o,j);WH.ae(h,o);var l=WH.ce("div");l.className="follower-cell-name q"+c.quality;var b=WH.ce("div");b.className="screenshot-caption";$(b).click(function(){location.href="/champion="+c.id+"."+f});WH.aE(h,"mouseover",Listview.funcBox.ssCellOver.bind(b));WH.aE(h,"mouseout",Listview.funcBox.ssCellOut.bind(b));WH.ae(b,WH.ct(c["name"+n]));WH.ae(l,b);WH.ae(h,l)}};Listview.templates.championgallery=Listview.templates["champion-gallery"];Listview.templates.faction={sort:[1],mode:1,nItemsPerPage:-1,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",compute:function(d,f){var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(d);WH.ae(b,WH.ct(d.name));if(d.expansion){var c=WH.ce("span");c.className=WH.getExpansionClassName(d.expansion);WH.ae(c,b);WH.ae(f,c)}else{WH.ae(f,b)}},getVisibleText:function(b){var c=b.name+Listview.funcBox.getExpansionText(b);return c}},{id:"side",name:LANG.side,type:"text",compute:function(b,d){if(b.side&&b.side!=3){var c=WH.ce("span");c.className=(b.side==1?"icon-alliance":"icon-horde");c.onmouseover=function(f){WH.Tooltip.showAtCursor(f,g_sides[b.side],0,0,"q")};c.onmousemove=WH.Tooltip.cursorUpdate;c.onmouseout=WH.Tooltip.hide;WH.ae(d,c)}},getVisibleText:function(b){if(b.side){return g_sides[b.side]}},sortFunc:function(d,c,f){return WH.stringCompare(g_sides[d.side],g_sides[c.side])}},{id:"standing",name:LANG.reputation,value:"standing",compute:function(b,c){c.style.padding=0;WH.ae(c,WH.createReputationBar(b.standing,b.friendshiprep))},hidden:1},{id:"category",name:LANG.category,type:"text",width:"16%",compute:function(d,f){if(d.category2!=null){f.className="small q1";var b=WH.ce("a"),c="/factions="+d.category2;if(d.category){c+="."+d.category}b.href=c;WH.ae(b,WH.ct(Listview.funcBox.getFactionCategory(d.category,d.category2)));WH.ae(f,b)}},getVisibleText:function(b){return Listview.funcBox.getFactionCategory(b.category,b.category2)},sortFunc:function(d,c,g){var f=Listview.funcBox.getFactionCategory;return WH.stringCompare(f(d.category,d.category2),f(c.category,c.category2))}}],getItemLink:function(b){return"/faction="+b.id},createCbControls:function(d,c){if(!c){return}var b=WH.ce("input");b.type="button";b.value=(!this.characterSettings||!this.characterSettings.editable?LANG.li_addtolist:LANG.li_addtoanotherlist);b.onclick=(function(f){Listview.cbAddToList.call(this,f,"faction")}).bind(this);WH.ae(d,b)}};Listview.templates.follower={sort:[-5,1],mode:1,searchable:1,filtrable:1,completionText:LANG.lvcompletion_collection,columns:[{id:"namealliance",name:LANG.som.alliance+" "+LANG.name,type:"text",align:"left",value:"namealliance",compute:function(f,j,c){var b=WH.ce("a");b.className="q"+f.quality+" listview-cleartext";b.href=this.getItemLink(f,1);if(f.hasOwnProperty("abilities")&&WH.isArray(f.abilities)&&f.hasOwnProperty("custom")&&f.custom){b.rel="q="+f.quality+"&level="+f.level+"&abil="+f.abilities.join(":")}j.style.paddingLeft="2.5em";if(f.portraitalliance){j.style.backgroundImage='url("'+g_staticUrl+"/images/wow/garr/"+f.portraitalliance+'.png")';j.style.backgroundRepeat="no-repeat";j.style.backgroundSize="3em 3em";j.style.backgroundPosition="-0.75em -0.25em"}WH.ae(b,WH.ct(f.namealliance));var h=WH.ce("div");WH.ae(j,h);WH.ae(h,b);if(f.hasOwnProperty("active")&&!parseInt(f.active)){h.style.position="relative";var g=WH.ce("div");g.className="listview-name-info q10";WH.ae(g,WH.ct(LANG.inactive));WH.aef(h,g)}WH.ae(j,h)}},{id:"classalliance",name:LANG.som.alliance+" "+LANG.classs,type:"text",align:"left",value:"classalliance",width:"20%",compute:function(c,d,b){WH.st(d,c.classalliance)}},{id:"namehorde",name:LANG.som.horde+" "+LANG.name,type:"text",align:"left",value:"namehorde",compute:function(f,j,c){var b=WH.ce("a");b.className="q"+f.quality+" listview-cleartext";b.href=this.getItemLink(f,2);if(f.hasOwnProperty("abilities")&&WH.isArray(f.abilities)&&f.hasOwnProperty("custom")&&f.custom){b.rel="q="+f.quality+"&level="+f.level+"&abil="+f.abilities.join(":")}j.style.paddingLeft="2.5em";if(f.portraithorde){j.style.backgroundImage='url("'+g_staticUrl+"/images/wow/garr/"+f.portraithorde+'.png")';j.style.backgroundRepeat="no-repeat";j.style.backgroundSize="3em 3em";j.style.backgroundPosition="-0.75em -0.25em"}WH.ae(b,WH.ct(f.namehorde));var h=WH.ce("div");WH.ae(j,h);WH.ae(h,b);if(f.hasOwnProperty("active")&&!f.active){h.style.position="relative";var g=WH.ce("div");g.className="listview-name-info q10";WH.ae(g,WH.ct(LANG.inactive));WH.aef(h,g)}WH.ae(j,h)}},{id:"classhorde",name:LANG.som.horde+" "+LANG.classs,type:"text",align:"left",value:"classhorde",width:"20%",compute:function(c,d,b){WH.st(d,c.classhorde)}},{id:"counters",name:LANG.counters,hidden:1,type:"text",width:"168px",compute:function(k,f){if(!k.hasOwnProperty("abilities")){return}var h=k.abilities;if(!WH.isArray(h)){if((WH.inArray(this.hiddenCols,"namehorde")!=-1)&&h.hasOwnProperty("1")){h=h["1"]}else{if((WH.inArray(this.hiddenCols,"namealliance")!=-1)&&h.hasOwnProperty("2")){h=h["2"]}else{return}}}f.style.padding="0 6px";f.style.textAlign="left";for(var m=0;m<h.length;m++){var j=g_mission_abilities[h[m]];for(var c in j.counters){if(!j.counters.hasOwnProperty(c)){continue}if(!g_garrison_mechanics.hasOwnProperty(j.counters[c])){continue}var b=g_garrison_mechanics[j.counters[c]];var l=WH.ce("div");l.style.display="inline-block";if(b.hasOwnProperty("icon")){var g=Icon.create(b.icon,0,null,"/mission-ability="+j.id);g.className+=" garrison-ability";g.style.cssFloat="left";WH.ae(l,g)}WH.ae(f,l)}}},getVisibleText:function(f){var d="";if(!f.hasOwnProperty("abilities")){return d}var h=f.abilities;if(!WH.isArray(h)){if((WH.inArray(this.hiddenCols,"namehorde")!=-1)&&h.hasOwnProperty("1")){h=h["1"]}else{if((WH.inArray(this.hiddenCols,"namealliance")!=-1)&&h.hasOwnProperty("2")){h=h["2"]}else{return d}}}for(var b=0;b<h.length;b++){var c=g_mission_abilities[h[b]];for(var g in c.counters){if(!c.counters.hasOwnProperty(g)){continue}d+=c.counters[g].name+" "}}return d}},{id:"quality",name:LANG.quality,type:"text",value:"quality",width:"10%",compute:function(c,d){var b=WH.ce("span");b.className="q"+c.quality;WH.st(b,g_item_qualities[c.quality]);WH.ae(d,b)},sortFunc:function(d,c){return WH.stringCompare(d.quality,c.quality)}},{id:"level",name:LANG.level,type:"number",value:"level",width:"5%"},{id:"itemlevelaverage",name:LANG.avg,type:"number",value:"avgilvl",width:"5%",hidden:1},{id:"itemlevelweapon",name:g_item_classes[2],type:"number",value:"itemlevelweapon",width:"5%"},{id:"itemlevelarmor",name:g_item_classes[4],type:"number",value:"itemlevelarmor",width:"5%"},{id:"completed",name:LANG.completion,width:"10%",hidden:true,compute:function(f,b,j,m){var h=3;if(this.hiddenCols){for(var l=0;l<this.hiddenCols.length;l++){if(this.hiddenCols[l]=="namealliance"){h=2;break}if(this.hiddenCols[l]=="namehorde"){h=1;break}}}if(f.npcalliance==f.npchorde){h=false}for(var d in g_user.lists){var g=g_user.lists[d];if(!(g.id in g_completion.follower)||!g.character){continue}var c=(WH.inArray(g_completion.follower[g.id],f.id)!=-1);if(h){if(h!=3){c|=(WH.inArray(g_completion.follower[g.id],""+f.id+"."+h)!=-1)}else{c|=(WH.inArray(g_completion.follower[g.id],""+f.id+".1")!=-1);c|=(WH.inArray(g_completion.follower[g.id],""+f.id+".2")!=-1)}}var k=WH.ce("a");k.href="/list="+g.id+"/"+g.url;k.className="progress-icon "+(c?"progress-8":"progress-0");WH.Tooltip.simple(k,WH.getCompletionTooltip(g,c),"",true);WH.ae(b,k)}},sortFunc:function(g,f,j){var k=3;if(this.hiddenCols){for(var d=0;d<this.hiddenCols.length;d++){if(this.hiddenCols[d]=="namealliance"){k=2;break}if(this.hiddenCols[d]=="namehorde"){k=1;break}}}var c=k,l=k;if(g.npcalliance==g.npchorde){c=false}if(f.npcalliance==f.npchorde){l=false}var h=function(q,n){var b=0;if(!g_user.lists){return b}for(var m=g_user.lists.length-1;m>=0;m--){var p=g_user.lists[m];if(!(p.id in g_completion.follower)||!p.character){continue}var o=WH.inArray(g_completion.follower[p.id],q)!=-1;if(n){if(n!=3){o|=(WH.inArray(g_completion.follower[p.id],""+q+"."+n)!=-1)}else{o|=(WH.inArray(g_completion.follower[p.id],""+q+".1")!=-1);o|=(WH.inArray(g_completion.follower[p.id],""+q+".2")!=-1)}}b=(b<<1)|(o?1:0)}return b};return WH.stringCompare(h(g.id,c),h(f.id,l))}}],getItemLink:function(d,c){if(!c&&this.hiddenCols){for(var b=0;b<this.hiddenCols.length;b++){if(this.hiddenCols[b]=="namealliance"){c=2;break}if(this.hiddenCols[b]=="namehorde"){c=1;break}}}if(d.npcalliance==d.npchorde){c=false}return"/follower="+d.id+(c?("."+c):"")},onBeforeCreate:function(){for(var b in this.columns){if((this.columns[b].id=="completed")&&(this.columns[b].hidden)){if((!(this.hasOwnProperty("completionMode")&&this.completionMode))&&WH.isSet("g_user")&&("lists" in g_user)&&("follower" in g_completion)&&(WH.inArray(this.hiddenCols,this.columns[b].id)==-1)){this.visibility.push(parseInt(b));break}}}}};Listview.templates["follower-gallery"]={sort:[1,2],mode:3,nItemsPerPage:48,nItemsPerRow:4,poundable:1,sortOptions:[{id:"name",name:LANG.name,sortFunc:function(d,c){var f=this.id.indexOf("horde")>=0?"horde":"alliance";return WH.stringCompare(d["name"+f],c["name"+f])}},{id:"level",name:LANG.level,value:"level"}],columns:[],value:"name",compute:function(k,g,j){var n=this.id.indexOf("horde")>=0?"horde":"alliance";var c=(n=="horde"?"2":"1");g.className="follower-cell";var o=WH.ce("a");o.className="follower-cell-follower";o.href="/follower="+k.id+"."+c;var p=224;var f=160;var m=(p/f)*100;var h=WH.ce("span");h.style.backgroundImage='url("'+g_staticUrl+"/images/wow/garr/npcmodels/"+k["npc"+n]+'.jpg"),url("'+g_staticUrl+"/images/wow/garr/"+k["portrait"+n]+'.png")';h.style.backgroundSize="cover, 80% auto";h.style.backgroundPosition="center";h.style.width=f+"px";var q=WH.ce("span");q.style.display="block";q.style.paddingTop=m+"%";WH.ae(h,q);WH.ae(o,h);WH.ae(g,o);var l=WH.ce("div");l.className="follower-cell-name q"+k.quality;var b=WH.ce("div");b.className="screenshot-caption";$(b).click(function(){location.href="/follower="+k.id+"."+c});WH.aE(g,"mouseover",Listview.funcBox.ssCellOver.bind(b));WH.aE(g,"mouseout",Listview.funcBox.ssCellOut.bind(b));WH.ae(b,WH.ct(k["name"+n]));WH.ae(l,b);WH.ae(g,l)}};Listview.templates.followergallery=Listview.templates["follower-gallery"];Listview.templates["mission-ability"]={sort:[1,2],mode:0,nItemsPerPage:100,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",span:2,compute:function(c,l,h){var f=WH.ce("td");f.style.width="1px";f.style.paddingRight="0";f.style.borderRight="none";var g=Icon.create(c.icon,(this.iconSize==null?0:this.iconSize),null,this.getItemLink(c));g.className+=" garrison-ability";WH.ae(f,g);WH.ae(h,f);l.style.borderLeft="none";var k=WH.ce("div");WH.ae(l,k);var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(c);WH.ae(b,WH.ct(c.name));WH.ae(k,b);if((c.flags&2)&&c.hasOwnProperty("byclass")&&(c.byclass==1)){k.style.position="relative";var j=WH.ce("div");j.className="listview-name-info q10";WH.ae(j,WH.ct(LANG.lvmissionability_innonly));WH.aef(k,j)}if(c.description!=null){var j=WH.ce("div");j.className="listview-blurb small";j.innerHTML=c.description;WH.ae(l,j)}},getVisibleText:function(b){return b.name}},{id:"side",hidden:1,name:LANG.side,type:"text",compute:function(b,f){if(b.hasOwnProperty("side")){for(var d=1;d<=2;d++){if((b.side&d)==0){continue}var c=WH.ce("span");c.className=(d==1?"icon-alliance":"icon-horde");c.onmouseover=function(g){WH.Tooltip.showAtCursor(g,g_sides[b.side],0,0,"q")};c.onmousemove=WH.Tooltip.cursorUpdate;c.onmouseout=WH.Tooltip.hide;WH.ae(f,c)}}},getVisibleText:function(b){if(b.hasOwnProperty("side")){return g_sides[b.side]}return""},sortFunc:function(d,c){return WH.stringCompare(d.hasOwnProperty("side")?g_sides[d.side]:"",c.hasOwnProperty("side")?g_sides[c.side]:"")}},{id:"type",name:LANG.type,type:"text",compute:function(c,d){var b=WH.ce("a");b.href="/mission-abilities="+c.followertype+"."+c.type;WH.st(b,g_mission_ability_types[c.followertype][c.type]);WH.ae(d,b)},getVisibleText:function(b){return g_mission_ability_types[b.followertype][b.type]},sortFunc:function(d,c){return WH.stringCompare(d.followertype,c.followertype)||WH.stringCompare(g_mission_ability_types[d.followertype][d.type],g_mission_ability_types[c.followertype][c.type])}},{id:"category",name:LANG.category,type:"text",compute:function(b,c){if(g_mission_ability_categories.hasOwnProperty(b.category)){WH.st(c,g_mission_ability_categories[b.category])}},getVisibleText:function(b){if(g_mission_ability_categories.hasOwnProperty(b.category)){return g_mission_ability_categories[b.category]}return""},sortFunc:function(d,c){return WH.stringCompare(g_mission_ability_categories.hasOwnProperty(d.category)?g_mission_ability_categories[d.category]:"",g_mission_ability_categories.hasOwnProperty(c.category)?g_mission_ability_categories[c.category]:"")}},{id:"counters",name:LANG.counters,type:"text",compute:function(g,l){if(!g.hasOwnProperty("counters")){return}var f=0;for(var k in g.counters){if(!g.counters.hasOwnProperty(k)){continue}var c=g.counters[k];var j=WH.ce("div");j.style.display="inline-block";if(c.hasOwnProperty("icon")){var h=Icon.create(c.icon,0,null,"/threat="+k);h.className+=" garrison-ability";h.style.display="inline-block";h.style.verticalAlign="middle";WH.ae(j,h);WH.ae(j,WH.ct(" "))}var b=WH.ce("a");b.href="/threat="+k;WH.st(b,c.name);WH.ae(j,b);if(f++%3==0&&f>1){WH.ae(l,WH.ce("br"))}else{WH.ae(l,WH.ce("span",{innerHTML:" &nbsp; "}))}WH.ae(l,j)}},getVisibleText:function(b){var c="";for(var d in b.counters){if(!b.counters.hasOwnProperty(d)){continue}c+=b.counters[d].name+" "}return c},sortFunc:function(f,d){var g=this.getVisibleText(f);var c=this.getVisibleText(d);return WH.stringCompare(g,c)}}],getItemLink:function(b){return"/mission-ability="+b.id}};Listview.templates.missionability=Listview.templates["mission-ability"];Listview.templates.mission={sort:[-3,-4,1],mode:0,nItemsPerPage:100,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",width:"50%",compute:function(k,j,f){var h=WH.ce("div");WH.ae(j,h);var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(k);WH.ae(b,WH.ct(k.name));WH.ae(h,b);var c=WH.ce("div");WH.ae(h,c);c.className="listview-blurb small";WH.st(c,k.description);if(k.flags&5){h.style.position="relative";var g=WH.ce("div");g.className="listview-name-info";if(k.flags&1){c=WH.ce("span");c.className="q3";WH.ae(c,WH.ct(g_item_qualities[3]));WH.ae(g,c)}if(k.flags&4){c=WH.ce("span");c.className="q5";c.style.marginLeft="3px";WH.ae(c,WH.ct(LANG.exhausting));WH.ae(g,c)}WH.aef(h,g)}},getVisibleText:function(b){return b.name}},{id:"type",name:LANG.type,type:"text",compute:function(c,b){if(g_garrison_mission_types.hasOwnProperty(c.missiontype)){WH.ae(b,WH.ct(g_garrison_mission_types[c.missiontype]))}},getVisibleText:function(b){if(g_garrison_mission_types.hasOwnProperty(b.missiontype)){return g_garrison_mission_types[b.missiontype]}return""},sortFunc:function(d,c){return WH.stringCompare(g_garrison_mission_types.hasOwnProperty(d.missiontype)?g_garrison_mission_types[d.missiontype]:"",g_garrison_mission_types.hasOwnProperty(c.missiontype)?g_garrison_mission_types[c.missiontype]:"")}},{id:"level",name:LANG.level,type:"number",value:"level",compute:function(c,b){if(!c.hasOwnProperty("followertype")||c.followertype!=2){WH.st(b,c.level)}},sortFunc:function(d,c){return WH.stringCompare(d.level,c.level)}},{id:"itemlevel",name:LANG.itemlevel,type:"number",value:"itemlevel",compute:function(c,b){if(c.itemlevel&&(!c.hasOwnProperty("followertype")||c.followertype!=2)){WH.st(b,c.itemlevel)}},sortFunc:function(d,c){return WH.stringCompare(d.itemlevel,c.itemlevel)}},{id:"followers",name:LANG.tab_followers,type:"number",value:"followers"},{id:"ships",name:LANG.tab_ships,type:"number",value:"followers",hidden:true},{id:"cost",name:LANG.cost,type:"number",value:"cost",compute:function(c,b){if(c.cost){Listview.funcBox.appendMoney(b,null,null,null,[[c.currency||824,c.cost]])}},sortFunc:function(d,c,f){return WH.stringCompare(d.cost,c.cost)}},{id:"missiontime",name:LANG.types[23][0],type:"number",value:"missiontime",hidden:true,compute:function(c,b){WH.st(b,WH.formatTimeElapsed(c.missiontime))},sortFunc:function(d,c){return WH.stringCompare(d.missiontime,c.missiontime)}},{id:"duration",name:LANG.duration,type:"number",compute:function(d,c){var b=WH.ce("span");WH.ae(c,b);WH.st(b,WH.formatTimeElapsed(d.missiontime))},sortFunc:function(d,c){return WH.stringCompare(d.missiontime,c.missiontime)}},{id:"experience",name:LANG.exp,type:"number",value:"experience"},{id:"reward",name:LANG.reward,type:"number",compute:function(k,j){var g=0,c=[],f=[];if(k.rewards.experience.length){var h=WH.ce("div");WH.ae(j,h);WH.ae(h,WH.ct(WH.numberFormat(k.rewards.experience[0])+" "+LANG.exp))}for(var b=0;b<k.rewards.currency.length;b++){if(k.rewards.currency[b].currency==0){g+=k.rewards.currency[b].amount}else{c.push([k.rewards.currency[b].currency,k.rewards.currency[b].amount])}}for(var b=0;b<k.rewards.item.length;b++){f.push([k.rewards.item[b].item,k.rewards.item[b].amount])}if(g+c.length+f.length){Listview.funcBox.appendMoney(j,g,null,f,c)}},sortFunc:function(d,c,f){var h=d.rewards.experience.length+d.rewards.currency.length+d.rewards.item.length;var g=d.rewards.experience.length+c.rewards.currency.length+c.rewards.item.length;return WH.stringCompare(h,g)||WH.stringCompare(d.rewards.experience.length,c.rewards.experience.length)||(d.rewards.experience.length?WH.stringCompare(d.rewards.experience[0],c.rewards.experience[0]):0)}}],getItemLink:function(b){return"/mission="+b.id}};Listview.templates.npc={sort:[1],mode:1,nItemsPerPage:100,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",compute:function(c,g){if(c.boss){g.className="icon-boss-padded"}var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(c);WH.ae(b,WH.ct(c.name));if(c.hasQuests!=null){b.className+=" icontiny tinyspecial";b.style.backgroundImage="url("+g_staticUrl+"/images/wow/icons/tiny/quest_start.gif)"}WH.ae(g,b);if(c.tag!=null){var f=WH.ce("div");f.className="small";WH.ae(f,WH.ct("<"+c.tag+">"));WH.ae(g,f)}},getVisibleText:function(b){var c=b.name;if(b.tag){c+=" <"+b.tag+">"}if(b.boss){c+=" boss skull"}return c},sortFunc:function(d,c,f){return WH.stringCompare(c.boss,d.boss)||WH.stringCompare(d.name,c.name)||WH.stringCompare(c.hasQuests,d.hasQuests)}},{id:"level",name:LANG.level,type:"range",width:"10%",getMinValue:function(b){return b.minlevel},getMaxValue:function(b){return b.maxlevel},compute:function(b,f){if(b.classification){var c=WH.ce("div");c.className="small";WH.ae(c,WH.ct(g_npc_classifications[b.classification]));WH.ae(f,c)}if(b.classification==3||b.maxlevel==9999){return"??"}if(b.minlevel>0&&b.maxlevel>0){if(b.minlevel!=b.maxlevel){return b.minlevel+LANG.hyphen+b.maxlevel}else{return b.minlevel}}return -1},getVisibleText:function(b){var c="";if(b.classification){c+=" "+g_npc_classifications[b.classification]}if(b.minlevel>0&&b.maxlevel>0){c+=" ";if(b.maxlevel==9999){c+="??"}else{if(b.minlevel!=b.maxlevel){c+=b.minlevel+LANG.hyphen+b.maxlevel}else{c+=b.minlevel}}}return c},sortFunc:function(d,c,f){if(f>0){return WH.stringCompare(d.minlevel,c.minlevel)||WH.stringCompare(d.maxlevel,c.maxlevel)||WH.stringCompare(d.classification,c.classification)}else{return WH.stringCompare(d.maxlevel,c.maxlevel)||WH.stringCompare(d.minlevel,c.minlevel)||WH.stringCompare(d.classification,c.classification)}}},{id:"location",name:LANG.location,type:"text",compute:function(b,c){return Listview.funcBox.location(b,c)},getVisibleText:function(b){return Listview.funcBox.arrayText(b.location,g_zones)},sortFunc:function(d,c,f){return Listview.funcBox.assocArrCmp(d.location,c.location,g_zones)}},{id:"react",name:LANG.react,type:"text",width:"10%",value:"react",filtrable:0,compute:function(d,j){if(d.react==null){return -1}var f=[LANG.lvnpc_alliance,LANG.lvnpc_horde];var h=0;for(var b=0;b<2;++b){if(d.react[b]!=null){if(h++>0){WH.ae(j,WH.ct(" "))}var g=WH.ce("span");g.className=(d.react[b]<0?"q10":(d.react[b]>0?"q2":"q"));WH.ae(g,WH.ct(f[b]));WH.ae(j,g)}}}},{id:"skin",name:LANG.skin,type:"text",value:"skin",compute:function(c,d){if(c.skin){var b=WH.ce("a");b.className="q1";b.href="/npcs?filter=cr=35;crs=0;crv="+c.skin;WH.ae(b,WH.ct(c.skin));WH.ae(d,b)}},hidden:1},{id:"petfamily",name:LANG.petfamily,type:"text",width:"12%",compute:function(c,d){d.className="q1";var b=WH.ce("a");b.href="/pet="+c.family;WH.ae(b,WH.ct(g_pet_families[c.family]));WH.ae(d,b)},getVisibleText:function(b){return g_pet_families[b.family]},sortFunc:function(d,c,f){return WH.stringCompare(g_pet_families[d.family],g_pet_families[c.family])},hidden:1},{id:"type",name:LANG.type,type:"text",width:"12%",compute:function(c,d){d.className="small q1";var b=WH.ce("a");b.href="/npcs="+c.type;WH.ae(b,WH.ct(g_npc_types[c.type]));WH.ae(d,b)},getVisibleText:function(b){return g_npc_types[b.type]},sortFunc:function(d,c,f){return WH.stringCompare(g_npc_types[d.type],g_npc_types[c.type])}},{id:"completed",name:LANG.completion,hidden:true,compute:function(b,f,d,c){if(!b.hasOwnProperty("type")||!Listview.templates.npc._validCompletionCategory(b.type)){return}WH.addCompletionIcons(f,"npc",b.id)},sortFunc:function(d,c,f){return WH.stringCompare(Listview.templates.npc._npcCompletedFlags(d.id),Listview.templates.npc._npcCompletedFlags(c.id))},getValue:function(d){var g=0;var f=g_completion.npc;if(!d.hasOwnProperty("type")||!Listview.templates.npc._validCompletionCategory(d.type)){return -1}for(var h in g_user.lists){var b=g_user.lists[h];if(!(b.id in f)){continue}if(WH.inArray(f[b.id],d.id)!=-1){g++}}return g}}],getItemLink:function(b){return"/npc="+b.id},_npcCompletedFlags:function(b){return WH.getCompletionFlags("npc",b)},_validCompletionCategory:function(b){return WH.inArray(g_completion_categories[1],b)!=-1},createCbControls:function(d,c){if(!c){return}var b=WH.ce("input");b.type="button";b.value=(!this.characterSettings||!this.characterSettings.editable?LANG.li_addtolist:LANG.li_addtoanotherlist);b.onclick=(function(f){Listview.cbAddToList.call(this,f,"npc")}).bind(this);WH.ae(d,b)},onBeforeCreate:function(){for(var b in this.columns){if(this.columns[b].id=="completed"&&this.columns[b].hidden){if(!(this.hasOwnProperty("completionMode")&&this.completionMode)&&WH.isSet("g_user")&&"lists" in g_user&&"npc" in g_completion&&WH.inArray(this.hiddenCols,this.columns[b].id)==-1){var c=0;for(var d in this.data){if(this.data[d].hasOwnProperty("type")&&Listview.templates.npc._validCompletionCategory(this.data[d].type)){c++}}if(c>this.data.length*0.1){this.visibility.push(parseInt(b))}}}}}};Listview.templates.object={sort:[1],mode:1,nItemsPerPage:100,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",compute:function(c,d){var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(c);WH.ae(b,WH.ct(c.name));WH.ae(d,b)}},{id:"location",name:LANG.location,type:"text",compute:function(b,c){return Listview.funcBox.location(b,c)},getVisibleText:function(b){return Listview.funcBox.arrayText(b.location,g_zones)},sortFunc:function(d,c,f){return Listview.funcBox.assocArrCmp(d.location,c.location,g_zones)}},{id:"skill",name:LANG.skill,width:"10%",value:"skill",hidden:true},{id:"type",name:LANG.type,type:"text",width:"12%",compute:function(c,d){d.className="small q1";var b=WH.ce("a");b.href="/objects="+c.type;WH.ae(b,WH.ct(g_object_types[c.type]));WH.ae(d,b)},getVisibleText:function(b){return g_object_types[b.type]},sortFunc:function(d,c,f){return WH.stringCompare(g_object_types[d.type],g_object_types[c.type])}}],getItemLink:function(b){return"/object="+b.id},createCbControls:function(d,c){if(!c){return}var b=WH.ce("input");b.type="button";b.value=(!this.characterSettings||!this.characterSettings.editable?LANG.li_addtolist:LANG.li_addtoanotherlist);b.onclick=(function(f){Listview.cbAddToList.call(this,f,"object")}).bind(this);WH.ae(d,b)}};Listview.templates.quest={sort:[1,2],mode:1,nItemsPerPage:100,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",compute:function(j,f){var m=$("<a/>",{"class":"listview-cleartext",href:this.getItemLink(j),text:j.name});var b=$("<div/>");b.append(m);if(j.reqclass){var l=$("<div/>",{"class":"small2"});var g=Listview.funcBox.assocBinFlags(j.reqclass,g_chr_classes);for(var h=0,k=g.length;h<k;++h){if(h>0){l.append(", ")}var m=$("<a/>",{href:"/class="+g[h],"class":"c"+g[h],text:g_chr_classes[g[h]]});l.append(m)}b.append(l)}if(j.historical||(j.wflags&32)||(j.reqrace&&j.reqrace!=-1)){b.css("position","relative");var l=$("<div/>",{"class":"listview-name-info"});if(j.historical){var n=$("<span/>",{css:{color:"red"},text:LANG.lvquest_removed});l.append(n)}if(j.wflags&32){if(j.historical){l.append($("<br/>"));b.css("height","33px")}var n=$("<span/>",{text:LANG.lvquest_autoaccept});if(j.wflags&64){n.css("color","red").append(" "+LANG.lvquest_hostile)}l.append(n)}if(j.reqrace&&j.reqrace!=-1){var c=Listview.funcBox.assocBinFlags(j.reqrace,g_chr_races);if(c.length&&(j.historical||(j.wflags&32))){l.append($("<br/>"));b.css("height","33px")}for(var h=0,k=c.length;h<k;++h){if(h>0){l.append(", ")}var m=$("<a/>",{href:"/race="+c[h],"class":"q1",text:g_chr_races[c[h]]});l.append(m)}}b.append(l)}$(f).append(b)}},{id:"level",name:LANG.level,value:"level",compute:function(b,f){if(b.type||b.daily||b.weekly){var c=WH.ce("div");c.className="small";WH.noWrap(c);if(b.daily){if(b.type){WH.ae(c,WH.ct(WH.sprintf(LANG.lvquest_daily,g_quest_types[b.type])))}else{WH.ae(c,WH.ct(LANG.daily))}}else{if(b.weekly){if(b.type){WH.ae(c,WH.ct(WH.sprintf(LANG.lvquest_weekly,g_quest_types[b.type])))}else{WH.ae(c,WH.ct(LANG.weekly))}}else{if(b.type){WH.ae(c,WH.ct(g_quest_types[b.type]))}}}WH.ae(f,c)}return b.level},getVisibleText:function(b){var c="";if(b.type){c+=" "+g_quest_types[b.type]}if(b.daily){c+=" "+LANG.daily}else{if(b.weekly){c+=" "+LANG.weekly}}if(b.level){c+=" "+b.level}return c},sortFunc:function(d,c,f){return WH.stringCompare(d.level,c.level)||WH.stringCompare(d.type,c.type)}},{id:"reqlevel",name:LANG.req,tooltip:LANG.tooltip_reqlevel,value:"reqlevel"},{id:"side",name:LANG.side,type:"text",compute:function(b,d){if(b.side&&b.side!=3){var c=WH.ce("span");c.className=(b.side==1?"icon-alliance":"icon-horde");c.onmouseover=function(f){WH.Tooltip.showAtCursor(f,g_sides[b.side],0,0,"q")};c.onmousemove=WH.Tooltip.cursorUpdate;c.onmouseout=WH.Tooltip.hide;WH.ae(d,c)}else{if(!b.side){WH.ae(d,WH.ct("??"))}}},getVisibleText:function(b){if(b.side){return g_sides[b.side]}},sortFunc:function(d,c,f){return WH.stringCompare(g_sides[d.side],g_sides[c.side])}},{id:"rewards",name:LANG.rewards,compute:function(c,j){var b=(c.itemchoices!=null||c.itemrewards!=null);if(b){var h,g;if(c.itemchoices&&c.itemchoices.length>1){h=LANG.lvquest_pickone;if(c.itemrewards&&c.itemrewards.length>0){g=LANG.lvquest_alsoget}}Listview.funcBox.createCenteredIcons(c.itemchoices,j,h,2);Listview.funcBox.createCenteredIcons(c.itemrewards,j,g,2)}if(c.titlereward&&g_titles[c.titlereward]){var f=g_titles[c.titlereward]["name_"+Locale.getName()];f=f.replace("%s",'<span class="q0">&lt;'+LANG.name+"&gt;</span>");var d=WH.ce("a");d.className="q1";d.href="/title="+c.titlereward;d.innerHTML=f;WH.ae(j,d);WH.ae(j,WH.ce("br"))}},getVisibleText:function(b){var c="";if(b.itemchoices&&b.itemchoices.length){c+=" "+LANG.lvquest_pickone;if(b.itemrewards&&b.itemrewards.length){c+=" "+LANG.lvquest_alsoget}}if(b.titlereward&&g_titles[b.titlereward]){c+=" "+g_titles[b.titlereward]["name_"+Locale.getName()]}return c},sortFunc:function(d,c,g){var k=(d.itemchoices!=null?d.itemchoices.length:0)+(d.itemrewards!=null?d.itemrewards.length:0);var j=(c.itemchoices!=null?c.itemchoices.length:0)+(c.itemrewards!=null?c.itemrewards.length:0);var h=(d.titlereward&&g_titles[d.titlereward]?g_titles[d.titlereward]["name_"+Locale.getName()]:"");var f=(c.titlereward&&g_titles[c.titlereward]?g_titles[c.titlereward]["name_"+Locale.getName()]:"");return WH.stringCompare(k,j)||WH.stringCompare(h,f)}},{id:"experience",name:LANG.exp,value:"xp"},{id:"money",name:LANG.money,compute:function(b,c){if(b.money>0||b.currencyrewards!=null){if(b.money>0){Listview.funcBox.appendMoney(c,b.money);if(b.currencyrewards!=null){WH.ae(c,WH.ct(" + "))}}if(b.currencyrewards!=null){Listview.funcBox.appendMoney(c,null,b.side,null,b.currencyrewards)}}},getVisibleText:function(b){var d="";for(var c=0;b.currencyrewards&&c<b.currencyrewards.length;++c){if(g_gatheredcurrencies[b.currencyrewards[c][0]]){d+=" "+g_gatheredcurrencies[b.currencyrewards[c][0]]["name_"+Locale.getName()]}}return d},sortFunc:function(d,c,f){var h=0,g=0;if(d.currencyrewards&&d.currencyrewards.length){$.each(d.currencyrewards,function(b,j){h+=j[1]})}if(c.currencyrewards&&c.currencyrewards.length){$.each(c.currencyrewards,function(b,j){g+=j[1]})}return WH.stringCompare(h,g)||WH.stringCompare(d.money,c.money)}},{id:"reputation",name:LANG.reputation,width:"14%",value:"id",hidden:true},{id:"category",name:LANG.category,type:"text",compute:function(c,d){if(c.category!=0){d.className="small";if(c.category2==-1){WH.Track.nonInteractiveEvent("Quest","Missing Category",c.category,1);d.className+=" q0";WH.ae(d,WH.ct(Listview.funcBox.getQuestCategory(c.category)))}else{d.className+=" q1";var b=WH.ce("a",{href:"/quests="+c.category2+"."+c.category,text:Listview.funcBox.getQuestCategory(c.category)});WH.ae(d,b)}}},getVisibleText:function(b){return Listview.funcBox.getQuestCategory(b.category)},sortFunc:function(d,c,g){var f=Listview.funcBox.getQuestCategory;return WH.stringCompare(f(d.category),f(c.category))}},{id:"completed",name:LANG.completion,hidden:true,compute:function(b,c){WH.addCompletionIcons(c,"quest",b.id)},sortFunc:function(d,c,f){return WH.stringCompare(this._questDoneFlags(d.id),this._questDoneFlags(c.id))},getValue:function(d){var g=0;var f=g_completion.quest;for(var h in g_user.lists){var b=g_user.lists[h];if(!(b.id in f)){continue}if(WH.inArray(f[b.id],d.id)!=-1){g++}}return g},_questDoneFlags:function(b){return WH.getCompletionFlags("quest",b)}}],getItemLink:function(b){return"/quest="+b.id},createCbControls:function(d,c){if(!c){return}var b=WH.ce("input");b.type="button";b.value=(!this.characterSettings||!this.characterSettings.editable?LANG.li_addtolist:LANG.li_addtoanotherlist);b.onclick=(function(f){Listview.cbAddToList.call(this,f,"quest")}).bind(this);WH.ae(d,b)},onBeforeCreate:function(){for(var b in this.columns){if((this.columns[b].id=="completed")&&(this.columns[b].hidden)){if((!(this.hasOwnProperty("completionMode")&&this.completionMode))&&WH.isSet("g_user")&&("lists" in g_user)&&("quest" in g_completion)&&(WH.inArray(this.hiddenCols,this.columns[b].id)==-1)){this.visibility.push(parseInt(b))}}}}};Listview.templates.ship={sort:[-5,1],mode:1,searchable:1,filtrable:1,completionText:LANG.lvcompletion_collection,columns:[{id:"namealliance",name:LANG.som.alliance+" "+LANG.name,type:"text",align:"left",value:"namealliance",compute:function(f,j,c){var b=WH.ce("a");b.className="q"+f.quality+" listview-cleartext";b.href=this.getItemLink(f,1);if(f.hasOwnProperty("abilities")&&WH.isArray(f.abilities)&&f.hasOwnProperty("custom")&&f.custom){b.rel="q="+f.quality+"&abil="+f.abilities.join(":")}WH.ae(b,WH.ct(f.namealliance));var h=WH.ce("div");WH.ae(j,h);WH.ae(h,b);if(f.hasOwnProperty("active")&&!parseInt(f.active)){h.style.position="relative";var g=WH.ce("div");g.className="listview-name-info q10";WH.ae(g,WH.ct(LANG.inactive));WH.aef(h,g)}WH.ae(j,h)}},{id:"classalliance",name:LANG.som.alliance+" "+LANG.classs,type:"text",align:"left",value:"classalliance",width:"20%",compute:function(c,d,b){WH.st(d,c.classalliance)}},{id:"namehorde",name:LANG.som.horde+" "+LANG.name,type:"text",align:"left",value:"namehorde",compute:function(f,j,c){var b=WH.ce("a");b.className="q"+f.quality+" listview-cleartext";b.href=this.getItemLink(f,2);if(f.hasOwnProperty("abilities")&&WH.isArray(f.abilities)&&f.hasOwnProperty("custom")&&f.custom){b.rel="q="+f.quality+"&abil="+f.abilities.join(":")}WH.ae(b,WH.ct(f.namehorde));var h=WH.ce("div");WH.ae(j,h);WH.ae(h,b);if(f.hasOwnProperty("active")&&!f.active){h.style.position="relative";var g=WH.ce("div");g.className="listview-name-info q10";WH.ae(g,WH.ct(LANG.inactive));WH.aef(h,g)}WH.ae(j,h)}},{id:"classhorde",name:LANG.som.horde+" "+LANG.classs,type:"text",align:"left",value:"classhorde",width:"20%",compute:function(c,d,b){WH.st(d,c.classhorde)}},{id:"counters",name:LANG.counters,hidden:1,type:"text",width:"168px",compute:function(f,g){if(!f.hasOwnProperty("abilities")){return}var j=f.abilities;if(!WH.isArray(j)){if((WH.inArray(this.hiddenCols,"namehorde")!=-1)&&j.hasOwnProperty("1")){j=j["1"]}else{if((WH.inArray(this.hiddenCols,"namealliance")!=-1)&&j.hasOwnProperty("2")){j=j["2"]}else{return}}}g.style.padding="0 6px";g.style.textAlign="left";for(var m=0;m<j.length;m++){var k=g_mission_abilities[j[m]];for(var c in k.counters){if(!k.counters.hasOwnProperty(c)){continue}if(!g_garrison_mechanics.hasOwnProperty(k.counters[c])){continue}var b=g_garrison_mechanics[k.counters[c]];var l=WH.ce("div");l.style.display="inline-block";if(b.hasOwnProperty("icon")){var h=Icon.create(b.icon,0,null,"/mission-ability="+k.id);h.className+=" garrison-ability";h.style.cssFloat="left";WH.ae(l,h)}WH.ae(g,l)}}},getVisibleText:function(f){var d="";if(!f.hasOwnProperty("abilities")){return d}var h=f.abilities;if(!WH.isArray(h)){if((WH.inArray(this.hiddenCols,"namehorde")!=-1)&&h.hasOwnProperty("1")){h=h["1"]}else{if((WH.inArray(this.hiddenCols,"namealliance")!=-1)&&h.hasOwnProperty("2")){h=h["2"]}else{return d}}}for(var b=0;b<f.abilities.length;b++){var c=g_mission_abilities[f.abilities[b]];for(var g in c.counters){if(!c.counters.hasOwnProperty(g)){continue}d+=c.counters[g].name+" "}}return d}},{id:"quality",name:LANG.quality,type:"text",value:"quality",width:"10%",compute:function(c,d){var b=WH.ce("span");b.className="q"+c.quality;WH.st(b,g_item_qualities[c.quality]);WH.ae(d,b)},sortFunc:function(d,c){return WH.stringCompare(d.quality,c.quality)}},{id:"completed",name:LANG.completion,width:"10%",hidden:true,compute:function(b,c,j,m){var h=3;if(this.hiddenCols){for(var l=0;l<this.hiddenCols.length;l++){if(this.hiddenCols[l]=="namealliance"){h=2;break}if(this.hiddenCols[l]=="namehorde"){h=1;break}}}if(b.npcalliance==b.npchorde){h=false}for(var f in g_user.lists){var g=g_user.lists[f];if(!g_completion.hasOwnProperty("ship")||(!(g.id in g_completion.ship))||!g.character){continue}var d=(WH.inArray(g_completion.ship[g.id],b.id)!=-1);if(h){if(h!=3){d|=(WH.inArray(g_completion.ship[g.id],""+b.id+"."+h)!=-1)}else{d|=(WH.inArray(g_completion.ship[g.id],""+b.id+".1")!=-1);d|=(WH.inArray(g_completion.ship[g.id],""+b.id+".2")!=-1)}}var k=WH.ce("a");k.href="/list="+g.id+"/"+g.url;k.className="progress-icon "+(d?"progress-8":"progress-0");WH.Tooltip.simple(k,WH.getCompletionTooltip(g,d),"",true);WH.ae(c,k)}},sortFunc:function(h,g,j){var k=3;if(this.hiddenCols){for(var f=0;f<this.hiddenCols.length;f++){if(this.hiddenCols[f]=="namealliance"){k=2;break}if(this.hiddenCols[f]=="namehorde"){k=1;break}}}var d=k,l=k;if(h.npcalliance==h.npchorde){d=false}if(g.npcalliance==g.npchorde){l=false}var c=function(b,o){var m=0;if(!g_user.lists){return m}for(var n=g_user.lists.length-1;n>=0;n--){var q=g_user.lists[n];if(!g_completion.hasOwnProperty("ship")||(!(q.id in g_completion.ship))||!q.character){continue}var p=WH.inArray(g_completion.ship[q.id],b)!=-1;if(o){if(o!=3){p|=(WH.inArray(g_completion.ship[q.id],""+b+"."+o)!=-1)}else{p|=(WH.inArray(g_completion.ship[q.id],""+b+".1")!=-1);p|=(WH.inArray(g_completion.ship[q.id],""+b+".2")!=-1)}}m=(m<<1)|(p?1:0)}return m};return WH.stringCompare(c(h.id,d),c(g.id,l))}}],getItemLink:function(d,c){if(!c&&this.hiddenCols){for(var b=0;b<this.hiddenCols.length;b++){if(this.hiddenCols[b]=="namealliance"){c=2;break}if(this.hiddenCols[b]=="namehorde"){c=1;break}}}if(d.npcalliance==d.npchorde){c=false}return"/ship="+d.id+(c?("."+c):"")},onBeforeCreate:function(){for(var b in this.columns){if((this.columns[b].id=="completed")&&(this.columns[b].hidden)){if((!(this.hasOwnProperty("completionMode")&&this.completionMode))&&WH.isSet("g_user")&&("lists" in g_user)&&("ship" in g_completion)&&(WH.inArray(this.hiddenCols,this.columns[b].id)==-1)){this.visibility.push(parseInt(b));break}}}}};Listview.templates.sound={searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",compute:function(c,d){var b=WH.ce("a");b.className="listview-cleartext";b.href="/sound="+c.id;WH.st(b,c.name);WH.ae(d,b)}},{id:"type",name:LANG.type,type:"text",compute:function(d,g){var c="";if(!this.hasOwnProperty("soundtypecache")){var f={};for(var b in mn_sounds){if(mn_sounds[b][0]<1000){f[mn_sounds[b][0]]=mn_sounds[b][1]}}this.soundtypecache=f}if(this.soundtypecache.hasOwnProperty(d.type)){c=this.soundtypecache[d.type]}WH.st(g,c)},sortFunc:function(d,c){if(!this.hasOwnProperty("soundtypecache")){var j={};for(var f in mn_sounds){if(mn_sounds[f][0]<1000){j[mn_sounds[f][0]]=mn_sounds[f][1]}}this.soundtypecache=j}var g=(this.soundtypecache.hasOwnProperty(d.type))?this.soundtypecache[d.type]:"";var h=(this.soundtypecache.hasOwnProperty(c.type))?this.soundtypecache[c.type]:"";return WH.stringCompare(g,h)||WH.stringCompare(d.name,c.name)}},{id:"activity",name:LANG.activity,hidden:true,type:"text",compute:function(b,c){if(!b.hasOwnProperty("activity")){return""}if(LANG.sound_activities.hasOwnProperty(b.activity)){return LANG.sound_activities[b.activity]}else{return b.activity}},sortFunc:function(d,c){return WH.stringCompare(this.compute(d),this.compute(c))}},{id:"sound",name:LANG.types[19][2],span:2,compute:function(c,h,b){var g=WH.ce("td");g.className="nowrap";WH.ae(b,g);g.style.borderRight="none";h.className="nowrap";h.style.borderLeft="none";var f=WH.ce("div");WH.ae(g,f);(new AudioControls()).init(c.files,f,{listview:this,trackdisplay:h})}}],getItemLink:function(b){return"/sound="+b.id}};Listview.templates.threat={sort:[1,3],mode:0,nItemsPerPage:100,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",span:2,compute:function(f,j,g){var c=WH.ce("td");c.style.width="1px";c.style.paddingRight="0";c.style.borderRight="none";var d=Icon.create(f.icon,(this.iconSize==null?0:this.iconSize),null,this.getItemLink(f));d.className+=" garrison-ability";WH.ae(c,d);WH.ae(g,c);j.style.borderLeft="none";var h=WH.ce("div");WH.ae(j,h);var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(f);WH.ae(b,WH.ct(f.name));WH.ae(h,b)},getVisibleText:function(b){return b.name}},{id:"description",name:LANG.description,type:"text",align:"left",compute:function(b,c){c.innerHTML=b.description}},{id:"category",name:LANG.category,type:"text",compute:function(c,d){var b=WH.ce("a");b.href="/threats="+c.category;WH.st(b,g_threat_categories[c.category]);WH.ae(d,b)},getVisibleText:function(b){return g_threat_categories[b.category]},sortFunc:function(d,c){return WH.stringCompare(g_threat_categories[d.category],g_threat_categories[c.category])}}],getItemLink:function(b){return"/threat="+b.id}};Listview.templates["order-advancement"]={sort:[3,4,1],mode:0,nItemsPerPage:100,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",span:2,compute:function(g,j,f){var c=WH.ce("td");c.style.width="1px";c.style.paddingRight="0";c.style.borderRight="none";var d=Icon.create(g.icon,(this.iconSize==null?0:this.iconSize),null,this.getItemLink(g));WH.ae(c,d);WH.ae(f,c);j.style.borderLeft="none";var h=WH.ce("div");WH.ae(j,h);var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(g);WH.ae(b,WH.ct(g.name));WH.ae(h,b)},getVisibleText:function(b){return b.name}},{id:"description",name:LANG.description,type:"text",align:"left",compute:function(b,c){c.innerHTML=b.description},getVisibleText:function(b){return b.description},sortFunc:function(d,c){return WH.stringCompare(d.description,c.description)}},{id:"class",name:LANG.classs,type:"text",compute:function(h,j){var g=WH.ce("div");g.className="small2";var f=Listview.funcBox.assocBinFlags(h.classmask,g_chr_classes);for(var c=0,b=f.length;c<b;++c){if(c>0){WH.ae(g,WH.ct(", "))}a=WH.ce("a");a.href="/order-advancements="+f[c];a.className="c"+f[c];WH.st(a,g_chr_classes[f[c]]);WH.ae(g,a)}WH.ae(j,g)},getVisibleText:function(g){var f="";var d=Listview.funcBox.assocBinFlags(g.classmask,g_chr_classes);for(var c=0,b=d.length;c<b;++c){if(c>0){f+=", "}f+=g_chr_classes[d[c]]}return f},sortFunc:function(d,c){return WH.stringCompare(Listview.templates["order-advancement"].columns[2].getVisibleText(d),Listview.templates["order-advancement"].columns[2].getVisibleText(c))}},{id:"tier",name:LANG.tier,type:"number",compute:function(b,c){return b.tier+1},getVisibleText:function(b){return b.tier+1},sortFunc:function(d,c){return WH.stringCompare(d.tier,c.tier)}},{id:"researchcost",name:LANG.lv_orderadvancement_researchcost,type:"number",compute:function(b,c){if(b.researchcost){Listview.funcBox.appendMoney(c,null,null,null,[[b.researchcurrency,b.researchcost]])}},sortFunc:function(d,c,f){return WH.stringCompare(d.researchcurrency,c.researchcurrency)||WH.stringCompare(d.researchcost,c.researchcost)}},{id:"changecost",name:LANG.lv_orderadvancement_changecost,type:"number",compute:function(b,c){if(b.switchcost){Listview.funcBox.appendMoney(c,null,null,null,[[b.switchcurrency,b.switchcost]])}},sortFunc:function(d,c,f){return WH.stringCompare(d.switchcurrency,c.switchcurrency)||WH.stringCompare(d.switchcost,c.switchcost)}}],getItemLink:function(b){return"/order-advancement="+b.id}};Listview.templates.zone={sort:[2,4],nItemsPerPage:-1,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",compute:function(c,f){var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(c);WH.ae(b,WH.ct(c.name));if(c.expansion){var d=WH.ce("span");d.className=WH.getExpansionClassName(c.expansion);WH.ae(d,b);WH.ae(f,d)}else{WH.ae(f,b)}},getVisibleText:function(b){var c=b.name+Listview.funcBox.getExpansionText(b);if(b.instance==5||b.instance==8){c+=" heroic"}return c}},{id:"level",name:LANG.level,type:"range",width:"10%",getMinValue:function(b){return b.minlevel},getMaxValue:function(b){return b.maxlevel},compute:function(b,c){if(b.minlevel>0&&b.maxlevel>0){if(b.minlevel!=b.maxlevel){return b.minlevel+LANG.hyphen+b.maxlevel}else{return b.minlevel}}},sortFunc:function(d,c,f){if(f>0){return WH.stringCompare(c.minlevel,d.minlevel)||WH.stringCompare(c.maxlevel,d.maxlevel)}else{return WH.stringCompare(c.maxlevel,d.maxlevel)||WH.stringCompare(c.minlevel,d.minlevel)}}},{id:"players",name:LANG.players,type:"text",hidden:true,compute:function(b,f){if(b.instance>0){var c=WH.ce("span");var d=Listview.templates.zone.getInstancePlayerText(b);if(d.indexOf("<br>")!=-1){c.className="small"}c.innerHTML=d;WH.ae(f,c)}},getVisibleText:function(b){if(b.instance>0){return Listview.templates.zone.getInstancePlayerText(b)}},sortFunc:function(d,c,f){return WH.stringCompare(Listview.templates.zone.getInstancePlayerText(d),Listview.templates.zone.getInstancePlayerText(c))}},{id:"territory",name:LANG.territory,type:"text",width:"13%",compute:function(b,d){var c=WH.ce("span");switch(b.territory){case 0:c.className="icon-alliance";break;case 1:c.className="icon-horde";break;case 4:c.className="icon-ffa";break}WH.ae(c,WH.ct(g_zone_territories[b.territory]));WH.ae(d,c)},getVisibleText:function(b){return g_zone_territories[b.territory]},sortFunc:function(d,c,f){return WH.stringCompare(g_zone_territories[d.territory],g_zone_territories[c.territory])}},{id:"instancetype",name:LANG.instancetype,type:"text",compute:function(b,k){if(b.instance>0){var f=WH.ce("span");if((b.instance>=1&&b.instance<=5)||b.instance==7||b.instance==8){f.className="icon-instance"+b.instance}var j=g_zone_instancetypes[b.instance];if(WH.isSet("g_difficulties")&&WH.isSet("g_mapdifficulties")&&g_mapdifficulties[b.id]){for(var d in g_mapdifficulties[b.id]){if(d==8){var c=WH.ce("span");c.className="icon-challenge";WH.Tooltip.simple(c,LANG.tooltip_challengemodeavailable,"q");WH.ae(k,c)}else{if(d==23){var h=WH.ce("span");h.className="icon-mythic";WH.Tooltip.simple(h,LANG.tooltip_mythicmodeavailable,"q");WH.ae(k,h)}}}}if(b.heroicLevel){var g=WH.ce("span");g.className="icon-heroic";WH.Tooltip.simple(g,LANG.tooltip_heroicmodeavailable+LANG.qty.replace("$1",b.heroicLevel));WH.ae(k,g)}WH.ae(f,WH.ct(j));WH.ae(k,f)}},getVisibleText:function(b){if(b.instance>0){var d=g_zone_instancetypes[b.instance];if(b.nplayers&&((b.instance!=2&&b.instance!=5)||b.nplayers>5)){if(b.instance==4){d+=" "+WH.sprintf(LANG.lvzone_xvx,b.nplayers,b.nplayers)}else{d+=" "+WH.sprintf(LANG.lvzone_xman,b.nplayers)}}if(WH.isSet("g_difficulties")&&WH.isSet("g_mapdifficulties")&&g_mapdifficulties[b.id]){for(var c in g_mapdifficulties[b.id]){if(c==8){d+=" challenge"}}}if(b.instance==5||b.instance==8){d+=" heroic"}return d}},sortFunc:function(d,c,f){return WH.stringCompare(g_zone_instancetypes[d.instance],g_zone_instancetypes[c.instance])||WH.stringCompare(d.instance,c.instance)||WH.stringCompare(d.nplayers,c.nplayers)}},{id:"category",name:LANG.category,type:"text",width:"15%",hidden:true,compute:function(c,d){d.className="small q1";var b=WH.ce("a");b.href="/zones="+c.category;WH.ae(b,WH.ct(g_zone_categories[c.category]));WH.ae(d,b)},getVisibleText:function(b){return g_zone_categories[b.category]},sortFunc:function(d,c,f){return WH.stringCompare(g_zone_categories[d.category],g_zone_categories[c.category])}}],getInstancePlayerText:function(k){if(k.nplayers==-2){k.nplayers="10/25"}var q="";if(k.instance==4){q+=WH.sprintf(LANG.lvzone_xvx,k.nplayers,k.nplayers)}else{var b=true;if(WH.isSet("g_difficulties")&&WH.isSet("g_mapdifficulties")&&g_mapdifficulties[k.id]){var m={};for(var p in g_mapdifficulties[k.id]){if(!parseInt(p)){continue}var h=g_difficulties[p];var o=h.minplayers;if(h.minplayers!=h.maxplayers){o=h.minplayers+"/"+h.maxplayers}if(p==17){o="25"}if(!m[o]){m[o]=[]}m[o].push(p)}var g=[];for(var n in m){g.push([n,m[n]])}g.sort(function(r,j){return j[1].length-r[1].length});if(g.length){b=false;var l=g.length>1;for(var f in g){var c="";for(var d in g[f][1]){c+=(!c?"":"/")+(g_difficulty_shortnames[g[f][1][d]]?g_difficulty_shortnames[g[f][1][d]]:"")}l=c&&l;q+=(q?"<br>":"")+(l?(c+": "):"")+WH.sprintf(LANG.lvzone_xman,g[f]?g[f][0]:k.nplayers)}}}if(b){q+=WH.sprintf(LANG.lvzone_xman,k.nplayers)}}return q},getItemLink:function(b){return"/zone="+b.id}};Listview.templates.event={sort:[2,1],nItemsPerPage:-1,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",value:"name",span:2,compute:function(c,g,f){var d=WH.ce("td");d.style.width="1px";d.style.paddingRight="0";d.style.borderRight="none";WH.ae(d,g_holidays.createIcon(c.id,0));WH.ae(f,d);g.style.borderLeft="none";var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(c);WH.ae(b,WH.ct(c.name));WH.ae(g,b)},getVisibleText:function(b){return b.name}},{id:"date",name:LANG.date,type:"text",width:"16%",allText:true,compute:function(d,k,g){var h=WH.getEventNextDates(d);if(h[0]&&h[1]){var j=WH.formatDateSimple(h[0]),b=WH.formatDateSimple(h[1]),f=WH.ce("span");if(j!=b){var c=WH.ce("span",{className:"nowrap"});WH.st(c,j+LANG.hyphen.replace(/\s*$/,""));WH.st(f," "+b);WH.aef(f,c)}else{f.className="nowrap";WH.st(f,j)}WH.ae(k,f);if(h[0]<=g_serverTime&&h[1]>=g_serverTime){g.className="checked";f.className="q2 tip";WH.Tooltip.simple(f,LANG.tooltip_activeholiday,"q")}}},getVisibleText:function(c){var d=WH.getEventNextDates(c);if(d[0]&&d[1]){var f=WH.formatDateSimple(d[0]),b=WH.formatDateSimple(d[1]);if(f!=b){return f+LANG.hyphen+b}else{return f}}return""},sortFunc:function(d,c,f){var h=WH.getEventNextDates(d);var g=WH.getEventNextDates(c);if(h[0]&&g[0]){return h[0]-g[0]}return 0}},{id:"category",name:LANG.category,type:"text",width:"16%",compute:function(d,f){f.className="small q1";var b=WH.ce("a"),c="/events="+d.category;b.href=c;WH.ae(b,WH.ct(g_holiday_categories[d.category]));WH.ae(f,b)},getVisibleText:function(b){return g_holiday_categories[b.category]},sortFunc:function(d,c,f){return WH.stringCompare(g_holiday_categories[d.category],g_holiday_categories[c.category])}}],getItemLink:function(b){return"/event="+b.id}};Listview.templates.holiday=Listview.templates.event;Listview.templates["event-calendar"]={sort:[1],mode:4,startOnMonth:new Date(g_serverTime.getFullYear(),0,1),nMonthsToDisplay:12,rowOffset:g_serverTime.getMonth(),poundable:2,columns:[],compute:function(b,f,c){if(!b.events||!b.events.length){return}for(var c=0;c<b.events.length;++c){var d=g_holidays.createIcon(b.events[c].id,1);d.onmouseover=Listview.funcBox.dateEventOver.bind(d,b.date,b.events[c]);d.onmousemove=WH.Tooltip.cursorUpdate;d.onmouseout=WH.Tooltip.hide;d.style.cssFloat=d.style.styleFloat="left";WH.ae(f,d)}},sortFunc:function(f,c){var k=WH.getEventNextDates(f);var j=WH.getEventNextDates(c);for(var h=0;h<2;++h){var g=k[h],d=j[h];if(g.getFullYear()==d.getFullYear()&&g.getMonth()==d.getMonth()&&g.getDate()==d.getDate()){return g-d}}return WH.stringCompare(f.name,c.name)}};Listview.templates.holidaycal=Listview.templates["event-calendar"];Listview.templates.currency={sort:[1],mode:1,searchable:1,filtrable:1,columns:[{id:"name",name:LANG.name,type:"text",align:"left",span:2,value:"name",compute:function(c,h,f){var d=WH.ce("td");d.style.width="1px";d.style.paddingRight="0";d.style.borderRight="none";WH.ae(d,Icon.create(c.icon,0,null,this.getItemLink(c),c.stack?c.stack:null));WH.ae(f,d);h.style.borderLeft="none";var g=WH.ce("div");var b=WH.ce("a");b.className="listview-cleartext";b.href=this.getItemLink(c);if(typeof c.name=="undefined"){c.name=(typeof g_currencies[c.id]!="undefined")?g_currencies[c.id][0]:""}WH.ae(b,WH.ct(c.name));WH.ae(g,b);WH.ae(h,g)}},{id:"category",name:LANG.category,type:"text",width:"15%",compute:function(c,d){d.className="small";var b=WH.ce("a");b.className="q1";b.href="/currencies="+c.category;WH.ae(b,WH.ct(g_currency_categories[c.category]));WH.ae(d,b)},getVisibleText:function(b){return g_currency_categories[b.category]},sortFunc:function(d,c,f){return WH.stringCompare(g_currency_categories[d.category],g_currency_categories[c.category])}}],getItemLink:function(b){return"/currency="+b.id},createCbControls:function(d,c){if(!c){return}var b=WH.ce("input");b.type="button";b.value=(!this.characterSettings||!this.characterSettings.editable?LANG.li_addtolist:LANG.li_addtoanotherlist);b.onclick=(function(f){Listview.cbAddToList.call(this,f,"currency")}).bind(this);WH.ae(d,b)}};var LiveSearch=new function(){var currentTextbox,lastSearch={},lastDiv,timer,prepared,container,cancelNext,hasData,summary,selection,LIVESEARCH_DELAY=500;function setText(textbox,txt){textbox.value=txt;textbox.selectionStart=textbox.selectionEnd=txt.length}function colorDiv(div,fromOver){if(lastDiv){lastDiv.className=lastDiv.className.replace("live-search-selected","")}lastDiv=div;lastDiv.className+=" live-search-selected";selection=div.i;if(!fromOver){show();setTimeout(setText.bind(0,currentTextbox,WH.getTextContent(div.firstChild.firstChild.childNodes[1])),1);cancelNext=1}}function aOver(){colorDiv(this.parentNode.parentNode,1)}function isVisible(){if(!container){return false}return container.style.display!="none"}function adjust(fromResize){if(fromResize==1&&!isVisible()){return}if(currentTextbox==null){return}var c=WH.ac(currentTextbox);container.style.left=(c[0])+"px";container.style.top=(c[1]+currentTextbox.offsetHeight)+"px";container.style.width=(currentTextbox.offsetWidth-4)+"px"}function prepare(useZulMode){if(prepared){if(useZulMode){container.className+=" live-search-mobile"}else{container.className=container.className.replace(/ *live-search-mobile\b/g,"")}return}prepared=1;container=WH.ce("div");container.className="live-search"+(useZulMode?" live-search-mobile":"");container.style.display="none";WH.ae(document.body,container);WH.aE(window,"resize",adjust.bind(0,1));if(!useZulMode){WH.aE(document,"click",hide)}}function show(){if(container&&!isVisible()){adjust();if(currentTextbox){currentTextbox.setAttribute("data-has-live-search","true")}$(container).css({opacity:"0"}).show().animate({opacity:"1"},"fast",null,doneShowing)}}function doneShowing(a){$(this).css("opacity","")}function hide(e){if(e&&!WH.isLeftClick(e)){return}if(container){container.style.display="none"}if(currentTextbox){currentTextbox.setAttribute("data-has-live-search","false")}}function highlight(match,$1){return($1?match:"<b><u>"+match+"</u></b>")}function display(textbox,search,suggz,dataz){var useZulMode=PageTemplate.Responsive.isZulInMobileMode();prepare(useZulMode);show();hasData=1;selection=null;while(container.firstChild){WH.de(container.firstChild)}search=search.replace(/[^a-z0-9\-]/gi," ");search=WH.trim(search.replace(/\s+/g," "));var regex=WH.createOrRegex(search,(search=="s"?"[%]":null));if(useZulMode){var firstDiv=WH.ce("div");firstDiv.className="live-search-zul-closer";var firstDivDiv=WH.ce("div");var firstA=WH.ce("a");firstA.innerHTML='<i class="fa fa-times"></i><span class="q10">'+LANG.zul_closesearch+"</span>";firstA.onclick=hide;firstA.onmouseover=aOver;WH.ae(firstDivDiv,firstA);WH.ae(firstDiv,firstDivDiv);WH.ae(container,firstDiv)}for(var i=0,len=suggz.length;i<len;++i){var pos=suggz[i].lastIndexOf("(");if(pos!=-1){suggz[i]=suggz[i].substr(0,pos-1)}var type=dataz[i][0],typeId=dataz[i][1],param1=dataz[i][2],param2=dataz[i][3],a=WH.ce("a"),sp=WH.ce("i"),sp2=WH.ce("span"),div=WH.ce("div"),div2=WH.ce("div");div.i=i;a.onmouseover=aOver;a.href="/"+(type==10&&param2?"statistic":g_types[type])+"="+typeId;if(textbox._append){a.rel+=textbox._append}if(type==1&&param1!=null){div.className+=" live-search-icon-boss"}else{if(type==3&&param2!=null){a.className+=" q"+param2}else{if(type==4&&param1!=null){a.className+=" q"+param1}else{if(type==13){a.className+=" c"+typeId}}}}if((type==3||type==6||type==9||type==10||type==13||type==14||type==15||type==17)&&param1){div.className+=" live-search-icon";div.style.backgroundImage="url("+g_staticUrl+"/images/wow/icons/"+(useZulMode?"medium":"small")+"/"+param1.toLowerCase()+".jpg)"}else{if((type==5||type==11)&&param1>=1&&param1<=2){div.className+=" live-search-icon-quest-"+(param1==1?"alliance":"horde")}}WH.ae(sp,WH.ct(LANG.types[type][0]));WH.ae(a,sp);var buffer=suggz[i];buffer=buffer.replace(regex,highlight);if(type==11){buffer=buffer.replace("%s",'<span class="q0">&lt;'+LANG.name+"&gt;</span>")}sp2.innerHTML=buffer;WH.ae(a,sp2);if(type==6&&param2){WH.ae(a,WH.ct(" ("+param2+")"))}WH.ae(div2,a);WH.ae(div,div2);WH.ae(container,div)}}function receive(xhr,opt){var text=xhr.responseText;if(text.charAt(0)!="["||text.charAt(text.length-1)!="]"){return}var a=eval(text);var search=a[0];if(search==opt.search){if(a.length==8){display(opt.textbox,search,a[1],a[7])}else{hide()}}}function fetch(textbox,search){new Ajax("/search?q="+WH.urlEncode(search)+"&opensearch",{onSuccess:receive,textbox:textbox,search:search})}function preFetch(textbox,search){if(cancelNext){cancelNext=0;return}hasData=0;if(timer>0){clearTimeout(timer);timer=0}timer=setTimeout(fetch.bind(0,textbox,search),LIVESEARCH_DELAY)}function cycle(dir){if(!isVisible()){if(hasData){show()}return}var firstNode=(container.childNodes[0].nodeName=="EM"?container.childNodes[3]:container.firstChild);var bakDiv=dir?firstNode:container.lastChild;if(lastDiv==null){colorDiv(bakDiv)}else{var div=dir?lastDiv.nextSibling:lastDiv.previousSibling;if(div){if(div.nodeName=="STRONG"){div=container.lastChild}colorDiv(div)}else{colorDiv(bakDiv)}}}function onKeyUp(e){e=WH.normalizeEvent(e);var textbox=e._target;var search=WH.trim(textbox.value.replace(/\s+/g," "));if(search==lastSearch[textbox.id]){return}lastSearch[textbox.id]=search;if(textbox!=document){currentTextbox=textbox}if(search.length){preFetch(textbox,search)}else{hide()}}function onKeyDown(e){e=WH.normalizeEvent(e);switch(e.keyCode){case 27:hide();break;case 38:cycle(0);break;case 40:cycle(1);break}}function onFocus(e){e=WH.normalizeEvent(e);var textbox=e._target;if(textbox!=document){currentTextbox=textbox}}this.attach=function(textbox){textbox=$(textbox);if(!textbox.length){return}textbox=textbox[0];if(textbox.getAttribute("autocomplete")=="off"){return}textbox.setAttribute("autocomplete","off");WH.aE(textbox,"focus",onFocus);WH.aE(textbox,"keyup",onKeyUp);WH.aE(textbox,"keydown",onKeyDown)};this.reset=function(textbox){lastSearch[textbox.id]=null;textbox.value="";hasData=0;hide()};this.hide=function(){hide()}};WH.locale=new function(){this.domainToLocale={www:"enus",live:"enus",ptr:"ptr",beta:"beta",mop:"enus",wod:"enus",legion:"enus",bfa:"beta",fr:"frfr",de:"dede",es:"eses",ru:"ruru",pt:"ptbr",it:"itit",cn:"zhcn",ko:"kokr"}};var LOCALE_ENUS=0;var LOCALE_KOKR=1;var LOCALE_FRFR=2;var LOCALE_DEDE=3;var LOCALE_ZHCN=4;var LOCALE_ESES=6;var LOCALE_RURU=7;var LOCALE_PTBR=8;var LOCALE_ITIT=9;var Locale={current:{},locales:{0:{id:LOCALE_ENUS,name:"enus",domain:"www.wowhead.com",description:"English"},1:{id:LOCALE_KOKR,name:"kokr",domain:"ko.wowhead.com",description:"한국어"},2:{id:LOCALE_FRFR,name:"frfr",domain:"fr.wowhead.com",description:"Fran"+String.fromCharCode(231)+"ais"},3:{id:LOCALE_DEDE,name:"dede",domain:"de.wowhead.com",description:"Deutsch"},4:{id:LOCALE_ZHCN,name:"zhcn",domain:"cn.wowhead.com",description:"简体中文"},6:{id:LOCALE_ESES,name:"eses",domain:"es.wowhead.com",description:"Espa"+String.fromCharCode(241)+"ol"},7:{id:LOCALE_RURU,name:"ruru",domain:"ru.wowhead.com",description:String.fromCharCode(1056,1091,1089,1089,1082,1080,1081)},8:{id:LOCALE_PTBR,name:"ptbr",domain:"pt.wowhead.com",description:"Português Brasileiro"},9:{id:LOCALE_ITIT,name:"itit",domain:"it.wowhead.com",description:"Italiano"}},getAll:function(){var b=[];for(var c in Locale.locales){b.push(Locale.locales[c])}return b},getAllByName:function(){var b=Locale.getAll();b.sort(function(d,c){return WH.stringCompare(d.description,c.description)});return b},getId:function(){return Locale.current.id},getName:function(){var b=Locale.getId();return Locale.locales[b].name},get:function(){var b=Locale.getId();return Locale.locales[b]},set:function(b){$.extend(Locale.current,Locale.locales[b]);if(b!==LOCALE_ENUS){Menu.sortGlobalMenus()}},getSmartCommaList:function(c,h){if(!h){h="and"}var f=c.length;var b="";for(var d=0,g;g=c[d];d++){if(d>0){if(d===f-1){if(f===2){b+=h==="or"?LANG.wordspace+LANG.or+LANG.wordspace:LANG.and}else{b+=h==="or"?LANG.enum_end_or:LANG.enum_end}}else{b+=LANG["enum"]}}b+=g}return b}};Locale.set(LOCALE_ENUS);function Mapper(c,d){WH.cO(this,c);if(this.parent&&!this.parent.nodeName){this.parent=WH.ge(this.parent)}else{if(!this.parent){return}}var b;this.mouseX=this.mouseY=0;this.editable=this.editable||false;this.overlay=this.overlay||false;this.rootMapDir=this.legacy?"/images/wow/maps/legacy":"/images/wow/maps";if(this.editable){this.zoomable=this.toggle=false;this.show=this.mouse=true}else{this.zoomable=(this.zoomable==null?true:this.zoomable);this.toggle=(this.toggle==null?true:this.toggle);this.show=(this.show==null?true:this.show);this.mouse=(this.mouse==null?false:this.mouse)}this.buttons=(this.buttons==null?true:this.buttons);this.zoneLink=(this.zoneLink==null?true:this.zoneLink);if(location.href.indexOf("zone=")!=-1){this.zoneLink=false}this.zoom=(this.zoom==null?0:this.zoom);this.zone=(this.zone==null?0:this.zone);this.level=(this.level==null?(Mapper.zoneDefaultLevel[this.zone]?Mapper.zoneDefaultLevel[this.zone]:0):this.fixLevel(this.level,this.zone));this.pins=[];this.nCoords=0;this.tempWidth=null;this.tempHeight=null;this.parent.className="mapper";this.parent.appendChild(this.span=WH.ce("span",{className:"mapper-map"}));WH.disableOldIESelect(this.span);this.overlaySpan=b=WH.ce("div",{className:"mapper-overlay"});this.overlaySpan.appendChild(WH.ce("div",{className:"mapper-overlay-expander"}));this.span.appendChild(b);this.buttonDiv=b=WH.ce("div");b.style.position="absolute";b.style.top=b.style.right="3px";if(this.buttons){this.parent.appendChild(b)}if(this.editable){this.span.onmouseup=this.addPin.bind(this);b=WH.createTextGlow(LANG.mapper_tippin);b.style.fontSize="13px";b.style.position="absolute";b.style.bottom=b.style.right="0";WH.disableOldIESelect(b);this.parent.appendChild(b)}else{this.sToggle=b=WH.createButton(LANG.mapper_hidepins,null,{click:this.toggleShow.bind(this)});b.style["float"]="right";b.style.display="none";WH.disableOldIESelect(b);this.buttonDiv.appendChild(b)}if(this.zoomable){this.span.onclick=this.toggleZoom.bind(this);this.span.id="sjdhfkljawelis"+(this.unique!==undefined?this.unique:"");this.sZoom=b=WH.createTextGlow(LANG.mapper_tipzoom,"mapper-zoomtip");b.style.fontSize="13px";b.style.position="absolute";b.style.bottom=b.style.right="0";WH.disableOldIESelect(b);this.span.appendChild(b)}this.sZoneLink=b=WH.createTextGlow("");b.style.display="none";b.style.position="absolute";b.style.top=b.style.left="0";this.parent.appendChild(b);if(this.mouse){this.parent.onmouseout=(function(){this.timeout=setTimeout((function(){this.sMouse.style.display="none"}).bind(this),1)}).bind(this);this.parent.onmouseover=(function(){clearTimeout(this.timeout);this.sMouse.style.display=""}).bind(this);this.span.onmousemove=this.span.onmousedown=this.getMousePos.bind(this);this.sMouse=b=WH.createTextGlow("(0.0, 0.0)");b.style.display="none";b.style.position="absolute";b.style.bottom=b.style.left="0";b.onmouseup=WH.sp;WH.disableOldIESelect(b);this.span.appendChild(b)}this.floorPins={};if(c.coords!=null){this.setCoords(c.coords)}else{if(c.link!=null){this.setLink(c.link)}}if(c.objectives){this.setObjectives(c.objectives)}if(c.zoneparent&&c.zones){this.setZones(c.zoneparent,c.zones)}this.updateMap(d)}Mapper.sizes=[[488,325,"normal"],[772,515,"zoom"],[1002,668,"original"],[224,149,"small"]];Mapper.zoneLevelOffset={};Mapper.multiLevelZones={};Mapper.zonePhased={};Mapper.garrisonLevelsToMapTiers={};Mapper.zoneDefaultLevel={};Mapper.remappedLevels={};Mapper.prototype={getMap:function(){return this.parent},update:function(f,j){if(f.zoom!=null){this.zoom=f.zoom}if(f.zone!=null){this.zone=f.zone}if(f.show!=null){this.show=f.show}this.pins=[];this.nCoords=0;for(var h in this.floorPins){if(this.floorPins[h].parentNode){WH.de(this.floorPins[h])}}this.floorPins={};if(this.floorButton){WH.de(this.floorButton);this.floorButton=null}var b=(f.level===undefined?0:this.fixLevel(parseInt(f.level),this.zone));if(!f.preservelevel){this.level=b}else{b=this.level}var d=WH.isSet("g_mapperData")?g_mapperData:false;if(d&&d[this.zone]&&!f.coords){var l=d[this.zone];var g=-1;for(var h in l){if(!l.hasOwnProperty(h)){continue}var c=this.fixLevel(parseInt(h),this.zone);if(f.level===undefined&&l[h].count>g){b=parseInt(c);g=l[h].count}if(l[h].coords){this.setCoords(l[h].coords,c)}}this.level=b;if(this.floorPins[this.level]){WH.ae(this.span,this.floorPins[this.level])}}else{if(f.coords!=null){var k=999;for(var h in f.coords){if(!f.coords.hasOwnProperty(h)){continue}var c=this.fixLevel(parseInt(h),this.zone);this.setCoords(f.coords[h],c);if(c<k){k=c}}if(k!=999&&!f.preservelevel){this.level=k}if(this.floorPins[this.level]){WH.ae(this.span,this.floorPins[this.level])}}else{if(f.link!=null){this.setLink(f.link)}}}this.updateMap(j)},fixLevel:function(g,f){if(Mapper.remappedLevels[f]&&Mapper.remappedLevels[f].hasOwnProperty(g)){return Mapper.remappedLevels[f][g]}if(Mapper.multiLevelZones.hasOwnProperty(f)){var d=parseInt(Mapper.multiLevelZones[f][0].substr((""+f).length+1));var c;for(var b=1;b<Mapper.multiLevelZones[f].length;b++){c=parseInt(Mapper.multiLevelZones[f][b].substr((""+f).length+1));if(Math.abs(g-c)<Math.abs(g-d)){d=c}}return d}return g},getZone:function(){return this.zone},setZone:function(b,d,c){this.pins=[];this.nCoords=0;if(this.floorPins[this.level]){WH.de(this.floorPins[this.level])}this.floorPins={};if(this.floorButton){WH.de(this.floorButton);this.floorButton=null}this.zone=b;this.level=d||0;this.updateMap(c);return true},getFloorsMenu:function(){if(!Mapper.multiLevelZones[this.zone]){return null}var j=[];var c=Mapper.multiLevelZones[this.zone];var h=(Mapper.zonePhased[this.zone]?g_zone_phases:g_zone_areas);var d=(function(l){return l[0]==this.level||(this.level===undefined&&l[0]==0)}).bind(this);var k,g,f;for(var b=0;g=c[b];b++){if(g.indexOf("-")<0){k=b}else{k=g.substr(g.indexOf("-")+1)}if(!h[this.zone]){f=[k,(Mapper.zonePhased[this.zone]?"[Phase ":"[Level ")+k+"]",this.setMap.bind(this,g,k,true)]}else{if(!h[this.zone].hasOwnProperty(k)){continue}f=[k,h[this.zone][k],this.setMap.bind(this,g,k,true)]}f[MENU_IDX_OPT]={checkedFunc:d};j.push(f)}return j},setMap:function(d,c,k){if(c!=this.level){if(this.floorPins[this.level]){WH.de(this.floorPins[this.level])}if(this.floorPins[c]){WH.ae(this.span,this.floorPins[c])}this.level=c}var j=Locale.getName();if(WH.isPtr()){j="ptr"}else{if(WH.isBeta()){j="beta"}}this.span.style.background="url("+g_staticUrl+this.rootMapDir+"/"+j+"/"+Mapper.sizes[this.zoom][2]+"/"+d+".jpg?"+g_wow_build+")";if(this.overlay){this.overlaySpan.style.background="url("+g_staticUrl+this.rootMapDir+"/overlay/"+Mapper.sizes[this.zoom][2]+"/"+d+".png?"+g_wow_build+")"}if(this.sZoneLink&&!this.noZoneName){var h="";var f=parseInt(this.zone);var l=g_zones[f]!=null;var b=(Mapper.zonePhased[this.zone]?g_zone_phases:g_zone_areas);if(l){if(this.zoneLink){h+='<a href="/zone='+f+'">'+g_zones[f]+"</a>"}if(Mapper.multiLevelZones[f]){if(this.zoneLink){h+=": "}h+=(b[f]&&b[f][c])?b[f][c]:((Mapper.zonePhased[f]?"Phase ":"Level ")+c)}WH.setInnerHtml(this.sZoneLink,h,"div");if(this.zoneLink){for(var g=0;g<9;++g){if(g==4){continue}this.sZoneLink.childNodes[g].firstChild.style.color="black"}}}this.sZoneLink.style.display=l?"":"none"}if(k){this.onMapUpdate&&this.onMapUpdate(this)}},setObjectives:function(h){var c={start:1,end:1,startend:1,sourcestart:1,sourceend:1};for(var m in h){var k=h[m];if(g_mapperData[m]===undefined){g_mapperData[m]={}}for(var d in k.levels){var b=k.levels[d];var j=ShowOnMap.combinePins(b);var f=j[0];g_mapperData[m][d]={count:f.length,coords:[]};for(var g=0;g<f.length;++g){var n=ShowOnMap.buildTooltip(f[g].list);g_mapperData[m][d].coords.push([f[g].coord[0],f[g].coord[1],{type:n[1],url:n[2],menu:n[3],label:n[0]}])}}}},setZones:function(o,p){o=$("#"+o);if(!o||!p||p.length==0||!this.objectives){return}var s=function(E,D,B,I){var C=[false,-1];for(var G=0;G<B.length;++G){if(G>0){t.append((G==B.length-1?LANG.and:LANG.comma))}var H=null;if(E.objectives[B[G][0]].mappable>0){H=$("<a/>",{href:"javascript:;",text:E.objectives[B[G][0]].zone});H.click(function(K,J){E.update({zone:J});WH.setSelectedLink(K,"mapper")}.bind(E,H[0],B[G][0]));H.isLink=true}else{H=$("<a/>",{href:"/zone="+B[G][0],text:E.objectives[B[G][0]].zone});WH.Tooltip.simple(H[0],LANG.tooltip_zonelink,"q")}if(p.length>1){var F=I[B[G][0]];if(F.start&&F.end){H.addClass("icontiny");H.css("background-image","url("+g_staticUrl+"/images/wow/icons/tiny/quest_startend.gif)");H.css("padding-left","20px")}else{if(F.start){H.addClass("icontiny");H.css("background-image","url("+g_staticUrl+"/images/wow/icons/tiny/quest_start.gif)");H.css("padding-left","14px")}else{if(F.end){H.addClass("icontiny");H.css("background-image","url("+g_staticUrl+"/images/wow/icons/tiny/quest_end.gif)");H.css("padding-left","16px")}}}}D.append(H);if(B[G][1]>C[1]){C=[H,B[G][1]]}}return C[0]};var f=function(B,F,E){var C=[];for(var D=0;D<B.length;++D){if(F[B[D][0]][E]){C.push(B[D])}}return C};var h={};var l={start:[],end:[],objective:[]};for(var m in this.objectives){if(h[m]===undefined){h[m]={}}var v=this.objectives[m];for(var A in v.levels){var c=v.levels[A];for(var u=0;u<c.length;++u){if(c[u].point=="start"||c[u].point=="sourcestart"){l.start.push(m);h[m].start=true}else{if(c[u].point=="end"||c[u].point=="sourceend"){l.end.push(m);h[m].end=true}else{if(c[u].point=="requirement"||c[u].point=="sourcerequirement"){l.objective.push(m);h[m].objective=true}}}}}}o.append(WH.getMajorHeading(LANG.mapper_relevantlocs,2,3));if(p.length==1&&this.missing==0){var t=$("<span/>",{html:LANG.mapper_entiretyinzone.replace("$$","<b>"+this.objectives[p[0][0]].zone+"</b>.")});o.append(t);this.update({zone:p[0][0]})}else{if(this.missing>0){var j=function(D,C){if(D.length!=C.length){return false}var B={};for(var F=D.length;F>=0;--F){B[D[F]]=true}for(var E=C.length;E>=0;--E){if(B[C[E]]===undefined){return false}}return true};var t=$("<span/>");var b=false,d=false,r=false;l.objective=WH.arrayUnique(l.objective);l.start=WH.arrayUnique(l.start);l.end=WH.arrayUnique(l.end);var w=l.start.length>0&&j(l.start,l.end);var g=l.start.length>0&&j(l.start,l.objective);var z=l.end.length>0&&j(l.end,l.objective);var y=f(p,h,"objective");var n=f(p,h,"start");var k=f(p,h,"end");switch(true){case !!(w&&g):var q=LANG.mapper_happensin.split("$$");t.text(q[0]);b=s(this,t,p,h);t.append(q[1]);break;case !!(w&&l.objective.length==0):var q=LANG.mapper_objectives.sex.split("$$");t.text(q[0]);b=s(this,t,p,h);t.append(q[1]);break;case !!(w):var q=LANG.mapper_objectives.ox_sey.split("$$");t.text(q[0]);b=s(this,t,n,h);t.append(q[1]);d=s(this,t,y,h);t.append(q[2]);break;case !!(g&&l.end.length==0):var q=LANG.mapper_objectives.osx.split("$$");t.text(q[0]);b=s(this,t,p,h);t.append(q[1]);break;case !!(g):var q=LANG.mapper_objectives.osx_ey.split("$$");t.text(q[0]);b=s(this,t,y,h);t.append(q[1]);d=s(this,t,k,h);t.append(q[2]);break;case !!(z&&l.start.length==0):var q=LANG.mapper_objectives.oex.split("$$");t.text(q[0]);b=s(this,t,p,h);t.append(q[1]);break;case !!(z):var q=LANG.mapper_objectives.oex_sy.split("$$");t.text(q[0]);b=s(this,t,n,h);t.append(q[1]);d=s(this,t,y,h);t.append(q[2]);break;case !!(l.start.length>0&&l.end.length>0&&l.objective.length>0):var q=LANG.mapper_objectives.ox_sy_ez.split("$$");t.text(q[0]);b=s(this,t,n,h);t.append(q[1]);d=s(this,t,y,h);t.append(q[2]);r=s(this,t,k,h);t.append(q[3]);break;case !!(l.start.length>0&&l.end.length>0):var q=LANG.mapper_objectives.sx_ey.split("$$");t.text(q[0]);b=s(this,t,n,h);t.append(q[1]);d=s(this,t,k,h);t.append(q[2]);break;case !!(l.start.length>0&&l.objective.length>0):var q=LANG.mapper_objectives.ox_sy.split("$$");t.text(q[0]);b=s(this,t,n,h);t.append(q[1]);d=s(this,t,y,h);t.append(q[2]);break;case !!(l.end.length>0&&l.objective.length>0):var q=LANG.mapper_objectives.ox_ey.split("$$");t.text(q[0]);b=s(this,t,y,h);t.append(q[1]);d=s(this,t,k,h);t.append(q[2]);break;case (l.start.length>0):var q=LANG.mapper_objectives.sx.split("$$");t.text(q[0]);b=s(this,t,p,h);t.append(q[1]);break;case (l.end.length>0):var q=LANG.mapper_objectives.ex.split("$$");t.text(q[0]);b=s(this,t,p,h);t.append(q[1]);break;case (l.objective.length>0):var q=LANG.mapper_objectives.ox.split("$$");t.text(q[0]);b=s(this,t,p,h);t.append(q[1]);break;default:var q=LANG.mapper_happensin.split("$$");t.text(q[0]);b=s(this,t,p,h);t.append(q[1]);break}o.append(t);if(b&&b.isLink){b.click()}else{if(d&&d.isLink){d.click()}else{if(r&&r.isLink){r.click()}}}}else{var q=LANG.mapper_happensin.split("$$");var t=$("<span/>",{text:q[0]});var b=s(this,t,p,h);t.append(q[1]);o.append(t);if(b&&b.isLink){b.click()}}}},setSize:function(b,c){this.tempWidth=b;this.tempHeight=c;this.updateMap(true)},getZoom:function(){return this.zoom},setZoom:function(b,c){this.zoom=b;this.tempWidth=this.tempHeight=null;this.updateMap(c)},toggleZoom:function(c){this.zoom=1-this.zoom;this.zoom++;this.updateMap(true);if(c){this.getMousePos(c)}if(this.sZoom){if(this.sZoom.style.display=="none"){this.sZoom.style.display=""}else{this.sZoom.style.display="none"}}if(this.zoom){var b=Platform.getViewportSize();if(b.width>=900){MapViewer.show({mapper:this,zoom:this.zoom})}}},getShow:function(){return this.show},setShow:function(b){this.show=b;var f=this.show?"":"none";for(var c in this.floorPins){this.floorPins[c].style.display=f}this.sToggle.innerHTML=this.show?LANG.mapper_hidepins:LANG.mapper_showpins},toggleShow:function(){this.setShow(!this.show)},getCoords:function(){var b=[];for(var c in this.pins){if(!this.pins[c].free){b.push([this.pins[c].x,this.pins[c].y])}}return b},clearPins:function(){for(var b in this.pins){this.pins[b].style.display="none";this.pins[b].free=true}},setCoords:function(r,n){var b;var d,j;if(n===undefined){this.clearPins();if(r.length){j=true;d=0}else{for(var h in r){d=h;break}if(d==null){return}r=r[d]}d=parseInt(d);if(!j){d=this.fixLevel(d,this.zone);this.level=d}}else{d=n}this.nCoords=r.length;for(var h in r){var o=r[h],g=o[2];if(o[0]===undefined||o[1]===undefined){continue}if(o[0]===null||o[1]===null){var q=this.parent.id?this.parent.id.replace(/^mapper-parent-/,""):this.parent;if(g_zones[q]){q=g_zones[q]}WH.error("Bad coordinates for",q,"-- Pin Coords:",o);continue}b=this.getPin(d);b.x=o[0];b.y=o[1];b.style.left=b.x+"%";b.style.top=b.y+"%";if(this.editable){b.a.onmouseup=this.delPin.bind(this,b)}else{if(g&&g.url){b.a.href=WH.markup.getFixedUrl(g.url);b.a.rel="np"+(g.rel?"&"+g.rel:"");b.a.style.cursor="pointer"}}if(g&&g.tooltip){b.a.tt="";var m=false;for(var c in g.tooltip){if(b.a.tt!=""){b.a.tt+="<br />"}b.a.tt+='<b class="q">'+c+"</b> ($)<br />";for(var v in g.tooltip[c].info){b.a.tt+="<div>"+g.tooltip[c].info[v]+"</div>"}if(!m&&g.tooltip[c].footer){b.a.tt+=g.tooltip[c].footer+"<br />";m=true}}}else{if(g&&g.label){b.a.tt=g.label}else{if(g&&g.fixTooltip){b.a.rel=b.a.rel.replace(/^np&?/,"");WH.dE(b.a,"mouseover",this.pinOver);WH.dE(b.a,"mouseout",WH.Tooltip.hide);b.a.tt="";if(typeof g.fixTooltip=="function"){b.a._fixTooltip=g.fixTooltip}}else{b.a.tt="$"}}}if(g&&g.menu){b.a.menu=g.menu;Menu.add(b.a,b.a.menu,{showAtCursor:true})}if(g&&g.type){b.className+=" pin-"+g.type}if(g&&g.mapicon){b.className+=" pin-object";b.a.style.backgroundPosition=(((g.mapicon+2)%8)*-16)+"px "+(Math.floor((g.mapicon+2)/8)*-16)+"px"}b.a.tt=WH.stringReplace(b.a.tt,"$",b.x.toFixed(1)+", "+b.y.toFixed(1));if(g&&g.lines){for(var f=0,l=g.lines.length;f<l;++f){if(o[0]==g.lines[f][0]&&o[1]==g.lines[f][1]){continue}for(var u=0,k=Mapper.sizes.length;u<k;++u){var t=Mapper.sizes[u];b=this.line(o[0]*t[0]/100,o[1]*t[1]/100,g.lines[f][0]*t[0]/100,g.lines[f][1]*t[1]/100,g.type);b.className+=" "+t[2];WH.ae(this.floorPins[d],b)}}}}this.onPinUpdate&&this.onPinUpdate(this)},getLink:function(){var c="";for(var b in this.pins){if(!this.pins[b].free&&this.pins[b].floor==this.level){c+=(this.pins[b].x<10?"0":"")+(this.pins[b].x<1?"0":"")+(this.pins[b].x*10).toFixed(0)+(this.pins[b].y<10?"0":"")+(this.pins[b].y<1?"0":"")+(this.pins[b].y*10).toFixed(0)}}return(this.zone?this.zone:"")+(Mapper.multiLevelZones[this.zone]&&this.level!=0?"."+this.level:"")+(c?":"+c:"")},setLink:function(j,f,m){var l=[];j=j.split(":");var g=j[0];var b=0;if(g.indexOf(".")!=-1){var c=g.split(".");g=c[0];b=parseInt(c[1])}b=(m&&m!=-1&&!b)?m:b;if(!this.setZone(g,b,f)){return false}if(j.length==2){for(var d=0;d<j[1].length;d+=6){var k=j[1].substr(d,3)/10;var h=j[1].substr(d+3,3)/10;if(isNaN(k)||isNaN(h)){break}l.push([k,h])}}this.setCoords(l,b);return true},updateMap:function(c){this.parent.style.width=this.span.style.maxWidth=(this.tempWidth?this.tempWidth:Mapper.sizes[this.zoom][0])+"px";this.span.style.maxHeight=(this.tempHeight?this.tempHeight:Mapper.sizes[this.zoom][1])+"px";this.parent.setAttribute("data-mapsize",Mapper.sizes[this.zoom][2]);if(!this.editable){this.parent.style.cssFloat=this.parent.style.styleFloat="left"}if(this.zone=="0"){this.span.style.background="black"}else{var f=this.level;var d=this.zone+(f?"-"+f:"");if(Mapper.garrisonLevelsToMapTiers[this.zone]&&Mapper.garrisonLevelsToMapTiers[this.zone][f]){d=this.zone+"__"+Mapper.garrisonLevelsToMapTiers[this.zone][f]}this.setMap(d,f);if(!this.floorButton&&Mapper.multiLevelZones[this.zone]){var b;this.floorButton=b=WH.createButton((Mapper.zonePhased[this.zone]?LANG.mapper_phase:LANG.mapper_floor));b.menu=this.getFloorsMenu();if(b.menu&&b.menu.length){Menu.add(b,b.menu,{showAtElement:true})}b.style["float"]="right";WH.disableOldIESelect(b);this.buttonDiv.appendChild(b)}else{if(this.floorButton){this.floorButton.style.display=Mapper.multiLevelZones[this.zone]?"":"none"}}}if(this.sToggle){this.sToggle.style.display=(this.toggle&&this.nCoords?"":"none")}$(".line",this.floorPins[f]).hide();$(".line."+Mapper.sizes[this.zoom][2],this.floorPins[f]).show();this.onMapUpdate&&this.onMapUpdate(this)},cleanPin:function(c,d){var b=this.pins[c];b.style.display="";b.free=false;b.className="pin";b.a.onmousedown=WH.rf;b.a.onmouseup=WH.rf;b.a.href="javascript:;";b.a.style.cursor="default";b.floor=d;return b},getPin:function(f){for(var d=0;d<this.pins.length;++d){if(this.pins[d].free){return this.cleanPin(d,f)}}var c=WH.ce("div"),b=WH.ce("a");c.className="pin";c.appendChild(b);c.a=b;c.floor=f;WH.aE(b,"mouseover",this.pinOver);WH.aE(b,"mouseout",WH.Tooltip.hide);b.onclick=WH.sp;this.pins.push(c);this.cleanPin(this.pins.length-1,f);if(!this.floorPins[f]){this.floorPins[f]=WH.ce("div");this.floorPins[f].style.display=this.show?"":"none";if(f==this.level){WH.ae(this.span,this.floorPins[f])}}WH.ae(this.floorPins[f],c);return c},addPin:function(c){c=WH.normalizeEvent(c);if(c._button>=2){return}this.getMousePos(c);var b=this.getPin(this.level);b.x=this.mouseX;b.y=this.mouseY;b.style.left=b.x.toFixed(1)+"%";b.style.top=b.y.toFixed(1)+"%";b.a.onmouseup=this.delPin.bind(this,b);b.a.tt=b.x.toFixed(1)+", "+b.y.toFixed(1);this.onPinUpdate&&this.onPinUpdate(this);return false},delPin:function(b,c){c=WH.normalizeEvent(c);b.style.display="none";b.free=true;WH.sp(c);this.onPinUpdate&&this.onPinUpdate(this)},pinOver:function(){WH.Tooltip.show(this,this.tt,4,0)},getMousePos:function(d){d=WH.normalizeEvent(d);var f=WH.ac(this.parent);var b=WH.getScroll();this.mouseX=Math.floor((d.clientX+b.x-f[0]-3)/Mapper.sizes[this.zoom][0]*1000)/10;this.mouseY=Math.floor((d.clientY+b.y-f[1]-3)/Mapper.sizes[this.zoom][1]*1000)/10;if(this.mouseX<0){this.mouseX=0}else{if(this.mouseX>100){this.mouseX=100}}if(this.mouseY<0){this.mouseY=0}else{if(this.mouseY>100){this.mouseY=100}}if(this.mouse){WH.setTextNodes(this.sMouse,"("+this.mouseX.toFixed(1)+", "+this.mouseY.toFixed(1)+")")}},line:function(g,p,d,o,l){var j=Math.min(g,d);var r=Math.max(g,d);var n=Math.min(p,o);var b=Math.max(p,o);var f=(r-j);var s=(b-n);var h=Math.sqrt(Math.pow(f,2)+Math.pow(s,2));var m=Math.atan2(s,f);var c=Math.sin(m);var k=Math.cos(m);var q=$('<span class="line" />').css({top:n.toFixed(2)+"px",left:j.toFixed(2)+"px",width:f.toFixed(2)+"px",height:s.toFixed(2)+"px"}).append($("<var />").css({width:h.toFixed(2)+"px","-o-transform":"rotate("+m+"rad)","-moz-transform":"rotate("+m+"rad)","-webkit-transform":"rotate("+m+"rad)",filter:"progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11="+k+", M12="+(-1*c)+", M21="+c+", M22="+k+")"}));if(!(g==j&&p==n)&&!(d==j&&o==n)){q.addClass("flipped")}if(l!=null){q.addClass("line-"+l)}return q[0]}};var g_zone_areas={};var MapViewer=new function(){var p,w,A,b,v,f,m,k,t,c,n,q,d,u,y;function o(){var B=Math.max(50,Math.min(618,WH.getWindowSize().h-72));b=1;A=1;if(b>1){b=1}if(A>1){A=1}p=Math.round(A*Mapper.sizes[MapViewer.getZoom()][0]);w=Math.round(A*Mapper.sizes[MapViewer.getZoom()][1]);if(d){$(".mapviewer-screen-sizer",d).remove();var C=WH.ce("div",{className:"mapviewer-screen-sizer"});C.style.paddingTop=w/p*100+"%";WH.ae(d,C)}var D=Math.max(480,p);Lightbox.setSize(D+20,w+52)}function g(B){var C=function(F,E){E+=":"+F.zone;if(F.level){E+="."+F.level}return E};var D="#map";if(c){D+="="+v.getLink()}else{if(Mapper.zoneDefaultLevel[v.zone]){if(Mapper.zoneDefaultLevel[v.zone]!=v.level){D=C(v,D)}}else{if(v.level!=0){D=C(v,D)}else{if((!WH.isSet("g_mapperData")||!g_mapperData[v.zone])&&(!WH.isSet("g_mapper_data")||!g_mapper_data[v.zone])){D=C(v,D)}}}}return D}function s(){if(m){m(v)}location.replace(g(true))}function z(B){if(B&&(A==b)&&WH.getWindowSize().h>q.offsetHeight){return}q.style.visibility="hidden";o(0);if(!B){if(!n){n=WH.ce("div");n.style.height="325px";n.style.padding="3px";n.style.marginTop="10px"}v.parent.style.borderWidth="0px";v.parent.style.marginTop="0px";v.span.style.cursor="pointer";if(v.span.onclick){f=v.span.onclick}v.span.onclick=Lightbox.hide;v.span.onmouseover=function(){y.style.display="block"};v.span.onmouseout=function(){setTimeout(function(){if(!y.hasMouse){y.style.display="none"}},10)};if(v.onMapUpdate){m=v.onMapUpdate}v.onMapUpdate=s;if(!c){k=v.parent.parentNode;t=v.parent.nextSibling;k.insertBefore(n,v.parent);WH.de(v.parent);WH.ae(u,v.parent)}else{WH.de(c);WH.ae(u,c)}if(location.hash.indexOf("#show")==-1){location.replace(g(false))}else{if(WH.isSet("mapShower")){mapShower.onExpand()}}}Lightbox.reveal();q.style.visibility="visible"}function j(){z(1)}function h(){if(f){v.span.onclick=f}else{v.span.onclick=null}f=null;if(m){v.onMapUpdate=m}else{v.onMapUpdate=null}m=null;v.span.style.cursor="";v.span.onmouseover=null;v.span.onmouseout=null;if(!c){WH.de(n);WH.de(v.parent);v.parent.style.borderWidth="";v.parent.style.marginTop="";if(t){k.insertBefore(v.parent,t)}else{WH.ae(k,v.parent)}k=t=null}else{WH.de(c);c=null}v.toggleZoom();if(location.hash.indexOf("#show")==-1){WH.clearHash()}else{if(WH.isSet("mapShower")){mapShower.onCollapse()}}}function r(C,F,D){v=D.mapper;q=C;if(F){C.className+=" mapviewer";d=WH.ce("div");d.style.width=Mapper.sizes[MapViewer.getZoom()][0]+"px";d.style.height=Mapper.sizes[MapViewer.getZoom()][1]+"px";d.className="lightbox-content mapviewer-screen";y=WH.ce("a");y.className="mapviewer-cover";y.href="javascript:;";y.onclick=Lightbox.hide;y.onmouseover=function(){y.hasMouse=true};y.onmouseout=function(){y.hasMouse=false};var G=WH.ce("span");var B=WH.ce("b");WH.ae(B,WH.ct(LANG.close));WH.ae(G,B);WH.ae(y,G);WH.ae(d,y);u=WH.ce("div");WH.ae(d,u);WH.ae(C,d);var E=WH.ce("a");E.className="dialog-x fa fa-times";E.href="javascript:;";E.onclick=Lightbox.hide;WH.ae(E,WH.ct(LANG.close));WH.ae(C,E)}l()}function l(){z()}this.checkPound=function(){if(location.hash&&location.hash.indexOf("#map")==0){var F=location.hash.split("=");if(F.length==2){var D=F[1];if(D){MapViewer.show({link:D})}}else{F=location.hash.split(":");var E=WH.ge("sjdhfkljawelis");if(E){E.onclick()}if(F.length==2){if(!E){MapViewer.show({link:F[1]})}var B=F[1].split(".");var C={zone:B[0]};if(B.length==2){C.level=parseInt(B[1])+1}v.update(C)}}}};this.getZoom=function(){if(typeof this.zoom=="number"){return this.zoom}return 1};this.show=function(B){this.zoom=B.zoom;WH.Track.interactiveEvent("Zone Maps","Show",(B.link?B.link:"General"));if(B.link){c=WH.ce("div");c.id="fewuiojfdksl";WH.ae(document.body,c);var C=new Mapper({parent:c.id});C.setLink(B.link,true);C.toggleZoom()}else{Lightbox.show("mapviewer",{onShow:r,onHide:h,onResize:j},B)}};$(document).ready(this.checkPound)};WH.markup=new function(){var b="abc";var c="name_enus";this.MODE={COMMENT:1,ARTICLE:2,QUICK_FACTS:3,SIGNATURE:4,REPLY:5};this.CLASS={ADMIN:40,STAFF:30,PREMIUM:20,USER:10,PENDING:1};this.SOURCE={LIVE:1,PTR:2,BETA:3};this.modes={};this.modes[this.MODE.COMMENT]="comment";this.modes[this.MODE.REPLY]="reply";this.modes[this.MODE.ARTICLE]="article";this.modes[this.MODE.QUICK_FACTS]="quickfacts";this.modes[this.MODE.SIGNATURE]="signature";this.sources={};this.sources[this.SOURCE.LIVE]="live";this.sources[this.SOURCE.PTR]="ptr";this.sources[this.SOURCE.BETA]="beta";this.globalAttributes={id:{req:false,valid:/^[a-z0-9_-]+$/i},title:{req:false,valid:/[\S ]+/},"class":{req:false,valid:/\S+/}};this.regex={betaPtrLang:/^(beta|mop|wod|legion|bfa|ptr|www|ko|fr|de|cn|es|ru|pt|it)$/,lang:/^(www|ko|fr|de|cn|es|ru|pt|it)$/};this.mode=this.MODE.ARTICLE;this.allow=this.CLASS.STAFF;this.root=undefined;this.dbPage=false;this.isPreview=false;this.inNewsType=0;this.mediaUid=b;this.tags={};this.initialized=false;this.defaultSource=false;this.firstTags={};this.postTags=[];this.collectTags={};this.excludeTags={};this.tooltipTags={};this.tooltipTagsWithRawText={};this.counts={};this.applyCommonAttributes=function(h,f){if(WH.markup.allow<this.CLASS.STAFF){return}if(f.id){h.id=f.id}if(f.title){h.title=f.title}if(f["class"]){if(h.className){h.className+=" "+f["class"]}else{h.className=f["class"]}}if(f.style){var g=h.getAttribute("style");if(g){h.setAttribute("style",g+"; "+f.style)}else{h.setAttribute("style",f.style)}}if(f["data-highlight"]){h.setAttribute("data-highlight",f["data-highlight"])}};this.init=function(){if(this.initialized){return}var k=[],g=[],j=[];for(var f in WH.markup.tags){if(!WH.markup.tags.hasOwnProperty(f)){continue}if(WH.markup.tags[f].block){WH.markup.firstTags[f]=true}if(WH.markup.tags[f].exclude){for(var h in WH.markup.tags[f].exclude){if(!WH.markup.tags[f].exclude.hasOwnProperty(h)){continue}if(!this.excludeTags[h]){this.excludeTags[h]={}}this.excludeTags[h][f]=WH.markup.tags[f].exclude[h]}}if(WH.markup.tags[f].post){this.postTags.push(f)}if(WH.markup.tags[f].trim){j.push(f)}if(WH.markup.tags[f].ltrim){k.push(f)}if(WH.markup.tags[f].rtrim){g.push(f)}}if(k.length>0){this.ltrimRegex=new RegExp("\\s*\\[("+k.join("|")+")([^a-z0-9]+.*)?]","ig")}if(g.length>0){this.rtrimRegex=new RegExp("\\[/("+g.join("|")+")\\]\\s*","ig")}if(j.length>0){this.trimRegex=new RegExp("\\s*\\[("+j.join("|")+")([^\\[]*)?\\]\\s*","ig")}this.initialized=true;$(function(){$("body").delegate("[data-highlight]","mouseenter",function(){var l=$(this).attr("data-highlight").split(":");if(l.length!=2){return}var m=$("#"+l[0]).get(0),p=parseInt(l[1]),o=$(m).val();if(!m||!p||!o){return}var n=$(m).val(o.substr(0,p))[0].scrollHeight;$(m).val(o).animate({scrollTop:n},250);m.selectionStart=p;m.selectionEnd=p})})};this.getAutoIncrementCount=function(f){if(!this.counts[f]){this.counts[f]=0}this.counts[f]++;return this.counts[f]};this.getCommonAttributes=function(f){var g="";if(WH.markup.allow<this.CLASS.STAFF){return g}if(f.id){g+=' id="'+f.id+'"'}if(f.title){g+=' title="'+f.title.replace('"','"').replace("'","'")+'"'}if(f["class"]){g+=' class="'+f["class"]+'"'}if(f.style){g+=' style="'+f.style+'"'}if(f["data-highlight"]){g+=' data-highlight="'+f["data-highlight"]+'"'}return g};this.convertToHtml=function(f){if(WH.isElement(f)){return f.outerHTML}if(WH.isArray(f)){return f.map(function(g){if(WH.isElement(g)){return g.outerHTML}return g})}if(WH.isString(f)){return f}WH.error("Trying to convert an unexpected markup tag result type to HTML. Returning raw value.",typeof f,f);return f};this.getDatabaseDomainInfo=function(f){var j="";var l=c;var n=location.hostname.split(".");var h="",k="";if(n.length>=4||n[0]=="local"||n[0]=="dev"){if(/^staging\d+$/.test(n[n.length-3])){k="."+n[n.length-3]}h=n[0]+"."}var m=false;if(f.domain){m=f.domain}else{if(f.site){m=f.site}else{if(this.defaultSource){m=this.sources[this.defaultSource]}}}if(m){switch(m){case"beta":m="bfa";break;case"live":case"wod":case"mop":case"www":m="www";if(h!=""){h=h.replace(/\.$/,"")}break}j="//"+h+(m=="www"&&h!=""?"":m)+k+".wowhead.com";var g=m=="live"?"www":m;l="name_"+WH.locale.domainToLocale[g]}else{j=WH.getRelativeHostPrefix()}return[j,l,m]};this.getEscapedHtml=function(g){var f=["nbsp","ndash"];if(typeof g=="undefined"){return""}g=g.replace(/&/g,"&amp;");if(f.length>0){g=g.replace(new RegExp("&amp;("+f.join("|")+");","g"),"&$1;")}return g.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};this.getFixedUrl=function(f){if(!f){return""}var g=f.charAt(0);if(g==="/"||g==="?"){f=f.replace(/^[\/\?]+/,"");f="/"+f}return f};this.getHtml=function(g,j){if(!j){j={}}if(!j.allow){if(j.roles){j.allow=this.rolesToClass(j.roles)}else{j.allow=this.CLASS.STAFF}}var f=d(g,j);var h=f.toHtml();if(j.prepend){h=j.prepend+h}if(j.append){h+=j.append}h=WH.fixWowheadHttps(h);setTimeout(WH.markup.tags.map.createMaps,250);return h};this.getImageUploadIds=function(g,h){var f=d(g,h);return f.imageUploadIds()};this.getMarkupFromHtml=function(g,j){var h=g.replace(/\n+/g,"");h=h.replace(/\s+/g," ");h=h.replace(/> </g,"><");h=h.replace(/&amp;/gi,"&");h=h.replace(/(&#160;|$nbsp;)/gi," ");for(var f in WH.markup.tags){if(WH.markup.tags.hasOwnProperty(f)&&WH.markup.tags[f].fromHtml){h=WH.markup.tags[f].fromHtml(h,j)}}h=h.replace(/<style\b[\s\S]*?>[\s\S]*?<\/style>/g,"");h=h.replace(/<\/?[a-z][a-z0-9]*\b[\s\S]*?>/g," ");h=h.replace(/<!--(.*?)-->/g,"");h=h.replace(/\n[\n]+/g,"\n\n");h=h.replace(/[ ]+/g," ");h=h.replace(/\t/g,"  ");return WH.trim(h)};this.getPreFormattedText=function(f){f=this.getEscapedHtml(f);f=f.replace(/\n/g,"<br>");return f};this.isUrlExternal=function(g){if(!g){return false}var f=WH.ce("a");f.href=g;return !(!f.hostname||/(^|\.)wowhead\.com$/.test(f.hostname))};this.isUrlSafe=function(g,h){if(!g){return true}if(g==="javascript:;"){return true}var f=g.match(/^([^:\\./]+):/i);if(f&&f[1]){var j=f[1];if(j==="http"||j==="https"){return true}if(h&&(j==="mailto"||j==="irc")){return true}if(j!=="mailto"&&g.indexOf("://")===-1){return true}return false}return true};this.matchOuterTags=function(u,o,y,j){var q=j.indexOf("g")>-1,r=j.replace(/g/g,""),w=new RegExp(o+"|"+y,"g"+r),p=new RegExp(o,r),v=[],z,A,k,h;do{z=0;while(k=w.exec(u)){if(p.test(k[0])){if(!z++){A=w.lastIndex;h=k}}else{if(z){if(!--z){v.push([u.slice(A,k.index),h[0],k[0]]);if(!q){return v}}}}}}while(z&&(w.lastIndex=A));return(v.length?v:false)};this.printHtml=function(g,f,h){var j=WH.ge(f);if(h&&h.removeTableTags){g=g.replace(/\[\/?(td|tr|table)[^\]]*]/g,"")}j.innerHTML=WH.markup.getHtml(g,h);WH.markup.tags.map.createMaps();if($(j).find("div.full-tweet").length&&typeof twttr==="object"&&twttr.hasOwnProperty("widgets")){twttr.widgets.load(j)}};this.rolesToClass=function(f){if(f&(U_GROUP_ADMIN|U_GROUP_VIP|U_GROUP_DEV)){return this.CLASS.ADMIN}else{if(f&U_GROUP_STAFF){return this.CLASS.STAFF}else{if(f&U_GROUP_PREMIUM){return this.CLASS.PREMIUM}else{if(f&U_GROUP_PENDING){return this.CLASS.PENDING}else{return this.CLASS.USER}}}}};this.setSource=function(f){switch(f){case"live":case"mop":case"wod":case"legion":WH.markup.defaultSource=WH.markup.SOURCE.LIVE;break;case"ptr":if(WH.isPtrActive()){WH.markup.defaultSource=WH.markup.SOURCE.PTR}break;case"beta":case"bfa":if(WH.isBetaActive()){WH.markup.defaultSource=WH.markup.SOURCE.BETA}break}};this.stripTags=function(g,h){var f=d(g,h);return f.tagless()};this.toggleReveal=function(h){var g=$("#reveal-"+h);if(g.length==0){return}var f=$("#revealtoggle-"+h);if(g.is(":visible")&&f.is(":visible")){g.hide();f.text(LANG.parens_open+LANG.readmore.toLowerCase()+LANG.parens_close)}else{g.show();if(f.hasClass("changelog")){f.hide()}else{f.text(LANG.parens_open+LANG.hide.toLowerCase()+LANG.parens_close)}}};function d(D,l){c="name_"+Locale.getName();if(l&&l.locale){c="name_"+WH.locale.domainToLocale[l.locale]}else{if(WH.isBeta()){c="name_beta"}else{if(WH.isPtr()){c="name_ptr"}}}var u=(D||"").replace(/\r/g,"");if(!l){l={}}if(!l.skipReset){WH.markup.mediaUid=l.uid||b;WH.markup.root=l.root;WH.markup.isPreview=l.isPreview||false;WH.markup.dbPage=l.dbPage||false;WH.markup.defaultSource=false;if(WH.markup.mediaUid!=b){g_screenshots[WH.markup.mediaUid]=[]}}if(l.roles&&(l.roles&(U_GROUP_ADMIN|U_GROUP_EDITOR|U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV|U_GROUP_BLOGGER))&&l.mode!=WH.markup.MODE.SIGNATURE){l.mode=WH.markup.MODE.ARTICLE}WH.markup.mode=l.mode||WH.markup.MODE.ARTICLE;WH.markup.allow=l.allow||WH.markup.CLASS.STAFF;WH.markup.inNewsType=l.inNewsType?l.inNewsType:0;if(l.stopAtBreak){var B=u.indexOf("[break]");if(B!=-1){u=u.substring(0,B)}}else{u=u.replace("[break]","")}var o=new WH.markup.tree();u=u.trim();if(WH.markup.postTags.length){for(var A in WH.markup.postTags){var J=WH.markup.postTags[A];if(u.indexOf("["+J)!=-1){if(!(WH.markup.tags[J].allowedModes&&WH.markup.tags[J].allowedModes[WH.markup.modes[l.mode]]==undefined)){for(var n in WH.markup.tags[J].collect){WH.markup.collectTags[n]=true}}}}}u=u.replace(/\n(\s*)\n/g,"\n\n");var C=u.length;var z=0,q=0,k=-1,p=-1,h=true,w=false;var g=function(N){var K,M,L;if(N.charAt(0)=='"'||N.charAt(0)=="'"){K=N.charAt(0);var s=N.indexOf(K,1);if(s>-1){L=N.substring(1,s);N=N.substring(s+1).trim();return{value:WH.markup.getEscapedHtml(L),str:N}}}M=N.indexOf(" ");if(M>-1){L=N.substring(0,M);N=N.substring(M+1).trim()}else{L=N;N=""}return{value:L,str:N}};var E=/^\s*[a-z0-9-]+\s*=/;while(q<C){k=u.indexOf("[",q);if(k>-1){q=k+1;if(k>0&&u.charAt(k-1)=="\\"){h=false;k=-1}else{p=u.indexOf("]",q)}}else{q=C}var f,r={};if(l.highlight&&$(l.highlight)){r["data-highlight"]=l.highlight+":"+k}if(p>-1){var v=u.substring(k+1,p);if(v.charAt(0)=="/"){w=true;f=v.substr(1).trim().toLowerCase()}if(!w){var F=v.indexOf(" "),y=v.indexOf("=");var G;if((y<F||F==-1)&&y>-1){f=v.substring(0,y).toLowerCase();v=v.substring(y+1).trim();var I=g(v);v=I.str;if(WH.markup.tags[f]==undefined||WH.markup.tags[f].attr==undefined||WH.markup.tags[f].attr.unnamed==undefined){h=false}else{r.unnamed=I.value}}else{if(F>-1){f=v.substring(0,F).toLowerCase();v=v.substring(F+1).trim();if(v.indexOf("=")==-1){if(WH.markup.tags[f]==undefined||WH.markup.tags[f].attr==undefined||WH.markup.tags[f].attr.unnamed==undefined){h=false}else{r.unnamed=v}v=""}}else{f=v.toLowerCase();v=""}}if(WH.markup.tags[f]==undefined){h=false}else{if(h){var J=WH.markup.tags[f];while(v!=""){var t="";if(!E.test(v)){t="unnamed"}else{y=v.indexOf("=");if(y==-1){h=false;break}t=v.substring(0,y).trim().toLowerCase();v=v.substring(y+1).trim()}var I=g(v);v=I.str;if(J.attr==undefined||J.attr[t]==undefined){if(WH.markup.globalAttributes[t]==undefined||(WH.markup.globalAttributes[t].valid!=undefined&&!WH.markup.globalAttributes[t].valid.test(I.value))){h=false;break}}r[t]=I.value}if(h&&J.attr){for(var H in J.attr){if(J.attr[H].req&&r[H]==undefined){h=false;break}else{if(r[H]==undefined){continue}}if(J.attr[H].valid!=undefined&&!J.attr[H].valid.test(r[H])){h=false;break}}if(h&&J.validate!=undefined){h=J.validate(r)}}}}}else{if(WH.markup.tags[f]==undefined){h=false}}}else{h=false}if(h){if(z!=k){var m=u.substring(z,k).replace(/\\\[/g,"[");var j={_rawText:m};o.openTag("<text>",j)}if(w){h=o.closeTag(f)}else{h=o.openTag(f,r)}if(h){z=q=p+1}else{z=k}}h=true;w=false;k=p=-1}if(z<C){var m=u.substr(z).replace(/\\\[/g,"[");var j={_rawText:m};o.openTag("<text>",j)}return o}};$(document).ready(function(){$(".quote-header").each(function(c){var f=$(this);var d=f.siblings();if(d.hasClass("quote-body")){var b=$("<a/>",{href:"javascript:;","class":"toggle"});b.click(function(j){var g=$(j);var h=g.parent();h.toggleClass("collapse");if(h.hasClass("collapse")){$(this).html("Expand")}else{$(this).html("Collapse")}}.bind(b,this));if($(this).parent().hasClass("collapse")){b.html("Expand")}else{b.html("Collapse")}f.append(b)}});$(".quote-wh").each(function(c){var d=$(this);var b=$("<a/>",{href:"javascript:;","class":"toggle"});b.click(function(g){var f=$(g);f.toggleClass("collapse");if(f.hasClass("collapse")){$(this).html("Expand")}else{$(this).html("Collapse")}}.bind(b,this));if($(this).hasClass("collapse")){b.html("Expand")}else{b.html("Collapse")}d.append(b)})});WH.markup.tags.artifactcalc={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},artifactcalcDivsOnPage:0,artifactcalcObjects:{},toHtml:function(c){var k=WH.markup.getDatabaseDomainInfo(c);this.artifactcalcDivsOnPage++;var d="markup-artifactcalc-"+this.artifactcalcDivsOnPage;var h=this;var b={id:d,embedded:true,markup:true,hash:c.unnamed.replace(/^#+/,""),editable:c.editable=="true",dataDomain:k[0]};var j=(function(f){var l=function(){if((!WH.ge("markup-artifactcalc-"+f))||(!WH.isSet("ArtifactCalc"))){window.setTimeout(l,250);return}h.artifactcalcObjects[f]=new ArtifactCalc(b)};return l})(this.artifactcalcDivsOnPage);if(this.artifactcalcDivsOnPage==1&&!WH.isSet("ArtifactCalc")){WH.loadAssets("artifact-weapon-calc",j)}else{j()}var g="artifactcalc-markup-parent";return'<div id="'+d+'" class="'+g+'"></div>'}};WH.markup.tags["bloodmallet-chart"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{axiscolor:{req:false,valid:/.+/},azeritetier:{req:false,valid:/.+/},backgroundcolor:{req:false,valid:/.+/},"class":{req:true,valid:/.+/},entries:{req:false,valid:/^\d+$/},fontcolor:{req:false,valid:/.+/},fightstyle:{req:false,valid:/.+/},spec:{req:true,valid:/.+/},type:{req:false,valid:/.+/}},toHtml:function(c){WH.Tools.Highcharts.loadScript(function(){clearTimeout(WH.markup.tags["bloodmallet-chart"].loadScriptsTimeout);WH.markup.tags["bloodmallet-chart"].loadScriptsTimeout=setTimeout(WH.Tools.Bloodmallet.loadCharts,0)});var f=WH.ce("div",{id:"bloodmallet-chart-"+WH.markup.getAutoIncrementCount("bloodmallet-chart"),className:"bloodmallet_chart",textContent:WH.TERMS.loading_ellipsis});f.setAttribute("data-wow-class",c["class"].replace("-","_"));f.setAttribute("data-wow-spec",c.spec.replace("-","_"));if(!c.backgroundcolor){c.backgroundcolor="#242424"}if(!c.axiscolor){c.axiscolor="#9d9d9d"}if(!c.fontcolor){c.fontcolor="#ccc"}var d={axiscolor:"axis-color",azeritetier:"azerite-tier",backgroundcolor:"background-color",entries:"entries",fontcolor:"font-color",fightstyle:"fight-style",type:"type"};for(var b in d){if(c[b]){f.setAttribute("data-"+d[b],c[b].replace("-","_"))}}return f}};WH.markup.tags.bluetweet={empty:true,ltrim:true,attr:{id:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){if(g_bluetweets[b.id]&&g_bluetweets[b.id].id){return WH.createTweetDiv(g_bluetweets[b.id])}return'<a href="https://twitter.com/wowheadtweets/status/'+b.id+'" class="full-tweet">Tweet #'+b.id+"</a>"}};WH.markup.tags.chart={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{id:{req:true,valid:/^\d+$/},type:{req:true,valid:/^barpercent|pie|rank|rankpercent$/},width:{req:false,valid:/^\d+$/},height:{req:false,valid:/^\d+$/},credits:{req:false,valid:/^profiler|none$/},sort:{req:false,valid:/^asc|desc$/}},toHtml:function(D){var t;if(!g_charts.hasOwnProperty(D.id)){t='<div class="highchart '+D.type+'" style="border: 1px solid #CCC;';if(D.width){t+="width: "+D.width+"px;"}if(D.height){t+="height: "+D.height+"px"}t+='">(Chart '+D.id+" not found)</div>";return t}var n=WH.markup.getDatabaseDomainInfo(D);var d=n[1];var H={};if(!D.credits||D.credits=="profiler"){H.href="/list";H.text=LANG.message_poweredbyprofiler}if(D.credits=="none"){H.enabled=false}switch(D.type){case"rank":case"rankpercent":var c=g_charts[D.id];var l,h=c[0].keyType;if(h&&h in g_types){l="/"+g_types[h]+"="}var m,w,f,g,G=(c[0].keyType&&g_gathered_types.hasOwnProperty(c[0].keyType))?g_gathered_types[c[0].keyType]:{};var j=[];for(var F in c[0].data){j.push(F)}j.sort(function(o,k){return WH.stringCompare(c[0].data[o],c[0].data[k])});if(D.sort=="desc"){j.reverse()}else{if(!D.sort){if(c[1].data){if(c[0].data[j[0]]/c[1].data>0.5){j.reverse()}}}}t='<div style="display: inline-block;';if(D.width){t+=" width: "+D.width+"px;"}t+='"><ol>';for(var s=0;s<j.length;s++){F=j[s];g=false;m=F;w="";f="";if(G.hasOwnProperty(parseInt(F,10))){g=G[parseInt(F,10)];m=g.hasOwnProperty(d)?g[d]:F;w=g.hasOwnProperty("quality")?g.quality:"";f=g.hasOwnProperty("icon")?g.icon:""}t+="<li>";if(f){f='<img align="absmiddle" src="'+g_staticUrl+"/images/wow/icons/tiny/"+f+'.gif">&nbsp;'}if(l){t+='<a href="'+l+F+'" class="q'+w+(f?" icontiny":"")+'">'+f+m+"</a>"}else{t+='<span class="q'+w+'">'+f+m+"</span>"}if(D.type=="rankpercent"&&c[1].data){t+=' <small class="q0">'+WH.sprintf(LANG.qty,(c[0].data[F]/c[1].data*100).toFixed(4)+"%")+"</small>"}t+="</li>"}t+="</ol>";if(H.text){t+='<div style="position: relative; top: -12px; text-align: right; font-size: 10px">';if(H.href){t+='<a href="'+H.href+'" class="q0">'+H.text+"</a>"}else{t+='<span class="q0">'+H.text+"</span>"}t+="</div>"}t+="</div>";return t;break}if(!WH.isSet("g_highcharts")){WH.Tools.Highcharts.loadScript();g_highcharts={charts:[],divIndex:0,pending:undefined};g_highcharts.ShowCharts=function(I){if(I){g_highcharts.pending=undefined}else{if(typeof g_highcharts.pending!="undefined"){return}}var o=false;if(WH.isSet("Highcharts")){for(var k=0;k<g_highcharts.charts.length;k++){if(g_highcharts.charts[k].rendered){continue}if($(g_highcharts.charts[k].container).length==0){o=true;continue}$(g_highcharts.charts[k].container).highcharts(g_highcharts.charts[k].chart);g_highcharts.charts[k].rendered=true}}else{o=true}if(o){g_highcharts.pending=window.setTimeout(g_highcharts.ShowCharts,250,true);return}}}var u="highchart-markup-"+(g_highcharts.divIndex++);t='<div class="highchart '+D.type+'" id="'+u+'" style="';if(D.width){t+="width: "+D.width+"px;"}if(D.height){t+="height: "+D.height+"px"}t+='"></div>';switch(D.type){case"barpercent":var c=g_charts[D.id];var v=(c[0].keyType&&g_types.hasOwnProperty(c[0].keyType))?g_types[c[0].keyType]:false;var y={container:"#"+u,chart:{}};y.chart={credits:H,chart:{type:"bar",backgroundColor:"#242424",plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{bar:{borderWidth:0,dataLabels:{color:"#ddd",style:{textShadow:"none"}}}},xAxis:{categories:[],labels:{style:{color:"#CCC"}},gridLineColor:"#404040",lineColor:"#404040",tickColor:"#404040"},yAxis:{min:0,max:100,title:{enabled:false},gridLineColor:"#404040",lineColor:"#404040",tickColor:"#404040"},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){var J=this.x+": "+this.y+"%";if(v){var o=(v in g_completion)?g_completion[v]:false;for(var K in g_user.lists){var k=g_user.lists[K];if(!(k.id in o)){continue}var I=(WH.inArray(o[k.id],this.point.id)!=-1);J+='<br><span class="progress-icon '+(I?"progress-8":"progress-0")+'"></span> ';J+=k.character+" - "+k.realm+" "+k.region}}return J},useHTML:true,backgroundColor:"rgba(36, 36, 36, 0.85)",style:{color:"#ccc"}},series:[{data:[],events:{click:function(k){if(g_charts[D.id][0].keyType){location.href="/"+g_types[g_charts[D.id][0].keyType]+"="+k.point.series.data[k.point.x].id}}}}]};var G=(c[0].keyType&&g_gathered_types.hasOwnProperty(c[0].keyType))?g_gathered_types[c[0].keyType]:{};var b,A=[];if(v&&WH.isSet("g_completion")&&g_completion.hasOwnProperty(v)&&g_user.hasOwnProperty("lists")&&g_user.lists&&g_user.lists.length){for(var s=0;s<g_user.lists.length;s++){b=""+g_user.lists[s].id;if((g_user.lists[s].pinned>0)&&g_completion[v].hasOwnProperty(b)){A=g_completion[v][b];if(g_user.lists[s].pinned>1){break}}}}var B=[];for(var F in c[0].data){if(!c[0].data.hasOwnProperty(F)){continue}B.push({k:F,v:c[0].data[F]})}B.sort(function(o,k){return WH.stringCompare(k.v,o.v)});if(D.sort=="asc"){B.reverse()}for(var s=0;s<B.length;s++){var E=B[s];var g=G.hasOwnProperty(E.k)?G[E.k][d]:E.k;var z={id:E.k,y:Math.round(E.v/c[1].data*100)};if(A.indexOf(parseInt(z.id,10))!=-1){z.color="#7CECB5"}y.chart.xAxis.categories.push(g);y.chart.series[0].data.push(z)}g_highcharts.charts.push(y);break;case"pie":var y={container:"#"+u,chart:{}};y.chart={credits:H,chart:{type:"pie",backgroundColor:"#242424",plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{pie:{borderColor:"#242424",dataLabels:{color:"#ddd",style:{textShadow:"none"}}}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){return this.point.name+": "+Math.round(this.y)+"%"},backgroundColor:"rgba(36, 36, 36, 0.85)",style:{color:"#ccc"}},series:[{data:[]}]};var c=g_charts[D.id];var B=[];var p=0,C=true;var g,G=(c[0].keyType&&g_gathered_types.hasOwnProperty(c[0].keyType))?g_gathered_types[c[0].keyType]:{};if(c[0].keyType==14){WH.cO(G,G);var r={24:LANG.som_legend_neutral,25:LANG.som_legend_alliance,26:LANG.som_legend_horde};for(var q in r){if(!r.hasOwnProperty(q)){continue}if(G.hasOwnProperty(q)&&G[q].hasOwnProperty(d)){G[q][d]+=LANG.wordspace+LANG.parens_open+r[q]+LANG.parens_close}}}for(var F in c[0].data){if(!c[0].data.hasOwnProperty(F)){continue}p+=c[0].data[F];C&=!isNaN(F)&&(F!="0");g=G.hasOwnProperty(F)?G[F][d]:F;B.push({k:F,keyName:g,v:c[0].data[F]})}if(!isNaN(c[1].data)&&(p/c[1].data<0.98)){B.push({k:C?0:"Other",v:c[1].data-p})}if(G){B.sort(function(o,k){return WH.stringCompare(k.v,o.v)||WH.stringCompare(o.keyName,k.keyName)})}else{B.sort(function(o,k){return WH.stringCompare(o.keyName,k.keyName)||WH.stringCompare(k.v,o.v)})}for(var s=0;s<B.length;s++){var E=B[s];y.chart.series[0].data.push({id:E.k,name:E.keyName,y:(E.v/c[1].data*100)})}g_highcharts.charts.push(y);break;default:t="<div>(Chart type "+D.type+" unknown)</div>";break}g_highcharts.ShowCharts();return t}};WH.markup.tags.countdown={empty:true,attr:{bg:{req:true,valid:/^(https?:)?\/\/[^\/]+\/.+/},time:{req:true,valid:/^[A-Za-z0-9 :,-]+$/},text:{req:false,valid:/.*/},completion:{req:false,valid:/.*/},url:{req:false,valid:/^(https?:)?\/\/[^\/]+\/.+/}},toHtml:function(b){var d=10000+WH.markup.getAutoIncrementCount("countdown");var c={id:d,bg:b.bg,completionText:b.completion,time:b.time};if(b.text){c.text=b.text}if(b.url){c.url=b.url}setTimeout((function(f){WH.countdownClock(f)}).bind(null,c),0);return'<div id="countdown-clock-'+d+'"></div>'}};WH.markup.tags.galleryupload={empty:false,allowedClass:WH.markup.CLASS.ADMIN,attr:{unnamed:{req:true,valid:/^[0-9]+$/},submittext:{req:false,valid:/.+/}},toHtml:function(b){var c="";c='<form method="POST" action="/gallery-upload" enctype="multipart/form-data" onsubmit="return WH.markup.tags.galleryupload._validateForm(this);">';c+='<input type="hidden" name="gallery" value="'+b.unnamed+'">';c+='<input type="hidden" name="message" value="">';c+='<input type="hidden" name="from" value="'+encodeURIComponent(location.pathname+location.search)+'">';c+='<input type="file" name="incoming" accept=".jpg,.jpeg,.png,image/jpeg,image/png" required>';c+=' <button type="submit" class="btn btn-primary">'+(b.submittext||LANG.submit)+"</button>";c+='</form><div style="display: none">';return[c,"</div>"]},_validateForm:function(c){var b=3;var d=c.incoming;if(!d||d.value==""){return false}if(d.files&&d.files.length){if(d.files.length>1){alert("Too many files");return false}if(d.files[0].size>b*1048576){alert(LANG.message_sizelimit.replace("%d",b).replace("&gt;",">"));return false}}c.message.value=c.nextSibling.textContent;return true}};WH.markup.tags["guide-content"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toHtml:function(b){return['(Content from <a href="/guide='+b.unnamed+'">Guide #'+b.unnamed+"</a>)",""]}};WH.markup.tags["guild-rankings"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/[a-z-]+/},raid:{req:true,valid:/[a-z-]+/},difficulty:{req:false,valid:/(normal|heroic|mythic)/}},toHtml:function(j){var h=WH.urlize(j.unnamed);var f=WH.urlize(j.raid);var c=WH.urlize(j.difficulty||"mythic");var l=f+"|"+h+"|"+c;var g='<table class="guild-boss-rankings"><tr>';for(var b=1;b<=3;b++){if(WH.data.guildRankings&&WH.data.guildRankings[l]){var d=WH.data.guildRankings[l][b-1];if(d){var k=d.realm.toLowerCase().replace(/[^a-z ]/,"").replace(" ","-");g+='<td class="guild-boss-rankings-earned">';g+='<div class="guild-boss-rankings-'+d.faction+'">';g+='<a href="https://raider.io/guilds/'+d.region.toLowerCase()+"/"+k+"/"+d.name+'" target="_blank">'+d.name+"</a>";g+="</div>";g+='<a href="https://raider.io/'+f+"/realm-rankings/"+d.region.toLowerCase()+"/"+k+"/"+c+'" target="_blank">('+d.region+") "+d.realm+"</a>";g+="</td>";continue}}g+="<td>";switch(b){case 1:g+="1st";break;case 2:g+="2nd";break;case 3:g+="3rd";break;default:g+=b+"th"}g+=" Place<br>Not Earned</td>"}g+="</tr></table>";return['<h3 class="heading-size-2 guild-boss-rankings-heading"><a href="https://raider.io/">Powered by Raider.io</a>',"</h3>"+g]},toText:function(j){var h=WH.urlize(j.unnamed);var g=WH.urlize(j.raid);var c=WH.urlize(j.difficulty||"mythic");var k=g+"|"+h+"|"+c;var l="";for(var b=1;b<=3;b++){var f="";switch(b){case 1:f="1st";break;case 2:f="2nd";break;case 3:f="3rd";break;default:f=b+"th"}l+=f+" Place: ";if(WH.data.guildRankings&&WH.data.guildRankings[k]){var d=WH.data.guildRankings[k][b-1];if(d){l+=d.name+", ("+d.region+") "+d.realm+", "+WH.ucfirst(d.faction)+". ";continue}}l+="Not Earned. "}return j._textContents+": "+l}};WH.markup.tags.lightbox={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^(map|model|screenshot)$/},zone:{req:false,valid:/^-?[0-9]+[a-z]?$/i},floor:{req:false,valid:/^[0-9]+$/},pins:{req:false,valid:/^[0-9]+$/}},validate:function(b){switch(b.unnamed){case"map":if(b.zone){return true}break;case"model":break;case"screenshot":break}return false},toHtml:function(b){var d="";var c="";switch(b.unnamed){case"map":d="/maps="+b.zone;if(b.floor){d+="."+b.floor}if(b.pins){d+=":"+b.pins}var f=d.substr(6);c="if(!WH.isLeftClick(event)) return; MapViewer.show({ link: '"+f+"' }); return false;";break}if(d&&c){return['<a href="'+d+'" onclick="'+c+'"'+WH.markup.getCommonAttributes(b)+">","</a>"]}return""}};WH.markup.tags.map={empty:false,attr:{zone:{req:true,valid:/^-?[0-9a-z\-_]+$/i},source:{req:false,valid:/\S+/},legacy:{req:false,valid:/^true$/}},allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{pin:1},maps:[],toHtml:function(b){var c=b._contents;b.id="dsgdfngjkfdg"+(WH.markup.tags.map.maps.length);var d="<div"+WH.markup.getCommonAttributes(b)+'></div><div style="clear: left"></div>';WH.markup.tags.map.maps.push({parent:b.id,zone:b.zone,coords:c?c:null,legacy:b.legacy||false});return[d]},createMaps:function(){for(var c=0;c<WH.markup.tags.map.maps.length;++c){var b=WH.markup.tags.map.maps[c];b.unique=c;new Mapper(b)}WH.markup.tags.map.maps=[]}};WH.markup.tags.pin={empty:false,attr:{url:{req:false,valid:/\S+/},type:{req:false,valid:/^[0-9]+$/},x:{req:true,valid:/^[0-9]{1,2}(\.[0-9])?$/},y:{req:true,valid:/^[0-9]{1,2}(\.[0-9])?$/},path:{req:false,valid:/^([0-9]{1,2}(\.[0-9])?[,:]?)+$/}},taglessSkip:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{map:1},toHtml:function(c){if(c.url&&!WH.markup.isUrlSafe(c.url)){c.url=""}var f=c._contents;if(c.url&&c.url.indexOf("npc=")!=-1){f='<b class="q">'+f+'</b><br /><span class="q2">'+LANG.som_viewnpc+"</span>"}if(c.url&&(c.url.indexOf("/")<0)&&(c.url.indexOf("=")>=0)){c.url="/"+c.url}var d=null;if(c.path){var h=c.path.split(":"),d=[];for(var g=0,b=h.length;g<b;++g){var j=h[g].split(",");if(j.length==2){d.push([parseFloat(j[0]||0),parseFloat(j[1]||0)])}}}return[[parseFloat(c.x||0),parseFloat(c.y||0),{label:f,url:c.url,type:c.type,lines:d}]]}};WH.markup.tags.model={empty:false,attr:{item:{req:false,valid:/^[0-9]+$/},object:{req:false,valid:/^[0-9]+$/},npc:{req:false,valid:/^[0-9]+$/},itemset:{req:false,valid:/^[0-9,]+$/},slot:{req:false,valid:/^[0-9]+$/},humanoid:{req:false,valid:/^1$/},"float":{req:false,valid:/^(left|right)$/i},border:{req:false,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/},img:{req:false,valid:/\S+/},link:{req:false,valid:/\S+/},label:{req:false,valid:/[\S ]+/}},allowedClass:WH.markup.CLASS.STAFF,skipSlots:{4:1,5:1,6:1,7:1,8:1,9:1,10:1,16:1,19:1,20:1},toHtml:function(b){var f="";var c=[];var d=[];if(b["float"]){c.push("markup-float-"+b["float"])}if(b.border){if(b.border==0){c.push("no-border")}else{c.push("border");d.push("border-width:"+b.border+"px")}}else{c.push("content-image");if(b.shadow=="true"){c.push("content-image-shadowed")}}if(b.npc){f="<a"+WH.markup.getCommonAttributes(b)+' href="#modelviewer:1:'+b.npc+":"+(b.humanoid?"1":"0")+'" onclick="ModelViewer.show({ type: 1, displayId: '+b.npc+", slot: "+b.slot+", "+(b.humanoid?"humanoid: 1, ":"")+"displayAd: 1, fromTag: 1"+(b.link?", link: '"+b.link.replace(/'/g,"'")+"'":"")+(b.label?", label: '"+b.label.replace(/'/g,"'")+"'":"")+' });"><img alt="'+WH.markup.getEscapedHtml(b._contents)+'" title="'+WH.markup.getEscapedHtml(b._contents)+'" src="'+(b.img?b.img:g_staticUrl+ModelViewer.getStaticBase()+"/thumbs/npc/"+b.npc+'.png" width="150" height="150')+'" ';if(c.length){f+='class="'+c.join(" ")+'"'}if(d.length){f+=' style="'+d.join(";")+'"'}f+="/></a>";return[f]}else{if(b.object){f="<a"+WH.markup.getCommonAttributes(b)+' href="#modelviewer:2:'+b.object+'" onclick="ModelViewer.show({ type: 2, displayId: '+b.object+", displayAd: 1, fromTag: 1"+(b.link?", link: '"+b.link.replace(/'/g,"'")+"'":"")+(b.label?", label: '"+b.label.replace(/'/g,"'")+"'":"")+' });"><img alt="'+WH.markup.getEscapedHtml(b._contents)+'" title="'+WH.markup.getEscapedHtml(b._contents)+'" src="'+(b.img?b.img:g_staticUrl+ModelViewer.getStaticBase()+"/thumbs/obj/"+b.object+'.png" width="150" height="150')+'" ';if(c.length){f+='class="'+c.join(" ")+'"'}if(d.length){f+=' style="'+d.join(";")+'"'}f+="/></a>";return[f]}else{if(b.item&&b.slot){f="<a"+WH.markup.getCommonAttributes(b)+' href="#modelviewer:3:'+b.item+":"+b.slot+'" onclick="ModelViewer.show({ type: 3, displayId: '+b.item+", slot: "+b.slot+", displayAd: 1, fromTag: 1"+(b.link?", link: '"+b.link.replace(/'/g,"'")+"'":"")+(b.label?", label: '"+b.label.replace(/'/g,"'")+"'":"")+' });"><img alt="'+WH.markup.getEscapedHtml(b._contents)+'" title="'+WH.markup.getEscapedHtml(b._contents)+'" src="'+(b.img?b.img:g_staticUrl+ModelViewer.getStaticBase()+"/thumbs/item/"+b.item+'.png" width="150" height="150')+'" ';if(c.length){f+='class="'+c.join(" ")+'"'}if(d.length){f+=' style="'+d.join(";")+'"'}f+="/></a>";return[f]}else{if(b.itemset){f="<a"+WH.markup.getCommonAttributes(b)+' href="javascript:;" onclick="ModelViewer.show({ type: 4, equipList: ['+b.itemset+"], displayAd: 1, fromTag: 1"+(b.link?", link: '"+b.link.replace(/'/g,"'")+"'":"")+(b.label?", label: '"+b.label.replace(/'/g,"'")+"'":"")+' });">'}else{return["[model]","[/model]"]}}}}return[f,"</a>"]}};WH.markup.tags.modelviewer=WH.markup.tags.model;WH.markup.tags["pet-team"]={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},calcDivsOnPage:0,calcObjects:{},toHtml:function(c){var k=WH.markup.getDatabaseDomainInfo(c);this.calcDivsOnPage++;var d="markup-pet-team-"+this.calcDivsOnPage;var h=this;var b={id:"markup-pet-team-"+this.calcDivsOnPage,embedded:true,markup:true,hash:c.unnamed.replace(/^#+/,""),editable:c.editable=="true",dataDomain:k[0]};var j=(function(f){var l=function(){if((!WH.ge("markup-pet-team-"+f))||(!WH.isSet("BattlePetTeamCalc"))){window.setTimeout(l,250);return}h.calcObjects[f]=new BattlePetTeamCalc(b)};return l})(this.calcDivsOnPage);if(this.calcDivsOnPage==1&&!WH.isSet("BattlePetTeamCalc")){WH.loadAssets("battle-pet-team-calc",j)}else{j()}var g="bpetteamcalc-markup-parent";return'<div id="'+d+'" class="'+g+'"></div>'}};WH.markup.tags.regexreplace={empty:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{"guide-content":1},attr:{unnamed:{req:true,valid:/^[^a-z\\].+[^a-z\\]$/},"with":{req:true,valid:/^.*$/}},toHtml:function(b){return' <span class="q0">Regex Replacing: "<b>'+b.unnamed+'</b>" With: "<b>'+b["with"]+'</b>"</span>'}};WH.markup.tags.replace={empty:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{"guide-content":1},attr:{unnamed:{req:true,valid:/^.+$/},"with":{req:true,valid:/^.*$/}},toHtml:function(b){return' <span class="q0">Replacing: "<b>'+b.unnamed+'</b>" With: "<b>'+b["with"]+'</b>"</span>'}};WH.markup.tags.screenshot={empty:false,count:0,attr:{id:{req:false,valid:/^[0-9]+$/},url:{req:false,valid:/\S+/},thumb:{req:false,valid:/\S+/},size:{req:false,valid:/^(thumb|small|resized|normal)$/i},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/},"float":{req:false,valid:/^(left|right)$/i},border:{req:false,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/}},taglessSkip:true,allowedClass:WH.markup.CLASS.STAFF,validate:function(b){if(b.url&&!b.thumb){return false}else{if(!b.id&&!b.url){return false}}return true},toHtml:function(g){var d=[];var l=[];var c="javascript:;";var b="";if(g.id){c=WH.getScreenshotUrl(g.id,"normal",g.title);var k=g.id;if(g.thumb&&g.thumb.match(/^[0-9]+$/)){k=g.thumb;g.thumb=null}b=WH.getScreenshotUrl(k,g.size||"thumb",g.title)}else{if(g.url){c=g.url}}if(g.thumb){b=g.thumb}if(!g_screenshots[WH.markup.mediaUid]){g_screenshots[WH.markup.mediaUid]=[]}var f=WH.markup.tags.screenshot.count++;var j='<a href="'+c+'" id="screenshot-thumb-'+f+'"'+WH.markup.getCommonAttributes(g)+">";setTimeout((function(n,p,o){var m=WH.ge("screenshot-thumb-"+n);if(m){m.onclick=(function(s,r,q){if(!WH.isLeftClick(q)){return}ScreenshotViewer.show({screenshots:s,pos:r});return false}).bind(null,p,o)}}).bind(null,f,""+WH.markup.mediaUid,g_screenshots[WH.markup.mediaUid].length),0);j+='<img src="'+b+'" ';if(g.size&&g.width){j+=' width="'+g.width+'"'}if(g.size&&g.height){j+=' height="'+g.height+'"'}if(g.border){if(g.border==0){d.push("no-border")}else{d.push("border");l.push("border-width:"+g.border+"px")}}else{d.push("content-image");if(g.shadow=="true"){d.push("content-image-shadowed")}}if(g["float"]){d.push("markup-float-"+g["float"])}if(d.length){j+=' class="'+d.join(" ")+'"'}if(l.length){j+=' style="'+l.join(";")+'"'}j+='alt="'+(g.title||"")+'" ';var h={caption:g.title,width:(g.size?null:g.width),height:(g.size?null:g.height),noMarkup:true};if(g.id){h.id=g.id}else{h.url=g.url}g_screenshots[WH.markup.mediaUid].push(h);return[j+"/></a>"]}};WH.markup.tags["google-sheet"]={empty:true,attr:{unnamed:{req:true,valid:/^[a-zA-Z0-9_-]+$/}},loadingPlaceholder:'<img src="'+g_staticUrl+'/images/icons/ajax-medium-242424.gif" style="margin:0 5px 0 0; position:relative; top:-1px; vertical-align:middle; width:16px">'+LANG.tooltip_loading,libraryLoaded:false,toHtml:function(b){var c="sheet-"+WH.markup.getAutoIncrementCount("google-sheet");var d=b.unnamed;if(!WH.markup.tags["google-sheet"].libraryLoaded){$.getScript("https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.3.4/tabletop.min.js");WH.markup.tags["google-sheet"].libraryLoaded=true}setTimeout(WH.markup.tags["google-sheet"].fetchSheet.bind(null,c,d),0);return'<div id="'+c+'">'+WH.markup.tags["google-sheet"].loadingPlaceholder+"</div>"},fetchSheet:function(b,c){var d;if(typeof Tabletop==="undefined"||!(d=WH.ge(b))){setTimeout(WH.markup.tags["google-sheet"].fetchSheet.bind(null,b,c),50);return}Tabletop.init({key:c,callback:WH.markup.tags["google-sheet"].renderSheet.bind(null,d,c),simpleSheet:true});setTimeout((function(g,f){if(g.innerHTML===WH.markup.tags["google-sheet"].loadingPlaceholder){WH.markup.tags["google-sheet"].renderError(g,f)}}).bind(null,d,c),5000)},renderError:function(c,b){c.innerHTML='<i class="fa fa-exclamation-triangle"></i>&nbsp; '+LANG.Markup.googleSheetError+'<a href="https://docs.google.com/spreadsheets/d/'+b+'" target="_blank">'+b+"</a>"},renderSheet:function(h,g,f,c){if(!c||!c.model_names||!c.model_names.length||!c.models||!c.models[c.model_names[0]]){WH.markup.tags["google-sheet"].renderError(h,g);return}var j={columns:[],searchable:true,filtrable:true,clickable:false};var k=c.models[c.model_names[0]].column_names;for(var d=0;d<k.length;d++){var b=k[d];if(!b){continue}j.columns.push({id:WH.urlize(b),name:WH.deUrlize(b),type:"text",align:f[0][b].length>10?"left":"center",compute:(function(l,o,p,n){if(o[l].length<=10){var m=WH.ce("span",{className:"no-wrap"});WH.st(m,o[l]);WH.ae(p,m)}else{WH.st(p,o[l])}}).bind(null,b),getVisibleText:(function(l,m){return m[l]}).bind(null,b),sortFunc:(function(n,m,l){return WH.stringCompare(m[n],l[n])}).bind(null,b)})}Listview.templates[h.id]=j;h.className="listview";h.innerHTML="";new Listview({template:h.id,id:h.id,parent:h.id,data:f})}};WH.markup.tags.talent={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},glyphs:{req:false,valid:/^false$/},specs:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},icons:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},talentDivsOnPage:0,talentObjects:{},toHtml:function(c){var k=WH.markup.getDatabaseDomainInfo(c);this.talentDivsOnPage++;var d="markup-talent-"+this.talentDivsOnPage;if(c.unnamed.indexOf("-")<0){c.glyphs="false"}var h=this;var b={parent:d,embedded:true,markup:true,hash:c.unnamed.replace(/^#+/,""),editable:c.editable=="true",dataDomain:k[0]};var j=(function(f){var l=function(){if((!WH.ge("markup-talent-"+f))||(!WH.isSet("TalentCalc"))){window.setTimeout(l,250);return}h.talentObjects[f]=new TalentCalc(b)};return l})(this.talentDivsOnPage);if(this.talentDivsOnPage==1&&!WH.isSet("TalentCalc")){WH.loadAssets("talent-calc",j)}else{j()}var g="talentcalc-markup-parent";if(c.glyphs=="false"){g+=" talentcalc-markup-no-glyphs"}if(c.specs!="true"){g+=" talentcalc-markup-no-specs"}return'<div id="'+d+'" class="'+g+'"></div>'}};WH.markup.tags["pvp-calc"]={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},icons:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},talentDivsOnPage:0,talentObjects:{},toHtml:function(c){var k=WH.markup.getDatabaseDomainInfo(c);this.talentDivsOnPage++;var d="markup-pvp-calc-"+this.talentDivsOnPage;var h=this;var b={id:"pvp-calc-"+this.talentDivsOnPage,parent:d,embedded:true,markup:true,hash:c.unnamed.replace(/^#+/,""),editable:c.editable=="true",dataDomain:k[0]};var j=(function(f){var l=function(){if((!WH.ge("markup-pvp-calc-"+f))||(!WH.isSet("PvpTalentCalc"))){window.setTimeout(l,250);return}h.talentObjects[f]=new PvpTalentCalc(b)};return l})(this.talentDivsOnPage);if(this.talentDivsOnPage==1&&!WH.isSet("PvpTalentCalc")){WH.loadAssets("pvp-talent-calc",j)}else{j()}var g="pvptalentcalc-markup-parent";return'<div id="'+d+'" class="'+g+'"></div>'}};WH.markup.tags["talent-pvp"]=WH.markup.tags["pvp-calc"];WH.markup.tags["honor-calc"]=WH.markup.tags["pvp-calc"];WH.markup.tags.time={empty:true,count:0,attr:{until:{req:false,valid:/^\d+$/},since:{req:false,valid:/^\d+$/},server:{req:false,valid:/^true$/}},validate:function(b){if(!b.until&&!b.since){return false}return true},toHtml:function(b){var d=WH.markup.tags.time.count++;var c='<span title="'+(new Date((b.until?b.until:b.since)*1000)).toLocaleString()+'" id="markupTime'+d+'">'+WH.markup.tags.time.getTime(b)+"</span>";setInterval(WH.markup.tags.time.updateTime.bind(null,d,b),5000);return c},getTime:function(b){var d;if(b.server){d=g_serverTime.getTime()/1000}else{d=(new Date()).getTime()/1000}var c=0;if(b.until){c=b.until-d}else{c=d-b.since}if(c>0){return WH.formatTimeElapsed(c)}else{return"0 "+LANG.timeunitspl[6]}},updateTime:function(d,b){var c=WH.ge("markupTime"+d);if(!c){return}c.firstChild.nodeValue=WH.markup.tags.time.getTime(b)}};WH.markup.tags.tooltip={empty:false,attr:{unnamed:{req:false,valid:/\S+/},name:{req:false,valid:/\S+/},bare:{req:false,valid:/^true$/i},label:{req:false,valid:/[\S ]+/}},taglessSkip:true,allowedClass:WH.markup.CLASS.STAFF,validate:function(b){if(!b.unnamed&&!b.name){return false}return true},toHtml:function(b){if(b.unnamed){return['<span class="tip" onmouseover="WH.Tooltip.showAtCursor(event, LANG[\''+b.unnamed+'\'], 0, 0, \'q\')" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()">',"</span>"]}else{WH.markup.tooltipTags[b.name]=(b.label?'<table><tr><td class="q0" style="width: 300px"><small>'+b.label+"</small></td></tr></table>":"")+b._contents;if(b.bare){WH.markup.tooltipTagsWithRawText[b.name]=true}return[""]}}};WH.markup.tags["top-mythic-classes"]={empty:true,attr:{unnamed:{req:true,valid:/^[A-Za-z0-9' -]+$/},affixes:{req:true,valid:/^(current|all)$/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(m){var k=WH.data.get("topMythicClasses",m.unnamed,m.affixes);var r='<div><i class="fa fa-exclamation-triangle"></i>&nbsp; '+LANG.notopmythicclassesdata_tip+"</div>";if(!k){return r}var p=[];var d=["tank","healer","dps"];for(var l=0,n;n=k.classes[l];l++){var q=g_staticUrl+"/images/classes/symbols/icon-"+g_file_classes[n.class_id]+".png";var c=' style="background-image:url('+q+')"';var o=Math.round(n.total/k.counts.total*100)+"%";var b='<div class="top-mythic-classes-class"><div class="top-mythic-classes-class-content"><div class="top-mythic-classes-class-crest"'+c+'></div><div class="top-mythic-classes-class-title"><span class="c'+n.class_id+'">'+g_chr_classes[n.class_id]+"</span> <small>"+o+"</small></div>";for(var h=0,f;f=d[h];h++){if(n.hasOwnProperty(f)){var g="<b>"+Math.round(n[f]/k.counts[f]*100)+"</b>%";b+='<span class="iconrole iconsmall '+f+'"><span>'+g+"</span></span>"}}b+="</div></div>";p.push(b)}if(!p.length){return r}return'<div class="top-mythic-classes">'+p.join("")+"</div>"}};WH.markup.tags["top-mythic-runs"]={empty:true,attr:{unnamed:{req:true,valid:/^.*$/},affixes:{req:true,valid:/^.*$/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(q){var z=WH.data.get("topMythicRuns",q.unnamed,q.affixes);var B='<div><i class="fa fa-exclamation-triangle"></i>&nbsp; '+LANG.notopmythicrunsdata_tip+"</div>";if(!z){return B}var c=[];var b=[];for(var v=0,n;n=z.runs[v];v++){n=n.run;var f='<div class="top-mythic-runs-run">';f+='<div class="top-mythic-runs-run-level">'+LANG.mythicPlus+LANG.wordspace+n.mythic_level+"</div>";var m=n.clear_time_ms/1000;var t=Math.floor(m/60);m=Math.round(m-(t*60));f+='<div class="top-mythic-runs-run-time">'+t+LANG.wordspace+LANG[t===1?"timeunitssg":"timeunitspl"][5]+LANG.wordspace+m+LANG.wordspace+LANG[m===1?"timeunitssg":"timeunitspl"][6]+"</div>";if(n.roster.length){var l=[];var y=[];for(var u=0,d;d=n.roster[u];u++){d=d.character;var w=g_spec2SeoShorthand[d["class"].id][WH.getSpecIndexFromSpecId(d.spec.id)];var h=Icon.create(g_file_specs[d.spec.id],Icon.sizeIds.small,undefined,"/"+w+"-"+g_class2SeoShorthand[d["class"].id]+"-guide",undefined,undefined,undefined,undefined,true);h.id="spec-icon-"+WH.markup.getAutoIncrementCount("specIcon");b.push([h.id,'<span class="no-wrap">'+WH.sprintf(LANG.guide_format,LANG.specclass_format.replace("%1$s",g_chr_specs[d.spec.id]).replace("%2$s",g_chr_classes[d["class"].id]))+"</span>","c"+d["class"].id,true]);l.push(WH.convertNodesToHtml(h));var o=g_file_genders[d.race.id===10?1:0];var g=Icon.create("race_"+g_file_races[d.race.id]+"_"+o,Icon.sizeIds.small,undefined,"/race="+d.race.id+"/"+WH.urlize(g_chr_races[d.race.id],true),undefined,undefined,undefined,undefined,true);g.id="race-icon-"+WH.markup.getAutoIncrementCount("raceIcon");b.push([g.id,g_chr_races[d.race.id],"q",true]);y.push(WH.convertNodesToHtml(g))}f+="<table>";f+="<tr><td>"+l.join("</td><td>")+"</td></tr>";f+="<tr><td>"+y.join("</td><td>")+"</td></tr>";f+="</table>"}if(q.affixes==="all"){f+='<div class="top-mythic-runs-run-affixes">'+LANG.affixes+LANG.colon;for(var s=0,p;p=n.weekly_modifiers[s];s++){var A=Icon.create(p.icon,Icon.sizeIds.small,undefined,"/affix="+p.id,undefined,undefined,undefined,undefined,true);var r=Icon.getLink(A);r.setAttribute("data-whattach","true");f+=WH.convertNodesToHtml(A)}f+="</div>"}f+="</div>";c.push(f)}setTimeout(function(){for(var j=0,k;k=b[j];j++){if(k[0]=WH.ge(k[0])){WH.Tooltip.simple.apply(WH.Tooltip,k)}}},0);if(!c.length){return B}return'<div class="top-mythic-runs">'+c.join("")+"</div>"}};WH.markup.tags.twitch={empty:true,attr:{unnamed:{req:true,valid:/^\w+$/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){var c=location.protocol=="https:"?"https://www-cdn.jtvnw.net/swflibs/TwitchPlayer.swf?channel="+b.unnamed:"http://player.twitch.tv/?channel="+b.unnamed;return'<iframe src="'+c+'" frameborder="0" scrolling="no" height="378" width="620"></iframe>'}};WH.markup.tags.video={empty:true,attr:{id:{req:true,valid:/^[0-9]+$/},unnamed:{req:false,valid:/^embed$/i},"float":{req:false,valid:/^(left|right)$/i},shadow:{req:false,valid:/^(true|false)$/},border:{req:false,valid:/^[0-9]+$/}},ltrim:true,rtrim:true,allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){if(g_videos[b.id]){var d="",g=g_videos[b.id];var c=[];var f=[];if(b.unnamed){if(g.videoType==1){d+=WH.markup.getHtml("[youtube="+g.videoId+"]",{skipReset:true})}}else{if(!g_videos[WH.markup.mediaUid]){g_videos[WH.markup.mediaUid]=[]}d+='<div style="position: relative; display: -moz-inline-stack; display: inline-block; zoom: 1; *display: inline"><a href="'+WH.sprintf(vi_siteurls[g.videoType],g.videoId)+'" onclick="if(!WH.isLeftClick(event)) return; VideoViewer.show({videos: \''+WH.markup.mediaUid+"', pos: "+g_videos[WH.markup.mediaUid].length+'}); return false;"'+WH.markup.getCommonAttributes(b)+">";d+='<img src="'+WH.sprintf(vi_thumbnails[g.videoType],g.videoId)+'" ';if(b.border){if(b.border==0){c.push("no-border")}else{c.push("border");f.push("border-width:"+b.border+"px")}}else{c.push("content-image");if(b.shadow!="false"){c.push("content-image-shadowed")}}if(b["float"]){c.push("markup-float-"+b["float"])}if(c.length){d+='class="'+c.join(" ")+'" '}if(f.length){str+=' style="'+f.join(";")+'"'}if(g.hasCaption){d+='alt="'+WH.markup.stripTags(g.caption,{mode:WH.markup.MODE.SIGNATURE,skipReset:true})+'" '}d+='/><img src="'+g_staticUrl+'/images/icons/play-sm.png" style="opacity: 0.6; filter:alpha(opacity=60); position: absolute; width: 48px; height: 48px; top: 23px; left: 38px" />';d+="</a></div>";g_videos[WH.markup.mediaUid].push(WH.dO(g))}return d}return"<b>Video #"+b.id+"</b>"}};WH.markup.tags.youtube={empty:true,attr:{unnamed:{req:true,valid:/\S+/},title:{req:false,valid:/[\S ]+/},thumb:{req:false,valid:/\S+/},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(l){var b=l.width?l.width:640;var n=l.height?l.height:390;if(window.outerWidth&&window.outerWidth-20<b){b=window.outerWidth-20;n=Math.floor(b*0.6015625)}var m={height:n,width:b,videoId:l.unnamed,playerVars:{autoplay:1}};if(WH.markup.tags.youtube.players.length==0){var d;if(WH.isSet("onYouTubeIframeAPIReady")&&(typeof window.onYouTubeIframeAPIReady=="function")){d=window.onYouTubeIframeAPIReady}else{d=function(){}}window.onYouTubeIframeAPIReady=function(){WH.markup.tags.youtube.apiReady=true;d()};if(!WH.isSet("YT")){window.YT={};WH.ajaxIshRequest("https://www.youtube.com/iframe_api",true)}}var j=WH.markup.tags.youtube.players.length;var c={id:j,containerId:"wh-youtube-"+j,yt:m,loaded:false};WH.markup.tags.youtube.players.push(c);var f="";var p=(n/b)*100;var h="//i.ytimg.com/vi/"+m.videoId+"/sddefault.jpg";if(b<=480||$(document).width()<=500){h="//i.ytimg.com/vi/"+m.videoId+"/hqdefault.jpg"}if(l.thumb){h=l.thumb;f+=" wh-youtube-custom-thumb"}if(p<=35){f+=" wh-youtube-short"}var k="";if(l.title){k='<div class="wh-youtube-title">'+l.title+"</div>"}var g='<div class="wh-youtube'+f+'" id="wh-youtube-'+j+'" style="background:url('+h+");max-width:"+b+'px"><div class="wh-youtube-inner" style="padding-top:'+p+'%">'+k+'<i class="fa fa-circle"></i><i class="fa fa-play-circle"></i></div></div>';setTimeout((function(q){var o=WH.ge("wh-youtube-"+q);if(o){o.onclick=WH.markup.tags.youtube.onClick.bind(o,q)}}).bind(null,j),0);return g},fromHtml:function(j){var c;if(c=j.match(/<iframe\b[\s\S]*?src="[\s\S]*?youtube\.com\/embed\/[\s\S]*?"[\s\S]*?><\/iframe>/gi)){for(var f=0;f<c.length;++f){var h=c[f].match(/src="[\s\S]*?youtube\.com\/embed\/([\s\S]*?)"/i),g=c[f].match(/width[:="]+\s*([0-9]+)/i),b=c[f].match(/height[:="]+\s*([0-9]+)/i),d=c[f].match(/border[:="]+\s*([0-9]+)/i);j=j.replace(c[f],"[youtube="+h[1]+(g?" width="+g[1]:"")+(b?" height="+b[1]:"")+"]")}}return j},players:[],apiReady:false,onClick:function(c){if(!WH.markup.tags.youtube.players[c]){if(typeof console!="undefined"&&console&&typeof console.error=="function"){console.error("YouTube embed options not found!")}return}if(WH.markup.tags.youtube.players[c].loaded){return}if(!WH.markup.tags.youtube.apiReady){setTimeout(WH.markup.tags.youtube.onClick.bind(this),50);return}var b=WH.ge(WH.markup.tags.youtube.players[c].containerId);if(!b){if(typeof console!="undefined"&&console&&typeof console.error=="function"){console.error("YouTube embed container vanished!")}return}this.className+=" wh-youtube-loaded";WH.markup.tags.youtube.players[c].loaded=true;WH.markup.tags.youtube.players[c].player=new YT.Player(this.firstChild,WH.markup.tags.youtube.players[c].yt)}};WH.markup.tags.achievement={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(c){var k=c.unnamed;var j=WH.markup.getDatabaseDomainInfo(c);var f=j[0];var h=j[1];var b=[];var g=null;if(c.diff){b.push("diff="+c.diff)}if(c.diffnew){b.push("diffnew="+c.diffnew)}if(c.tempname){g=c.tempname}if(g_achievements[k]&&g_achievements[k][h]){var d=g_achievements[k];return'<a href="'+f+"/achievement="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+(!c.icon?' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+d.icon.toLowerCase()+'.gif"':"")+WH.markup.getCommonAttributes(c)+' align="absmiddle" /> <span class="tinyicontxt">'+WH.markup.getEscapedHtml(d[h])+"</span></a>"}return'<a href="'+f+"/achievement="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+WH.markup.getCommonAttributes(c)+">"+(g?g:("("+LANG.types[10][0]+" #"+k+")"))+"</a>"},toText:function(b){var g=b.unnamed;var f=WH.markup.getDatabaseDomainInfo(b);var c=f[0];var d=f[1];if(g_achievements[g]&&g_achievements[g][d]){return WH.markup.getEscapedHtml(g_achievements[g][d])}return LANG.types[10][0]+" #"+g}};WH.markup.tags.affix={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(c){var k=c.unnamed;var j=WH.markup.getDatabaseDomainInfo(c);var d=j[0];var g=j[1];var b=[];var f=null;if(c.diff){b.push("diff="+c.diff)}if(c.diffnew){b.push("diffnew="+c.diffnew)}if(c.tempname){f=c.tempname}if(g_affixes[k]&&g_affixes[k][g]){var h=g_affixes[k];return'<a href="'+d+"/affix="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+(!c.icon?' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+h.icon.toLowerCase()+'.gif" align="absmiddle"':"")+WH.markup.getCommonAttributes(c)+"> "+WH.markup.getEscapedHtml(h[g])+"</a>"}return'<a href="'+d+"/affix="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+WH.markup.getCommonAttributes(c)+">"+(f?f:("("+LANG.types[40][0]+" #"+k+")"))+"</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_affixes[f]&&g_affixes[f][c]){return WH.markup.getEscapedHtml(g_affixes[f][c])}return LANG.types[40][0]+" #"+f}};WH.markup.tags["bfa-champion"]={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(j){var f=j.unnamed;var h=WH.markup.getDatabaseDomainInfo(j);var d=h[0];var k=h[1];var o=[];var g=null;if(j.diff){o.push("diff="+j.diff)}if(j.diffnew){o.push("diffnew="+j.diffnew)}if(j.quality){o.push("q="+j.quality)}if(j.level){o.push("level="+j.level)}if(j.abilities){o.push("abil="+j.abilities)}if(j.tempname){g=j.tempname}var n=parseInt(f);if(g_bfa_champions[n]&&g_bfa_champions[n][k]){var b=g_bfa_champions[n];var m=b.quality;if(j.quality){m=j.quality}if(!j.hasOwnProperty("class")){j["class"]="q"+m}else{if(!/\bq\d\b/.test(j["class"])){j["class"]+=" q"+m}}var c=b[k];var l;if((l=c.indexOf(" / "))!=-1){if(/\.1$/.test(f)){c=c.substr(0,l)}else{if(/\.2$/.test(f)){c=c.substr(l+3)}}}return'<a href="'+d+"/bfa-champion="+f+'"'+(o.length?' rel="'+o.join("&")+'"':"")+WH.markup.getCommonAttributes(j)+">"+WH.markup.getEscapedHtml(c)+"</a>"}return'<a href="'+d+"/bfa-champion="+f+'"'+(o.length?' rel="'+o.join("&")+'"':"")+WH.markup.getCommonAttributes(j)+">"+(g?g:("("+LANG.types[38][0]+" #"+f+")"))+"</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_bfa_champions[f]&&g_bfa_champions[f][c]){return WH.markup.getEscapedHtml(g_bfa_champions[f][c])}return LANG.types[38][0]+" #"+f}};WH.markup.tags.building={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},nolvl:{req:false,valid:/^true$/},"short":{req:false,valid:/^true$/},side:{req:false,valid:/^1|2$/}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(j){var d=j.unnamed;var g=WH.markup.getDatabaseDomainInfo(j);var b=g[0];var m=g[1];if(g_buildings[d]&&g_buildings[d][m]){var k=g_buildings[d];var c=k[m];var h=j["short"]?LANG.traits["level"][2]:LANG.level;if(j.side){var l=new RegExp(j.side==1?" \\/ .+$":"[^\\/]+ \\/ ");c=c.replace(l,"")}else{if(j["short"]){if(g_garrison_building_short_names.hasOwnProperty(d)){c=g_garrison_building_short_names[d]}}}var f=(!j.nolvl&&k.hasOwnProperty("level"))?h+" "+k.level+" ":"";return'<a href="'+b+"/building="+d+'"'+WH.markup.getCommonAttributes(j)+">"+f+WH.markup.getEscapedHtml(c)+"</a>"}return'<a href="'+b+"/building="+d+'"'+WH.markup.getCommonAttributes(j)+">("+LANG.types[20][0]+" #"+d+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_buildings[f]&&g_buildings[f][c]){return WH.markup.getEscapedHtml(g_buildings[f][c])}return LANG.types[20][0]+" #"+f}};WH.markup.tags["class"]={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}if(b.unnamed>=1&&b.unnamed<=12){return true}return false},toHtml:function(b){var h=b.unnamed;var g=WH.markup.getDatabaseDomainInfo(b);var d=g[0];var f=g[1];if(g_classes[h]&&g_classes[h][f]){var c=g_classes[h];return'<a href="'+d+"/class="+h+'"'+(!b.icon?' class="icontiny c'+h+'"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+g_classes.getIcon(h)+'.gif"':"")+WH.markup.getCommonAttributes(b)+' align="absmiddle" /> <span class="tinyicontxt">'+WH.markup.getEscapedHtml(c[f])+"</span></a>"}return'<a href="'+d+"/class="+h+'" class="c'+h+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[13][0]+" #"+h+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_classes[f]&&g_classes[f][c]){return WH.markup.getEscapedHtml(g_classes[f][c])}return LANG.types[13][0]+" #"+f}};WH.markup.tags.champion={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(j){var f=j.unnamed;var h=WH.markup.getDatabaseDomainInfo(j);var d=h[0];var k=h[1];var o=[];var g=null;if(j.diff){o.push("diff="+j.diff)}if(j.diffnew){o.push("diffnew="+j.diffnew)}if(j.quality){o.push("q="+j.quality)}if(j.level){o.push("level="+j.level)}if(j.abilities){o.push("abil="+j.abilities)}if(j.tempname){g=j.tempname}var n=parseInt(f);if(g_champions[n]&&g_champions[n][k]){var c=g_champions[n];var m=c.quality;if(j.quality){m=j.quality}if(!j.hasOwnProperty("class")){j["class"]="q"+m}else{if(!/\bq\d\b/.test(j["class"])){j["class"]+=" q"+m}}var b=c[k];var l;if((l=b.indexOf(" / "))!=-1){if(/\.1$/.test(f)){b=b.substr(0,l)}else{if(/\.2$/.test(f)){b=b.substr(l+3)}}}return'<a href="'+d+"/champion="+f+'"'+(o.length?' rel="'+o.join("&")+'"':"")+WH.markup.getCommonAttributes(j)+">"+WH.markup.getEscapedHtml(b)+"</a>"}return'<a href="'+d+"/champion="+f+'"'+(o.length?' rel="'+o.join("&")+'"':"")+WH.markup.getCommonAttributes(j)+">"+(g?g:("("+LANG.types[28][0]+" #"+f+")"))+"</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_champions[f]&&g_champions[f][c]){return WH.markup.getEscapedHtml(g_champions[f][c])}return LANG.types[28][0]+" #"+f}};WH.markup.tags.currency={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},amount:{req:false,valid:/^[0-9\:]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var h=b.unnamed;var g=WH.markup.getDatabaseDomainInfo(b);var c=g[0];var d=g[1];if(g_gatheredcurrencies[h]&&g_gatheredcurrencies[h][d]){var f=g_gatheredcurrencies[h];if(b.amount){return'<a href="'+c+"/currency="+h+'"'+(!b.icon?' class="icontinyr tip q1" onmouseover="WH.Tooltip.showAtCursor(event, \''+WH.markup.getEscapedHtml(f[d])+'\', 0, 0, \'q1\');" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()" style="background-image:url('+g_staticUrl+"/images/wow/icons/tiny/"+f.icon[0].toLowerCase()+".gif)":"")+WH.markup.getCommonAttributes(b)+'"> <span class="tinyicontxt">'+b.amount.split(":").join(" - ")+"</span></a>"}else{return'<a href="'+c+"/currency="+h+'"'+(!b.icon?' class="icontiny q1"><span><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+f.icon[0].toLowerCase()+'.gif"':"")+WH.markup.getCommonAttributes(b)+' align="absmiddle" /> <span class="tinyicontxt">'+WH.markup.getEscapedHtml(f[d])+"</a>"}}return'<a href="'+c+"/currency="+h+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[17][0]+" #"+h+")</a>"+(b.amount>0?" x"+b.amount:"")},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_gatheredcurrencies[f]&&g_gatheredcurrencies[f][c]){return WH.markup.getEscapedHtml(g_gatheredcurrencies[f][c])}return LANG.types[17][0]+" #"+f}};WH.markup.tags.event={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},allowedClass:WH.markup.CLASS.STAFF,validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var h=b.unnamed;var g=WH.markup.getDatabaseDomainInfo(b);var d=g[0];var f=g[1];if(g_holidays[h]&&g_holidays[h][f]){var c=g_holidays[h];return'<a href="'+d+"/event="+h+'"'+WH.markup.getCommonAttributes(b)+">"+WH.markup.getEscapedHtml(c[f])+"</a>"}return'<a href="'+d+"/event="+h+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[12][0]+" #"+h+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_holidays[f]&&g_holidays[f][c]){return WH.markup.getEscapedHtml(g_holidays[f][c])}return LANG.types[12][0]+" #"+f}};WH.markup.tags.faction={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var h=b.unnamed;var g=WH.markup.getDatabaseDomainInfo(b);var c=g[0];var d=g[1];if(g_factions[h]&&g_factions[h][d]){var f=g_factions[h];return'<a href="'+c+"/faction="+h+'"'+WH.markup.getCommonAttributes(b)+">"+WH.markup.getEscapedHtml(f[d])+"</a>"}return'<a href="'+c+"/faction="+h+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[8][0]+" #"+h+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_factions[f]&&g_factions[f][c]){return WH.markup.getEscapedHtml(g_factions[f][c])}return LANG.types[8][0]+" #"+f}};WH.markup.tags.follower={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(j){var d=j.unnamed;var g=WH.markup.getDatabaseDomainInfo(j);var c=g[0];var k=g[1];var o=[];var f=null;if(j.diff){o.push("diff="+j.diff)}if(j.diffnew){o.push("diffnew="+j.diffnew)}if(j.quality){o.push("q="+j.quality)}if(j.level){o.push("level="+j.level)}if(j.abilities){o.push("abil="+j.abilities)}if(j.tempname){f=j.tempname}var n=parseInt(d);if(g_followers[n]&&g_followers[n][k]){var h=g_followers[n];var m=h.quality;if(j.quality){m=j.quality}if(!j.hasOwnProperty("class")){j["class"]="q"+m}else{if(!/\bq\d\b/.test(j["class"])){j["class"]+=" q"+m}}var b=h[k];var l;if((l=b.indexOf(" / "))!=-1){if(/\.1$/.test(d)){b=b.substr(0,l)}else{if(/\.2$/.test(d)){b=b.substr(l+3)}}}return'<a href="'+c+"/follower="+d+'"'+(o.length?' rel="'+o.join("&")+'"':"")+WH.markup.getCommonAttributes(j)+">"+WH.markup.getEscapedHtml(b)+"</a>"}return'<a href="'+c+"/follower="+d+'"'+(o.length?' rel="'+o.join("&")+'"':"")+WH.markup.getCommonAttributes(j)+">"+(f?f:("("+LANG.types[21][0]+" #"+d+")"))+"</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_followers[f]&&g_followers[f][c]){return WH.markup.getEscapedHtml(g_followers[f][c])}return LANG.types[21][0]+" #"+f}};WH.markup.tags.guide={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(c){var h=c.unnamed;var g=WH.markup.getDatabaseDomainInfo(c);var d=g[0];var f="name";if(g_guides[h]&&g_guides[h][f]){var b=g_guides[h];return'<a href="'+d+"/guide="+h+'"'+WH.markup.getCommonAttributes(c)+"> "+WH.markup.getEscapedHtml(b[f])+"</a>"}return'<a href="'+d+"/guide="+h+'"'+WH.markup.getCommonAttributes(c)+">("+LANG.types[100][0]+" #"+h+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c="name";if(g_guides[f]&&g_guides[f][c]){return WH.markup.getEscapedHtml(g_guides[f][c])}return LANG.types[100][0]+" #"+f}};WH.markup.tags["mission-ability"]={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(c){var k=c.unnamed;var j=WH.markup.getDatabaseDomainInfo(c);var d=j[0];var g=j[1];var b=[];var f=null;if(c.diff){b.push("diff="+c.diff)}if(c.diffnew){b.push("diffnew="+c.diffnew)}if(c.tempname){f=c.tempname}if(g_missionabilities[k]&&g_missionabilities[k][g]){var h=g_missionabilities[k];return'<a href="'+d+"/mission-ability="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+(!c.icon?' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+h.icon.toLowerCase()+'.gif" align="absmiddle"':"")+WH.markup.getCommonAttributes(c)+"> "+WH.markup.getEscapedHtml(h[g])+"</a>"}return'<a href="'+d+"/mission-ability="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+WH.markup.getCommonAttributes(c)+">"+(f?f:("("+LANG.types[22][0]+" #"+k+")"))+"</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_missionabilities[f]&&g_missionabilities[f][c]){return WH.markup.getEscapedHtml(g_missionabilities[f][c])}return LANG.types[22][0]+" #"+f}};WH.markup.tags.garrisonability=WH.markup.tags["mission-ability"];WH.markup.tags.icondb={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},block:{req:false,valid:/^(true|false)$/},size:{req:false,valid:/^(tiny|small|medium|large)$/},name:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(h){var o=h.size?h.size:"small";var m=h.name=="true";var f=h.unnamed;var g=WH.markup.getDatabaseDomainInfo(h);var c=g[0];var k=c+"/icon="+f;var n=[];var d=null;if(h.diff){n.push("diff="+h.diff)}if(h.diffnew){n.push("diffnew="+h.diffnew)}if(h.tempname){d=h.tempname}if(g_icons[f]&&g_icons[f].name){k+="/"+WH.urlize(g_icons[f].name);var j=g_icons[f];if(m){if(o=="tiny"){return'<a href="'+k+'"'+(n.length?' rel="'+n.join("&")+'"':"")+(!h.icon?' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+j.icon.toLowerCase()+'.gif" align="absmiddle"':"")+WH.markup.getCommonAttributes(h)+"> "+WH.markup.getEscapedHtml(j.name)+"</a>"}else{var l=WH.ce("a",{href:k});var b=WH.ce("div",null,l);WH.ae(l,Icon.create(j.name,Icon.sizeIds[o],null,false,null,null,null,null,true));l.innerHTML+=WH.markup.getEscapedHtml(j.name);return b.innerHTML}}else{var b=WH.ce("div");WH.ae(b,Icon.create(j.name,Icon.sizeIds[o],null,k,null,null,null,null,h.block!="true"));return b.innerHTML}}return'<a href="'+k+'"'+(n.length?' rel="'+n.join("&")+'"':"")+WH.markup.getCommonAttributes(h)+">"+(d?d:("("+LANG.types[29][0]+" #"+f+")"))+"</a>"},toText:function(b){var c=b.unnamed;if(g_icons[c]&&g_icons[c].name){return WH.markup.getEscapedHtml(g_icons[c].name)}return LANG.types[29][0]+" #"+c}};WH.markup.tags.item={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},"azerite-powers":{req:false,valid:/^[0-9:]+$/},bonus:{req:false,valid:/^[0-9:]+$/},spec:{req:false,valid:/^[0-9]+$/},ak:{req:false,valid:/^[0-9]+$/},tooltip:{req:false,valid:/^true$/i},tempname:{req:false},transmog:{req:false,valid:/^([0-9]+|hidden)$/}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(j){var c=j.unnamed;var g=WH.markup.getDatabaseDomainInfo(j);var b=g[0];var m=g[1];var o=[];var d=null;var h="";if(j.tempname){d=j.tempname}if(j.bonus){o.push("bonus="+j.bonus)}if(j["azerite-powers"]){o.push("azerite-powers="+j["azerite-powers"])}if(j.spec){o.push("spec="+j.spec)}if(j.ak){o.push("artk="+j.ak)}if(j.transmog){o.push("transmog="+j.transmog)}if(g_items[c]&&g_items[c][m]){var n=g_items[c];var l=n.icon||"inv_misc_questionmark";var k="<a"+WH.markup.getCommonAttributes(j)+' href="'+b+"/item="+c+(o.length?"?"+o.join("&"):"")+'" class="q'+n.quality+(!j.icon?' icontiny" data-entity="item" data-entity-has-icon="true"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+l.toLowerCase()+'.gif"':"")+' align="absmiddle" />&nbsp;<span class="tinyicontxt">';k+=WH.markup.getEscapedHtml(n[m])+"</span></a>";h=k}else{h='<a href="'+b+"/item="+c+(o.length?"?"+o.join("&"):"")+'"'+WH.markup.getCommonAttributes(j)+' data-entity="item" data-entity-has-icon="true">'+(d?d:("("+LANG.types[3][0]+" #"+c+")"))+"</a>"}if(j.tooltip){var f="markup-item-tooltip-"+WH.markup.getAutoIncrementCount("item-tooltip");setTimeout($WowheadPower.replaceWithTooltip.bind($WowheadPower,f,3,c),0);h='<span id="'+f+'">'+h+"</span>"}return h},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_items[f]&&g_items[f][c]){return WH.markup.getEscapedHtml(g_items[f][c])}return LANG.types[3][0]+" #"+f}};WH.markup.tags["item-set"]={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^-?[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var h=b.unnamed;var f=WH.markup.getDatabaseDomainInfo(b);var c=f[0];var d=f[1];if(g_itemsets[h]&&g_itemsets[h][d]){var g=g_itemsets[h];return'<a href="'+c+"/item-set="+h+'"'+WH.markup.getCommonAttributes(b)+">"+WH.markup.getEscapedHtml(g[d])+"</a>"}return'<a href="'+c+"/item-set="+h+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[4][0]+" #"+h+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_itemsets[f]&&g_itemsets[f][c]){return WH.markup.getEscapedHtml(g_itemsets[f][c])}return LANG.types[4][0]+" #"+f}};WH.markup.tags.itemset=WH.markup.tags["item-set"];WH.markup.tags.mission={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(c){var k=c.unnamed;var j=WH.markup.getDatabaseDomainInfo(c);var d=j[0];var g=j[1];var b=[];var f=null;if(c.diff){b.push("diff="+c.diff)}if(c.diffnew){b.push("diffnew="+c.diffnew)}if(c.tempname){f=c.tempname}if(g_missions[k]&&g_missions[k][g]){var h=g_missions[k];return'<a href="'+d+"/mission="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+WH.markup.getCommonAttributes(c)+"> "+WH.markup.getEscapedHtml(h[g])+"</a>"}return'<a href="'+d+"/mission="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+WH.markup.getCommonAttributes(c)+">"+(f?f:("("+LANG.types[23][0]+" #"+k+")"))+"</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_missions[f]&&g_missions[f][c]){return WH.markup.getEscapedHtml(g_missions[f][c])}return LANG.types[23][0]+" #"+f}};WH.markup.tags.npc={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var h=b.unnamed;var g=WH.markup.getDatabaseDomainInfo(b);var d=g[0];var f=g[1];if(g_npcs[h]&&g_npcs[h][f]){var c=g_npcs[h];return'<a href="'+d+"/npc="+h+'"'+WH.markup.getCommonAttributes(b)+">"+WH.markup.getEscapedHtml(c[f])+"</a>"}return'<a href="'+d+"/npc="+h+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[1][0]+" #"+h+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_npcs[f]&&g_npcs[f][c]){return WH.markup.getEscapedHtml(g_npcs[f][c])}return LANG.types[1][0]+" #"+f}};WH.markup.tags["order-advancement"]={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(c){var k=c.unnamed;var j=WH.markup.getDatabaseDomainInfo(c);var d=j[0];var g=j[1];var b=[];var f=null;if(c.diff){b.push("diff="+c.diff)}if(c.diffnew){b.push("diffnew="+c.diffnew)}if(c.tempname){f=c.tempname}if(g_orderadvancements[k]&&g_orderadvancements[k][g]){var h=g_orderadvancements[k];return'<a href="'+d+"/order-advancement="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+(!c.icon?' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+h.icon.toLowerCase()+'.gif" align="absmiddle"':"")+WH.markup.getCommonAttributes(c)+"> "+WH.markup.getEscapedHtml(h[g])+"</a>"}return'<a href="'+d+"/order-advancement="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+WH.markup.getCommonAttributes(c)+">"+(f?f:("("+LANG.types[30][0]+" #"+k+")"))+"</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_orderadvancements[f]&&g_orderadvancements[f][c]){return WH.markup.getEscapedHtml(g_orderadvancements[f][c])}return LANG.types[30][0]+" #"+f}};WH.markup.tags.outfit={empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toHtml:function(b){var g=b.unnamed;var f=g_outfits[g];var c="/outfit="+g+(f&&f.hasOwnProperty("name")?"/"+WH.urlize(f.name):"");var d;if(f){if(f.classs){d='<a href="'+c+'" class="icontiny c'+f.classs+'" target="_blank" whattach="true"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+g_classes.getIcon(f.classs)+'.gif" align="absmiddle" /> '}else{d='<a href="'+c+'" target="_blank" whattach="true">'}d+=WH.htmlEntities(f.name)+"</a>"}else{d='<a href="'+c+'" target="_blank" whattach="true">Outfit #'+g+"</a>"}return d}};WH.markup.tags["pet-ability"]={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(c){var k=c.unnamed;var j=WH.markup.getDatabaseDomainInfo(c);var d=j[0];var g=j[1];var b=[];var f=null;if(c.diff){b.push("diff="+c.diff)}if(c.diffnew){b.push("diffnew="+c.diffnew)}if(c.tempname){f=c.tempname}if(g_petabilities[k]&&g_petabilities[k][g]){var h=g_petabilities[k];return'<a href="'+d+"/pet-ability="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+WH.markup.getCommonAttributes(c)+(h.icon?(' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+h.icon.toLowerCase()+'.gif" align="absmiddle" /'):"")+'> <span class="tinyicontxt">'+WH.markup.getEscapedHtml(h[g])+"</span></a>"}return'<a href="'+d+"/pet-ability="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+WH.markup.getCommonAttributes(c)+">"+(f?f:("("+LANG.types[200][0]+" #"+k+")"))+"</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_petabilities[f]&&g_petabilities[f][c]){return WH.markup.getEscapedHtml(g_petabilities[f][c])}return LANG.types[200][0]+" #"+f}};WH.markup.tags.petability=WH.markup.tags["pet-ability"];WH.markup.tags.object={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var h=b.unnamed;var g=WH.markup.getDatabaseDomainInfo(b);var c=g[0];var d=g[1];if(g_objects[h]&&g_objects[h][d]){var f=g_objects[h];return'<a href="'+c+"/object="+h+'"'+WH.markup.getCommonAttributes(b)+">"+WH.markup.getEscapedHtml(f[d])+"</a>"}return'<a href="'+c+"/object="+h+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[2][0]+" #"+h+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_objects[f]&&g_objects[f][c]){return WH.markup.getEscapedHtml(g_objects[f][c])}return LANG.types[2][0]+" #"+f}};WH.markup.tags.pet={empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var h=b.unnamed;var g=WH.markup.getDatabaseDomainInfo(b);var c=g[0];var d=g[1];if(g_pet_families&&g_pet_families[h]&&g_pets&&g_pets[h]){var f="<span"+(!b.icon?' class="icontiny" style="background-image: url('+g_staticUrl+"/images/wow/icons/tiny/"+g_pets[h]["icon"].toLowerCase()+".gif)":"")+'">';f+='<a href="'+c+"/pet="+h+'"'+WH.markup.getCommonAttributes(b)+">"+WH.markup.getEscapedHtml(g_pet_families[h])+"</a></span>";return f}return'<a href="'+c+"/pet="+h+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[9][0]+" #"+h+")</a>"},toText:function(b){var c=b.unnamed;if(g_pet_families&&g_pet_families[c]){return WH.markup.getEscapedHtml(g_pet_families[c])}return LANG.types[9][0]+" #"+c}};WH.markup.tags.quest={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var j=b.unnamed;var h=WH.markup.getDatabaseDomainInfo(b);var f=h[0];var g=h[1];if(g_quests[j]&&g_quests[j][g]){var d=g_quests[j];var c="";if(d.hasOwnProperty("_side")){switch(d._side){case 1:c=" icon-alliance";break;case 2:c=" icon-horde";break}}return'<a href="'+f+"/quest="+j+'"'+(!b.icon?' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+(d.daily?"quest_start_daily":"quest_start")+'.gif"':"")+WH.markup.getCommonAttributes(b)+' align="absmiddle" /> <span class="tinyicontxt'+c+'">'+WH.markup.getEscapedHtml(d[g])+"</span></a>"}return'<a href="'+f+"/quest="+j+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[5][0]+" #"+j+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_quests[f]&&g_quests[f][c]){return WH.markup.getEscapedHtml(g_quests[f][c])}return LANG.types[5][0]+" #"+f}};WH.markup.tags.race={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},gender:{req:false,valid:/^(0|1)$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}if(g_file_races[b.unnamed]){return true}return false},toHtml:function(b){var j=b.unnamed;var g=b.gender|0;var h=WH.markup.getDatabaseDomainInfo(b);var c=h[0];var f=h[1];if(g_races[j]&&g_races[j][f]){var d=g_races[j];return'<a href="'+c+"/race="+j+'"'+(!b.icon?' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+g_races.getIcon(j,g)+'.gif"':"")+WH.markup.getCommonAttributes(b)+' align="absmiddle" /> <span class="tinyicontxt">'+WH.markup.getEscapedHtml(d[f])+"</span></a>"}return'<a href="'+c+"/race="+j+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[14][0]+" #"+j+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_races[f]&&g_races[f][c]){return WH.markup.getEscapedHtml(g_races[f][c])}return LANG.types[14][0]+" #"+f}};WH.markup.tags.resource={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(c){var k=c.unnamed;var j=WH.markup.getDatabaseDomainInfo(c);var d=j[0];var g=j[1];var b=[];var f=null;if(c.diff){b.push("diff="+c.diff)}if(c.diffnew){b.push("diffnew="+c.diffnew)}if(c.tempname){f=c.tempname}if(g_resources[k]&&g_resources[k][g]){var h=g_resources[k];return'<a href="'+d+"/resource/"+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+(!c.icon?' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+h.icon.toLowerCase()+'.gif" align="absmiddle"':"")+WH.markup.getCommonAttributes(c)+"> "+WH.markup.getEscapedHtml(h[g])+"</a>"}return'<a href="'+d+"/resource/"+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+WH.markup.getCommonAttributes(c)+">"+(f?f:("("+LANG.types[27][0]+" #"+k+")"))+"</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_resources[f]&&g_resources[f][c]){return WH.markup.getEscapedHtml(g_resources[f][c])}return LANG.types[27][0]+" #"+f}};WH.markup.tags.ship={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(j){var d=j.unnamed;var h=WH.markup.getDatabaseDomainInfo(j);var c=h[0];var k=h[1];var o=[];var f=null;if(j.diff){o.push("diff="+j.diff)}if(j.diffnew){o.push("diffnew="+j.diffnew)}if(j.quality){o.push("q="+j.quality)}if(j.abilities){o.push("abil="+j.abilities)}if(j.tempname){f=j.tempname}var n=parseInt(d);if(g_ships[n]&&g_ships[n][k]){var g=g_ships[n];var m=g.quality;if(j.quality){m=j.quality}if(!j.hasOwnProperty("class")){j["class"]="q"+m}else{if(!/\bq\d\b/.test(j["class"])){j["class"]+=" q"+m}}var b=g[k];var l;if((l=b.indexOf(" / "))!=-1){if(/\.1$/.test(d)){b=b.substr(0,l)}else{if(/\.2$/.test(d)){b=b.substr(l+3)}}}return'<a href="'+c+"/ship="+d+'"'+(o.length?' rel="'+o.join("&")+'"':"")+WH.markup.getCommonAttributes(j)+">"+WH.markup.getEscapedHtml(b)+"</a>"}return'<a href="'+c+"/ship="+d+'"'+(o.length?' rel="'+o.join("&")+'"':"")+WH.markup.getCommonAttributes(j)+">"+(f?f:("("+LANG.types[25][0]+" #"+d+")"))+"</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_ships[f]&&g_ships[f][c]){return WH.markup.getEscapedHtml(g_ships[f][c])}return LANG.types[25][0]+" #"+f}};WH.markup.tags.skill={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var h=b.unnamed;var g=WH.markup.getDatabaseDomainInfo(b);var d=g[0];var f=g[1];if(g_skills[h]&&g_skills[h][f]){var c=g_skills[h];return'<a href="'+d+"/skill="+h+'"'+(!b.icon?' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+g_skills.getIcon(h)+'.gif"':"")+WH.markup.getCommonAttributes(b)+' align="absmiddle" /> <span class="tinyicontxt">'+WH.markup.getEscapedHtml(c[f])+"</span></a>"}return'<a href="'+d+"/skill="+h+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[15][0]+" #"+h+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_skills[f]&&g_skills[f][c]){return WH.markup.getEscapedHtml(g_skills[f][c])}return LANG.types[15][0]+" #"+f}};WH.markup.tags.sound={empty:true,attr:{unnamed:{req:false,valid:/^[0-9]+$/},src:{req:false,valid:/\S+/},title:{req:false,valid:/\S+/},type:{req:false,valid:/\S+/},src2:{req:false,valid:/\S+/},type2:{req:false,valid:/\S+/},domain:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if(b.unnamed){return true}if(!b.src){return false}return true},toHtml:function(h){var k,b,l,c,d,g;var f=WH.markup.getDatabaseDomainInfo(h);var m=f[0];if(h.unnamed){if(!(h.unnamed in g_sounds)){return""}if(!g_sounds[h.unnamed].hasOwnProperty("files")){return""}if(g_sounds[h.unnamed].files.length==0){return""}if(!g_sounds[h.unnamed].files[0].hasOwnProperty("type")){return""}k=g_sounds[h.unnamed].files[0].type;b=g_sounds[h.unnamed].files[0].url;l=g_sounds[h.unnamed].name?g_sounds[h.unnamed].name:g_sounds[h.unnamed].files[0].title;c=m+"/sound="+h.unnamed+"/"+WH.urlize(l)}else{if(WH.markup.allow<WH.markup.CLASS.STAFF){return""}b=h.src;l=h.title?h.title:"(Unknown)";if(h.hasOwnProperty("type")){k=h.type}else{switch(h.src.toLowerCase().substr(-4)){case".mp3":k="audio/mpeg";break;case".ogg":k='audio/ogg; codecs="vorbis"';break}}if(h.src2){d=h.src2;if(h.hasOwnProperty("type2")){g=h.type2}else{switch(h.src2.toLowerCase().substr(-4)){case".mp3":g="audio/mpeg";break;case".ogg":g='audio/ogg; codecs="vorbis"';break}}}}var j='<audio preload="none" controls="true"'+WH.markup.getCommonAttributes(h);if(h.unnamed){j+=' rel="sound='+h.unnamed+'"'}j+=">";if(!(/^(https?:)?\/\//).test(b)){b=g_staticUrl+"/wowsounds"+b}j+='<source src="'+b+'"';if(k){j+=' type="'+k.replace(/"/g,"&quot;")+'"'}j+=">";if(d){j+='<source src="'+d+'"';if(g){j+=' type="'+g.replace(/"/g,"&quot;")+'"'}j+=">"}j+="</audio>";if(c){j='<div class="audiomarkup">'+j+'<br><a href="'+c+'">'+l+"</a></div>"}return j},fromHtml:function(c){var b=c.match(/<audio [^>]*\brel="sound=(\d+)/);if(b){return"[sound="+b[1]+"]"}return c.replace(/<audio\b[\s\S]*?><source\b[\s\S]*\bsrc="([^"]*?)"[\s\S]*?<\/audio>/gi,'[sound src="$1"]')}};WH.markup.tags.spell={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},icon:{req:false,valid:/^(false|tiny|small|medium|large)$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},buff:{req:false,valid:/^true$/},mop:{req:false,valid:/^[0-9]+$/},mopname:{req:false,valid:/\S+/},mopicon:{req:false,valid:/\S+/},tooltip:{req:false,valid:/^true$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(p){var d=p.unnamed;var l=WH.markup.getDatabaseDomainInfo(p);var c=l[0];var q=l[1];var r=[];var f=null;var n="";if(p.buff){r.push("buff")}if(p.diff){r.push("diff="+p.diff)}if(p.diffnew){r.push("diffnew="+p.diffnew)}if(p.mop){r.push("mop="+p.mop)}if(p.tempname){f=p.tempname}if(g_spells[d]&&g_spells[d][q]){var m=g_spells[d];var k=[];var j=false;var o="";var h="";n="";switch(p.icon){case"false":break;case"large":case"medium":case"small":var b=WH.ce("div");WH.ae(b,Icon.create(m.icon.toLowerCase(),Icon.sizeIds[p.icon],null,c+"/spell="+d,null,null,null,null,true));n=b.innerHTML.replace(/^(<span[^>]+)>/,'$1 data-entity-icon="spell">');j=true;break;case"tiny":default:if(p["class"]){p["class"]+=" icontiny"}else{p["class"]="icontiny"}o='<img src="'+g_staticUrl+"/images/wow/icons/tiny/"+m.icon.toLowerCase()+'.gif" align="absmiddle" /> <span class="tinyicontxt">';h="</span>";j=true}n+='<a href="'+c+"/spell="+d+'"'+(r.length?' rel="'+r.join("&")+'"':"")+(k.length?' class="'+k.join(" ")+'"':"")+WH.markup.getCommonAttributes(p)+' data-entity="spell" data-entity-has-icon="'+JSON.stringify(j)+'">'+o+WH.markup.getEscapedHtml(m[q])+h+"</a>"}else{if(p.mop&&p.mopname&&p.mopicon&&p.mopicon.indexOf(".jpg",p.mopicon.length-4)!==-1){n='<span class="tooltip-inside-icon" style="background:url('+g_staticUrl+"images/wow/icons/mop-talents/18/"+WH.markup.getEscapedHtml(p.mopicon)+')"></span> <a href="'+c+"/spell="+d+'"'+(r.length?' rel="'+r.join("&")+'"':"")+' data-entity="spell"><span class="tinyicontxt">'+WH.markup.getEscapedHtml(p.mopname)+"</span></a>"}else{n='<a href="'+c+"/spell="+d+'"'+(r.length?' rel="'+r.join("&")+'"':"")+' data-entity="spell">'+(f?f:("("+LANG.types[6][0]+" #"+d+")"))+"</a>"}}if(p.tooltip){var g="markup-spell-tooltip-"+WH.markup.getAutoIncrementCount("spell-tooltip");setTimeout($WowheadPower.replaceWithTooltip.bind($WowheadPower,g,6,d),0);n='<span id="'+g+'">'+n+"</span>"}return n},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_spells[f]&&g_spells[f][c]){return WH.markup.getEscapedHtml(g_spells[f][c])}return LANG.types[6][0]+" #"+f}};WH.markup.tags.statistic={empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var h=b.unnamed;var g=WH.markup.getDatabaseDomainInfo(b);var d=g[0];var f=g[1];if(g_achievements[h]&&g_achievements[h][f]){var c=g_achievements[h];return'<a href="'+d+"/achievement="+h+'"'+(!b.icon?' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+c.icon.toLowerCase()+'.gif"':"")+WH.markup.getCommonAttributes(b)+' align="absmiddle" /> <span class="tinyicontxt">'+WH.markup.getEscapedHtml(c[f])+"</span></a>"}return'<a href="'+d+"/achievement="+h+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[10][0]+" #"+h+")</a>"},toText:function(b){var g=b.unnamed;var f=WH.markup.getDatabaseDomainInfo(b);var c=f[0];var d=f[1];if(g_achievements[g]&&g_achievements[g][d]){return WH.markup.getEscapedHtml(g_achievements[g][d])}return LANG.types[10][0]+" #"+g}};WH.markup.tags.threat={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(c){var k=c.unnamed;var j=WH.markup.getDatabaseDomainInfo(c);var d=j[0];var g=j[1];var b=[];var f=null;if(c.diff){b.push("diff="+c.diff)}if(c.diffnew){b.push("diffnew="+c.diffnew)}if(c.tempname){f=c.tempname}if(g_threats[k]&&g_threats[k][g]){var h=g_threats[k];return'<a href="'+d+"/threat="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+(!c.icon?' class="icontiny"><img src="'+g_staticUrl+"/images/wow/icons/tiny/"+h.icon.toLowerCase()+'.gif" align="absmiddle"':"")+WH.markup.getCommonAttributes(c)+"> "+WH.markup.getEscapedHtml(h[g])+"</a>"}return'<a href="'+d+"/threat="+k+'"'+(b.length?' rel="'+b.join("&")+'"':"")+WH.markup.getCommonAttributes(c)+">"+(f?f:("("+LANG.types[26][0]+" #"+k+")"))+"</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_threats[f]&&g_threats[f][c]){return WH.markup.getEscapedHtml(g_threats[f][c])}return LANG.types[26][0]+" #"+f}};WH.markup.tags.title={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var g=b.unnamed;var f=WH.markup.getDatabaseDomainInfo(b);var c=f[0];var d=f[1];if(g_titles[g]&&g_titles[g][d]){return'<a href="'+c+"/title="+g+'"'+WH.markup.getCommonAttributes(b)+">"+WH.markup.getEscapedHtml(g_titles[g][d])+"</a>"}return'<a href="'+c+"/title="+g+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[11][0]+" #"+g+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_titles[f]&&g_titles[f][c]){return WH.markup.getEscapedHtml(g_titles[f][c])}return LANG.types[11][0]+" #"+f}};WH.markup.tags["transmog-set"]={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var g=b.unnamed;var f=WH.markup.getDatabaseDomainInfo(b);var c=f[0];var d=f[1];if(g_transmogsets[g]&&g_transmogsets[g][d]){return'<a href="'+c+"/transmog-set="+g+'"'+WH.markup.getCommonAttributes(b)+' class="q'+g_transmogsets[g]["quality"]+'">'+WH.markup.getEscapedHtml(g_transmogsets[g][d])+"</a>"}return'<a href="'+c+"/transmog-set="+g+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[101][0]+" #"+g+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_transmogsets[f]&&g_transmogsets[f][c]){return WH.markup.getEscapedHtml(g_transmogsets[f][c])}return LANG.types[101][0]+" #"+f}};WH.markup.tags.zone={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.betaPtrLang},site:{req:false,valid:WH.markup.regex.betaPtrLang}},validate:function(b){if((b.domain||b.site)&&WH.markup.dbPage){return false}return true},toHtml:function(b){var g=b.unnamed;var f=WH.markup.getDatabaseDomainInfo(b);var c=f[0];var d=f[1];if(g_gatheredzones[g]&&g_gatheredzones[g][d]){return'<a href="'+c+"/zone="+g+'"'+WH.markup.getCommonAttributes(b)+">"+WH.markup.getEscapedHtml(g_gatheredzones[g][d])+"</a>"}return'<a href="'+c+"/zone="+g+'"'+WH.markup.getCommonAttributes(b)+">("+LANG.types[7][0]+" #"+g+")</a>"},toText:function(b){var f=b.unnamed;var d=WH.markup.getDatabaseDomainInfo(b);var c=d[1];if(g_gatheredzones[f]&&g_gatheredzones[f][c]){return WH.markup.getEscapedHtml(g_gatheredzones[f][c])}return LANG.types[7][0]+" #"+f}};WH.markup.tags.acronym={empty:false,attr:{unnamed:{req:true}},toHtml:function(b){return['<span class="tip" onmouseover="WH.Tooltip.showAtCursor(event, \''+WH.markup.getEscapedHtml(b.unnamed)+'\', 0, 0, \'q1\');" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()" '+WH.markup.getCommonAttributes(b)+">","</span>"]}};WH.markup.tags.b={empty:false,allowInReplies:true,toHtml:function(b){return["<b"+WH.markup.getCommonAttributes(b)+">","</b>"]},fromHtml:function(b){return b.replace(/<(b|big|strong)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[b]$2[/b]")}};WH.markup.tags.br={empty:true,toHtml:function(b){return"<br />"},fromHtml:function(b){return b.replace(/<br\b[\s\S]*?>/gi,"\n")}};WH.markup.tags.center={empty:false,allowInReplies:false,allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){return["<center>","</center>"]},fromHtml:function(b){return b.replace(/<center>([\s\S]+?)<\/center>/gi,"[pad][div align=center]$1[/div][pad]")}};WH.markup.tags.code={block:true,empty:false,rtrim:true,itrim:true,helpText:true,allowedChildren:{"<text>":1},toHtml:function(b){var c='<pre class="code';if(b.first){c+=" first"}if(b.last){c+=" last"}c+='"'+WH.markup.getCommonAttributes(b)+">";return[c,"</pre>"]}};WH.markup.tags.color={empty:false,attr:{unnamed:{req:true,valid:/^.*/i}},allowedClass:WH.markup.CLASS.STAFF,extraColors:{deathknight:"c6",dk:"c6",druid:"c11",hunter:"c3",mage:"c8",monk:"c10",paladin:"c2",priest:"c5",rogue:"c4",shaman:"c7",warlock:"c9",warrior:"c1",poor:"q0",common:"q1",uncommon:"q2",rare:"q3",epic:"q4",legendary:"q5",artifact:"q6",heirloom:"q7",wowtoken:"q8"},toHtml:function(b){var d=/^(aqua|black|blue|fuchsia|gray|green|lightblue|lime|maroon|navy|olive|purple|red|silver|teal|white|yellow|c\d+|r\d+|q\d*?|#[a-f0-9]{6})$/i;var f="<span ";if(b.unnamed.match(d)){if(b.unnamed=="#00C0FF"){f+='class="blizzard-blue"'+WH.markup.getCommonAttributes(b)}else{var c=b.unnamed.charAt(0);f+=((c=="q"||c=="c"||(c=="r"&&b.unnamed!="red"))?'class="':'style="color: ')+b.unnamed+'"'+WH.markup.getCommonAttributes(b)}}else{if(WH.markup.tags.color.extraColors[b.unnamed]){f+='class = "'+WH.markup.tags.color.extraColors[b.unnamed]+'"'}}f+=">";return[f,"</span>"]}};WH.markup.tags.del={empty:false,attr:{copy:{req:false,valid:/^true$/}},toHtml:function(b){var c='<del class="diffmod"'+WH.markup.getCommonAttributes(b);if(!b.copy){c+=' unselectable="on"'}c+=">";return[c,"</del>"]}};WH.markup.tags.div={empty:false,block:true,ltrim:true,rtrim:true,itrim:true,attr:{clear:{req:false,valid:/^(left|right|both)$/i},unnamed:{req:false,valid:/^hidden$/i},"float":{req:false,valid:/^(left|right)$/i},align:{req:false,valid:/^(left|right|center)$/i},margin:{req:false,valid:/^\d+$/},style:{req:false,valid:/^[^"<>]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){var f="<div"+WH.markup.getCommonAttributes(b);var d=[];var c=[];if(b.clear){d.push("clear: "+b.clear)}if(b.unnamed){d.push("display: none")}if(b.width){d.push("width: "+b.width)}if(b["float"]){c.push("markup-float-"+b["float"])}if(b.align){d.push("text-align: "+b.align)}if(b.margin){d.push("margin: "+b.margin)}if(b.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){d.push(b.style)}if(b.first){c.push("first")}if(b.last){c.push("last")}if(d.length>0){f+=' style="'+d.join(";")+'"'}if(c.length>0){f+=' class="'+c.join(" ")+'"'}f+=">";return[f,"</div>"]},fromHtml:function(g,f){f=f||0;var b;if(b=WH.markup.matchOuterTags(g,"<div\\b[\\s\\S]*?>","</div>","g")){for(var c=0;c<b.length;++c){var h=b[c][1].match(/float:\s*(left|right)"/i),d=b[c][1].match(/width[:="]+\s*([0-9]+)/i);g=g.replace(b[c][1]+b[c][0]+b[c][2],"\n"+Array(f+1).join("\t")+"[div"+(h?" float="+h[1]:"")+(d?" width="+d[1]:"")+"]"+WH.markup.tags.div.fromHtml(b[c][0],f+1)+"[/div]")}}return g}};WH.markup.tags["entity-list-toggle"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{"for":{req:true,valid:/.+/}},toHtml:function(b){var d=WH.ce("div",{className:"entity-list-toggle"});d.setAttribute("data-initialized","false");d.setAttribute("for",b["for"]);var c=WH.ce("div",{className:"entity-list-toggle-controls"});WH.ae(d,c);WH.markup.applyCommonAttributes(d,b);clearTimeout(WH.markup.tags["entity-list-toggle"].initTimer);WH.markup.tags["entity-list-toggle"].initTimer=setTimeout(WH.markup.tags["entity-list-toggle"].init,0);return[d.outerHTML.replace(/<\/div><\/div>$/,""),"</div></div>"]},init:function(){$('.entity-list-toggle[data-initialized="false"] .entity-list-toggle-controls').each(function(){var b=this;var c=this.parentNode;$(b).children(".entity-list-toggle-option").each(function(){var d=$(this);d.addClass("fa fa-fw");this.onclick=WH.markup.tags["entity-list-toggle-option"].toggleEntity.bind(null,c,d);WH.markup.tags["entity-list-toggle-option"].toggleEntity(c,d,true);d.find("a").click(function(f){f.preventDefault()})});c.setAttribute("data-initialized","true")})}};WH.markup.tags["entity-list-toggle-option"]={empty:false,attr:{hide:{req:false,valid:/[0-9,]+/},show:{req:false,valid:/[0-9,]+/}},toHtml:function(b){if(!b.hide&&!b.show){return['<div style="display:none">',"</div>"]}var c=WH.ce("div",{className:"entity-list-toggle-option"});if(b.hide){c.setAttribute("data-hide",b.hide)}if(b.show){c.setAttribute("data-show",b.show)}WH.markup.applyCommonAttributes(c,b);return[c.outerHTML.replace(/<\/div>$/,""),"</div>"]},toggleEntity:function(c,b,m){var j;var l;if(m===true||b.hasClass("fa-check")){b.removeClass("fa-check").addClass("fa-times");j=b.attr("data-show");l=b.attr("data-hide")}else{b.removeClass("fa-times").addClass("fa-check");j=b.attr("data-hide");l=b.attr("data-show")}var f=$("#"+c.getAttribute("for"));if(!f.length){WH.error("No target wrapper for entity list toggler.",c);return}j=j?j.split(","):[];l=l?l.split(","):[];var g;var h;var k=f.find("> li");var d=m===true?0:150;for(g=0;h=j[g];g++){k.filter(":nth-child("+h+")").slideUp(d)}for(g=0;h=l[g];g++){k.filter(":nth-child("+h+")").slideDown(d)}return false}};WH.markup.tags.hr={empty:true,trim:true,allowedModes:{article:1,quickfacts:1,comment:1},toHtml:function(b){return"<hr />"},fromHtml:function(b){return b.replace(/<hr\b[\s\S]*?>/gi,"[hr]")}};WH.markup.tags.h2={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^false$/i}},toHtml:function(b){if(!b.id){b.id=WH.urlize(b._textContents,true)}var f="<h2"+WH.markup.getCommonAttributes(b);var c=["heading-size-2"];if(b.first||b.unnamed){c.push("first")}if(b.last){c.push("last")}if(c.length>0){f+=' class="'+c.join(" ")+'"'}var d=[];if(b.clear){if(b.clear=="true"||b.clear=="both"){d.push("clear:both")}else{d.push("clear:"+b.clear)}}if(b.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){d.push(b.style)}if(d.length){f+=' style="'+d.join(";")+'"'}return[f+">","</h2>"]},fromHtml:function(b){return b.replace(/<h2\b[\s\S]*?>([\s\S]*?)<\/h2>/gi,"\n[major-heading]$1[/major-heading]")}};WH.markup.tags.h3={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^false$/i}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){if(!b.id){b.id=WH.urlize(b._textContents,true)}var f="<h3"+WH.markup.getCommonAttributes(b);var c=["heading-size-3"];if(b.first||b.unnamed){c.push("first")}if(b.last){c.push("last")}if(c.length>0){f+=' class="'+c.join(" ")+'"'}var d=[];if(b.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){d.push(b.style)}if(d.length){f+=' style="'+d.join(";")+'"'}return[f+">","</h3>"]},fromHtml:function(b){return b.replace(/<h3\b[\s\S]*?>([\s\S]*?)<\/h3>/gi,"\n[minor-heading]$1[/minor-heading]")}};WH.markup.tags.h4={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},toc:{req:false,valid:/^false$/i}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){if(!b.id){b.id=WH.urlize(b._textContents)}var d="<h4"+WH.markup.getCommonAttributes(b);var c=["heading-size-4"];if(b.first||b.unnamed){c.push("first")}if(b.last){c.push("last")}if(c.length>0){d+=' class="'+c.join(" ")+'"'}return[d+">","</h4>"]},fromHtml:function(b){return b.replace(/<h4\b[\s\S]*?>([\s\S]*?)<\/h4>/gi,"\n[h4]$1[/h4]")}};WH.markup.tags.h5={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},toc:{req:false,valid:/^false$/i}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){if(!b.id){b.id=WH.urlize(b._textContents)}var d="<h5"+WH.markup.getCommonAttributes(b);var c=["heading-size-5"];if(b.first||b.unnamed){c.push("first")}if(b.last){c.push("last")}if(c.length>0){d+=' class="'+c.join(" ")+'"'}return[d+">","</h5>"]},fromHtml:function(b){return b.replace(/<h5\b[\s\S]*?>([\s\S]*?)<\/h5>/gi,"\n[h5]$1[/h5]")}};WH.markup.tags.h6={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},toc:{req:false,valid:/^false$/i}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){if(!b.id){b.id=WH.urlize(b._textContents)}var d="<h6"+WH.markup.getCommonAttributes(b);var c=["heading-size-6"];if(b.first||b.unnamed){c.push("first")}if(b.last){c.push("last")}if(c.length>0){d+=' class="'+c.join(" ")+'"'}return[d+">","</h6>"]},fromHtml:function(b){return b.replace(/<h6\b[\s\S]*?>([\s\S]*?)<\/h6>/gi,"\n[h6]$1[/h6]")}};WH.markup.tags.i={empty:false,allowInReplies:true,toHtml:function(b){return["<i"+WH.markup.getCommonAttributes(b)+">","</i>"]},fromHtml:function(b){return b.replace(/<(i|em)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[i]$2[/i]")}};WH.markup.tags.icon={empty:false,itrim:true,attr:{align:{req:false,valid:/^right$/i},"float":{req:false,valid:/^(left|right)$/i},name:{req:false,valid:/\S+/},size:{req:false,valid:/^(tiny|small|medium|large)$/},unnamed:{req:false,valid:/^class$/i},url:{req:false,valid:/\S+/},preset:{req:false,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,presets:{boss:g_staticUrl+"/images/icons/boss.gif",heroic:g_staticUrl+"/images/icons/heroic.gif"},validate:function(b){if(!b.name&&!b.url&&!b.preset){return false}if(b.preset&&!WH.markup.tags.icon.presets[b.preset]){return false}return true},toHtml:function(b){var d=(b.size?b.size:"tiny");if(!b.name){b.name=""}if(d=="tiny"){var j="<span"+WH.markup.getCommonAttributes(b)+' class="';if(b.unnamed==undefined){j+="icontiny";if(b.align){j+="r"}var h="";if(b.name){h=g_staticUrl+"/images/wow/icons/tiny/"+b.name.toLowerCase()+".gif"}else{if(b.preset){h=WH.markup.tags.icon.presets[b.preset]}else{if(b.url&&WH.markup.isUrlSafe(b.url)){h=b.url}else{return""}}}j+='" style="background-image: url('+h+')">'}else{j+=b.name+'">'}return[j,"</span>"]}else{var j="<div"+WH.markup.getCommonAttributes(b)+' onclick="Icon.showIconName(this)" class="icon'+d+(b["float"]?'" style="float: '+b["float"]+';">':'">');var g={small:0,medium:1,large:2};var c=null;if(b.url&&WH.markup.isUrlSafe(b.url)){c=b.url}else{if(b._textContents&&WH.markup.isUrlSafe(b._textContents)){c=b._textContents}}var f=Icon.create(b.name.toLowerCase(),g[d],null,c);j+=f.innerHTML+"</div>";return[j]}}};WH.markup.tags.iconlist={empty:false,block:true,ltrim:true,rtrim:true,attr:{domain:{req:false,valid:WH.markup.regex.betaPtrLang}},taglessSkip:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{b:1,achievement:1,currency:1,faction:1,holiday:1,item:1,itemset:1,npc:1,object:1,pet:1,quest:1,spell:1,title:1,zone:1},toHtml:function(j){var f=WH.markup.getDatabaseDomainInfo(j)[2];var k="",d;for(var g=0;g<j._nodes.length;++g){var c=WH.dO(j._nodes[g]);c.attr.domain=f;var h=WH.markup.tags[c.name].toHtml(c.attr),b="",l="";h=WH.markup.convertToHtml(h);if(WH.isArray(h)){h=h[0]+c.attr._contents+h[1]}else{if(WH.isString(h)&&(d=h.match(/href="(.+?)".+?url\(\/images\/wow\/icons\/tiny\/(.+?)\.gif\)/))){c.attr.icon="false";h=WH.markup.tags[c.name].toHtml(c.attr);h=WH.markup.convertToHtml(h);b=d[1];l=d[2]}}if(h){k+="<tr><th>"+(l?WH.markup.getHtml("[icon name="+l+" size=small url="+b+"]",{skipReset:true}):"<ul><li>&nbsp;</li></ul>")+"</th><td>"+h+"</td></tr>"}}if(k){k='<div class="iconlist-col"><table class="iconlist">'+k+"</table></div>"}return[k]}};WH.markup.tags.img={empty:true,count:0,attr:{src:{req:false,valid:/\S+/},icon:{req:false,valid:/\S+/},id:{req:false,valid:/^[0-9]+$/},blog:{req:false,valid:/^[0-9]+$/},news:{req:false,valid:/^[0-9]+$/},size:{req:false,valid:/^(thumb|resized|normal|large|medium|small|tiny)$/i},width:{req:false,valid:/^[0-9%]+$/},height:{req:false,valid:/^[0-9]+$/},"float":{req:false,valid:/^(left|right|center)$/i},border:{req:false,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/},margin:{req:false,valid:/^[0-9]+$/},style:{req:false,valid:/^[^<>]+$/}},blogSize:/^(thumb|normal)$/i,idSize:/^(thumb|resized|normal)$/i,iconSize:/^(large|medium|small|tiny)$/i,allowedClass:WH.markup.CLASS.STAFF,validate:function(b){if(b.src){return true}else{if(b.id){return(b.size?WH.markup.tags.img.idSize.test(b.size):true)}else{if(b.icon){return(b.size?WH.markup.tags.img.iconSize.test(b.size):true)}else{if(b.blog||b.news){return(b.size?WH.markup.tags.img.blogSize.test(b.size):true)}}}}return false},toHtml:function(g){var k=WH.ce("img");var h=k;var d=[];var l=[];WH.markup.applyCommonAttributes(k,g);k.removeAttribute("style");k.className="";if(g.src){k.src=g.src}else{if(g.id){k.src=WH.getScreenshotUrl(g.id,g.size||"normal",g.title)}else{if(g.icon){k.src=g_staticUrl+"/images/wow/icons/"+(g.size?g.size:"large")+"/"+g.icon+".jpg"}else{if(g.blog||g.news){if(g_blogimages[g.blog||g.news]){var f=g_blogimages[g.blog||g.news];if(g.size&&g.size=="thumb"){var b=g_staticUrl+"/uploads/blog/images/"+(g.blog||g.news)+(f.type==3?".png":".jpg");k.src=g_staticUrl+"/uploads/blog/thumbs/"+(g.blog||g.news)+(f.type==3?".png":".jpg");k.alt=f.alt;k.width=f.thumbwidth;k.height=f.thumbheight;if(!g_screenshots[WH.markup.mediaUid]){g_screenshots[WH.markup.mediaUid]=[]}var c=WH.markup.tags.img.count++;h=WH.ce("a",{},h);h.href=b;h.id="img-thumb-"+c;setTimeout((function(n,p,o){var m=WH.ge("img-thumb-"+n);if(m){m.onclick=(function(s,r,q){if(!WH.isLeftClick(q)){return}ScreenshotViewer.show({screenshots:s,pos:r});return false}).bind(null,p,o)}}).bind(null,c,""+WH.markup.mediaUid,g_screenshots[WH.markup.mediaUid].length),0);var j={url:b,caption:f.alt,width:f.width,height:f.height,noMarkup:true};g_screenshots[WH.markup.mediaUid].push(j)}else{k.src=g_staticUrl+"/uploads/blog/images/"+(g.blog||g.news)+(f.type==3?".png":".jpg");k.alt=f.alt;if(!g.width&&!g.height){g.width=f.width;g.height=f.height}else{if(!g.height){if(g.width.toString().indexOf("%")===-1){g.height=Math.round(f.height*g.width/f.width)}}else{if(!g.width){g.width=Math.round(f.width*g.height/f.height)}}}}}else{return("Image #"+(g.blog||g.news))}}}}}if(g.width){k.width=g.width}if(g.height){k.height=g.height}if(g["float"]){if(g["float"]=="center"){h=WH.ce("div",{},h);h.style.textAlign="center";l.push("margin:10px auto")}else{d.push("markup-float-"+g["float"]);if(g.margin){if(g["float"]=="left"){l.push("margin:0 "+g.margin+"px "+g.margin+"px 0")}else{l.push("margin:0 0 "+g.margin+"px "+g.margin+"px")}}}}if(g.border){if(g.border==0){d.push("no-border")}else{d.push("border");l.push("border-width:"+g.border+"px")}}else{d.push("content-image");if(g.shadow=="true"){d.push("content-image-shadowed")}}k.alt=g.title||k.alt||"";if(g.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){l.push(g.style)}if(d.length){k.className=d.join(" ")}if(l.length){k.setAttribute("style",l.join(";"))}return h},fromHtml:function(j){var c;if(c=j.match(/<img\b[\s\S]*?src="[\s\S]+?"[\s\S]*?>/gi)){for(var f=0;f<c.length;++f){var h=c[f].match(/src="([\s\S]+?)"/i),g=c[f].match(/width[:="]+\s*([0-9]+)/i),b=c[f].match(/height[:="]+\s*([0-9]+)/i),d=c[f].match(/border[:="]+\s*([0-9]+)/i);j=j.replace(c[f],"[img src="+h[1]+(g?" width="+g[1]:"")+(b?" height="+b[1]:"")+" border="+(d?d[1]:0)+"]")}}return j}};WH.markup.tags.ins={empty:false,toHtml:function(b){return['<ins class="diffmod"'+WH.markup.getCommonAttributes(b)+">","</ins>"]}};WH.markup.tags.li={empty:false,itrim:true,allowedParents:{ul:1,ol:1},attr:{"class":{req:false,valid:/^[a-z0-9 _-]+$/i},style:{req:false,valid:/^[^<>]+$/}},helpText:function(){var c="";c+="[ul]";for(var b=0;b<3;++b){c+="\n[li]"+LANG.markup_li+"[/li]"}c+="\n[/ul]\n\n";c+="[ol]";for(var b=0;b<3;++b){c+="\n[li]"+LANG.markup_li+"[/li]"}c+="\n[/ol]\n";return c.toLowerCase()},toHtml:function(b){return["<li"+WH.markup.getCommonAttributes(b)+"><div>","</div></li>"]},fromHtml:function(f,d){d=d||0;var b;if(b=WH.markup.matchOuterTags(f,"<li\\b[\\s\\S]*?>","</li>","g")){for(var c=0;c<b.length;++c){f=f.replace(b[c][1]+b[c][0]+b[c][2],"\n\t"+Array(d+1).join("\t")+"[li]"+WH.markup.tags.li.fromHtml(b[c][0],d+1)+"[/li]")}}return f}};WH.markup.tags["major-heading"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^false$/i}},toHtml:function(b){if(!b.id){b.id=WH.urlize(b._textContents,true)}var f="<h2"+WH.markup.getCommonAttributes(b);var c=["heading-size-2"];if(b.first||b.unnamed){c.push("first")}if(b.last){c.push("last")}if(c.length>0){f+=' class="'+c.join(" ")+'"'}var d=[];if(b.clear){if(b.clear=="true"||b.clear=="both"){d.push("clear:both")}else{d.push("clear:"+b.clear)}}if(b.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){d.push(b.style)}if(d.length){f+=' style="'+d.join(";")+'"'}return[f+">","</h2>"]},fromHtml:function(b){return b.replace(/<h2\b[\s\S]*?>([\s\S]*?)<\/h2>/gi,"\n[major-heading]$1[/major-heading]")}};WH.markup.tags["minor-heading"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^false$/i}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){if(!b.id){b.id=WH.urlize(b._textContents,true)}var f="<h3"+WH.markup.getCommonAttributes(b);var c=["heading-size-3"];if(b.first||b.unnamed){c.push("first")}if(b.last){c.push("last")}if(c.length>0){f+=' class="'+c.join(" ")+'"'}var d=[];if(b.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){d.push(b.style)}if(d.length){f+=' style="'+d.join(";")+'"'}return[f+">","</h3>"]},fromHtml:function(b){return b.replace(/<h3\b[\s\S]*?>([\s\S]*?)<\/h3>/gi,"\n[minor-heading]$1[/minor-heading]")}};WH.markup.tags.nav={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{"nav-item":1},toHtml:function(b){var h="nav-markup-"+WH.markup.getAutoIncrementCount("nav");var g='<div class="clear"></div><div class="smooth-nav-wrapper" id="'+h+'"><div class="smooth-nav-outer"><div class="smooth-nav-inner">';var d=b._contents;for(var f=0,c;c=d[f];++f){g+='<a id="'+h+"-"+f+'"'+(c.url?' href="'+c.url+'"':"")+' rel="np">';g+=c.content;g+="</a>";if(c.tooltip){setTimeout((function(l,k){var j=WH.ge(l);if(j){WH.Tooltip.simple(j,k.replace(/&lt;br&gt;/g,"<br>"),"q")}}).bind(null,h+"-"+f,c.tooltip),0)}}g+="</div></div></div>";setTimeout(WH.setupSmoothNavClicks.bind(null,"#"+h),0);return[g]}};WH.markup.tags["nav-item"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{nav:1},attr:{unnamed:{req:false,valid:/\S+/},tooltip:{req:false,valid:/^.*$/}},toHtml:function(b){return[{content:b._contents,tooltip:b.tooltip,url:b.unnamed}]}};WH.markup.tags.n5={empty:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/}},toHtml:function(b){return WH.getN5(b.unnamed)}};WH.markup.tags.minibox={empty:false,rtrim:true,itrim:true,attr:{"float":{req:false,valid:/^(left|right)$/i}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){var c="<div"+WH.markup.getCommonAttributes(b)+' class="minibox';if(b["float"]=="left"){c+=" minibox-left"}c+='">';return[c,"</div>"]}};WH.markup.tags.money={empty:true,attr:{unnamed:{req:false,valid:/^[0-9]+$/},side:{req:false,valid:/^(alliance|horde|both)$/i},items:{req:false,valid:/^[0-9,]+$/},currency:{req:false,valid:/^[0-9,]+$/},achievement:{req:false,valid:/\S+/},arena:{req:false,valid:/^[0-9]+$/},honor:{req:false,valid:/^[0-9]+$/},conquest:{req:false,valid:/^[0-9]+$/},justice:{req:false,valid:/^[0-9]+$/},valor:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){var d=[],c=[];if(b.items){var g=b.items.split(",");if(g.length>=2){for(var f=0;f<g.length-1;f+=2){d.push([g[f],g[f+1]])}}}if(b.currency){var g=b.currency.split(",");if(g.length>=2){for(var f=0;f<g.length-1;f+=2){c.push([g[f],g[f+1]])}}}if(b.arena&&!b.conquest){b.conquest=b.arena}if(b.honor){c.push([392,b.honor])}if(b.conquest){c.push([390,b.conquest])}if(b.justice){c.push([395,b.justice])}if(b.valor){c.push([396,b.valor])}return WH.getMoneyHtml(b.unnamed,b.side,d,c,b.achievement)}};WH.markup.tags.ol={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{li:1},toHtml:function(b){var c="<ol";var d=[];if(b.first){d.push("first")}if(b.last){d.push("last")}if(d.length>0){c+=' class="'+d.join(" ")+'"'}c+=WH.markup.getCommonAttributes(b)+">";return[c,"</ol>"]},fromHtml:function(f,d){d=d||0;var b;if(b=WH.markup.matchOuterTags(f,"<ol\\b[\\s\\S]*?>","</ol>","g")){for(var c=0;c<b.length;++c){f=f.replace(b[c][1]+b[c][0]+b[c][2],"\n"+Array(d+1).join("\t")+"[ol]"+WH.markup.tags.ol.fromHtml(b[c][0],d+1)+"\n"+Array(d+1).join("\t")+"[/ol]")}}return f}};WH.markup.tags.p={empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){return['<p style="line-height: 1.4em; margin: 1em 0px 0px 0px;"'+WH.markup.getCommonAttributes(b)+">","</p>"]},fromHtml:function(f){var c;if(c=f.match(/<p\b[\s\S]*?>[\s\S]*?<\/p>/gi)){for(var d=0;d<c.length;++d){var g=c[d].match(/^<p\b[\s\S]*?text-align:\s*(center|left|right)/i);var b=c[d].match(/<p\b[\s\S]*?>([\s\S]*?)<\/p>/i);f=f.replace(c[d],"[pad][div"+(g?" align="+g[1]:"")+"]"+(b?b[1]:"")+"[/div][pad]")}}return f}};WH.markup.tags.pad={empty:true,block:true,trim:true,allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){var c='<div class="pad';if(b.first){c+=" first"}if(b.last){c+=" last"}c+='"'+WH.markup.getCommonAttributes(b)+"></div>";return c}};WH.markup.tags.pre={empty:false,block:true,rtrim:true,toHtml:function(b){var c='<pre class="code';if(b.first){c+=" first"}if(b.last){c+=" last"}c+='"'+WH.markup.getCommonAttributes(b)+">";return[c,"</pre>"]},fromHtml:function(b){return b.replace(/<pre\b[\s\S]*?>([\s\S]*?)<\/pre>/gi,"[pre]$1[/pre]")}};WH.markup.tags.quote={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{unnamed:{req:false,valid:/[\S ]+/},url:{req:false,valid:/\S+/},blizzard:{req:false,valid:/^true$/},pname:{req:false},wowhead:{req:false,valid:/^true$/},display:{req:false,valid:/^block$/},align:{req:false,valid:/^(left|right|center)$/i},"float":{req:false,valid:/^(left|right|none)$/i},clear:{req:false,valid:/^(left|right|both)$/i},collapse:{req:false,valid:/^true$/}},allowedModes:{article:1,quickfacts:1,comment:1},validate:function(b){if(b.blizzard||b.wowhead||b.collapse||b.url){if(WH.markup.allow<WH.markup.CLASS.STAFF){return false}}return true},toHtml:function(h){var k="<div"+WH.markup.getCommonAttributes(h);var l=[];var c=["quote"];if(h.display){l.push("display: "+h.display)}if(h.align){l.push("text-align: "+h.align)}if(h.clear){l.push("clear:"+h.clear)}if(l.length){k+=' style="'+l.join("; ")+'" '}if(h.first){c.push("first")}if(h.last){c.push("last")}if(h["float"]){c.push("markup-float-"+h["float"])}k+=' class="'+c.join(" ");if(h.blizzard){if(h.unnamed&&h.blizzard){var b=WH.markup.getFixedUrl(h.url);var d="View Original";if(b.indexOf("bluetracker")>=0){d="Blue Tracker"}if(typeof h.pname!=="undefined"){d=h.pname}var f=h.unnamed.trim();if(f.length<=0){return["",""]}k=k.replace('class="quote','class="quote-blizz');k+=(h.collapse?" collapse":"")+'"><div class="quote-header">';var g=b.match(/https?:\/\/(us|eu)\.battle\.net\/wow\/en\/blog\/([0-9]+)/i)||b.match(/https?:\/\/(us|eu)\.battle\.net\/wow\/en\/forum\/topic\/([0-9]+)/i);if(g){k+='Originally posted by <strong>Blizzard</strong> (<a href="'+b+'" target="_blank">Official Post</a>';var j=g[2];k+=' | <a href="//www.wowhead.com/bluetracker?topic='+j+'">Blue Tracker</a>)</div><div class="quote-body"><hr /><h2 class="heading-size-2">'+f+"</h2>"}else{k+=(h.url&&WH.markup.isUrlSafe(h.url)?'Originally posted by <strong>Blizzard</strong> (<a href="'+WH.markup.getFixedUrl(h.url)+'" target="_blank">'+d+'</a>)</div><div class="quote-body"><hr />':'<h2 class="heading-size-2">'+f+"</h2>")}return[k,"</div></div>"]}return["",""]}else{if(h.wowhead){k=k.replace('class="quote','class="quote-wh');k+=(h.collapse?" collapse":"")+'">';k+='<div class="quote-body">';return[k,"</div></div>"]}else{k+='">';if(h.unnamed){var f=h.unnamed.trim();if(f.length>0){k+="<small><b>";if(h.url&&WH.markup.isUrlSafe(h.url)){k+='<a href="'+WH.markup.getFixedUrl(h.url)+'"'+(WH.markup.isUrlExternal(h.url)?' target="_blank"':"")+">"+f+"</a>"}else{if(WH.isUsernameValid(f)){k+='<a href="/user='+f+'">'+f+"</a>"}else{k+=f}}k+="</b> "+LANG.markup_said+'</small><div class="pad"></div>'}}return[k,"</div>"]}}}};WH.markup.tags.reveal={empty:false,allowedClass:WH.markup.CLASS.STAFF,toHtml:function(c){if(!WH.markup.inNewsType||WH.markup.inNewsType>1){return["",""]}var b=WH.markup.getAutoIncrementCount("reveals");return['<span id="reveal-'+b+'" style="display: none">','</span> <a id="revealtoggle-'+b+'" class="revealtoggle" href="javascript:;" onclick="WH.markup.toggleReveal('+b+');">'+LANG.parens_open+LANG.readmore.toLowerCase()+LANG.parens_close+"</a>"]}};WH.markup.tags.s={empty:false,allowInReplies:true,toHtml:function(b){return["<del"+WH.markup.getCommonAttributes(b)+">","</del>"]},fromHtml:function(b){b=b.replace(/<del\b[\s\S]*?>([\s\S]*?)<\/del>/gi,"[s]$1[/s]");return b.replace(/<s\b[\s\S]*?>([\s\S]*?)<\/s>/gi,"[s]$1[/s]")}};WH.markup.tags.section={empty:false,ltrim:true,rtrim:true,trim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{},toHtml:function(b){return['<div class="secheader"><var></var>',"</div>"]}};WH.markup.tags.small={empty:false,toHtml:function(b){return["<small"+WH.markup.getCommonAttributes(b)+">","</small>"]},fromHtml:function(b){return b.replace(/<small\b[\s\S]*?>([\s\S]*?)<\/small>/gi,"[small]$1[/small]")}};WH.markup.tags.span={empty:false,attr:{"class":{req:false,valid:/^[a-z0-9 _-]+$/i},style:{req:false,valid:/^[^<>]+$/},unnamed:{req:false,valid:/^(hidden|invisible)$/},tooltip:{req:false,valid:/\S+/},tooltip2:{req:false,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){var d="<span"+WH.markup.getCommonAttributes(b);var c=[];if(b.unnamed=="hidden"){c.push("display: none")}else{if(b.unnamed=="invisible"){c.push("visibility: hidden")}}if(c.length>0){d+=' style="'+c.join(";")+'"'}if(b.tooltip&&WH.markup.tooltipTags[b.tooltip]){d+=" onmouseover=\"WH.Tooltip.showAtCursor(event, WH.markup.tooltipTags['"+b.tooltip+"'], 0, 0, "+(WH.markup.tooltipTagsWithRawText[b.tooltip]?"null":"'q'")+", "+(b.tooltip2&&WH.markup.tooltipTags[b.tooltip2]?"WH.markup.tooltipTags['"+b.tooltip2+"']":"null")+')" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()"'}d+=">";return[d,"</span>"]},fromHtml:function(b){return b.replace(/<span\b([\s\S]*?)>([\s\S]*?)<\/span>/gi,function(g,k,j){var f=/style="[\s\S]*?color:\s?#(\w{6});?/i;var h=k.match(f);if(h){var c={ffd100:"q","9d9d9d":"q0",ffffff:"q1","1eff00":"q2","0070dd":"q3",a335ee:"q4",ff8000:"q5",e5cc80:"q6","00ccff":"q8","71d5ff":"q9",ff4040:"q10",ffff98:"q13",ff8040:"r1",ffff00:"r2","40bf40":"r3","808080":"r4",c69b6d:"c1",f48cba:"c2",aad372:"c3",fff468:"c4",c41e3b:"c6","2359ff":"c7","68ccef":"c8","9382c9":"c9","008467":"c10",ff7c0a:"c11"};var d=c[h[1]];if(d){return"[color="+d+"]"+j+"[/color]"}}return g})}};WH.markup.tags.spoiler={block:true,empty:false,attr:{unnamed:{req:false,valid:/^.*$/}},rtrim:true,ltrim:true,itrim:true,timer:null,toHtml:function(b){clearTimeout(WH.markup.tags.spoiler.timer);WH.markup.tags.spoiler.timer=setTimeout(function(){$('button[data-spoiler-revealer="needs-handler"].spoiler-revealer').each(function(){this.onclick=function(){this.parentNode.parentNode.className+=" spoiler-reveal"};this.removeAttribute("data-spoiler-revealer")});$('button[data-spoiler-hider="needs-handler"].spoiler-hider').each(function(){this.onclick=function(){this.parentNode.parentNode.className=this.parentNode.parentNode.className.replace(/ *spoiler-reveal/g,"")};this.removeAttribute("data-spoiler-hider")})},1);return['<div class="pad"></div><div class="spoiler-wrapper"><div class="spoiler-desc"><b>'+LANG.markup_spoil+"</b> "+(b.unnamed?b.unnamed:"")+' <button type="button" class="spoiler-revealer btn btn-small btn-site" data-spoiler-revealer="needs-handler">'+LANG.markup_spoiler_reveal+'</button><button type="button" class="spoiler-hider btn btn-small btn-site" data-spoiler-hider="needs-handler">'+LANG.markup_spoiler_hide+"</button></div><div"+WH.markup.getCommonAttributes(b)+' class="spoiler">',"</div></div>"]}};WH.markup.tags.sub={empty:false,toHtml:function(b){return["<sub"+WH.markup.getCommonAttributes(b)+">","</sub>"]},fromHtml:function(b){return b.replace(/<sub\b[\s\S]*?>([\s\S]*?)<\/sub>/gi,"[sub]$1[/sub]")}};WH.markup.tags.sup={empty:false,toHtml:function(b){return["<sup"+WH.markup.getCommonAttributes(b)+">","</sup>"]},fromHtml:function(b){return b.replace(/<sup\b[\s\S]*?>([\s\S]*?)<\/sup>/gi,"[sup]$1[/sup]")}};WH.markup.tags.tabs={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{tab:1},attr:{name:{req:true,valid:/\S+/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toHtml:function(c){c.id=WH.urlize(c.name);var b=WH.markup.isPreview;var h='<div class="clear"></div><div id="dsf67g4d-'+c.id+(b?"-preview":"")+'"></div>';h+="<div";if(c.width){h+=' style="width: '+c.width+'"'}h+=">";h+='<div class="tabbed-contents">';var f=c._contents;for(var d=0;d<f.length;++d){var g=f[d];h+='<div id="tab-'+c.id+"-"+g.id+'" style="display: none">';h+=g.content;h+='<div class="clear"></div>';h+="</div>"}h+="</div>";h+="</div>";setTimeout((function(n,l,o){var j=new Tabs({parent:WH.ge("dsf67g4d-"+n.id+(o?"-preview":"")),forum:1,noScroll:(o?true:false)});for(var k=0;k<l.length;++k){var m=l[k];j.add(m.name,{id:n.id+"-"+m.id,icon:m.icon,"class":m["class"]})}j.flush()}).bind(null,c,f,(b?"preview":"")),0);return[h]}};WH.markup.tags.tab={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{tabs:1},attr:{name:{req:true,valid:/[\S ]+/},icon:{req:false,valid:/\S+/},id:{req:false,valid:/[\S ]+/}},toHtml:function(b){var c=b.id?WH.urlize(b.id,true,true):null;if(!c){c=WH.urlize(b.name,true,true)}if(!c){c=WH.markup.getAutoIncrementCount("tab")}b.name=WH.stringReplace(b.name,"_"," ");if(typeof(b["class"])!="undefined"){b["class"]=WH.stringReplace(b["class"],"_"," ")}return[{content:b._contents,id:c,name:b.name,icon:b.icon,"class":b["class"]}]}};WH.markup.tags.table={empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{tr:1},attr:{border:{req:false,valid:/^[0-9]+$/},cellspacing:{req:false,valid:/^[0-9]+$/},cellpadding:{req:false,valid:/^[0-9]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toHtml:function(b){var c=WH.ce("table");WH.markup.applyCommonAttributes(c,b);if(typeof b.border!=="undefined"){c.border=b.border;if(c.className){c.className+=" clean-markup-table-borders"}else{c.className="clean-markup-table-borders"}}if(typeof b.cellspacing!=="undefined"){c.cellSpacing=b.cellspacing}if(typeof b.cellpadding!=="undefined"){c.cellPadding=b.cellpadding}if(typeof b.width!=="undefined"){c.style.width=b.width}return[c.outerHTML.replace(/<\/table>$/,"")+"<tbody>","</tbody></table>"]},fromHtml:function(j,h){h=h||0;var b;if(b=WH.markup.matchOuterTags(j,"<table\\b[\\s\\S]*?>","</table>","g")){for(var d=0;d<b.length;++d){var c=b[d][1].match(/border[:="]+\s*([0-9]+)/i),f=b[d][1].match(/width[:="]+\s*([0-9]+)/i),k=b[d][1].match(/cellspacing="([\s\S]+?)"/i),g=b[d][1].match(/cellpadding="([\s\S]+?)"/i);j=j.replace(b[d][1]+b[d][0]+b[d][2],"\n"+Array(h+1).join("\t")+"[table"+(c?" border="+c[1]:"")+(f?" width="+f[1]:"")+(k?" cellspacing="+k[1]:"")+(g?" cellpadding="+g[1]:"")+"]"+WH.markup.tags.table.fromHtml(b[d][0],h+1)+"\n"+Array(h+1).join("\t")+"[/table]")}}return j}};WH.markup.tags.tr={empty:false,itrim:true,allowedChildren:{td:1},allowedParents:{table:1},toHtml:function(b){return["<tr"+WH.markup.getCommonAttributes(b)+">","</tr>"]},fromHtml:function(f,d){d=d||0;var b;if(b=WH.markup.matchOuterTags(f,"<tr\\b[\\s\\S]*?>","</tr>","g")){for(var c=0;c<b.length;++c){f=f.replace(b[c][1]+b[c][0]+b[c][2],"\n\t"+Array(d+1).join("\t")+"[tr]"+WH.markup.tags.tr.fromHtml(b[c][0],d+1)+"\n"+Array(d+1).join("\t")+"[/tr]")}}return f}};WH.markup.tags.td={empty:false,itrim:true,allowedParents:{tr:1},attr:{unnamed:{req:false,valid:/^header$/},align:{req:false,valid:/^(right|left|center|justify)$/i},valign:{req:false,valid:/^(top|middle|bottom|baseline)$/i},colspan:{req:false,valid:/^[0-9]+$/},rowspan:{req:false,valid:/^[0-9]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toHtml:function(b){var c="<"+(b.unnamed?"th":"td")+WH.markup.getCommonAttributes(b);if(b.align!=undefined){c+=' align="'+b.align+'"'}if(b.valign!=undefined){c+=' valign="'+b.valign+'"'}if(b.colspan!=undefined){c+=' colspan="'+b.colspan+'"'}if(b.rowspan!=undefined){c+=' rowspan="'+b.rowspan+'"'}if(b.width!=undefined){c+=' style="width: '+b.width+'"'}c+=">";return[c,"</"+(b.unnamed?"th":"td")+">"]},fromHtml:function(n,h){h=h||0;var p=["td","th"],d;for(var g=0;g<p.length;++g){if(d=WH.markup.matchOuterTags(n,"<"+p[g]+"\\b[\\s\\S]*?>","</"+p[g]+">","g")){for(var k=0;k<d.length;++k){var b=d[k][1].match(/width[:="]+\s*([0-9]+)/i),l=d[k][1].match(/align="([\s\S]+?)"/i),o=d[k][1].match(/valign="([\s\S]+?)"/i),c=d[k][1].match(/colspan="([\s\S]+?)"/i),f=d[k][1].match(/rowspan="([\s\S]+?)"/i);n=n.replace(d[k][1]+d[k][0]+d[k][2],"\n\t\t"+Array(h+1).join("\t")+"[td"+(p[g]=="th"?"=header":"")+(b?" width="+b[1]:"")+(l?" align="+l[1]:"")+(o?" valign="+o[1]:"")+(c?" colspan="+c[1]:"")+(f?" rowspan="+f[1]:"")+"]"+WH.markup.tags.td.fromHtml(d[k][0],h+1)+"[/td]")}}}return n}};WH.markup.tags.toc={block:true,post:true,trim:true,ltrim:true,rtrim:true,collect:{h2:1,h3:1,"major-heading":1,"minor-heading":1,toggler:1,changelog:1},exclude:{tabs:{h2:1,h3:1,"major-heading":1,"minor-heading":1},minibox:{h2:1,h3:1,"major-heading":1,"minor-heading":1}},allowedClass:WH.markup.CLASS.STAFF,attr:{h3:{req:false,valid:/^false$/},"minor-heading":{req:false,valid:/^false$/}},postHtml:function(q,o){var p="<h3";var y=["heading-size-3"];if(q.first){y.push("first")}if(q.last){y.push("last")}if(y.length>0){p+=' class="'+y.join(" ")+'"'}p+=WH.markup.getCommonAttributes(q)+">"+LANG.markup_toc+"</h3><ul>";var f="<b>";var v="</b>";var n=WH.ge("guide-view-toc");var b=null;if(n){p="<ul>";f=v="";b=WH.ge("guide-navigation")}var g="";var m=1;var l=(q.h3!="false"&&q["minor-heading"]!="false");var h=[];for(var r in o.h2){h.push(o.h2[r])}for(var r in o["major-heading"]){h.push(o["major-heading"][r])}for(var r in o.h3){h.push(o.h3[r])}for(var r in o["minor-heading"]){h.push(o["minor-heading"][r])}for(var r in o.toggler){h.push(o.toggler[r])}for(var r in o.changelog){h.push(o.changelog[r])}h.sort(function(k,j){return k.offset-j.offset});var c=false;for(var u in h){if(h[u].name=="h2"||h[u].name=="major-heading"){c=true;break}}for(var t in h){r=h[t];switch(r.name){case"changelog":if(g=="h3"){p+="</ul>";m--}p+="<li>"+f+"<a href='#guide-changelog' onclick=\"WH.markup.toggleReveal('changelog');\">Changelog</a>"+v+"</li>";g="h2";break;case"toggler":if((r.attr.toc!="false")&&r.attr.name){var w=r.attr.size||3;if(w==3&&g=="h2"){p+="<ul>";m++}else{if(w==2&&g=="h3"){p+="</ul>";m--}}p+="<li>"+f+"<a href='#"+(r.attr.id?WH.urlize(r.attr.id,true):WH.urlize(r.attr.name,true))+"'>"+r.attr.name+"</a>"+v+"</li>";g="h"+w}break;case"h2":case"major-heading":if(r.attr.toc!="false"){if(g=="h3"){p+="</ul>";m--}p+="<li>"+f+"<a href='#"+(r.attr.id?WH.urlize(r.attr.id,true):WH.urlize(r.attr._textContents,true))+"'>"+r.attr._textContents+"</a>"+v+"</li>";g="h2"}break;case"h3":case"minor-heading":if(l&&r.attr.toc!="false"&&(g!=""||o.h2.length==0||o["major-heading"].length==0)){if(g=="h2"){p+="<ul>";m++}else{if(!g&&c){p+="<li>"+LANG.overview+"</li><ul>";m++}}p+="<li>"+f+"<a href='#"+(r.attr.id?WH.urlize(r.attr.id,true):WH.urlize(r.attr._textContents,true))+"'>"+r.attr._textContents+"</a>"+v+"</li>";g="h3"}break}}for(var s=0;s<m;s++){p+="</ul>"}if(n){if(b){var d=$(b);var z=d.find('a[href$="wowhead.com'+location.pathname+'"]');if(z.length){$(n).closest("table").parent().remove();z.addClass("current");z.after(p);return""}}n.innerHTML=p;return""}return p}};WH.markup.tags.toggler={empty:false,attr:{id:{req:false,valid:/^[a-z0-9_-]+$/i},closed:{req:false,valid:/^(true|false)$/i},"class":{req:false,valid:/^[a-z0-9 _-]+$/i},icon:{req:false,valid:/^[a-z0-9 _-]+$/i},name:{req:false,valid:/^.+$/i},size:{req:false,valid:/^[2-6]$/i},toc:{req:false,valid:/^false$/i},unnamed:{req:false,valid:/^hidden$/i}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(f){if(f.id){var d='<a href="javascript:;" class="disclosure-'+(f.unnamed?"off":"on")+'" onclick="return WH.disclose(WH.ge(\''+f.id+"'), this)\">";return[d,"</a>"]}var b=WH.markup.getAutoIncrementCount("toggler");var j="toggler-set-"+b;var h="";if(f.icon){var c=WH.ce("div",{},Icon.create(f.icon,0,null,false,null,null,null,null,true));h=c.innerHTML}var k=f.id;if(!k&&f.name){k=WH.urlize(f.name)}if(!k){k=b}var l=WH.getMajorHeading('<a href="javascript:;" class="toggler-'+(f.closed=="true"?"off":"on")+'" onclick="return WH.toggle.call(this, WH.ge(\''+j+'\'))"><span class="fa fa-chevron-right fa-fw"></span> <span class="toggler-title'+(h?" toggler-title-with-icon":"")+(f["class"]?" "+f["class"]:"")+'">'+h+(f.name||LANG.su_toggle)+"</span></a>",f.size||3,null,{asString:true,id:k});var g=l+'<div id="'+j+'"'+(f.closed=="true"?' style="display:none"':"")+">";return[g,"</div>"]}};WH.markup.tags.u={empty:false,allowInReplies:true,toHtml:function(b){return["<ins"+WH.markup.getCommonAttributes(b)+">","</ins>"]},fromHtml:function(b){return b.replace(/<(ins|u)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[u]$2[/u]")}};WH.markup.tags.ul={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{li:1},toHtml:function(b){var c="<ul";var d=[];if(b.first){d.push("first")}if(b.last){d.push("last")}if(d.length>0){c+=' class="'+d.join(" ")+'"'}c+=WH.markup.getCommonAttributes(b)+">";return[c,"</ul>"]},fromHtml:function(f,d){d=d||0;var b;if(b=WH.markup.matchOuterTags(f,"<ul\\b[\\s\\S]*?>","</ul>","g")){for(var c=0;c<b.length;++c){f=f.replace(b[c][1]+b[c][0]+b[c][2],"\n"+Array(d+1).join("\t")+"[ul]"+WH.markup.tags.ul.fromHtml(b[c][0],d+1)+"\n"+Array(d+1).join("\t")+"[/ul]")}}return f}};WH.markup.tags.url={allowedClass:WH.markup.CLASS.USER,allowInReplies:true,empty:false,helpText:"[url=http://www.google.com]"+LANG.markup_url+"[/url]",attr:{unnamed:{req:false,valid:/\S+/},rel:{req:false,valid:/((item|quest|spell|achievement|npc|object|petability|pet-ability)=([0-9]+)|np)/},onclick:{req:false,valid:/[\S ]+/},style:{req:false,valid:/^[^"<>]+$/},tooltip:{req:false,valid:/\S+/},tooltip2:{req:false,valid:/\S+/},newwindow:{req:false,valid:/^true$/}},validate:function(b){if(b.onclick&&WH.markup.allow<WH.markup.CLASS.ADMIN){return false}if(b.tooltip&&WH.markup.allow<WH.markup.CLASS.STAFF){return false}var c="";if(b.unnamed&&/^(mailto:|irc:)/i.test(b.unnamed.trim())&&WH.markup.allow<WH.markup.CLASS.STAFF){return false}if(b.unnamed&&/^(javascript:)/i.test(b.unnamed.trim())){return false}return true},toHtml:function(b){var d;if(b.unnamed){d=b.unnamed;d=d.replace(/&amp;/,"&");if(!d.match(/^([^:\\.\/]+):/i)&&d.charAt(0)!="/"&&d.charAt(0)!="#"){d="/"+d}if(WH.markup.isUrlSafe(d,true)){var c="<a"+WH.markup.getCommonAttributes(b)+' href="'+WH.markup.getFixedUrl(d)+'"';if(WH.markup.isUrlExternal(d)||b.newwindow){c+=' target="_blank"'}if(b.rel){c+=' rel="'+b.rel+'"'}if(b.onclick){c+=' onclick="'+b.onclick+'"'}if(b.tooltip&&WH.markup.tooltipTags[b.tooltip]){c+=" onmouseover=\"WH.Tooltip.showAtCursor(event, WH.markup.tooltipTags['"+b.tooltip+"'], 0, 0, "+(WH.markup.tooltipTagsWithRawText[b.tooltip]?"null":"'q'")+", "+(b.tooltip2&&WH.markup.tooltipTags[b.tooltip2]?"WH.markup.tooltipTags['"+b.tooltip2+"']":"null")+')" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()"'}if(b.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){c+=' style="'+b.style+'"'}c+=">";return[c,"</a>"]}else{return["",""]}}else{d=b._textContents;d=d.replace(/&amp;/,"&");if(WH.markup.isUrlSafe(d)){var c="<a"+WH.markup.getCommonAttributes(b)+' href="'+WH.markup.getFixedUrl(d)+'"';if(WH.markup.isUrlExternal(d)){c+=' target="_blank"'}if(b.rel){c+=' rel="'+b.rel+'"'}if(b.onclick){c+=' onclick="'+b.onclick+'"'}if(b.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){c+=' style="'+b.style+'"'}c+=">";return[c+d+"</a>"]}else{return["",""]}}},fromHtml:function(b){return b.replace(/<a\b[^>]*?href=\"(.+?)\"[\s\S]*?>([\s\S]*?)<\/a>/gi,"[url=$1]$2[/url]")}};WH.markup.tags.wowheadresponse={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{unnamed:{req:true,valid:/[\S ]+/},roles:{req:true,valid:/[0-9]+/}},allowedModes:{article:1,quickfacts:1,comment:1},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){var f="<div"+WH.markup.getCommonAttributes(b);var d=[];f+=' class="quote ';if(b.first){f+="firstmargin "}if(b.last){f=="last "}var g=b.unnamed.trim();if(g.length<=0){return["",""]}var c="";if(b.roles&U_GROUP_ADMIN){c="comment-blue"}else{c="comment-green"}if(g_customColors[g]){c="comment-"+g_customColors[g]}f+=c+'"><small class="icon-wowhead"><b class="'+c+'"><a href="/user='+g+'">'+g+"</a></b> "+LANG.markup_said+'</small><div class="pad"></div>';return[f,"</div>"]}};WH.markup.tags["<text>"]={empty:true,noHelp:true,allowInReplies:true,toHtml:function(c,b){b=b||$.noop;if(c._text==" "&&!b.noNbsp){c._text="&nbsp;"}c._text=c._text.replace(/\\\[/g,"[");if(b&&b.noLink){return c._text}else{if(b&&b.needsRaw){return c._rawText}else{var f=[];var g=WH.markup.getPreFormattedText(c._rawText.replace(/(https?:\/\/|www\.)([\/_a-z0-9\%\?#@\-\+~&=;:'|]|\.[a-z0-9\-])+/gi,function(h){var k=WH.markup.getPreFormattedText(h.replace(/^www/,"http://www"));h=WH.markup.getPreFormattedText(h);var j=f.length;f.push([k,h]);return"$L"+j}));g=g.replace(/\$L([\d+]) /gi,"$L$1&nbsp;");for(var d in f){g=g.replace("$L"+d,function(j){if(WH.markup.allow<WH.markup.CLASS.USER&&!WH.markup.tags["<text>"].isLinkAllowed(f[d][0])){return WH.sprintf('<span class="tip" onmouseover="WH.Tooltip.showAtCursor(event, LANG.linkremoved_tip, 0, 0, \'q\')" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()">[$1]</span>',LANG.linkremoved)}var h='<a href="'+f[d][0]+'"';if(WH.markup.isUrlExternal(f[d][0])){h+=' target="_blank"'}h+=">"+f[d][1]+"</a>";return h})}return g}}},toText:function(b){return b._text},whitelistedWebsites:[/(.*\.)?wowhead.com/i,/(.*\.)?thottbot.com/i,/(.*\.)?torhead.com/i,/(.*\.)?mmoui.com/i,/(.*\.)?tankspot.com/i,/(.*\.)?guildfans.com/i,/(.*\.)?allakhazam.com/i,/(.*\.)?zam.com/i,/(.*\.)?blizzard.com/i,/(.*\.)?worldofwarcraft.com/i,/(.*\.)?wow-europe.com/i,/(.*\.)?battle.net/i,/(.*\.)?sc2ranks.com/i,/(.*\.)?torchlightarmory.com/i,/(.*\.)?vindictusdb.com/i,/(.*\.)?wowinterface.com/i,/(.*\.)?vginterface.com/i,/(.*\.)?lotrointerface.com/i,/(.*\.)?eq2interface.com/i,/(.*\.)?eqinterface.com/i,/(.*\.)?mmo-champion.com/i,/(.*\.)?joystiq.com/i,/(.*\.)?wow-heroes.com/i,/(.*\.)?be-imba.hu/i,/(.*\.)?wowpedia.org/i,/(.*\.)?curse.com/i,/(.*\.)?elitistjerks.com/i,/(.*\.)?wowwiki.com/i,/(.*\.)?worldoflogs.com/i,/(.*\.)?wowinsider.com/i,/(.*\.)?guildwork.com/i,/(.*\.)?hearthhead\.com/i],isLinkAllowed:function(d){var g=d.match("[a-z]+://([a-z0-9.-]+)");if(!g){return true}var f=g[1];var h=false;for(var c=0,b;b=WH.markup.tags["<text>"].whitelistedWebsites[c];c++){if(f.search(b)==0){h=true}}return h}};WH.markup.tags.achievementpoints={empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){var c='<span class="moneyachievement tip" onmouseover="Listview.funcBox.moneyAchievementOver(event)" onmousemove="WH.Tooltip.cursorUpdate(event)" onmouseout="WH.Tooltip.hide()"'+WH.markup.getCommonAttributes(b)+">"+b.unnamed+"</span>";return c}};WH.markup.tags.anchor={empty:true,ltrim:true,rtrim:true,attr:{unnamed:{req:false,valid:/\S+/}},validate:function(b){if(!b.unnamed&&!b.id){return false}return true},toHtml:function(b){if(!b.unnamed&&b.id){b.unnamed=b.id;b.id=null}return'<a name="'+b.unnamed+'"'+WH.markup.getCommonAttributes(b)+"></a>"}};WH.markup.tags.blip={empty:true,attr:{unnamed:{req:true,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(c){var d="http://blip.tv/play/"+c.unnamed;var g=600;var b=368;var f="";f+='<embed width="'+g+'" height="'+b+'" src="'+d+'" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" wmode="opaque"></embed>';return f}};WH.markup.tags.changelog={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{open:{req:false,valid:/^true$/}},toHtml:function(b){WH.Track.nonInteractiveEvent("Deprecated","Changelog Markup",location.pathname);var c='<a id="revealtoggle-changelog" class="revealtoggle changelog" href="javascript:;" onclick="WH.markup.toggleReveal(\'changelog\');">'+LANG.showchangelog+"</a>";var d="display: none";if(b.open=="true"){c=d=""}return['<div style="margin: 1em 0" id="guide-changelog"><div id="reveal-changelog" style="'+d+'"><h3 class="heading-size-3">Changelog</h3>',"</div>"+c+"</div>"]}};WH.markup.tags.db={empty:true,attr:{unnamed:{req:true,valid:/^(live|ptr|beta|mop|wod|legion|bfa)$/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){WH.markup.setSource(b.unnamed);return""},toText:function(b){WH.markup.setSource(b.unnamed);return""}};WH.markup.tags.feedback={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{mailto:{req:false,valid:/^true$/i}},toHtml:function(b){return'<b><span class="icontiny" style="background-image: url('+g_staticUrl+'/images/icons/email.gif)"><a href="'+(b.mailto?"mailto:feedback@wowhead.com":'javascript:;" onclick="ContactTool.show();')+'">feedback@wowhead.com</a></span></b>'}};WH.markup.tags.forumrules={empty:true,allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){return'<b><span class="icontiny" style="background-image: url('+g_staticUrl+'/images/icons/favicon.gif)"><a href="//www.wowhead.com/forums&topic=2">forum rules</a></span></b>'}};WH.markup.tags.html={empty:false,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{"<text>":1},rawText:true,taglessSkip:true,toHtml:function(b){return[b._contents]}};WH.markup.tags.markupdoc={empty:true,attr:{tag:{req:false,valid:/[a-z0-9]+/i},help:{req:false,valid:/^(admin|staff|premium|user|pending)$/}},allowedClass:WH.markup.CLASS.STAFF,validate:function(b){if(b.tag&&!WH.markup.tags[b.tag]){return false}return true},toHtml:function(d){var f="",c=(d.help?WH.markup.CLASS[d.help.toUpperCase()]:false);if(c){f+=LANG.markup_helpdoc+'<div class="pad3"></div><table class="comment comment-markupdoc"><tr><th>'+LANG.markup_help1+"</th><th>"+LANG.markup_help2+"</th></tr>"}if(d.tag){f=WH.markup.tags.markupdoc.generateTagDocs(d.tag,c)}else{for(var b in WH.markup.tags){if(!c&&f!=""){f+='<div class="pad3"></div>'}f+=WH.markup.tags.markupdoc.generateTagDocs(b,c)}}return f+(c?"</table>":"")},generateTagDocs:function(g,c){var b=WH.markup.tags[g];if(!b){return""}var j="";if(c){if((b.allowedClass&&b.allowedClass>c)||(!b.helpText&&(b.empty||b.allowedParents||b.allowedChildren||!LANG["markup_"+g]))){return""}if(b.helpText&&typeof b.helpText=="function"){j=b.helpText()}else{if(b.helpText&&typeof b.helpText=="string"){j=b.helpText}else{j="["+g+"]"+LANG["markup_"+g].toLowerCase()+"[/"+g+"]"}}return"<tr><td><pre>"+j+"</pre></td><td>"+WH.markup.getHtml(j,{skipReset:true})+"</td></tr>"}j='<div><h3 class="heading-size-3 first">Tag: ['+WH.markup.getEscapedHtml(g)+"]</h3>";j+='<table class="grid">';if(b.attr){j+='<tr><td align="right" width="200">Attributes:</td><td>';for(var d in b.attr){j+='<div style="margin: 5px; display: inline-block"><table><tr><th style="background-color: #242424; font-weight: bolder" colspan="2">';if(d=="unnamed"){j+="Self (["+g+"=???])"}else{j+=d}j+="</th></tr>";j+='<tr><td align="right">Required:</td><td>'+(b.attr[d].req?"Yes":"No")+"</td></tr>";j+='<tr><td align="right">Valid:</td><td>'+(b.attr[d].valid?WH.markup.getEscapedHtml(b.attr[d].valid.toString()):"--")+"</td></tr></table></div>"}j+="</td></tr>"}j+='<tr><td align="right" width="200">Has closing tag:</td><td>'+(b.empty?"No":"Yes")+"</td></tr>";j+='<tr><td align="right">Required group:</td><td>';if(b.allowedClass==WH.markup.CLASS.ADMIN){j+="Administrator"}else{if(b.allowedClass==WH.markup.CLASS.STAFF){j+="Staff"}else{if(b.allowedClass==WH.markup.CLASS.PREMIUM){j+="Premium"}else{if(b.allowedClass&&b.allowedClass!=WH.markup.CLASS.PENDING){j+="Not pending"}else{j+="None"}}}}j+="</td></tr>";if(b.allowedChildren){j+='<tr><td align="right">Allowed children:</td><td>';for(var f in b.allowedChildren){j+=WH.markup.getEscapedHtml(f)+"<br />"}j+="</td></tr>"}if(b.allowedParents){j+='<tr><td align="right">Allowed parents:</td><td>';for(var f in b.allowedParents){j+=WH.markup.getEscapedHtml(f)+"<br />"}j+="</td></tr>"}if(b.presets){j+='<tr><td align="right">Preset values:</td><td><table>';for(var h in b.presets){j+='<tr><td align="right">'+h+"</td><td>"+WH.markup.getEscapedHtml(b.presets[h])+"</td></tr>"}j+="</table></td></tr>"}if(b.trim){j+='<tr><td colspan="2">Trim whitespace</td></tr>'}if(b.ltrim){j+='<tr><td colspan="2">Trim preceding whitespace</td></tr>'}if(b.rtrim){j+='<tr><td colspan="2">Trim following whitespace</td></tr>'}if(b.itrim){j+='<tr><td colspan="2">Trim whitespace around interior content</td></tr>'}if(b.block){j+='<tr><td colspan="2">Automatically remove top padding if not the first item</td></tr>'}j+="</table></div>";return j}};WH.markup.tags.menu={empty:true,trim:true,ltrim:true,rtrim:true,attr:{tab:{req:true,valid:/^[0-9]+$/},path:{req:true,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){var c=b.path.split(",");PageTemplate.set({activeTab:b.tab,breadcrumb:c})}};WH.markup.tags.random={empty:false,itrim:true,allowedClass:WH.markup.CLASS.STAFF,toHtml:function(c){var d=[];for(var b=0;b<c._nodes.length;b++){if(c._nodes[b].name=="randomoption"){d.push(c._nodes[b].attr._contents)}}if(d.length==0){return[c._contents]}return[d[Math.floor(Math.random()*d.length)]]}};WH.markup.tags.randomoption={empty:false,rtrim:true,ltrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{random:1},toHtml:function(b){return["",""]}};WH.markup.tags.script={ltrim:true,rtrim:true,empty:false,attr:{src:{req:false,valid:/^\S+$/}},allowedClass:WH.markup.CLASS.ADMIN,allowedChildren:{"<text>":1},rawText:true,taglessSkip:true,toHtml:function(b){if(b.src){$.getScript(b.src,function(){$.globalEval(b._contents)})}else{$.globalEval(b._contents)}return[""]}};WH.markup.tags.style={ltrim:true,rtrim:true,empty:false,allowedClass:WH.markup.CLASS.ADMIN,allowedChildren:{"<text>":1},rawText:true,taglessSkip:true,toHtml:function(b){WH.addCss(b._contents);return[""]}};WH.markup.tags.visitedpage={empty:false,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toHtml:function(b){$.post("/visited-page",{id:b.unnamed},function(){AchievementCheck()});return""}};WH.markup.tags["--"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,trim:true,ltrim:true,rtrim:true,attr:{unnamed:{req:false}},toHtml:function(b){return""},toText:function(b){return""}};WH.markup.tree=function(){this.nodes=[];this.currentNode=null};WH.markup.tree.prototype={openTag:function(c,d){if(c!="<text>"&&WH.markup.tags[c]&&!WH.markup.tags[c].allowedClass){WH.markup.tags[c].allowedClass=WH.markup.CLASS.PENDING}if(!WH.markup.tags[c]){return false}else{if(WH.markup.tags[c].allowedModes&&WH.markup.tags[c].allowedModes[WH.markup.modes[WH.markup.mode]]==undefined){return false}else{if(WH.markup.tags[c].allowedClass&&WH.markup.tags[c].allowedClass>WH.markup.allow){return false}}}if(WH.markup.mode==WH.markup.MODE.REPLY&&!WH.markup.tags[c].allowInReplies){return false}var f={name:c,attr:d,parent:null,nodes:[]};if(this.currentNode){f.parent=this.currentNode}if(WH.markup.tags[c].allowedParents){if(f.parent!=null){if(WH.markup.tags[c].allowedParents[f.parent.name]===undefined){return false}}else{if(WH.markup.root==undefined||WH.markup.tags[c].allowedParents[WH.markup.root]==undefined){return false}}}if(f.parent&&WH.markup.tags[f.parent.name].allowedChildren&&WH.markup.tags[f.parent.name].allowedChildren[c]==undefined){return false}if(this.currentNode){if(this.currentNode.nodes.length==0&&f.name=="<text>"&&WH.markup.tags[this.currentNode.name].itrim){f.attr=WH.markup.utility.ltrimText(f.attr)}else{if(this.currentNode.nodes.length>0){var g=this.currentNode.nodes.length-1;var b=WH.markup.utility.checkSiblingTrim(this.currentNode.nodes[g],f);this.currentNode.nodes[g]=b[0];f=b[1]}}if(f.name=="<text>"){f.attr._text=WH.markup.getPreFormattedText(f.attr._rawText);if(f.attr._text.length>0){this.currentNode.nodes.push(f)}}else{this.currentNode.nodes.push(f)}}else{if(this.nodes.length>0){var g=this.nodes.length-1;var b=WH.markup.utility.checkSiblingTrim(this.nodes[g],f);this.nodes[g]=b[0];f=b[1]}if(f.name=="<text>"){f.attr._text=WH.markup.getPreFormattedText(f.attr._rawText);if(f.attr._text.length>0){this.nodes.push(f)}}else{this.nodes.push(f)}}if(!WH.markup.tags[c].empty&&!WH.markup.tags[c].post){this.currentNode=f}return true},closeTag:function(c){if(WH.markup.tags[c].empty||WH.markup.tags[c].post){return false}if(!this.currentNode){return false}else{if(this.currentNode.name==c){if(this.currentNode.nodes.length>0){var g=this.currentNode.nodes.length-1;if(WH.markup.tags[this.currentNode.name].itrim&&this.currentNode.nodes[g].name=="<text>"){var f=this.currentNode.nodes[g];f.attr=WH.markup.utility.rtrimText(f.attr);f.attr._text=WH.markup.getPreFormattedText(f.attr._rawText);this.currentNode.nodes[g]=f}}this.currentNode=this.currentNode.parent}else{var d=function(j,h){for(var k=h.length-1;k>=0;--k){if(h[k].name==j){return k}}return -1};var b;if(this.currentNode.parent){b=d(c,this.currentNode.parent.nodes)}else{b=d(c,this.nodes)}if(b==-1){return false}}}return true},toHtml:function(){var f=[];var j={};for(var m in WH.markup.collectTags){j[m]=[]}this.tagless(true);var l=0;var b=function(n,q,w){var y="";for(var r=0;r<n.length;++r){var p=n[r];if(q==0&&r==0&&WH.markup.firstTags[p.name]){p.attr.first=true}else{if(q>0&&r==0&&WH.markup.firstTags[p.parent.name]){p.attr.first=true}}if(r==n.length-1&&WH.markup.firstTags[p.name]){p.attr.last=true}if(WH.markup.excludeTags[p.name]){w[p.name]=(w[p.name]?w[p.name]+1:1)}for(var v in w){for(var z in WH.markup.excludeTags[v]){if(WH.markup.excludeTags[v][z][p.name]){p.attr[z]=false}}}if(WH.markup.collectTags[p.name]){p.offset=l++;j[p.name].push(p)}if(WH.markup.tags[p.name].post){var u="<!--"+Math.random()+"-->";y+=u;f.push([p,u])}else{if(WH.markup.tags[p.name].empty){var s;if(p.parent&&WH.markup.tags[p.parent.name].rawText){s=WH.markup.tags[p.name].toHtml(p.attr,{needsRaw:true})}else{s=WH.markup.tags[p.name].toHtml(p.attr,{noLink:p.parent&&p.parent.name==="url"})}s=WH.markup.convertToHtml(s);if(typeof s=="string"){y+=s}else{if(s!==undefined){if(y==""){y=[]}y.push(s)}}}else{var o=arguments.callee(p.nodes,q+1,w);p.attr._contents=o;p.attr._nodes=p.nodes;var A=WH.markup.tags[p.name].toHtml(p.attr);A=WH.markup.convertToHtml(A);if(A.length==2){y+=A[0]+o+A[1]}else{if(A.length==1){if(typeof A[0]=="string"){y+=A[0]}else{if(y==""){y=[]}y.push(A[0])}}}}}if(w[p.name]){w[p.name]--;if(w[p.name]==0){delete w[p.name]}}}return y};var k=b(this.nodes,0,[]);for(var g=0;g<f.length;++g){var d=f[g][0];var c=f[g][1];var h=WH.markup.tags[d.name].postHtml(d.attr,j);if(typeof h=="string"){k=k.replace(c,h)}}return k},tagless:function(d){var b=function(f){var l="";for(var h=0;h<f.length;++h){var k=f[h];var j=arguments.callee(k.nodes);if(d){k.attr._textContents=j}else{k.attr._contents=j}if(k.name=="<text>"){var g=WH.markup.tags[k.name].toHtml(k.attr,{noLink:true,noNbsp:true});l+=WH.markup.convertToHtml(g)}else{if(WH.markup.tags[k.name].toText){l+=WH.markup.tags[k.name].toText(k.attr)}}if(!WH.markup.tags[k.name].taglessSkip){l+=j}}return l};if(d){b(this.nodes)}else{var c=b(this.nodes);c=c.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"');return c}},imageUploadIds:function(){var c=[];var b=function(d){for(var f=0;f<d.length;++f){var g=d[f];if(g.name=="img"&&g.attr.upload){c.push(g.attr.upload)}arguments.callee(g.nodes)}};b(this.nodes);return c}};WH.markup.utility=new function(){this.ltrimText=function(b){b._rawText=b._rawText.ltrim();return b};this.rtrimText=function(b){b._rawText=b._rawText.rtrim();return b};this.checkSiblingTrim=function(c,b){if(b.name=="<text>"&&(WH.markup.tags[c.name].rtrim||WH.markup.tags[c.name].trim)){b.attr=WH.markup.utility.ltrimText(b.attr)}else{if(c.name=="<text>"&&(WH.markup.tags[b.name].ltrim||WH.markup.tags[b.name].trim)){c.attr=WH.markup.utility.rtrimText(c.attr)}}return[c,b]}};WH.markup.init();var MENU_IDX_ID=0;var MENU_IDX_NAME=1;var MENU_IDX_URL=2;var MENU_IDX_SUB=3;var MENU_IDX_OPT=4;var Menu=new function(){var aa={sortableMenus:[mn_artifactWeaponCalc,mn_classes,mn_currencies,mn_database,mn_events_holidays,mn_events_recurring,mn_guides_specs,mn_pvpTalentCalc,mn_icons,mn_itemSets,mn_npcs,mn_objects,mn_outfits,mn_pets,mn_races,mn_resources,mn_skills,mn_sounds,mn_talentCalc,mn_transmog_classes,mn_transmogsets],sortableMenusAndSubmenus:[mn_quests],sortableSubmenus:[{menu:mn_battlepets,paths:[["*"]]},{menu:mn_classHalls,paths:[[23],[30],[7]]},{menu:mn_forums,paths:[[-2]]},{menu:mn_garrisons,paths:[[4,"*"]]},{menu:mn_guides,paths:[[1]]},{menu:mn_items,paths:[[4,1],[4,2],[4,3],[4,4],[1],[0],[16],[7],[6],[9],[-2,0,"*"],[-2,1,"*"],[-2,2],[-2,16],[-2,4],[-2,5],[-2,6],[-2,7],[-3]]},{menu:mn_npcs,paths:[["*"]]},{menu:mn_spells,paths:[[7],[-17],[-18],[-13],[-16],[-12],[-2],[50],[52],[54],[-3],[-3,"*"],[-7],[11],[9]]},{menu:mn_zones,paths:[[9],["classHalls"]]}]};var ax=this;var V=null;var T=[];var Y=null;var z=null;var aw=null;var B=null;var aH=null;ax.getMenu=function(){return mn_path};ax.addTouch=function(aT,aU,aS){if(!aS){aS=$.noop}var aR=$(aT);aR.data("menu",aU);aR.click(P)};function P(aR,aT){var aS=$(this);if(aS.hasClass("active")||aS.hasClass("touch-menu-active")){aF.call(this)}else{ab.call(this,aR,aT)}if(aR){aR.preventDefault();aR.stopPropagation()}}function s(aT,aS,aR,aU){aG(aT,aS,aR,aU);if(aS){aS.preventDefault();aS.stopPropagation()}}ax.add=function(aT,aU,aS){if(!aS){aS=$.noop}var aR=$(aT);if(aS.onShow){aU.onShow=aS.onShow}if(aS.onHide){aU.onHide=aS.onHide}aR.data("menu",aU);if(Platform.isTouch()){aR.click(P);return}if(aS.showAtCursor){if(aS.leftAndRightClick){aT.oncontextmenu=WH.rf;aR.click(function(aV){if(aV.which!=2){R.call(this,aV);return false}}).mouseup(function(aV){aj.call(this,R,aV)})}else{if(aS.rightClick){aT.oncontextmenu=WH.rf;aR.mouseup(function(aV){aj.call(this,R,aV)})}else{aR.click(R)}}}else{if(aS.showAtElement){if(aS.leftAndRightClick){aT.oncontextmenu=WH.rf;aR.click(function(aV){if(aV.which!=2){ap.call(this,aV);return false}}).mouseup(function(aV){aj.call(this,ap,aV)}).mouseleave(d)}else{if(aS.rightClick){aT.oncontextmenu=WH.rf;aR.mouseup(function(aV){aj.call(this,ap,aV)}).mouseleave(d)}else{aR.click(function(aV){if(aV.which!=2){if($(this).hasClass("open")){return}else{ap.call(this,aV);return false}}}).mouseleave(d)}}}else{aR.mouseover(ap).mouseout(d)}}};ax.remove=function(aR){$(aR).data("menu",null).unbind("click",R).unbind("mouseover",ap).unbind("mouseout",d)};ax.show=function(aT,aS){if(Platform.isTouch()){P.call(aS,null,aT);return}var aR=$(aS);aH=aR.get(0);B=aT;m(aT,aR)};ax.showAtCursor=function(aS,aR){if(Platform.isTouch()){s(aS,aR);return}B=aS;J(aS,aR.pageX,aR.pageY)};ax.showAtXY=function(aS,aR,aT){if(Platform.isTouch()){s(aS,null,aR,aT);return}B=aS;J(aS,aR,aT)};ax.hide=function(aR){if(Platform.isTouch()){ag();return}d(null,aR);M()};ax.addButtons=function(aT,aU,aS){var aV=$(aT);if(!aV.length){return}var aR=$('<span class="menu-buttons"></span>');$.each(aU,function(aW,aY){if(E(aY)){return}var aZ=$("<a></a>");var aX=$("<span></span>",{text:aY[MENU_IDX_NAME]}).appendTo(aZ);ax.linkifyItem(aY,aZ);aZ.data("parentMenu",aU).data("menuItem",aY);if(aY[MENU_IDX_OPT]&&aY[MENU_IDX_OPT].rel){aZ.attr("rel",aY[MENU_IDX_OPT].rel)}if(G(aY)){aX.addClass("hassubmenu");if(Platform.isTouch()){ax.addTouch(aZ.get(0),aY[MENU_IDX_SUB])}else{if(aS&&aS.menusOnClick){ax.add(aZ,aY[MENU_IDX_SUB],{showAtElement:true})}else{ax.add(aZ,aY[MENU_IDX_SUB])}}}aR.append(aZ)});aV.append(aR)};ax.linkifyItem=function(aT,aU){var aS=ax.getItemOpt(aT);if(typeof aT[MENU_IDX_OPT]=="object"&&aT[MENU_IDX_OPT].className){aU.addClass(aT[MENU_IDX_OPT].className)}if(typeof aT[MENU_IDX_OPT]=="object"&&aT[MENU_IDX_OPT].onMouseOver){aU.mouseover(aT[MENU_IDX_OPT].onMouseOver)}if(typeof aT[MENU_IDX_OPT]=="object"&&aT[MENU_IDX_OPT].onMouseOut){aU.mouseout(aT[MENU_IDX_OPT].onMouseOut)}if(!aT[MENU_IDX_URL]){aU.attr("href","javascript:;");aU.addClass("unlinked");if(aS.tooltip){aU.attr("href",aS.tooltip);aU.click(WH.rf)}return false}if(typeof aT[MENU_IDX_URL]=="function"){aU.attr("href","javascript:;");aU.click(ak);if(aS.tooltip){aU.attr("href",aS.tooltip);aU.click((function(aV){aV();return false}).bind(null,aT[MENU_IDX_URL]))}else{aU.click(aT[MENU_IDX_URL])}if(aS.rel){aU.attr("rel",aS.rel)}}else{var aR=ax.getItemUrl(aT);aU.attr("href",aR);if(aS.newWindow||WH.isExternalUrl(aR)){aU.attr("target","_blank")}if(aS.rel){aU.attr("rel",aS.rel)}}return true};ax.updateItem=function(aR){var aU=aR.$a;if(!aU){return}var aS=ax.getItemOpt(aR);aU.removeClass("checked tinyicon icon");aU.css("background-image","");if(aR.checked){aU.addClass("checked fonticon");aU.prepend('<i class="fa fa-check fa-size-s fa-color-white fonticon-icon"/>')}else{var aV=false;var aT=function(a4){switch(typeof a4){case"string":return a4;break;case"function":var a3=a4(aR);if(typeof a3=="string"){return a3}break}return false};if(!aV&&aS.armory){var aW=aT(aS.armory);if(aW){aV=true;aU.addClass("armoryicon");aU.css("background-image","url("+aW+")")}}if(!aV&&aS.fontIcon){var a1=aT(aS.fontIcon);if(a1){aV=true;aU.addClass("fonticon");aU.prepend('<i class="fa fa-'+a1+' fonticon-icon"/>')}}if(!aV&&aS.tinyIcon){var aX=aT(aS.tinyIcon);if(aX){aV=true;aU.addClass("tinyicon");aU.css("background-image","url("+WH.getTinyIconUrl(aX)+")")}}if(!aV&&aS.icon){var a0=aT(aS.icon);if(a0){aV=true;aU.addClass("icon");aU.css("background-image","url("+a0+")")}}if(!aV&&aS.socketColor){var a2=aT(aS.socketColor);if(a2&&g_file_gems[a2]){aV=true;aU.addClass("socket-"+g_file_gems[a2])}}}if(aS.np){aU.attr("rel","np")}var aZ=(aS["class"]||aS.className);if(aZ){aU.addClass(aZ)}if(aS.attributes){for(var aY in aS.attributes){if(aS.attributes.hasOwnProperty(aY)){aU.attr(aY,aS.attributes[aY])}}}};ax.prepareForZul=function(aR,aS){return I(aR,aS)};ax.hasMenu=function(aS){var aR=$(aS);return aR.data("menu")!=null};ax.modifyUrl=function(aT,aU,aS){var aR={params:aU,opt:aS};y(aT,function(aV){aV.modifyUrl=aR});PageTemplate.updateBreadcrumb()};ax.fixUrls=function(aT,aR,aS){aS=aS||{};aS.hash=(aS.hash?"#"+aS.hash:"");l(aT,aR,aS,0)};ax.customizeUrl=function(aV,aR){for(var aS=0,aT;aT=aV[aS];aS++){if(typeof aT[MENU_IDX_URL]!="string"){continue}var aU=aT[MENU_IDX_URL].replace(/^\//,"");if(aR[aU]){aT[MENU_IDX_URL]="/"+aR[aU]}}};ax.sort=function(aS,aR){if(ar(aS)){W(aS,aR)}else{w(aS,aR)}};ax.sortSubmenus=function(aS,aR){$.each(aR,function(aT,aY){var aX;if(aY[aY.length-1]==="*"){if(aY.length>1){var aU=ax.findItem(aS,aY.slice(0,aY.length-1));aX=aU[MENU_IDX_SUB]}else{aX=aS}if(aX instanceof Array){for(var aV=0,aW;aW=aX[aV];aV++){if(aW[MENU_IDX_SUB] instanceof Array){ax.sort(aW[MENU_IDX_SUB])}}}else{WH.error("Could not find submenus to sort.",aS,aR)}}else{aX=ax.findItem(aS,aY);if(aX&&aX[MENU_IDX_SUB]){ax.sort(aX[MENU_IDX_SUB])}}})};ax.implode=function(aU,aS){if(!aS){aS=$.noop}var aR=[];var aT;if(aS.createHeadinglessGroup){aT=[];aR.push([0,"",null,aT])}$.each(aU,function(aV,aW){if(E(aW)){aT=[];aR.push([aW[MENU_IDX_ID],aW[MENU_IDX_NAME],aW[MENU_IDX_URL],aT,aW[MENU_IDX_OPT]])}else{if(aT){aT.push(aW)}else{aR.push(aW)}}});return aR};ax.findItem=function(aS,aR){return ax.getFullPath(aS,aR).pop()};ax.getFullPath=function(aY,aX){var aS=[];var aW=function(a3,a2){var a4=v(aY,a3);if(a4!==-1){var a0=[];var a1=aY[a4];if(a1[MENU_IDX_OPT]&&a1[MENU_IDX_OPT].breadcrumbParent){var aZ=aW(a1[MENU_IDX_OPT].breadcrumbParent,true);if(aZ){a0.push(aZ.pop())}}a1.parentMenu=aY;if(!a2){aY=a1[MENU_IDX_SUB]}a0.push(a1);return a0}return null};for(var aU=0;aU<aX.length;++aU){var aT=aW(aX[aU]);if(aT){for(var aR=0,aV;aV=aT[aR];aR++){aS.push(aV)}}}return aS};ax.getItemUrl=function(aS){var aR=aS[MENU_IDX_URL];if(!aR){return null}if(aS.modifyUrl){aR=WH.modifyUrl(aR,aS.modifyUrl.params,aS.modifyUrl.opt,aS)}return aR};ax.getItemOpt=function(aR){if(!aR[MENU_IDX_OPT]){aR[MENU_IDX_OPT]={}}return aR[MENU_IDX_OPT]};this.isHeading=function(aR){return E(aR)};ax.removeItemById=function(aR,aT){var aS=v(aR,aT);if(aS!=-1){aR.splice(aS,1)}};ax.map=function(aT,aY,a2){aY.className+=" menu-map";for(var aV=0,a1;a1=aT[aV];aV++){if(a1[MENU_IDX_OPT]&&a1[MENU_IDX_OPT].menuMapHide){continue}WH.ae(aY,WH.getMajorHeading(typeof a1[MENU_IDX_URL]=="string"?'<a href="'+ax.getItemUrl(a1)+'">'+a1[MENU_IDX_NAME]+"</a>":a1[MENU_IDX_NAME],2));if(typeof a1[MENU_IDX_SUB]=="object"){var a0=WH.ce("div",{className:"menu-map-section"});var aS=null;var aZ=WH.ce("div",{className:"menu-map-submenu-group"});for(var aU=0,aX;aX=a1[MENU_IDX_SUB][aU];aU++){if(aX[MENU_IDX_OPT]&&aX[MENU_IDX_OPT].menuMapHide){continue}if(aX[MENU_IDX_ID]==null){WH.ae(a0,aZ);aZ=WH.ce("div",{className:"menu-map-submenu-group"});aS=aX[MENU_IDX_NAME];WH.ae(a0,WH.getMajorHeading(typeof aX[MENU_IDX_URL]=="string"?'<a href="'+ax.getItemUrl(aX)+'">'+aX[MENU_IDX_NAME]+"</a>":aX[MENU_IDX_NAME],3));continue}if(a2&&a2.noEmptySubmenus&&!aX[MENU_IDX_SUB]){continue}var aW=WH.getMajorHeading(typeof aX[MENU_IDX_URL]=="string"?'<a href="'+ax.getItemUrl(aX)+'">'+aX[MENU_IDX_NAME]+"</a>":aX[MENU_IDX_NAME],4);var aR=WH.ce("div",{className:"menu-map-submenu"},aW);if(aX[MENU_IDX_NAME]==aS){aR.setAttribute("data-duplicate-heading","true")}if(typeof aX[MENU_IDX_SUB]=="object"){ax.addButtons(aR,aX[MENU_IDX_SUB],{menusOnClick:true})}WH.ae(aZ,aR)}WH.ae(a0,aZ);WH.ae(aY,a0)}}};this.sortGlobalMenus=function(){if(Locale.getId()===LOCALE_ENUS){return}for(var aU=0,aV;aV=aa.sortableMenus[aU];aU++){Menu.sort(aV)}for(var aT=0;aV=aa.sortableMenusAndSubmenus[aT];aT++){Menu.sort(aV,true)}for(var aS=0,aR;aR=aa.sortableSubmenus[aS];aS++){Menu.sortSubmenus(aR.menu,aR.paths)}mn_transmogsets.sort(function(aX,aW){if(aX[MENU_IDX_ID]===1020){return -1}else{if(aW[MENU_IDX_ID]===1020){return 1}}return 0})};var Q=25;var aQ=333;var t=520;var n=4;var b=6;var N=6;var au=2;var ad=26;var o=false;var U;var X;var h={};var S={};var an={};var aM={};var ae=0;function af(){if(o){return}o=true;var aS=$('<div class="menu"><a href="#"><span>ohai</span></a></div>').css({left:"-1000px",top:"-1000px"}).appendTo(document.body);var aR=aS.children("a").outerHeight();aS.remove();if(aR&&!isNaN(aR)&&aR!=ad){ad=aR}}function m(aS,aR){if(X){X.removeClass("open")}X=aR;X.addClass("open");c(aS)}function ak(){if(Platform.isTouch()){ag();return}if(X){X.removeClass("open");X=null}aq(0)}function J(aS,aR,aT){clearTimeout(U);c(aS,aR,aT)}function c(aS,aR,aT){aL(0);ai(aS,0,aR,aT);aq(1)}function ai(aS,aW,a1,a0){af();if(typeof aS=="function"){aS=aS()}at(aS);var aX=C(aS);var aT=j(aX,aW);var aY=am(aW,aT);aY.append(aT.menu);var aU=!aD(aW);h[aW]=aY;for(var aV=0,aR;aR=h[aV];aV++){aR.attr("data-reverse-tier",aW-aV+1)}var aZ=aB(aY,aW,a1,a0);aY.css({left:aZ.x+"px",top:aZ.y+"px"});var a2=WH.createRect(aZ.x,aZ.y,aY.width(),aY.height());WAS.intersect(a2,true);aN(aY,aU)}function am(aT,aS){var aR;if(an[aT]){aR=an[aT];aR.children().detach();aR.css({left:0,top:0});aR.attr("class","menu");if(aS.menuType){aR.addClass("menu-type-"+aS.menuType)}return aR}aR=$('<div class="menu"></div>').data("depth",aT).mouseover(aO.bind(null,aT)).mouseleave(H).delegate("a","mouseenter",{depth:aT},aE).delegate("a","click",r);if(aS.menuType){aR.addClass("menu-type-"+aS.menuType)}aR.appendTo(document.body);an[aT]=aR;return aR}function C(aU){var aS=p(aU);if(aM[aS]){return aM[aS]}var aT;var aR=[];$.each(aU,function(aW,aX){if(!F(aX)){return}var aY=g(aX);if(E(aX)){aT=aY;return}if(aT){aR.push(aT);aT=null}aR.push(aY)});var aV=$(aR);aM[aU]=aV;return aV}function g(aV){ac(aV);var aW=$("<a></a>");aV.$a=aW;aW.data("menuItem",aV);var aS=aV[MENU_IDX_NAME];if(aV[MENU_IDX_OPT]&&aV[MENU_IDX_OPT].generateText){aS=aV[MENU_IDX_OPT].generateText(aV)}if(E(aV)){aW.addClass("separator");aW.text(aS)}ax.linkifyItem(aV,aW);ax.updateItem(aV);if(aV[MENU_IDX_OPT]){if(aV[MENU_IDX_OPT].column){aW.data("column",aV[MENU_IDX_OPT].column)}if(aV[MENU_IDX_OPT].noSoftColumns){aW.data("noSoftColumns",aV[MENU_IDX_OPT].noSoftColumns)}if(aV[MENU_IDX_OPT].menuType){aW.data("menuType",aV[MENU_IDX_OPT].menuType)}if(aV[MENU_IDX_OPT].modifyTooltip){aW.get(0)._fixTooltip=aV[MENU_IDX_OPT].modifyTooltip}}if(E(aV)){return aW}var aR;var aU=aS,aT,aX,aY;if((typeof aU=="object"&&aU!=null)&&("tagName" in aU)&&(aU.tagName.toLowerCase()=="span")){while(aT=aU.getElementsByTagName("span")[0]){aX=document.createElement("div");aX.className=aT.className;$.extend(aX.style,aT.style);aX.style.display="inline";while(aY=aT.firstChild){aY.parentNode.removeChild(aY);aX.appendChild(aY)}aT.parentNode.insertBefore(aX,aT);aT.parentNode.removeChild(aT)}aR=$(aU).clone()}else{aR=$("<span></span>");aR.text(aS)}aR.appendTo(aW);if(G(aV)){aR.addClass("hassubmenu")}return aW}function j(a9,bh){var a1=a9.length;var aW=$(window).height()-(au*2)-N;var a2=Math.floor(Math.max(0,aW)/ad);var bi=Math.floor(t/ad);var be=a1>0&&!a9[0].data("noSoftColumns");var a5=false;if(bi<a2&&be){a2=bi;a5=true}var aS=[];var a4=null;var a7=-1;if(a1>0){a4=a9[0].data("menuType");if(a9[0].data("column")){a9.each(function(){var bj=$(this).data("column");if(bj){a7=bj-1}if(!aS[a7]){aS[a7]=$("<td/>")}aS[a7].append(this)})}else{if(a2<a1){var aT=Math.min(n,Math.ceil(a1/a2));var aV=Math.ceil(a1/aT);var bd=0;var a6=a1;var a8=0;while(a6>0){a7++;var a3=Math.min(a6,aV);var aZ=bd;var aY=aZ+a3;if(a5){if(a8!=0){aY+=a8;a3+=a8;a8=0}if(a9[aY-1]&&a9[aY-1].hasClass("separator")){aY--;a3--;a8=1}if(a9[aY]&&!a9[aY].hasClass("separator")){if(a9[aY-2]&&a9[aY-1]&&a9[aY]&&a9[aY-2].hasClass("separator")&&!a9[aY-1].hasClass("separator")){if(a9[aY+1]&&a9[aY+2]&&!a9[aY+1].hasClass("separator")&&a9[aY+2].hasClass("separator")){aY+=2;a3+=2}else{aY-=2;a3-=2;a8=2}}if(a9[aY]&&a9[aY+1].hasClass("separator")){aY+=1;a3+=1}if(a9[aY+1]&&a9[aY+2]&&!a9[aY+1].hasClass("separator")&&a9[aY+2].hasClass("separator")){aY+=2;a3+=2}}}a9.slice(aZ,aY).each(function(){if(!aS[a7]){aS[a7]=$("<td/>")}aS[a7].append(this)});bd+=a3;a6-=a3}}}}if(aS.length){var a0=WH.ce("div",{className:"menu-outer"});var bf=WH.ce("div",{className:"menu-inner"});var bc=WH.ce("table",{className:"menu-columns"});var aR=WH.ce("tbody");var bg=$("<tr/>");WH.ae(a0,bf);WH.ae(bf,bc);WH.ae(bc,aR);for(var ba=0,aX;aX=aS[ba];ba++){bg.append(aX)}bg.appendTo(aR);return{columns:aS.length,menuType:a4,menu:a0}}var aU=$('<div class="menu-outer"></div>');var bb=$('<div class="menu-inner"></div>');a9.each(function(){bb.append(this)});aU.append(bb);return{menuType:a4,menu:aU}}function aB(aS,aT,aR,aU){if(aT==0){return u(aS,aT,aR,aU)}return ah(aS,aT)}function u(a0,aX,a2,a1){var aZ=WH.getViewport();var aY=a0.width();var aT=a0.height();var aV=aY+b;var aR=aT+N;var aS=(a2!=null&&a1!=null);if(aS){if(a1+aR>aZ.b){a1=Math.max(aZ.t,aZ.b-aR)}}else{var aU=X;var aW=aU.offset();a2=aW.left;a1=aW.top+aU.outerHeight();if(a1+aR>aZ.b&&aW.top>=aR){a1=aW.top-aR}}if(a2+aV>aZ.r){a2=Math.max(aZ.l,aZ.r-aV)}return{x:a2,y:a1}}function ah(aZ,aW){var aY=WH.getViewport();var aX=aZ.width();var aS=aZ.height();var aU=aX+b;var aR=aS+N;var aT=S[aW-1];var aV=aT.offset();var a1=false;var a2=aV.left+aT.outerWidth()-5;var a0=aV.top-2;if(a2+aU>aY.r){a1=true}if(a1){a2=Math.max(aY.l,aV.left-aX)}if(a0+aR>aY.b){a0=Math.max(aY.t,aY.b-aR)}return{x:a2,y:a0}}function aN(aR,aS){if(aS){aR.css({opacity:"0"}).show().animate({opacity:"1"},"fast",null,aI)}else{aR.show()}}function aI(aR){$(this).css("opacity","")}function aq(aR){while(h[aR]){h[aR].stop().hide();h[aR]=null;++aR}if(!h[0]){WAS.restoreHidden();M()}}function aL(aR){while(S[aR]){S[aR].removeClass("open");S[aR]=null;++aR}}function aD(aR){return h[aR||0]!=null}function k(aR){return aR[MENU_IDX_ID]}function E(aR){return aR[MENU_IDX_ID]==null||(aR[MENU_IDX_OPT]&&aR[MENU_IDX_OPT].heading)}function ar(aR){return WH.inArray(aR,true,E)!=-1}function G(aR){return aR[MENU_IDX_SUB]!=null}function v(aR,aS){return WH.inArray(aR,aS,k)}function aA(aS){var aR=ax.getItemOpt(aS);if(aR&&aR.requiredAccess&&!User.hasPermissions(aR.requiredAccess)){return false}return true}function F(aR){if(!(aR instanceof Array)){return false}if(!aA(aR)){return false}if(aR[MENU_IDX_OPT]&&aR[MENU_IDX_OPT].hide){return false}if(G(aR)){if(!Z(aR[MENU_IDX_SUB])){return false}}return true}function Z(aR){return WH.inArray(aR,true,K)!=-1}function K(aR){return !E(aR)&&aA(aR)}function p(aR){if(aR.uniqueId==null){aR.uniqueId=ae++}return aR.uniqueId}function L(aS,aR){$.each(aS,function(aT,aU){y(aU,aR)})}function y(aR,aS){aS(aR);if(G(aR)){L(aR[MENU_IDX_SUB],aS)}}function l(aU,aR,aS,aT){$.each(aU,function(aW,aX){if(aX===undefined){return}if(E(aX)){return}if(aS.uniqueUrls&&aS.uniqueUrls[aX[MENU_IDX_ID]]){aX[MENU_IDX_URL]=aS.uniqueUrls[aX[MENU_IDX_ID]]}else{if(aX[MENU_IDX_URL]==null){if(aS.idReplacements&&aS.idReplacements[aX[MENU_IDX_ID]]){aX[MENU_IDX_URL]=aR+aS.idReplacements[aX[MENU_IDX_ID]]+aS.hash}else{aX[MENU_IDX_URL]=aR+aX[MENU_IDX_ID]+aS.hash}}}if(G(aX)){var aV=true;var aY=aR;if(aS.useSimpleIds){aV=false}else{if(aS.useSimpleIdsAfter!=null&&aT>=aS.useSimpleIdsAfter){aV=false}else{if(aS.useLastUrl){aV=false;aY=aX[MENU_IDX_URL]+((aX[MENU_IDX_URL].indexOf("=")>=0)?".":"=")}}}if(aV){aY+=aX[MENU_IDX_ID]+"."}l(aX[MENU_IDX_SUB],aY,aS,aT+1)}})}function w(aU,aS){if(!(aU instanceof Array)){WH.error("Trying to do a menu sort on a non-array.",typeof aU,aU);return}aU.sort(function(aW,aV){return WH.stringCompare(aW[MENU_IDX_NAME],aV[MENU_IDX_NAME])});if(aS){for(var aR=0,aT;aT=aU[aR];aR++){if(aT[MENU_IDX_SUB] instanceof Array){Menu.sort(aT[MENU_IDX_SUB],aS)}}}}function W(aT,aR){var aS=ax.implode(aT,{createHeadinglessGroup:true});$.each(aS,function(aU,aV){w(aV[MENU_IDX_SUB],aR)});aP(aT,aS)}function aP(aS,aR){aS.splice(0,aS.length);$.each(aR,function(aT,aU){if(aU[MENU_IDX_NAME]){aS.push([aU[MENU_IDX_ID],aU[MENU_IDX_NAME],aU[MENU_IDX_URL],undefined,aU[MENU_IDX_OPT]])}$.each(aU[MENU_IDX_SUB],function(aV,aW){aS.push(aW)})})}function ac(aS){var aR=ax.getItemOpt(aS);if(typeof aR.regenerateMenuItem==="function"){WH.cO(aS,aR.regenerateMenuItem(aS))}if(aR.checkedUrl&&location.href.match(aR.checkedUrl)){aS.checked=true}if(typeof aR.checkedFunc=="function"){aS.checked=aR.checkedFunc(aS)}}function at(aR){if(aR.onBeforeShow){aR.onBeforeShow(aR)}$.each(aR,function(aS,aU){var aT=ax.getItemOpt(aU);if(aT.onBeforeShow){aT.onBeforeShow(aU)}})}function ap(aS){clearTimeout(U);var aR=$(this);var aT=aR.data("menu");aH=this;B=aT;if(!aD()){U=setTimeout((function(aV,aU){m.call(null,aV,aU);aC(this,aV,aS)}).bind(this,aT,aR),Q);return}m(aT,aR);aC(this,aT,aS)}function d(aS,aR){clearTimeout(U);if(aD()){if(aR){ak()}else{U=setTimeout(ak,aQ)}}}function R(aS){clearTimeout(U);var aR=$(this);var aT=aR.data("menu");aH=this;B=aT;ax.showAtCursor(aR.data("menu"),aS);aC(this,aT,aS)}function aj(aR,aS){aS=WH.normalizeEvent(aS);if(aS._button==3||aS.shiftKey||aS.ctrlKey){aR.call(this,aS)}}function ab(aT,aV){var aR=$(this),aU=aR.parent(),aS=aR.data("menuItem");if(!aV){aV=aR.data("menu")}B=aV;aH=this;if(aw){aw.removeClass("touch-menu-active");aw=null}if(aU[0].tagName=="DT"){ag();aR.addClass("active");V=null;T=[aS[MENU_IDX_ID]];av(aV)}else{aw=aR;aw.addClass("touch-menu-active");V=aV;T=aS?[aS[MENU_IDX_ID]]:[null];av(aV,{atElement:aR})}aC(this,aV,aT)}function aG(aT,aS,aR,aU){B=aT;aH=null;if(aw){aw.removeClass("touch-menu-active");aw=null}V=aT;av(aT,{atPosition:aS?[aS.pageX,aS.pageY+5]:[aR,aU]});aC(null,aT,aS,aR,aU)}function av(aT,a6){if(!a6){a6={}}var aU;if(a6.atElement||a6.atPosition){var aY=false;if(!Y){Y=$("<div/>",{"class":"floating-touch-menu-container",css:{display:"none"}});Y.appendTo("body")}else{var a3=Y.offset();aY=a3.top}Y.empty();aU=$("<div/>",{"class":"floating-touch-menu"});z=$("<div/>",{"class":"floating-touch-menu-arrow"});aU.append(z).appendTo(Y);var a5=$("<a/>",{"class":"floating-touch-menu-closer"});a5.click(ag);Y.append(a5);var a0=a6.atElement?a6.atElement.offset():{left:a6.atPosition[0],top:a6.atPosition[1]};var a2=a0.top;if(a6.atElement){a2+=a6.atElement.outerHeight()}var aZ=parseInt(a2+7);var aS=aZ!=aY;Y.css({display:"block",top:(aS?aZ-10:aZ)+"px"});var aW=a0.left;if(a6.atElement){aW+=(a6.atElement.outerWidth()/2)}z.css({display:"block",left:parseInt(aW-10)+"px"});if(aS){Y.css({opacity:"0"});setTimeout(function(){Y.animate({opacity:"1",top:"+=10px"})},0)}}else{Y=null;z=null;aU=$("#header-nav-subnav");if(!aU.length){aU=$("<div/>",{"class":"header-nav-subnav",id:"header-nav-subnav"});aU.insertAfter("#header-nav")}aU.empty()}var aV=false;if((!a6.atElement&&!a6.atPosition)||(a6.atElement&&a6.atElement.data("menuItem"))){aV=true}if(aV){if(Y){Y.addClass("has-breadcrumb")}var aX=WH.ce("ul");aX.className="touch-menu-breadcrumb";if(a6.atElement){var a4=$(a6.atElement);if(a4.data("parentMenu")){aX.menu=$(a6.atElement).data("parentMenu")}else{if(a4.html()){aX.menu=[[0,a4.html(),null,aT]]}}}O(aX,T)}else{if(Y){Y.removeClass("has-breadcrumb")}}if(Y){if(a6.atElement&&a6.atElement.parents("div.breadcrumb")){Y.addClass("from-breadcrumb")}else{Y.removeClass("from-breadcrumb")}}var aR=WH.ce("div");aR.className="touch-menu-items";aR.style.left="0%";ay(aT,{target:aR});var a1=WH.ce("div");a1.className="touch-menu-items-wrapper";WH.ae(a1,aR);if(aV){aU.append(aX)}aU.append(a1).attr("class","touch-menu")}function ay(aW,aU){if(aU.animate){var aV=$(".touch-menu-items");$(aU.animate).parent().addClass("chosen");aV.addClass("chosen");setTimeout(function(){var aZ=WH.ce("div");aZ.className="touch-menu-items";var a1=(T.length-2)*-10+2;aZ.style.left=a1+"%";f(aZ,aW);var a2=$(aZ);var a0=aV.last();a0.after(a2);var a3=a0.height();aV.each(function(){var a4=$(this);if(a4.data("height")){a4.css({height:"1px"}).animate({left:"-=12%"})}else{a4.data("height",a4.height()).css("height",a4.height()+"px").animate({left:"-=12%",height:"1px"})}});var aY=a2.height();a2.css("height",a3+"px").animate({left:"-=12%",height:aY+"px"})},100)}else{if(aU.reverse){var aX=$(".touch-menu-items");var aR=$(aX.get(aU.targetPathIndex));var aT=aU.reverse*12;var aS=aX.last();aR.css({height:aS.height()+"px"}).animate({left:"+="+aT+"%",height:aR.data("height")+"px"},{complete:function(){$(this).css("height","")}});aS.css({height:"1px"});aX.not(aR).animate({left:"+="+aT+"%"},{complete:function(){aR.removeClass("chosen");$(".chosen",aR).removeClass("chosen");aR.nextAll().stop().remove()}})}else{if(aU.target){$(aU.target).empty();f(aU.target,aW)}}}}function O(aW,a0,a1){var aS=aW.menu||Menu.getMenu();var aY,aT,aV,aU;if(a1){for(aV in T){aY=T[aV];for(aU in aS){aT=aS[aU];if(aT[MENU_IDX_ID]==aY){aS=aT[MENU_IDX_SUB];break}}}T=T.concat(a0)}var aR,aZ,aX;for(aV in a0){aY=a0[aV];aR=null;for(aU in aS){aT=aS[aU];if(aT[MENU_IDX_ID]==aY){aR=aT;break}}if(!aR){break}aZ=WH.ce("li");aX=WH.ce("a");aX.href="javascript:;";ax.linkifyItem(aR,$(aX));aX.innerHTML=aR[MENU_IDX_NAME];aX.onclick=al;WH.ae(aZ,aX);WH.ae(aW,aZ)}}function al(){var aV=$(this).parent();if(aV.is(":last-child")){return true}var aT=aV.index();var aU=Menu.getMenu();for(var aS=0;aS<=aT;aS++){for(var aR in aU){if(aU[aR][MENU_IDX_ID]==T[aS]){aU=aU[aR][MENU_IDX_SUB];break}}}aV.nextAll().remove();ay(aU,{reverse:T.length-aT-1,targetPathIndex:aT});T=T.slice(0,aT+1);return false}function f(aU,aV){var aS=null,aT;for(var aR in aV){aT=aV[aR];if(!F(aT)){continue}if(E(aT)){A(aU,aT);aS=ao(aU);continue}if(!aS){aS=ao(aU)}WH.ae(aS,D(aT))}}function ao(aS){var aR=WH.ce("ul");WH.ae(aS,aR);return aR}function A(aV,aS){var aR=WH.ce("a");var aT=$(aR);aS.$a=aT;aT.data("menuItem",aS);ax.linkifyItem(aS,aT);ax.updateItem(aS);aT.text(aS[MENU_IDX_NAME]);var aU=WH.getMajorHeading(aT.get(0),2);WH.ae(aV,aU)}function D(aR){g(aR);ac(aR);var aT=$("<a></a>");aR.$a=aT;aT.data("menuItem",aR);var aU=ax.linkifyItem(aR,aT);ax.updateItem(aR);var aW;var aZ=aK(aR),a0,aV,aS;if((typeof aZ=="object")&&("tagName" in aZ)&&(aZ.tagName.toLowerCase()=="span")){while(a0=aZ.getElementsByTagName("span")[0]){aV=document.createElement("div");aV.className=a0.className;$.extend(aV.style,a0.style);aV.style.display="inline";while(aS=a0.firstChild){aS.parentNode.removeChild(aS);aV.appendChild(aS)}a0.parentNode.insertBefore(aV,a0);a0.parentNode.removeChild(a0)}aW=$(aZ)}else{aW=$("<span></span>");aW.text(aK(aR))}aW.appendTo(aT);var aY=WH.ce("li");aT.appendTo(aY);if(G(aR)){if(aU){aT.addClass("has-sub");aW.addClass("has-sub");var aX=WH.ce("a");aX.className="view-sub";aX.href="javascript:;";aX.onclick=q;$(aX).data("menuItem",aR);WH.ae(aY,aX)}else{aT.addClass("only-sub").data("menuItem",aR).click(q);aW.addClass("only-sub")}}return aY}function aK(aR){return aR[MENU_IDX_OPT].shortname||aR[MENU_IDX_NAME]}function q(){var aR=$(this).data("menuItem");var aS=$(".touch-menu-breadcrumb");if(aS.length){O(aS.get(0),[aR[MENU_IDX_ID]],true)}else{T.push(null)}ay(aR[MENU_IDX_SUB],{animate:this})}function aF(){ag()}function ag(){$("#header-nav dt > a.active").removeClass("active");$("#header-nav-subnav").removeClass("touch-menu").empty();if(Y){Y.empty().css({display:"none"})}V=null;T=[];z=null;if(aw){aw.removeClass("touch-menu-active")}aw=null;M()}function aO(aU,aT){clearTimeout(U);var aS=!aT.target.className;if(!aS){var aR=aT.target.className.split(" ");aS=aR.indexOf("open")==-1&&aR.indexOf("hassubmenu")==-1&&aR.indexOf("fonticon-icon")==-1}if(aS){az(aU)}}function H(aR){clearTimeout(U);U=setTimeout(ak,aQ)}function aE(aS){clearTimeout(U);var aT=$(this);var aV=aS.data.depth;aL(aV);var aR=aT.data("menuItem");var aU=aV;if(aR&&G(aR)){aT.addClass("open");S[aV]=aT;ai(aR[MENU_IDX_SUB],aV+1);++aU}aq(aU+1)}function az(aR){clearTimeout(U);aL(aR);aq(aR+1)}function r(aT){var aU=$(this);var aS=aU.data("menuItem");if(!aS){return}var aR=ax.getItemOpt(aS);if(aR.onClick){aR.onClick()}}function M(){if(B&&B.onHide){B.onHide.call(aH,B)}B=null;aH=null}function aC(aS,aT,aR){if(aT.onShow){aT.onShow.call(aS,aT,aR)}}function I(aW,aX){if(!(aW instanceof Array)){return null}var aT=[];var aV;for(var aR=0,aS;aS=aW[aR];aR++){var aU=aJ(aS,aX);if(!aU){continue}if(aS[MENU_IDX_ID]==null){aV=aU;continue}if(aV){aT.push(aV);aV=null}aT.push(aU)}return aT}function aJ(aT,aV){var aS=aT[MENU_IDX_OPT]||{};if(aS.zulHide){return null}if(aT[MENU_IDX_OPT]&&aT[MENU_IDX_OPT].requiredAccess&&!User.hasPermissions(aT[MENU_IDX_OPT].requiredAccess)){return null}var aU={type:"link"};var aR="";if(aT[MENU_IDX_ID]==null){aU.heading=true}aU.text=aT[MENU_IDX_NAME];if(typeof aU.text!="string"){aU.text=""}aU.name="null";if(aT[MENU_IDX_OPT]&&aT[MENU_IDX_OPT].hasOwnProperty("zulName")){aU.name=aT[MENU_IDX_OPT].zulName}if(aS.zulNoHref){}else{if(typeof aS.zulHref=="function"){aU.href=aS.zulHref}else{switch(typeof aT[MENU_IDX_URL]){case"string":aU.href=Menu.getItemUrl(aT);break;case"function":aU.click=aT[MENU_IDX_URL];break}}}if(aT[MENU_IDX_OPT]){if(aS.zulGetMobileMenu){if(!aU.menu){aU.menu={}}aU.menu.mobile=aS.zulGetMobileMenu}if(aS.fontIcon){aU.fontIcon=aS.fontIcon}if(aS.icon){aU.imageIcon={universal:aS.icon,enlargeForMobile:true}}if(aS.tinyIcon){aU.imageIcon={universal:WH.getTinyIconUrl(aS.tinyIcon),enlargeForMobile:true}}if(aS.armory){aU.imageIcon={universal:aS.armory,enlargeForMobile:true};aR=(aR?" ":"")+"zul-bar-icon-armory"}if(typeof aU.imageIcon=="object"&&typeof aU.fontIcon!="undefined"){delete aU.fontIcon}if(aT.checked){aU.checked=true}else{if(aS.checkedUrl&&location.href.match(aS.checkedUrl)){aU.checked=true}else{if(typeof aS.checkedFunc=="function"){aU.checked=aS.checkedFunc(aT)}else{if(aS.checked){aU.checked=true}}}}}if(aT[MENU_IDX_SUB]){if(!aU.menu){aU.menu={}}aU.menu.mobile=I(aT[MENU_IDX_SUB])}if(aR){aU.className=aR}if(aV){aU.condition=aV}else{if(aS.zulCondition){aU.condition=aS.zulCondition}}return aU}$(window).keyup((function(aR,aS){if(aS.keyCode==27){aR()}}).bind(null,ak))};Menu.customizeUrl(mn_events_holidays,mn_events_urls);Menu.customizeUrl(mn_events_recurring,mn_events_urls);Menu.fixUrls(mn_bluetracker,"/bluetracker=");Menu.fixUrls(mn_forums,"/forums?board=",{useSimpleIds:true});Menu.fixUrls(mn_garrisons,null,{useLastUrl:true});Menu.findItem(mn_lists,[101])[MENU_IDX_URL]=li_createList.bind(null,1,null,null,null,null);Menu.findItem(mn_lists,[102])[MENU_IDX_URL]=li_createList.bind(null,2);var ModelViewer=new function(){this.validSlots=[1,3,4,5,6,7,8,9,10,13,14,15,16,17,19,20,21,22,23,25,26];this.slotMap={1:1,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,13:21,14:14,15:22,16:16,17:21,19:19,20:20,21:21,22:22,23:22,25:21,26:21};var c,G,O=[],u,b,f,I,B,E,q,A,n,m,o,K,s,k,y,L,H=false,N=[{id:10,name:g_chr_races[10],model:"bloodelf"},{id:34,name:g_chr_races[34],model:"darkirondwarf"},{id:11,name:g_chr_races[11],model:"draenei"},{id:3,name:g_chr_races[3],model:"dwarf"},{id:7,name:g_chr_races[7],model:"gnome"},{id:9,name:g_chr_races[9],model:"goblin"},{id:28,name:g_chr_races[28],model:"highmountaintauren"},{id:1,name:g_chr_races[1],model:"human"},{id:32,name:g_chr_races[32],model:"kultiran"},{id:30,name:g_chr_races[30],model:"lightforgeddraenei"},{id:36,name:g_chr_races[36],model:"magharorc"},{id:27,name:g_chr_races[27],model:"nightborne"},{id:4,name:g_chr_races[4],model:"nightelf"},{id:24,name:g_chr_races[24],model:"pandaren"},{id:2,name:g_chr_races[2],model:"orc"},{id:6,name:g_chr_races[6],model:"tauren"},{id:33,name:g_chr_races[33],model:"thinhuman"},{id:8,name:g_chr_races[8],model:"troll"},{id:5,name:g_chr_races[5],model:"scourge"},{id:29,name:g_chr_races[29],model:"voidelf"},{id:35,name:g_chr_races[35],model:"vulpera"},{id:22,name:g_chr_races[22],model:"worgen"},{id:31,name:g_chr_races[31],model:"zandalaritroll"}],M=[{id:0,name:LANG.male,model:"male"},{id:1,name:LANG.female,model:"female"}];var D=[{name:LANG.pd_hd,val:"true"},{name:LANG.pd_sd,val:"false"}];function C(){}function p(){var P,Q;if(n.is(":visible")){P=(n[0].selectedIndex>=0?n.val():"")}else{P=(m[0].selectedIndex>=0?m.val():"")}Q=(o[0].selectedIndex>=0?o.val():0);return{r:P,s:Q}}function v(P,Q){return(!isNaN(P)&&P>0&&WH.inArray(N,P,function(R){return R.id})!=-1&&!isNaN(Q)&&Q>=0&&Q<=1)}function z(){var Q=600;if(window.innerWidth&&window.innerWidth-20<Q){Q=window.innerWidth-20}q.css("width",Q+"px");if(B){B.destroy()}var Y={type:ZamModelViewer.WOW,contentPath:ModelViewer.getContentPath(),container:q,aspect:Q/q.height(),background:"background.png",models:{type:G,id:c}};if(y.hasOwnProperty("characterData")){var S=p();if(y.characterData.race==S.r&&y.characterData.gender==S.s){Y.sk=y.characterData.skincolor;Y.ha=y.characterData.hairstyle;Y.hc=y.characterData.haircolor;Y.fa=y.characterData.facetype;Y.fh=y.characterData.features;Y.fc=y.characterData.haircolor;Y.ep=y.characterData.blindfolds;Y.ho=y.characterData.hornstyle;Y.ta=y.characterData.tattoos;Y.cls=y.characterData.charClass}}var R=ZamModelViewer.Wow.Types;if((G==R.NPC||G==R.HUMANOIDNPC||G==R.CHARACTER)&&O.length){var V=[];O=[].concat.apply([],O);for(var T=0;T<O.length;T+=2){V.push([O[T],O[T+1]])}Y.items=V}if(u){Y.link=u}if(b){Y.label=b}if(K){Y.hd=(K.val()=="true")}var X=p(),U=X.r,W=X.s;if(U==10||(U==1&&W==0)){Y.hd=true}if(ModelViewer.canTakeScreenshots){Y.transparent=true;delete Y.background;q.css({backgroundImage:'url("'+g_staticUrl+'/modelviewer/background.png")'})}WH.debug("Creating ZamModelViewer with these options:",Y);this.viewer=B=new ZamModelViewer(Y);if(!I.noPound){var P="#modelviewer";var X=$("#dsgndslgn464d");if(X.length==0){switch(I.type){case 1:P+=":1:"+I.displayId+":"+(I.humanoid|0);break;case 2:P+=":2:"+I.displayId;break;case 3:P+=":3:"+I.displayId+":"+(I.slot|0);break;case 4:P+=":4:"+O.join(";");break;case 101:case 110:P+=":101:"+O.join(";");break}}if(U&&W){P+=":"+U+"+"+W}else{P+=":"}if(I.extraPound!=null){P+=":"+I.extraPound}H=false;location.replace(WH.rtrim(P,":"))}}this.grabScreenshot=function(T,Q){if(!ModelViewer.canTakeScreenshots){return}if(!Q){Q="screenshot";if(g_pageInfo){if(g_pageInfo.name){Q=g_pageInfo.name}else{if(g_pageInfo.type&&g_types[g_pageInfo.type]){Q=g_types[g_pageInfo.type];if(g_pageInfo.typeId){Q+=" "+g_pageInfo.typeId}}}}}var R=$(T.renderer.canvas)[0];var P="fullscreenchange";var S;var U=function(V){if(V){document.removeEventListener(P,S,false)}window.requestAnimationFrame(function(){T.renderer.makeDataURL=["image/png",1];window.requestAnimationFrame(function(){var W=T.renderer.screenshotDataURL;var X=WH.ce("a");X.download=Q+".png";X.href=W;X.style.display="none";WH.ae(document.body,X);X.click();if(document.exitFullscreen){document.exitFullscreen()}else{if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}}}})})};if(R.requestFullscreen){document.addEventListener(P,S=U.bind(this,true),false);R.requestFullscreen()}else{if(R.webkitRequestFullscreen){P="webkit"+P;document.addEventListener(P,S=U.bind(this,true),false);R.webkitRequestFullscreen()}else{if(R.mozRequestFullScreen){P="moz"+P;document.addEventListener(P,S=U.bind(this,true),false);R.mozRequestFullScreen()}else{U(false)}}}};function t(){var T=p(),Q=T.r,R=T.s;if(!Q){if(!o.is(":visible")){return}o.hide();c=O[1];switch(I.slot){case 1:G=2;break;case 3:G=4;break;default:G=1}}else{if(!o.is(":visible")){o.show()}var T=function(U){return U.id};var S=WH.inArray(N,Q,T);var P=WH.inArray(M,R,T);if(S!=-1&&P!=-1){c=N[S].model+M[P].model;G=16}WH.setWowheadCookie("temp_default_3dmodel",Q+","+R)}j();C();z()}function l(){var P=$("select",A);if(P.val()&&B&&B.method("isLoaded")){var Q=P.val();WH.debug("Setting model viewer animation to:",Q);B.method("setAnimation",Q)}}function d(){if(H){return}var T=$("select",A);T.empty();if(!B||!B.method("isLoaded")){T.append($("<option/>",{text:LANG.tooltip_loading,val:0}));return}var P={};var R=B.method("getNumAnimations");for(var S=0;S<R;++S){var Q=B.method("getAnimation",S);if(Q&&Q!="EmoteUseStanding"){P[Q]=1}}var U=[];for(var Q in P){U.push(Q)}U.sort();for(var S=0;S<U.length;++S){T.append($("<option/>",{text:U[S],val:U[S]}))}H=true}function g(P,T,R,S){WH.arrayWalk(P,function(U){U.checked=false;if(U&&U[MENU_IDX_SUB]){WH.arrayWalk(U[MENU_IDX_SUB],function(V){V.checked=false})}});T.checked=true;R.checked=true;O[1]=S;c=S;var Q=p();if(Q.r){t()}else{C();z()}}function h(S,R,Q,P,T){c=Q;f=R[MENU_IDX_ID];$(P).text(T);C();z()}function j(){var S=[];switch(y.type){case 4:case 101:case 110:if(y.itemData){for(var P in y.itemData){S.push({itemId:y.itemData[P][0],itemBonus:y.itemData[P][1],slot:y.itemData[P][2]})}}break}if(S.length>0){if(y.characterData){if(!y.characterData["class"]&&y.characterData.charClass){y.characterData["class"]=y.characterData.charClass}var R=$.extend({},y.characterData);R.date=(new Date()).getTime();S.push(R)}else{var Q=p();Q.date=(new Date()).getTime();S.push(Q)}WH.localStorage.set("lastViewedModel",JSON.stringify(S))}}function r(Y,S){var Z=-1,aa=-1,T,V;if(S.race!=null&&S.sex!=null){Z=S.race;aa=S.sex;E.hide();Y=0}else{E.show()}if(S.hasOwnProperty("characterData")&&S.characterData.hasOwnProperty("race")){Z=S.characterData.race}if(S.hasOwnProperty("characterData")&&S.characterData.hasOwnProperty("gender")){aa=S.characterData.gender}if(Z==-1&&aa==-1){if(location.hash){var X=location.hash.match(/modelviewer:.*?([0-9]+)\+([0-9]+)/);if(X!=null){if(v(X[1],X[2])){Z=X[1];aa=X[2];o.show()}}}}if(Y){T=n;V=1;n.show();n[0].selectedIndex=-1;m.hide();if(aa==-1){o.hide()}}else{if(Z==-1&&aa==-1){var ac=1,W=0;if(g_user&&g_user.cookies.default_3dmodel){var R=g_user.cookies.default_3dmodel.split(",");if(R.length==2){ac=R[0];W=R[1]-1}}else{var Q=WH.getWowheadCookie("temp_default_3dmodel");if(Q){var R=Q.split(",");if(R.length==2){ac=R[0];W=R[1]}}}if(v(ac,W)){Z=ac;aa=W}else{Z=1;aa=0}}T=m;V=0;n.hide();m.show();o.show()}if(aa!=-1){o[0].selectedIndex=aa}if(Z!=-1&&aa!=-1){var ab=function(ad){return ad.id};var P=WH.inArray(N,Z,ab);var U=WH.inArray(M,aa,ab);if(P!=-1&&U!=-1){c=N[P].model+M[U].model;G=16;P+=V;T[0].selectedIndex=P;o[0].selectedIndex=U}}}function J(){if(!I.noPound){if(!I.fromTag&&s&&s.indexOf("modelviewer")==-1){WH.setHash(s)}else{WH.clearHash()}}if(B){B.destroy()}if(I.onHide){I.onHide()}}function F(aq,X,ai){var az,ax;y=ai;Lightbox.setSize(620,452);if(X){aq=$(aq);aq.addClass("has-lightbox-caption modelviewer");var Y=$("<div/>",{"class":"modelviewer-screen"});var R=$("<div/>",{"class":"lightbox-content modelviewer-modelbg"});R.append(Y);aq.append(R);q=Y;A=$("<div/>",{"class":"modelviewer-animation"});var au=$("<var/>",{text:LANG.animation});A.append(au);var ay=$("<select/>",{change:l,mouseenter:d});ay.append($("<option/>",{text:Platform.isTouch()?LANG.dialog_taptoload:LANG.dialog_mouseovertoload}));A.append(ay);aq.append(A);var az=$("<a/>",{"class":"dialog-question fa fa-question",href:"/help=modelviewer",target:"_blank",text:LANG.help}),ax=$("<a/>",{"class":"dialog-x fa fa-times",href:"javascript:;",click:Lightbox.hide,text:LANG.close});aq.append(ax);aq.append(az);if(ModelViewer.canTakeScreenshots){aq.append($("<a/>",{"class":"dialog-question fa fa-camera",href:"javascript:;",click:function(){ModelViewer.grabScreenshot(B)},text:LANG.tab_screenshots}))}if(ai.itemData){var al=$("<div/>",{"class":"modelviewer-slots"}).appendTo(Y);var ae=$("<div/>",{"class":"modelviewer-slots-left"}).appendTo(al);var ag=$("<div/>",{"class":"modelviewer-slots-right"}).appendTo(al);var V=$("<div/>",{"class":"modelviewer-slots-bottom"}).appendTo(al);var ar=$("<a/>",{"class":"btn btn-site btn-small modelviewer-slots-link fa fa-male",href:"/dressing-room",html:" "+LANG.mv_dressingroom}).appendTo(al);var ad={};for(var aD=0,Z;Z=g_character_slots_data[aD];++aD){ad[Z.id]=Icon.create("inventoryslot_"+Z.name,1,null,"javascript:;");ad[Z.id].className+=" modelviewer-slots-noicon";if(Z.noModel){ad[Z.id].style.visibility="hidden"}$(ad[Z.id]).appendTo(aD<8?ae:(aD<16?ag:V))}for(var aC=0,ap;ap=ai.itemData[aC];aC++){if(ad[ap[2]]){Icon.setTexture(ad[ap[2]],1,g_items.getIcon(ap[0],ap[1]).toLowerCase());Icon.getLink(ad[ap[2]]).href="/item="+ap[0]+(ap[1]&&ap[1]!=-1?"&bonus="+ap[1]:"");ad[ap[2]].className=ad[ap[2]].className.replace(/ *modelviewer-slots-noicon/,"")}}}E=$("<div/>",{"class":"modelviewer-model"});var aw=function(aI,aH){return WH.stringCompare(aI.name,aH.name)};N.sort(aw);n=$("<select/>",{change:t});m=$("<select/>",{change:t});o=$("<select/>",{change:t});K=$("<select/>",{change:t});n.append($("<option/>"));for(var aE=0,ah=N.length;aE<ah;++aE){var aA=$("<option/>",{val:N[aE].id,text:N[aE].name});n.append(aA)}for(var aE=0,ah=N.length;aE<ah;++aE){var aA=$("<option/>",{val:N[aE].id,text:N[aE].name});m.append(aA)}for(var aE=0,ah=M.length;aE<ah;++aE){var aA=$("<option/>",{val:M[aE].id,text:M[aE].name});o.append(aA)}o.css("display","inline");o.hide();for(var aE=0,ah=D.length;aE<ah;++aE){var aA=$("<option/>",{val:D[aE].val,text:D[aE].name});K.append(aA)}var ak=y.artifact&&!$.isEmptyObject(y.artifact);var T=$("<a>"+LANG.artifactappearances+"</a>");T.get(0).style.marginLeft="5px";if(ak){var am=g_items[y.typeId];var ab=[];for(var aE in y.artifact){var ao=y.artifact[aE];if(!$.isEmptyObject(ao)){var aa=[aE,ao["1"]?ao["1"].setname:""];var at=[];var P=false;for(var aD in ao){var S=ao[aD].mod;if(am.appearances&&am.appearances[S]&&am.appearances[S][0]){var U=ao[aD].swatchrgb;var ac=WH.ce("span");ac.className="artifact-appearance";ac.style.backgroundColor="rgba("+WH.sprintf("$1,$2,$3,1",(U>>16)&255,(U>>8)&255,U&255)+")";var an=[aD,ac];an[MENU_IDX_URL]=g.bind(this,ab,aa,an,am.appearances[S][0]);at.push(an);if(am.appearances[S][0]==ai.displayId){at[at.length-1].checked=true;P=true}}}aa[MENU_IDX_SUB]=at;aa.checked=P;ab.push(aa)}}Menu.add(T,ab)}var aB=y.specVariants&&!$.isEmptyObject(y.specVariants);var Q=$("<a>",{text:LANG.specializationvariants});Q.get(0).style.marginLeft="5px";if(aB){var ab=[];for(var aE in y.specVariants){var W=y.specVariants[aE];var aj=WH.ce("span");aj.className="spec-variant";aj.innerHTML=W.specName;var aG=[aE,aj];aG[MENU_IDX_URL]=h.bind(this,ab,aG,W.modelId,Q,W.specName);aG[MENU_IDX_OPT]={tinyIcon:g_staticUrl+"/images/wow/icons/tiny/"+g_file_specs[W.specId]+".gif",checkedFunc:function(aH){return aH[MENU_IDX_ID]==f}};if(W.modelId==ai.displayId){$(Q).text(W.specName);f=aE}ab.push(aG)}Menu.add(Q,ab)}E.append(n);E.append(m);E.append(o);E.append(K);if(ak){E.append("<br>");E.append(T)}aq.append(E);if(aB){aq.append("<br>");aq.append(Q)}var ac=$("<div/>",{"class":"modelviewer-instructions"});ac.append(LANG.mv_controls);aq.append(ac);var aF=$("<div/>",{id:"modelviewer-msg","class":"sub",css:{display:"none","margin-top":"-6px",color:"#ccc","font-size":"13px"}});aq.append(aF);if(WH.isSet("g_user")&&g_user.id){$.ajax({url:"/website-achievement-explored",data:{trigger:"modelviewer"},success:function(){AchievementCheck()},type:"POST"})}}switch(ai.type){case 1:E.hide();if(ai.humanoid){G=32}else{G=8}if(ai.equipList){O=ai.equipList}c=ai.displayId;break;case 2:E.hide();G=64;c=ai.displayId;break;case 3:case 4:case 101:case 110:if(ai.type==3){O=[ai.slot,ai.displayId]}else{O=ai.equipList}if(O.length>2||WH.inArray([4,5,6,7,8,9,10,16,19,20],O[0])!=-1||((ai.type==101||ai.type==110)&&O.length>1)){r(0,ai)}else{switch(O[0]){case 1:G=2;break;case 3:G=4;break;default:G=1}c=O[1];r(1,ai)}break}C();setTimeout(z,1);var av=$("#modelviewer-msg");if(ai.message&&av.length>0){av.html(ai.message);av.show()}else{av.hide()}if(ai.link){u=ai.link}if(ai.label){b=ai.label}var af="";if(ai.fromTag){af+="Custom ";switch(ai.type){case 1:af+="NPC "+ai.displayId+(ai.humanoid?" humanoid":"");break;case 2:af+="Object "+ai.displayId;break;case 3:af+="Item "+ai.displayId+" Slot "+(ai.slot|0);break;case 4:af+="Item set "+O.join(".");break;case 101:af+="Transmog set "+O.join(".");break;case 110:af+="Outfit "+O.join(".");break}}else{switch(ai.type){case 1:af+="NPC "+(ai.typeId?ai.typeId:" DisplayID "+ai.displayId);break;case 2:af+="Object "+ai.typeId;break;case 3:af+="Item "+ai.typeId;break;case 4:af+="Item set "+O.join(".");break;case 101:af+="Transmog set "+O.join(".");break;case 110:af+="Outfit "+O.join(".");break}}WH.Track.interactiveEvent("Model Viewer","Show",WH.urlize(af));s=location.hash;j()}this.checkPound=function(){if(location.hash&&location.hash.indexOf("#modelviewer")==0){var T=location.hash.split(":");if(T.length>=3){T.shift();var R=parseInt(T.shift());var Q={type:R};switch(R){case 1:Q.displayId=parseInt(T.shift());var P=parseInt(T.shift());if(P==1){Q.humanoid=1}break;case 2:Q.displayId=parseInt(T.shift());break;case 3:Q.displayId=parseInt(T.shift());Q.slot=parseInt(T.shift());break;case 4:var S=T.shift();Q.equipList=S.split(";");break}if(Q.displayId||Q.equipList){ModelViewer.show(Q)}if(L!=null){if(T.length>0&&T[T.length-1]){L(T[T.length-1])}}}else{if(L!=null&&T.length==2&&T[1]){L(T[1])}else{var U=$("#dsgndslgn464d");if(U.length>0){U.click()}}}}};this.addExtraPound=function(P){L=P};this.show=function(P){I=P;Lightbox.show("modelviewer",{onShow:F,onHide:J},P)};this.getContentPath=function(){return""+(WH.isDev()?"https://wow.zamimg.com":g_staticUrl)+this.getStaticBase()+"/"};this.getStaticBase=function(){return"/modelviewer"};var w=(g_user.roles&U_GROUP_STAFF)>0;Object.defineProperties(this,{canTakeScreenshots:{get:function(){return w}}});$(document).ready(this.checkPound)};var PageTemplate=new function(){var k=this;var B={requestedSocialScripts:{},userMenu:null};k.init=function(){l();v();r();n();z();G=true};k.initUserMenus=function(){M();F();w();K();$("#zul-bar-user .hassubmenu").append('<span class="fa fa-chevron-down"></span>')};k.initSidebar=function(){WH.setupDynamicFixedElement("sidebar","#sidebar")};k.get=function(P){return p[P]};k.set=function(Q){if(!Q){return}var P={};$.extend(P,p);$.extend(p,Q);p.activeTab=parseInt(p.activeTab);if(G){if(p.activeTab!=P.activeTab){N()}if(p.breadcrumb!=P.breadcrumb){c()}}};k.getBreadcrumb=function(){return h};k.updateBreadcrumb=function(){c()};k.expandBreadcrumb=function(){return C()};k.locateBreadcrumb=function(){var S=Menu.getFullPath(Menu.getMenu(),p.breadcrumb);if(!S.length){return}if((!g_pageInfo)||(!g_pageInfo.hasOwnProperty("typeId"))){return}var T=new RegExp("\\b"+g_types[g_pageInfo.type]+"="+g_pageInfo.typeId+"\\b");var Q=WH.cO(p.breadcrumb);Q.pop();var P=false;var R=function(V){Q.push(V[0]);if(V[3]&&V[3].length){for(var U=0;U<V[3].length&&!P;U++){R(V[3][U])}}else{P|=(V.length>2)&&T.test(V[2])}if(!P){Q.pop()}};R(S.pop());if(P){p.breadcrumb=Q;c()}};k.getUserMenu=function(){return b()};k.getListsSubmenu=function(){return I()};k.collapseInteriorSidebar=function(){$(".interior-sidebar-wrapper").addClass("collapsed")};k.expandInteriorSidebar=function(){$(".interior-sidebar-wrapper").removeClass("collapsed")};var G=false;var p={};var h;var o;var L=[];function u(){D();t()}function D(){h=$('<div class="breadcrumb"></div>')}function t(){if(WH.Browser.ie6){$(document.documentElement).addClass("ie6 ie67 ie678")}if(WH.Browser.ie7){$(document.documentElement).addClass("ie7 ie67 ie678")}if(WH.Browser.ie8){$(document.documentElement).addClass("ie8 ie678")}}function F(){Favorites.refreshMenu()}function w(){var P=$(".zul-bar-user-item-user");if(!P.length){return}P.attr("href","/user="+g_user.name);Menu.add(P,b());P.addClass("hassubmenu")}function b(){if(B.userMenu){return B.userMenu}var T=[];var P=["user-page",LANG.userpage,"/user="+g_user.name,null,{checkedUrl:new RegExp("user="+g_user.name+"$","i"),fontIcon:"user"}];T.push(P);var S=["settings",LANG.settings,"/account",null,{fontIcon:"cog",checkedUrl:/account(?!=premium)/i}];T.push(S);if(g_user.premium){T.push(["premium",LANG.premiumsettings,"/account=premium",null,{checkedUrl:/account=premium/i,fontIcon:"star"}])}else{T.push(["premium-upgrade",LANG.premiumsettings,"/premium",null,{className:"premium-upgrade",checkedUrl:/premium/i,fontIcon:"star"}])}var Q=["reputation",LANG.reputation,"/reputation",null,{fontIcon:"trophy"}];T.push(Q);if(!Locale.getId()){var R=["guides",LANG.myguides,"/my-guides",null,{fontIcon:"book"}];T.push(R)}H(T);g(T);T.push(["sign-out",LANG.signout,"/account=signout"]);B.userMenu=T;return T}function M(){if(!g_user.lists||!g_user.lists.length){return}var Q=[];E(Q);Q=Q[MENU_IDX_SUB];if(!Q.length){return}var P=WH.ge("zul-bar-user-item-avatar");if(!P){return}Menu.add(P,Q)}function H(Q){if(!g_user.lists||!g_user.lists.length){return}var P=O();Q.push(P)}function O(){var Q={onBeforeShow:E,zulGetMobileMenu:f,zulHref:function(U,T,R,S){return R?false:"/user="+g_user.name},fontIcon:"users"};for(var P=0;P<g_user.lists.length;P++){if(g_user.lists[P].thumbnail){delete Q.icon;Q.armory="//render-"+g_user.lists[P].region.toLowerCase()+".worldofwarcraft.com/character/"+g_user.lists[P].thumbnail}}return["lists",LANG.li_myprofiles,"/user="+g_user.name+"#lists",null,Q]}function f(){return Menu.prepareForZul(I())}function E(P){P[MENU_IDX_SUB]=I()}function I(){if(!g_user.lists){return null}var P=[];var ac=[["refresh",LANG.refreshcharacterlist,"/account=battlenet",null,{icon:g_staticUrl+"/images/icons/battlenet.png"}]];var U=[],Z=[],V=[],S=[];g_user.lists.sort(function(af,ae){return WH.stringCompare(af.realm,ae.realm)||WH.stringCompare(af.name,ae.name)});var T=false;$.each(g_user.lists,function(ae,af){if(af.mode==1){if(af.pinned>0){U.push(li_generateListMenuItem(af,true))}if(T&&(T!=af.realm)){if(Z.length){Z.unshift([undefined,T])}Z.push([undefined,af.realm])}T=af.realm;Z.push(li_generateListMenuItem(af))}else{S.push(li_generateListMenuItem(af))}});var W=0,Q,Y,ab;var R=function(af,ag){var ae=0+ag;return function(ai){if(ai){return}for(var ah=0;ah<af.length;ah++){if(af[ah][0]==ae){af.splice(ah--,1)}}}};if(g_user.battlenetChars&&g_user.battlenetChars.length){g_user.battlenetChars.sort(function(af,ae){return WH.stringCompare(af.region,ae.region)||WH.stringCompare(af.realm,ae.realm)||WH.stringCompare(af.name,ae.name)});T=false;for(var ad=0;ad<g_user.battlenetChars.length;ad++){Y=g_user.battlenetChars[ad];if(Y.level<10){continue}Q=WH.urlize(Y.region+" "+Y.realm+" "+Y.name,true);ab=false;for(var aa=0;aa<g_user.lists.length;aa++){if(g_user.lists[aa].url==Q){ab=true;break}}if(ab){continue}if(T&&(T!=Y.realm)){if(V.length){V.unshift([undefined,T])}V.push([undefined,Y.realm])}T=Y.realm;W--;V.push([W,Y.name,"/list/"+Q+"?private",null,{className:"listmanager-mode1"}]);WH.BattleNet.CharacterExists(Y.region,Y.realm,Y.name,R(V,W))}}var X=0;if(Z.length){X++}if(V.length){X++}if(S.length){X++}if((Z.length+V.length+S.length<=12)||(X<=1)){if(Z.length){P.push([undefined,LANG.tab_profiles]);P.push.apply(P,Z)}if(V.length){P.push([undefined,LANG.tc_import]);P.push.apply(P,ac.concat(V))}if(S.length){P.push([undefined,LANG.li_customlists]);P.push.apply(P,S)}}else{if(U.length){P.push([undefined,LANG.zul_pinnedprofiles]);P.push.apply(P,U);P.push([undefined,LANG.other])}if(Z.length){P.push([1,LANG.tab_profiles,null,Z])}if(V.length){P.push([1,LANG.tc_import,null,ac.concat(V)])}if(S.length){P.push([1,LANG.li_customlists,null,S])}}return P}function g(P){if(!g_user.bagscans||!g_user.bagscans.length){return}var Q=["bagscans",LANG.mybagscans,"/bagscanner",null,{onBeforeShow:q,zulGetMobileMenu:J,zulHref:function(U,T,R,S){return R?false:"/bagscanner"},tinyIcon:"inv_misc_bag_08"}];P.push(Q)}function J(){return Menu.prepareForZul(j())}function q(P){P[MENU_IDX_SUB]=j()}function j(){var R=[[0,LANG.mybagscans,"/bagscanner",null,{hide:true,zulCondition:function(V,U,T){return T}}]];var S=15;var Q=[];if(g_user.bagscans.length>S){g_user.bagscans.sort(function(U,T){return WH.stringCompare(T.when,U.when)})}for(var P=0;P<S&&P<g_user.bagscans.length;P++){Q.push(g_user.bagscans[P])}Q.sort(function(U,T){return WH.stringCompare(U.name,T.name)});$.each(Q,function(T,U){R.push([U.id,U.name,"/bagscanner="+U.id])});return R}function K(){var Q="//";var T=location.pathname+location.search+location.hash;var P=Locale.getId();var S=[];var R;$.each(Locale.getAllByName(),function(V,U){var W=[U.id,U.description,Q+U.domain+T];if(U.id==P){W.checked=true;R=U}S.push(W)});d($(".zul-bar-user-item-locale"),S,R);$(document).ready(function(){d($("#footer-links-language"),S,R)})}function d(Q,R,P){Q.attr("href","javascript:;");Q.text(P.description);Q.addClass("hassubmenu");Menu.add(Q,R)}function l(){$("#header-expandsite").attr("href","javascript:;").click(PageTemplate.expandSite);$(".data-env-links a[title]").each(function(){WH.Tooltip.simple(this,'<span class="no-wrap">'+this.title+"</span>","q2");this.title=""})}function m(){if(h.is(":empty")){return}var P=location.href.split("/");if(P.length){P=P[3].replace(/^\?(.*)/,"$1").split(/[\?&#=]/);if(P.length&&P[0]=="news"){return}}PageTemplate.addShareButtons($("#main-precontents"));m=function(){}}k.getShareUrl=function(P,Q){switch(P){case"twitter":return"https://twitter.com/intent/tweet?text=%20"+Q+"%20via%20@Wowhead";case"facebook":return"https://www.facebook.com/sharer/sharer.php?u="+Q;case"reddit":return"//www.reddit.com/submit?url="+Q+"&r=wow";case"google":return"https://plus.google.com/share?url="+Q;default:return""}};k.addShareButtons=function(Q,Z){if(!(Q instanceof jQuery)){Q=$(Q)}if(typeof Z!="object"){Z={}}if(!(Z.types instanceof Array)){Z.types=["twitter","facebook","google","reddit"]}if(!Z.mode){Z.mode="links"}var T=$("<div/>",{"class":"share-buttons"}).prependTo(Q);var X=(""+(Z.title||document.title)).split(LANG.hyphen).shift();var P=""+(Z.url||location.href);for(var R=0,U;U=Z.types[R];R++){if(["buttons","links","icons"].indexOf(Z.mode)>-1){var W=PageTemplate.getShareUrl(U,P);var V=U;var Y=LANG.share;switch(U){case"twitter":Y=LANG.tweet;break;case"facebook":V="facebook-official";break;case"reddit":V="reddit-alien";Y=LANG.reddit;break;case"google":V="google-plus";break}if(Z.mode=="icons"){V+=" fa-fw";Y=null}var S=$("<a/>",{"class":(Z.mode=="buttons"?"btn btn-primary btn-small ":"")+"fa fa-"+V,href:W,rel:"np",text:Y,target:"_blank"});T.append(S);if(Z.mode=="icons"){WH.Tooltip.simple(S.get(0),WH.sprintf(LANG.shareon,U=="google"?LANG.googleplus:LANG[U]),"q",true)}}else{if(Z.mode=="native-buttons"){switch(U){case"twitter":T.append($('<a href="https://twitter.com/share" class="twitter-share-button btn btn-primary btn-small fa fa-twitter" data-url="'+P+'" data-text="'+X+'" data-via="Wowhead" data-lang="'+Locale.getName().replace(/(..)(..)/,"$1-$2")+'" target="_blank">'+LANG.tweet+"</a>"));break;case"facebook":T.append($('<div class="fb-share-button" data-href="'+P+'" data-layout="'+(Z.showCounts?"button_count":"button")+'"></div>'));break;case"reddit":T.append($('<a href="//www.reddit.com/submit?url='+encodeURIComponent(P)+'&r=wow" onclick="window.location = \'//www.reddit.com/submit?url='+encodeURIComponent(P)+'\'; return false" class="btn btn-primary btn-small fa fa-reddit-alien" target="_blank" rel="np">'+LANG.reddit+"</a>"));break;case"google":T.append($('<div class="g-plus" data-action="share" data-annotations="bubble"></div>'));break}s(U)}}}};function s(R){if(B.requestedSocialScripts[R]){return}B.requestedSocialScripts[R]=true;var P=null;switch(R){case"facebook":$('<div id="fb-root"></div>').prependTo(document.body);P=WH.ce("script",{id:"facebook-jssdk",src:"//connect.facebook.net/"+Locale.getName().replace(/(..)(..)/,"$1_$2").replace(/(..)$/,function(S){return S.toUpperCase()})+"/sdk.js#xfbml=1&version=v2.5"});break;case"twitter":P=WH.ce("script",{id:"twitter-wjs",src:"https://platform.twitter.com/widgets.js"});break;case"google":P=WH.ce("script",{id:"google-platform-api",src:"https://apis.google.com/js/platform.js"});break}if(P){var Q=document.getElementsByTagName("script")[0];Q.parentNode.insertBefore(P,Q)}}function v(){var P=$("#header-nav");if(!P.length){return}o=$("<dl/>");var Q='<span class="fa fa-chevron-down"></span>';$.each(Menu.getMenu(),function(R,T){if(T[MENU_IDX_OPT]&&(T[MENU_IDX_OPT].breadcrumbOnly||T[MENU_IDX_OPT].hide)){return}var S=$('<dt><a data-id="'+T[MENU_IDX_ID]+'">'+T[MENU_IDX_NAME]+(T[MENU_IDX_SUB]&&T[MENU_IDX_SUB].length?Q:"")+"</a></dt>");var U=S.children("a");if(T[MENU_IDX_OPT]&&T[MENU_IDX_OPT].rel){U.attr("rel",T[MENU_IDX_OPT].rel)}Menu.linkifyItem(T,U);U.data("menuItem",T);S.appendTo(o)});N();o.prependTo(P)}function y(R){var P=WH.ce("a",{className:R[MENU_IDX_OPT]&&R[MENU_IDX_OPT].headerNavIcon?"header-nav-icon":"header-nav-text",href:R[MENU_IDX_URL],rel:"np"});if(!R[MENU_IDX_URL]){P.href="javascript:;";P.className+=" unlinked"}if(R[MENU_IDX_OPT]&&R[MENU_IDX_OPT].className){P.className+=" "+R[MENU_IDX_OPT].className}if(R[MENU_IDX_OPT]&&R[MENU_IDX_OPT].title){P.title=R[MENU_IDX_OPT].title}var Q=WH.ce("span");WH.ae(P,Q);if(R[MENU_IDX_OPT]&&R[MENU_IDX_OPT].headerNavIcon){Q.style.background="url("+g_staticUrl+"/images/wow/icons/medium/"+R[MENU_IDX_OPT].headerNavIcon+".jpg)"}else{WH.st(Q,R[MENU_IDX_NAME]);if(R[MENU_IDX_SUB]&&R[MENU_IDX_SUB].length){WH.ae(P,WH.ce("span",{className:"fa fa-chevron-down"}))}}if(R[MENU_IDX_SUB]&&R[MENU_IDX_SUB].length){Menu.add(P,R[MENU_IDX_SUB])}return P}function r(){var U=$(".header-nav-features").empty();for(var S=0,T;T=mn_featuredContent[S];S++){if(T[MENU_IDX_OPT]&&T[MENU_IDX_OPT].expandInHeaderNav){if(T[MENU_IDX_SUB]){if(T[MENU_IDX_OPT].includeNameWhenExpanded){var V=y([,T[MENU_IDX_NAME]]);V.className+=" header-nav-expanded-name";U.append(V)}for(var Q=0,R;R=T[MENU_IDX_SUB][Q];Q++){var P=y(R);if(T[MENU_IDX_OPT].includeNameWhenExpanded){P.className+=" header-nav-has-expanded-name"}U.append(P)}}}else{U.append(y(T))}}U.append($("<a/>",{"class":"header-nav-wowhead-premium",href:"/premium"}).append($("<span/>",{html:"<b>"+LANG.wowheadPremium+"</b><br>"+LANG.premiumUpgradeTagLine})).append($("<span/>",{html:LANG.premiumUpgrade})).append($("<span/>",{html:LANG.premium})))}function n(){var T=$("div.header-search");if(T.length){var S=$('input[type="text"]',T);var R=$("body");if(R.hasClass("home")){WH.safeFocus(S)}if(WH.localStorage.get("showRandomWidget")=="true"){WH.localStorage.remove("showRandomWidget");var Q=WH.ce("a");Q.className="header-random fa fa-random";Q.href="/random";WH.Tooltip.simple(Q,LANG.anotherrandompage_tip,"q2");T.append(Q)}var P;P=$("<a/>",{"class":"header-search-button fa fa-search",href:"javascript:;"});P.click(A).appendTo(T);$("form",T).submit(WH.preventEmptyFormSubmission);LiveSearch.attach(S);if(Array.prototype.indexOf&&!p.noSearchBoxGrab){R.keydown((function(V,U){if(!U.ctrlKey&&!U.metaKey&&!U.altKey&&WH.keyPressIsAlphaNumeric(U)&&["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.tagName)==-1){if(V.offset().top>=(window.scrollY||window.pageYOffset)){V.focus()}}}).bind(null,S))}}}function z(){c()}function N(){if(!o){return}$.each(Menu.getMenu(),function(P,R){var S=$('a[data-id="'+R[MENU_IDX_ID]+'"]',o);var Q=(R[MENU_IDX_ID]==p.activeTab);if(Q){if(Platform.isTouch()){S.addClass("active-touch");if(R[MENU_IDX_SUB]){Menu.addTouch(S,R[MENU_IDX_SUB])}}else{S.addClass("active");Menu.add(S,R[MENU_IDX_SUB])}}else{S.removeClass("active-touch").removeClass("active");if(R[MENU_IDX_SUB]){if(Platform.isTouch()){Menu.addTouch(S,R[MENU_IDX_SUB])}else{Menu.add(S,R[MENU_IDX_SUB])}}}})}function c(){if(!p.breadcrumb||!p.breadcrumb.length){h.detach();setTimeout(function(){if(h.is(":empty")){h.detach()}},0);return}h.empty();if(L.length){$.each(L,function(){this.checked=false;Menu.updateItem(this)});L=[]}var R=Menu.getFullPath(Menu.getMenu(),p.breadcrumb);if(!R.length){return}var Q=(R.length-1);var S={"@context":"http://schema.org","@type":"BreadcrumbList",itemListElement:[]};$.each(R,function(aa,T){var X=Menu.getItemOpt(T);var Z={"@type":"ListItem",position:aa+1,item:{}};if(X.tinyIcon){Z.item.image=WH.ensureUrlProtocol(WH.getTinyIconUrl(X.tinyIcon))}T.checked=true;if((T[MENU_IDX_OPT]&&T[MENU_IDX_OPT].breadcrumbParent)||(R[aa+1]&&R[aa+1][MENU_IDX_OPT]&&R[aa+1][MENU_IDX_OPT].breadcrumbParent)){if(!T[MENU_IDX_OPT]){T[MENU_IDX_OPT]={}}T[MENU_IDX_OPT].checkedFunc=function(ad){var ac=$("#main-precontents .breadcrumb span a.open");return ac.text()===ad[MENU_IDX_NAME]}}L.push(T);Menu.updateItem(T);var Y=C();var V=Y;if(T[MENU_IDX_URL]){var U=Menu.getItemUrl(T);Z.item["@id"]=WH.ensureUrlProtocol(U);V=$("<a/>",{href:U,rel:"np"}).appendTo(Y)}var ab=X.breadcrumb?X.breadcrumb.trim():T[MENU_IDX_NAME].trim();Z.item.name=ab;V.text(ab);Menu.add(V,T.parentMenu);S.itemListElement.push(Z);Y.appendTo(h);if(aa==Q&&T[MENU_IDX_SUB]){Y.addClass("breadcrumb-arrow");var W=$('<span class="breadcrumb-ellipsis">...</span>');Menu.add(W,T[MENU_IDX_SUB]);W.appendTo(h)}});$("#json-ld-breadcrumbs").remove();if(S.itemListElement.length){var P=document.createElement("script");P.id="json-ld-breadcrumbs";P.type="application/ld+json";P.text=JSON.stringify(S);document.head.appendChild(P)}h.trigger("update");if(!h.is(":empty")){h.appendTo("#main-precontents");h.show()}ZUL.regenerateMenu(false,true);m()}function C(){h.children("span:last").addClass("breadcrumb-arrow");return $("<span/>").appendTo(h)}k.expandSite=function(){WAS.removeAll();$("#header-expandsite").remove();var R=333;var Q=$("#sidebar");var P=$(".top-sidebar-infobox");P.detach();if(Q.is(":empty")){Q.remove();$("#sidebar-wrapper").remove();var S=$("#layout");if(S.hasClass("no-sidebar")){return}S.removeClass("has-sidebar").addClass("no-sidebar")}else{Q.prepend(P)}setTimeout(function(){$(document.body).removeClass("has-ads").addClass("no-ads")},R+1)};function A(){var P=$(this).siblings("form").submit().children("input");WH.safeFocus(P)}u()};PageTemplate.Responsive=new function(){var f={navRowsMaxHeight:50+2,responsiveCheckWiggleRoom:5};var g={maxMobileNavigationWidth:774,secondaryNavElementMinimums:{},useMobileZUL:false};var b={};this.check=function(){if(j()){d(!g.useMobileZUL);ZUL.setMobileMode(g.useMobileZUL);if(!g.useMobileZUL){if(j()){d(!g.useMobileZUL);ZUL.setMobileMode(g.useMobileZUL)}}}return g.useMobileZUL};this.isZulInMobileMode=function(){return Boolean(document.body.className&&document.body.className.indexOf("has-mobile-zul-bar")>-1)};function c(m){if(!b[m]||!b[m].length){b[m]=$(m)}return b[m]}function h(m,o){if(!o){o=window.innerWidth}if(g.secondaryNavElementMinimums[m]&&g.secondaryNavElementMinimums[m]>=o){return}g.secondaryNavElementMinimums[m]=o;o=(parseInt(o)+f.responsiveCheckWiggleRoom).toString();var n="@media screen and (max-width:"+o+"px) { "+m+" {display:none !important} }";WH.addCss(n)}function l(){if(g.useMobileZUL){return}var n=$("dt:last-child:visible",c(".header-nav"));if(n.length){var r=n.offset().left+n.outerWidth();var p=$(".header-social li:visible").first();if(p.length){var t=p.offset().left;if(r>t){h(".header-social")}}}var s=c(".header-nav-features");var u=$("> a:visible",s).not(".header-nav-wowhead-premium").last();if(u.length){var q=u.offset().left+u.outerWidth();var v=$(".header-nav-wowhead-premium:visible",s);if(v.length){var o=v.offset().left;var m=15;if(q-m>o){h(".header-nav-wowhead-premium")}}}}function k(){if(!g.useMobileZUL){var m=c(".header-nav");if(m.height()>f.navRowsMaxHeight){g.useMobileZUL=true;return true}}if(!g.useMobileZUL){var n=c(".header-nav-features");if(n.height()>f.navRowsMaxHeight){g.useMobileZUL=true;return true}}return false}function j(){l();var n=g.useMobileZUL;var m=Platform.getViewportWidth();g.useMobileZUL=m<=g.maxMobileNavigationWidth;if(k()){m+=f.responsiveCheckWiggleRoom;if(m>g.maxMobileNavigationWidth){g.maxMobileNavigationWidth=m}}return g.useMobileZUL!==n}function d(m){if(!m){$(document.body).addClass("no-header")}else{$(document.body).removeClass("no-header")}}};WH.convertRawItemDataForPaperdoll=function(c){var d={};d.slotId=c[0];d.itemId=c[1];d.transmogId=c[9];d.hidden=c[10];d.rawBonuses=c.slice(11,17);d.bonuses=[];for(var b in d.rawBonuses){if(d.rawBonuses.hasOwnProperty(b)&&d.rawBonuses[b]){d.bonuses.push(d.rawBonuses[b])}}return d};WH.convertPaperdollItemDataToRaw=function(d){var b=[];for(var c=0;c<17;c++){b[c]=0}b[0]=d.slotId;b[1]=d.itemId;b[9]=d.transmogId?d.transmogId:0;b[10]=d.hidden?d.hidden:0;b[11]=d.itemBonus?d.itemBonus:0;return b};var Platform=new function(){this.known=false;this.initialized=false;this.initSteps={};var f=false;var d=false;var h=false;var j=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(j)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(j.substr(0,4))){f=true}if(!f){if(/(android|ipad|playbook|silk)/i.test(j)){d=true}}var k=WH.getGets();if(typeof k.testmobile!="undefined"&&!f){h=true;f=true}if(typeof k.testtablet!="undefined"&&!d){h=true;d=true}this.known=true;this.preInit1=function(){if(Platform.initSteps["1"]){return}$("html").addClass(Platform.get()+"-device"+(h?" forced-device":""));if(Platform.isTouch()){g()}Platform.initSteps["1"]=true};this.preInit2=function(){if(Platform.initSteps["2"]){return}if(Platform.isTouch()){b()}Platform.initSteps["2"]=true};this.init=function(){if(Platform.initSteps["3"]||Platform.initialized){return}if(Platform.isTouch()){Platform.preInit1();Platform.preInit2()}WH.prepInfobox();WH.Responsive.test(true);c();Platform.initSteps["3"]=true;Platform.initialized=true};function c(){setTimeout(function(){WH.updateContentHeight();setInterval(WH.updateContentHeight,200)},9)}this.isMobile=function(){return f};this.isTablet=function(){return d};this.isTouch=function(){return this.isMobile()||this.isTablet()};this.get=function(){if(this.isMobile()){return"mobile"}if(this.isTablet()){return"tablet"}return"pointer"};this.getViewportSize=function(){var l=window;var m="inner";if(!("innerWidth" in window)){m="client";l=document.documentElement||document.body}return{width:l[m+"Width"],height:l[m+"Height"]}};this.getViewportHeight=function(){return this.getViewportSize().height};this.getViewportWidth=function(){return this.getViewportSize().width};function g(){$("html").addClass("touch-device")}function b(){Platform.preInit1();$("#layout").removeClass("has-sidebar").addClass("no-sidebar");$("#sidebar .vertical-block-bg, #sidebar .sidebar-block-bg, #sidebar .block-block-bg").remove();$("#header-expandsite").remove()}};$(document).ready(Platform.init);var PoundChecker=new function(){var b=null;var f=null;var c=1000;var d=function(){if(!f){PoundChecker.stop();return}if(location.hash){f()}};this.start=function(g,h){if(f){if(WH.isSet("g_dev")){alert("Multiple pound checkers are bad, mmkay?")}return}f=g;if(h){c=h}b=setInterval(d,c)};this.stop=function(){clearInterval(b);b=f=null;c=1000};this.pause=function(){clearInterval(b)};this.resume=function(){if(f){b=setInterval(f,c)}}};var ProgressBar=function(b){this.opts={text:"",hoverText:"",color:"rep6",width:0,progress:0};this.elements={text:null,hoverText:null,textContainer:null,progress:null,container:null};WH.cO(this.opts,b);this.build()};ProgressBar.prototype.build=function(){var c=$("<a/>",{"class":"progressbar",href:"javascript:;"});if(this.opts.width>0){c.css("width",this.opts.width+"px")}else{c.css("width","auto")}var b=$("<div/>",{"class":"progressbar-text"});if(this.opts.text){this.elements.text=$("<del/>",{text:this.opts.text});b.append(this.elements.text)}if(this.opts.hoverText){this.elements.hoverText=$("<ins/>",{text:this.opts.hoverText});b.append(this.elements.hoverText)}c.append(b);var d=$("<div/>",{"class":"progressbar-"+this.opts.color,css:{width:this.opts.progress+"%"},text:String.fromCharCode(160)});c.append(d);if(this.opts.text){b.append($("<div/>",{"class":"progressbar-text progressbar-hidden",text:this.opts.text}))}this.elements.container=c;this.elements.progress=d;this.elements.textContainer=b;return c};ProgressBar.prototype.setText=function(b){this.opts.text=b;if(this.elements.text){this.elements.text.text(this.opts.text)}else{this.elements.text=$("<del/>",{text:this.opts.text});if(this.opts.hoverText){this.opts.hoverText.before(this.elements.text)}else{this.elements.textContainer.append(this.elements.text)}}};ProgressBar.prototype.setHoverText=function(b){this.opts.hoverText=b;if(this.elements.hoverText){this.elements.hoverText.text(this.opts.hoverText)}else{this.elements.hoverText=$("<ins/>",{text:this.opts.hoverText});this.elements.textContainer.append(this.elements.hoverText)}};ProgressBar.prototype.setProgress=function(b){this.opts.progress=b;this.elements.progress.css("width",this.opts.progress+"%")};ProgressBar.prototype.setWidth=function(b){this.opts.width=b;if(this.opts.width>0){this.elements.container.css("width",this.opts.width+"px")}else{this.elements.container.css("width","auto")}};ProgressBar.prototype.getText=function(){return this.opts.text};ProgressBar.prototype.getHoverText=function(){return this.opts.hoverText};ProgressBar.prototype.getWidth=function(){return this.opts.width};ProgressBar.prototype.getContainer=function(){return this.elements.container};WH.Responsive=new function(){this.CONSTANTS={INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT:768,SIDEBAR_REMOVAL_BREAKPOINT:1200};var d={platformInitComplete:false};this.test=function(f){b.test();c.test();if(f){d.platformInitComplete=true}};var c=new function(){var g={classesToSkip:["db-action-buttons"],idsToSkip:["announcement","infobox-original-position"]};var f;this.test=function(){if(!WAS.showAds()){return}h();var l=$("#ds-box");if(f){if(!l.length){return}var k=Platform.getViewportSize();var m=l.closest(".interior-sidebar");if(m.length){if(k.width<WH.Responsive.CONSTANTS.INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT){m.appendTo(f)}else{if(!m.parent().hasClass("interior-sidebar-wrapper")){$(".interior-sidebar-wrapper").prepend(m)}}}else{if(k.width<WH.Responsive.CONSTANTS.SIDEBAR_REMOVAL_BREAKPOINT){l.appendTo(f)}else{if(l.parent().attr("id")!=="distroscale-original-position"){$("#distroscale-original-position").append(l)}}}}};function h(){if(f||d.platformInitComplete){return}var k=WH.ge("main-contents");if(!k){return}var l=j(k);if(!l){l=k}f=WH.ce("div",{id:"distroscale-alternate-position"});l.parentNode.insertBefore(f,l.nextSibling)}function j(p){mainLoop:for(var n=0;n<p.childNodes.length;n++){var q=p.childNodes[n];if(!q||q.nodeType!==Node.ELEMENT_NODE||q.tagName==="SCRIPT"||q.tagName==="NOSCRIPT"){continue}if(q.id){for(var m=0,r;r=g.idsToSkip[m];m++){if(q.id.indexOf(r)===0){continue mainLoop}}}if(q.className){for(var l=0,o;o=g.classesToSkip[l];l++){if(q.className.match(new RegExp("\\b"+o+"\\b"))){continue mainLoop}}}if(!$(q).is(":visible")){continue}if(n+1===p.childNodes.length){break}if(q.className&&q.className.match(/\btext\b/)){return j(q)}return q}return null}};var b=new function(){var f;this.test=function(){if(!f&&!d.platformInitComplete){f=WH.ge("infobox-alternate-position")}var j=$(".infobox");g(j);h(j)};function g(l){if(!f||!l.length){return}var j=Platform.getViewportSize();var k=l.closest(".interior-sidebar");if(k.length){if(j.width<WH.Responsive.CONSTANTS.INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT){k.appendTo(f)}else{if(!k.parent().hasClass("interior-sidebar-wrapper")){$(".interior-sidebar-wrapper").prepend(k)}}}else{if(j.width<WH.Responsive.CONSTANTS.SIDEBAR_REMOVAL_BREAKPOINT){l.appendTo(f)}else{if(l.parent().attr("id")!=="infobox-original-position"){$("#infobox-original-position").append(l)}}}}function h(j){$(".icon-db-link div",j).each(function(){var m=$(this);var l=(Platform.getViewportSize()).width-54;if(!Platform.isTouch()){l-=20}var k=Math.min(l,m.parent().width());m.css("width",k+"px")})}}};$(window).resize(WH.Responsive.test);function ss_submitAScreenshot(){tabsContribute.focus(1)}function ss_validateForm(b){if(!b.elements.screenshotfile.value.length){alert(LANG.message_noscreenshot);return false}return true}function ss_appendSticky(){var l=WH.ge("infobox-sticky-ss");if(!l){return}var h=g_pageInfo.type;var b=g_pageInfo.typeId;var j=WH.inArray(lv_screenshots,1,function(n){return n.sticky});if(j!=-1){l.className="has-thumb";var g=lv_screenshots[j];var k=WH.ce("a");k.href="#screenshots:id="+g.id;k.onclick=function(n){ScreenshotViewer.show({screenshots:lv_screenshots,pos:j});return WH.rfWithoutControlKey(n)};var m=[300,300];var f=WH.ce("img"),d=Math.min(m[0]/g.width,m[1]/g.height);f.src=WH.getScreenshotUrl(g.id,"small");f.width=Math.round(d*g.width);f.height=Math.round(d*g.height);f.className="border";WH.ae(k,f);WH.ae(l,k);var c=$("#infobox-screenshots");if(!c){c=$("th",$(l).parents().prev("tr"))}c.append(" ("+lv_screenshots.length+")").wrapInner($('<a href="#screenshots"></a>').click(function(){tabsRelated.focus(tabsRelated.getTabById("screenshots"));return false}))}else{var k;if(g_user.id>0){k='<a href="javascript:;" onclick="ss_submitAScreenshot(); return false">'}else{k='<a href="/account=signin">'}l.innerHTML=WH.sprintf(LANG.infobox_noneyet,k+LANG.infobox_submitone+"</a>")}ss_appendSticky=function(){}}var g_screenshots={};var ScreenshotViewer=new function(){var A,C,f,v,d,r=150,I=150,F,p,j=0,w,G,k,l,n,N,t,s,m,u,O,b,y,B="screenshots";function K(){var T=A[C];if(!T){T={height:270,width:300}}v=T.width;d=T.height;var V=v;var R=WH.getWindowSize();var S=R.w-r;var Q=Math.min(v,S);var U=Q*(d/v);if(U+I>R.h){V=(R.h-I)*(v/d);F=true}else{F=false}Lightbox.setSize(V+20,d+52);$(".screenshotviewer-image-inner",l).css({"padding-top":(d/v)*100+"%"})}function o(S){var R=A[S],Q="#"+B;if(j==0){Q+=(R?":id="+R.id:"")}else{Q+=":"+w+":"+(R?S+1:S+0.5)}return Q}function H(R){var Q="";if(typeof g_gathered_types=="object"&&g_gathered_types[R.type]&&g_gathered_types[R.type][R.typeId]&&g_gathered_types[R.type][R.typeId]["name_"+Locale.getName()]){Q=g_gathered_types[R.type][R.typeId]["name_"+Locale.getName()]}else{if(typeof g_pageInfo=="object"&&g_pageInfo.type&&g_pageInfo.typeId&&g_pageInfo.name){Q=g_pageInfo.name}}if(R.caption){if(Q){Q+=LANG.hyphen+R.caption}else{Q=R.caption}}return Q}function D(X){clearTimeout(y);if(X&&!F&&WH.getWindowSize().h>G.offsetHeight+I){return}G.style.visibility="hidden";var Y=A[C];if(!Y){Y={ad:true,height:270,width:300}}K();var ab=H(Y);var Q=Y.url||WH.getScreenshotUrl(Y.id,"normal",ab);var S="";if(Y.ad){S='<div class="screenshot-block"><div id="screenshot-block-target"></div><div class="screenshot-block-caption">'+LANG.advertisement+"</div></div>";setTimeout(function(){WAS.create("medrec","screenshot-block-target")},0)}else{S='<img src="'+Q+'" width="'+v+'" height="'+d+'">'}l.innerHTML=S+'<div class="screenshotviewer-image-inner" style="padding-top:'+(d/v)*100+'%"></div>';if(!X){WH.Track.interactiveEvent("Screenshots","Show",Y.id+((Y.caption&&Y.caption.length)?" ("+Y.caption+")":""));if(Y.ad){s.href="javascript:;";s.style.display="none"}else{if(Y.url){s.href=Q;s.style.display="block"}else{s.href=WH.getScreenshotUrl(Y.id,"normal",ab);s.style.display="block"}}if(!Y.user&&typeof g_pageInfo=="object"){Y.user=g_pageInfo.username}var V=(Y.date&&Y.user),U=(A.length>1);if(V){var T=new Date(Y.date),aa=(g_serverTime-T)/1000;var Z=m.firstChild.childNodes[1];Z.href="/user="+Y.user;Z.innerHTML=Y.user;var ad=m.firstChild.childNodes[3];WH.ee(ad);ad.removeAttribute("class");ad.removeAttribute("title");WH.formatDate(ad,aa,T);m.firstChild.title=LANG.lvscreenshot_from+Y.user+" "+WH.formatDate(null,aa,T);m.firstChild.style.display=""}else{m.firstChild.style.display="none"}var ad=m.childNodes[1];WH.ee(ad);if(Y.user){if(V){WH.ae(ad,WH.ct(" "+LANG.dash+" "))}var Z=WH.ce("a");Z.href="javascript:;";Z.onclick=ContactTool.show.bind(ContactTool,{mode:3,screenshot:Y});Z.className="icon-report";WH.Tooltip.simple(Z,LANG.report_tooltip,"q2");WH.ae(Z,WH.ct(LANG.report));WH.ae(ad,Z)}ad=m.childNodes[2];if(U){var ac="";if(Y.user){ac=LANG.dash}if(C%1!=0){ac+=WH.sprintf(LANG.dialog_adbetweenimages,C+0.5,C+1.5,A.length)}else{ac+=(C+1)+LANG.lvpage_of+A.length}ad.innerHTML=ac;ad.style.display=""}else{ad.style.display="none"}m.style.display=(V||U?"":"none");if(Locale.getId()!=LOCALE_ENUS&&Y.caption){Y.caption=""}var W=(Y.caption!=null&&Y.caption.length);var R=(Y.subject!=null&&Y.subject.length&&Y.type&&Y.typeId);if(W||R){S="";if(R){S+=LANG.types[Y.type][0]+LANG.colon;S+='<a href="/'+g_types[Y.type]+"="+Y.typeId+'">';S+=Y.subject;S+="</a>"}if(W){if(R){S+=LANG.dash}S+=Y.noMarkup?Y.caption:WH.markup.getHtml(Y.caption,{mode:WH.markup.MODE.SIGNATURE})}u.innerHTML=S;u.style.display=""}else{u.style.display="none"}if(A.length>1){N.href=o(P(-1));t.href=o(P(1));N.style.display=t.style.display=""}else{N.style.display=t.style.display="none"}if(C!=f||Platform.isTouch()){n.style.display="none"}location.replace(o(C))}Lightbox.reveal();G.style.visibility="visible"}function P(R){var Q=C;Q+=R;if(Q<0){Q=A.length-1}else{if(Q>=A.length){Q=0}}return Q}function z(R){console.log("logging",R);if(typeof OX=="undefined"){return}if(!window.ox_instances){window.ox_instances={}}var Q=window.ox_instances;Q[R]=OX({auid:R});Q[R].load()}function E(R){var Q=C+R;if(typeof WAS!="undefined"&&WAS.showAds()&&false){if(C%1!=0){R=R/2}else{if(Q!=f&&Q+1!=f&&((R>0&&(100+Q-f)%5==0)||(R<0&&(100+Q-f+1)%5==0))){R=R/2}}if(C%1==0&&Q!=f&&Q+1!=f&&((R>0&&(100+Q-f)%4==0)||(R<0&&(100+Q-f+1)%4==0))){z("537180962")}}C=P(R);c();return false}function g(Q){Q=WH.normalizeEvent(Q);switch(Q.keyCode){case 37:E(-1);break;case 39:E(1);break}}function L(){D(1)}function M(){h();if(A.length>1){WH.dE(document,"keyup",g)}if(p&&j==0){if(p.indexOf(":id=")!=-1){p="#"+B}WH.setHash(p)}else{WH.clearHash()}}function J(W,S,R){if(typeof R.screenshots=="string"){A=g_screenshots[R.screenshots];j=1;w=R.screenshots}else{A=R.screenshots;j=0;w=null}G=W;C=0;if(R.pos&&R.pos>=0&&R.pos<A.length){C=R.pos}f=C;if(S){W.className+=" has-lightbox-caption screenshotviewer";k=WH.ce("div");k.className="lightbox-content screenshotviewer-screen";n=WH.ce("div");n.className="screenshotviewer-keystip";n.innerHTML=LANG.dialog_ssviewerkeys;WH.ae(W,n);var Y=WH.ce("div");var V=WH.ce("div");Y.className="screenshotviewer-page-wrapper screenshotviewer-prev-wrapper";V.className="screenshotviewer-page-wrapper screenshotviewer-next-wrapper";N=WH.ce("a");t=WH.ce("a");N.className="screenshotviewer-prev";t.className="screenshotviewer-next";N.href="javascript:;";t.href="javascript:;";var T=WH.ce("span");T.className="fa fa-chevron-left";WH.ae(N,T);T=WH.ce("span");T.className="fa fa-chevron-right";WH.ae(t,T);WH.aE(N,"click",E.bind(N,-1));WH.aE(N,"tap",E.bind(N,-1));WH.aE(t,"click",E.bind(t,1));WH.aE(t,"tap",E.bind(t,1));WH.ae(Y,N);WH.ae(V,t);WH.ae(k,Y);WH.ae(k,V);l=WH.ce("div",{className:"screenshotviewer-image",innerHTML:'<div class="screenshotviewer-image-inner"></div>'});WH.ae(k,l);WH.ae(W,k);var U=WH.ce("a");U.className="dialog-x fa fa-times";U.href="javascript:;";U.onclick=Lightbox.hide;WH.ae(U,WH.ct(LANG.close));WH.ae(W,U);s=WH.ce("a");s.className="dialog-arrow fa fa-external-link";s.href="javascript:;";s.target="_blank";WH.ae(s,WH.ct(LANG.original));WH.ae(W,s);var X=WH.ce("div",{className:"lightbox-caption"});m=WH.ce("div");m.className="screenshotviewer-from";var Q=WH.ce("span");WH.ae(Q,WH.ct(LANG.lvscreenshot_from));WH.ae(Q,WH.ce("a"));WH.ae(Q,WH.ct(" "));WH.ae(Q,WH.ce("span"));WH.ae(m,Q);WH.ae(m,WH.ce("span"));WH.ae(m,WH.ce("span"));WH.ae(X,m);u=WH.ce("div");u.className="screenshotviewer-caption";WH.ae(X,u);WH.ae(W,X)}p=location.hash;if(A.length>1){WH.aE(document,"keyup",g)}c()}function c(){var Q=A[C];if(Q&&(!Q.width||!Q.height)){if(O){O.onload=null;O.onerror=null}else{G.className="";b=[];while(G.firstChild){b.push(G.firstChild);WH.de(G.firstChild)}}clearTimeout(y);y=setTimeout(function(){Q.width=126;Q.height=22;K();Q.width=null;Q.height=null;var S=WH.ce("div");S.className="screenshotviewer-loading";var R=WH.ce("img");R.src=g_staticUrl+"/images/ui/misc/progress-anim.gif";R.width=126;R.height=22;WH.ae(S,R);WH.ae(G,S);Lightbox.reveal();G.style.visiblity="visible"},150);O=new Image();O.onload=(function(R,S){clearTimeout(S);R.width=this.width;R.height=this.height;O=null;q();D()}).bind(O,Q,y);O.onerror=(function(R){clearTimeout(R);O=null;Lightbox.hide();q()}).bind(O,y);O.src=Q.url||WH.getScreenshotUrl(Q.id,"normal",H(Q))}else{D()}}function h(){if(!O){return}O.onload=null;O.onerror=null;O=null;q()}function q(){if(!b){return}WH.ee(G);G.className="lightbox-frame has-lightbox-caption screenshotviewer";for(var Q=0;Q<b.length;++Q){WH.ae(G,b[Q])}b=null}this.getScreenshotDescription=function(Q){return H(Q)};this.checkPound=function(){if(location.hash&&location.hash.indexOf("#"+B)==0){if(!g_listviews[B]){var R=location.hash.split(":");if(R.length==3){var S=g_screenshots[R[1]],Q=parseInt(R[2]);if(S&&Q>=1&&Q<=S.length){ScreenshotViewer.show({screenshots:R[1],pos:Q-1,hashname:B})}}}}};this.show=function(Q){if("hashname" in Q){B=Q.hashname;delete Q.hashname}Lightbox.show("screenshotviewer",{onShow:J,onHide:M,onResize:L},Q)};$(document).ready(this.checkPound)};(function(){if((User.hasPermissions(U_GROUP_ADMIN)||WH.isDev()||(g_user&&parseInt(g_user.id)===1788274))&&!location.pathname.match(/^\/(account|admin|edit|search)(=|\/|\?|$)/)){if(!document.title){WH.debugMessage({text:"No page title!","class":"debug-seo-error"})}$(function(){setTimeout(function(){if(!$("h1").length){WH.debugMessage({text:"No H1!","class":"debug-seo-error"})}},1000)});var d=function(h){return h.match(/(%s|\$\d)/)};var g=$('meta[name="description"]').attr("content");if(g){var f={html:'<span class="q0">SEO Description:</span> '+g,"class":"debug-seo"};if(d(g)){f["class"]+="-error"}if(g.length<130){f.html+=' <span class="q0">(short)</span>';f["class"]+="-warn"}else{if(g.length>160){f.html+=' <span class="q0">(long)</span>';f["class"]+="-warn"}}WH.debugMessage(f)}else{WH.debugMessage({text:"No SEO description!","class":"debug-seo-error"})}var b=$('meta[name="keywords"]').attr("content");if(b){var c={html:'<span class="q0">SEO Keywords:</span> '+b.split(",").join(", "),"class":"debug-seo"};if(d(b)){c["class"]+="-error"}WH.debugMessage(WH.escapeHtml(c))}else{WH.debugMessage({text:"No SEO keywords!","class":"debug-seo-error"})}}})();var ShowOnMap=function(d,f,c){var b=this;b.data=d;b.currentPath=[];if(f==null){f=myMapper}b.mapper=f;b._legend=null;b._legendLabel=null;b._legendContents=null;b._legendHorde=null;b._legendAlliance=null;b._menu=[];b._trackingIcons=[];b._controlsdiv=c?$(typeof c=="string"?("#"+c):c):$("#lenrlkn4");b.construct()};ShowOnMap.prototype.onExpand=function(){this.expanded=true;location.replace(this.pound+".map")};ShowOnMap.prototype.onCollapse=function(){this.expanded=false;var b=WH.getHash();if(b.indexOf("#show")==0&&b.indexOf(".map")>0){this.pound=b.substr(0,b.indexOf(".map"));location.replace(this.pound)}};ShowOnMap.prototype.construct=function(){if(!this.data){return}var ae=this._controlsdiv;var g=function(l,d){return WH.stringCompare(l[1],d[1])};var J=[];var c=[];for(var ab in this.data){if(this.data[ab].length===undefined){var R=[];var Q=[];var s={};var z=this.data[ab];for(var U in z){var f=false;for(var Y=0,w=z[U].length;Y<w;++Y){if(z[U][Y].paths){f=true;break}}var o=WH.urlize(U);if(z[U][0].name_enus!==undefined){o=WH.urlize(z[U][0].name_enus)}var r={};var O={};var F=[o];var T=ShowOnMap.combinePins(z[U],false,f);var M=T[0];var A=T[1];var ag=0;for(var Y=0;Y<M.length;++Y){var E=M[Y];var I=ShowOnMap.buildTooltip(E.list);var h=I[2];var Z=null;if(h=="javascript:;"){Z=I[3]}if(E.list.length==1){h=(g_types[E.list[0].type]&&E.list[0].id?"/"+g_types[E.list[0].type]+"="+E.list[0].id:"")}if(ab=="rare"||ab=="herb"||ab=="vein"){I[1]=R.length+1}if(r[E.level]==undefined){r[E.level]=[]}r[E.level].push([E.coord[0],E.coord[1],{url:h,label:I[0],menu:Z,type:I[1],lines:E.list[0].paths}]);ag++}if(ag>0){var h=(g_types[z[U][0].type]&&z[U][0].id?"/"+g_types[z[U][0].type]+"="+z[U][0].id:"");O[R.length+1]=[U,h];F.push(U+WH.sprintf(LANG.qty,A));F.push(this.showStuff.bind(this,r,[ab,o],O));R.push(F);for(var aa in r){if(Q[aa]){Q[aa]=Q[aa].concat(r[aa])}else{Q[aa]=r[aa]}}s[R.length]=[U,h]}}if(R.length>0){R.sort(g);var F=[ab,LANG.som[ab],this.showStuff.bind(this,Q,[ab],s),R];this._menu.push(F);var G=[[null,LANG.som[ab]],["all",LANG.som.all,F[2]]];for(x=0;x<R.length;x++){G.push(R[x])}this._trackingIcons.push([ab,undefined,s,G])}}else{if(this.data[ab].length==0){continue}var f=false;for(var Y=0,w=this.data[ab].length;Y<w;++Y){if(this.data[ab][Y].paths){f=true;break}}var F=[ab];var r={};var V={},D={};var q={},L={};var O={};var t={};var N={};var T=ShowOnMap.combinePins(this.data[ab],false,f);var A=T[1];var ag=0,j=0,C=0,k=0,b=0;var u=function(p,aj){for(var ah=0;ah<aj.length;++ah){var d=aj[ah];var al=p;d.list.key=ab;var am=ShowOnMap.buildTooltip(d.list,(p=="hordedailyquests"||p=="alliancedailyquests")?true:false);var l=am[2];var ai=null;if(l=="javascript:;"){ai=am[3]}if(d.list.length==1){l=(g_types[d.list[0].type]&&d.list[0].id?"/"+g_types[d.list[0].type]+"="+d.list[0].id:"")}var ak=[d.coord[0],d.coord[1],{url:l,label:am[0],menu:ai,type:am[1],lines:d.list[0].paths}];if(r[d.level]==undefined){r[d.level]=[];V[d.level]=[];D[d.level]=[];q[d.level]=[];L[d.level]=[]}if(d.list[0].mapicon){ak[2].mapicon=d.list[0].mapicon}if(al!="mailbox"&&al!="vignettes"&&al!="rare"&&al!="spirithealer"&&al!="book"&&al!="forge"&&al!="treasure"&&al!="anvil"&&al!="hordequests"&&al!="alliancequests"&&al!="hordedailyquests"&&al!="alliancedailyquests"&&al!="boss"){if(am[1]==2||am[1]==0){if(am[1]==2){t[2]=[LANG.som_legend_horde,null]}else{t[0]=[LANG.som_legend_neutral,null]}V[d.level].push(ak);j++}if(am[1]==3||am[1]==0){if(am[1]==3){N[3]=[LANG.som_legend_alliance,null]}else{N[0]=[LANG.som_legend_neutral,null]}q[d.level].push(ak);k++}}else{if(al=="hordequests"){al="quest";if(am[1]==2){t[2]=[LANG.som_legend_horde,null]}else{t[0]=[LANG.som_legend_neutral,null]}V[d.level].push(ak);j++}else{if(al=="hordedailyquests"){al="daily";if(am[1]==2){t[2]=[LANG.som_legend_horde,null]}else{t[0]=[LANG.som_legend_neutral,null]}D[d.level].push(ak);C++}else{if(al=="alliancequests"){al="quest";if(am[1]==3){N[3]=[LANG.som_legend_alliance,null]}else{N[0]=[LANG.som_legend_neutral,null]}q[d.level].push(ak);k++}else{if(al=="alliancedailyquests"){al="daily";if(am[1]==3){N[3]=[LANG.som_legend_alliance,null]}else{N[0]=[LANG.som_legend_neutral,null]}L[d.level].push(ak);b++}else{r[d.level].push(ak);ag++}}}}}}return al};var ad=u(ab,T[0]);if(ab=="alliancequests"){var y=ShowOnMap.combinePins(this.data[ab],true);if(y[1]>0){u("alliancedailyquests",y[0])}}else{if(ab=="hordequests"){var P=ShowOnMap.combinePins(this.data[ab],true);if(P[1]>0){u("hordedailyquests",P[0])}}}if(ad=="rare"){A=this.data[ad].length}else{if(ad=="forge"||ad=="anvil"||ad=="treasure"||ad=="mailbox"){A=T[0].length}}if(ag>0){var F=[ad,LANG.som[ad]+WH.sprintf(LANG.qty,A),this.showStuff.bind(this,r,[ad],O)];this._menu.push(F);this._trackingIcons.push([ad,r,O])}if(j>0){var F=[ad,LANG.som[ad]+WH.sprintf(LANG.qty,j),this.showStuff.bind(this,V,["horde",ad],t),null];if(ad=="quest"){F.push({tinyIcon:"quest_start"});if(C>0){c.push(F);F=["daily",LANG.som.daily+WH.sprintf(LANG.qty,C),this.showStuff.bind(this,D,["horde","daily"],t),null,{tinyIcon:"quest_start_daily"}];this._trackingIcons.push(["daily",D,t])}}c.push(F);this._trackingIcons.push([ad,V,t])}if(k>0){var F=[ad,LANG.som[ad]+WH.sprintf(LANG.qty,k),this.showStuff.bind(this,q,["alliance",ad],N),null];if(ad=="quest"){F.push({tinyIcon:"quest_start"});if(b>0){J.push(F);F=["daily",LANG.som.daily+WH.sprintf(LANG.qty,b),this.showStuff.bind(this,L,["alliance","daily"],N),null,{tinyIcon:"quest_start_daily"}];this._trackingIcons.push(["daily",L,N])}}J.push(F);this._trackingIcons.push([ad,q,N])}}}J.sort(g);c.sort(g);this._menu.sort(g);if(c.length>0){this._menu.unshift(["horde",LANG.som.horde,"",c,{tinyIcon:"side_horde"}])}if(J.length>0){this._menu.unshift(["alliance",LANG.som.alliance,"",J,{tinyIcon:"side_alliance"}])}var v=[-1,LANG.som_nothing,this.showStuff.bind(this,[],[-1],{})];v.checked=true;this._menu.push(v);var H=WH.createButton(LANG.showonmap,null,{"class":"mapper-som-button fa fa-search"});Menu.add(H,this._menu,{showAtElement:true});ae.append(H);var K;if(!this._legend){this._legend=$("<div/>",{"class":"mapper-legend",css:{display:"none"}});var X=$("<div/>",{"class":"mapper-legend-container"});this._legendLabel=$("<b/>",{text:LANG.som_legend});X.append(this._legendLabel);this._legendContents=$("<div/>",{css:{"float":"right"}});X.append(this._legendContents);var K=$("<div/>",{css:{clear:"right"}});X.append(K);this._legend.append(X)}ae.append(this._legend);K=$("<div/>",{css:{clear:"left"}});ae.append(K);this.setTrackingIcons();var B=[];var W=WH.getHash();if(W.indexOf("#show:")!=-1){B=W.split(".")}else{if(this.data.instance){B.push("#show:boss")}}if(B.length>0){if(B.length==2&&B[1]=="map"){this.expanded=true;this.mapper.toggleZoom()}var S=B[0].split(":");if(S.length<2){return}var ac=this._menu;for(var Y=1;Y<S.length;++Y){var af=S.length-1;for(var U=0;U<ac.length;++U){if(ac[U][0]==S[Y]){if(ac[U][3]&&Y<af){ac=ac[U][3]}else{ac=ac[U]}break}}}if(ac&&ac[2]&&jQuery.isFunction(ac[2])){ac[2]()}}};ShowOnMap.prototype.setTrackingIcons=function(){var r=this.mapper.parent;var F={repair:"repair",auctioneer:"auctioneer",banker:"banker",battlemaster:"battlemaster",innkeeper:"inn",guildmaster:"guild",stablemaster:"stablemaster",flightmaster:"flightmaster",trainer:"trainer-profession",vendor:"vendor-food",quest:"quest",daily:"daily",anvil:"blacksmithing",herb:"herbalism",vein:"mining",book:"trainer-class",forge:"smelting",spirithealer:"spirithealer",boss:"boss",rare:"hostile-npc",vignettes:"resource",treasure:"treasure",mailbox:"mailbox"};var p=[{name:LANG.types[1][2],icons:["repair","auctioneer","banker","battlemaster","innkeeper","guildmaster","stablemaster","flightmaster","trainer","vendor","spirithealer","boss","rare"],elements:[]},{name:LANG.types[5][2],icons:["quest","daily"],elements:[]},{name:l_guide_categories[2],icons:["anvil","herb","vein","book","forge"],elements:[]},{name:LANG.loot,icons:["vignettes","treasure"],elements:[]},{name:LANG.other,icons:["mailbox"],elements:[]}];var b=this._trackingIcons;b.sort(function(k,j){return WH.stringCompare(k[0],j[0])});for(var v=1;v<b.length;v++){if(b[v][0]==b[v-1][0]){var s={};for(var w in b[v][1]){if(!b[v][1].hasOwnProperty(w)){continue}s[w]=b[v][1][w]}for(w in b[v-1][1]){if(!b[v-1][1].hasOwnProperty(w)){continue}if(!s.hasOwnProperty(w)){s[w]=b[v-1][1][w]}else{s[w]=s[w].concat(b[v-1][1][w])}}b[v-1][1]=s;var C={};for(var g in b[v][2]){if(!b[v][2].hasOwnProperty(g)){continue}C[g]=b[v][2][g]}for(g in b[v-1][2]){if(!b[v-1][2].hasOwnProperty(g)){continue}C[g]=b[v-1][2][g]}b[v-1][2]=C;b.splice(v--,1)}}b.sort(function(k,j){return WH.stringCompare(LANG.som[k[0]],LANG.som[j[0]])});var f=WH.ce("div",{className:"mapper-legend-icons"});for(var E=0,t;t=b[E];E++){if(!F.hasOwnProperty(t[0])){continue}var B=WH.ce("div");B.className="mapper-legend-icon "+F[t[0]];B.setAttribute("data-legend-icon",t[0]);B.onmousedown=WH.rf;if(t[1]){var c=[t[0]];if(t[0]!="vignettes"&&t[0]!="treasure"){c.splice(0,0,-2)}WH.aE(B,"click",this.showStuff.bind(this,t[1],c,t[2],B))}if(t[3]){Menu.add(B,t[3],{showAtElement:true})}WH.Tooltip.simpleNonTouch(B,LANG.som[t[0]]);var o=false;for(var D=0,q;q=p[D];D++){if(q.icons.indexOf(t[0])>-1){o=true;p[D].elements.push(B);break}}if(!o){if(typeof console!="undefined"&&typeof console.error=="function"){console.error("Could not find group for "+t[0]+" icon!")}}}for(var A=0,H;H=p[A];A++){if(H.elements.length){var n=WH.ce("div",{className:"mapper-legend-icons-group"});var h=WH.ce("div",{className:"mapper-legend-icons-heading",innerHTML:H.name});var u=WH.ce("div",{className:"mapper-legend-icons-icons"});if(H.style){for(var z in H.style){if(H.style.hasOwnProperty(z)){n.style[z]=H.style[z]}}}for(var y=0,G;G=H.elements[y];y++){WH.ae(u,G)}WH.ae(n,h);WH.ae(n,u);WH.ae(f,n)}}var d=WH.ce("div",{className:"mapper-legend-icons-tip",innerHTML:LANG.mapper_clickicon});$("> span:first-child",this.mapper.parent).append(d);WH.ae(r,f);r.className+=" mapper-autoheight"};ShowOnMap.prototype.setLegend=function(g){this._legendContents.empty();var h=$("<div/>");var d=0;for(var c in g){var f=$("<span/>",{"class":("mapper-pin mapper-pin-"+c+" mapper-legend-pin")});if(g[c][1]){var b=$("<a/>",{href:g[c][1],text:g[c][0]});f.append(b)}else{f.text(g[c][0])}h.append(f);if((++d)%4==0){h.append($("<br/>"))}}this._legendContents.append(h)};ShowOnMap.prototype.showStuff=function(g,h,c){if(WH.isEqualSimpleObject(h,this.currentPath)){this.showStuff.call(this,[],[-1],{});return}Menu.hide();var b=false;for(var d=0,f;f=h[d];d++){if(typeof f!="string"){continue}var k=$('[data-legend-icon="'+f+'"]');if(k.length){k.parents(".mapper-legend-icons").find(".mapper-legend-icon").removeClass("active");k.addClass("active");b=true;break}}if(!b){$(".mapper-legend-icon",this.mapper.parent).removeClass("active")}var j={coords:g,preservelevel:true};if((typeof g_pageInfo!="undefined")&&g_pageInfo.hasOwnProperty("id")){j.zone=g_pageInfo.id}this.mapper.update(j);this.setLegend(c);this.checkMenu(h);this.currentPath=h;if((h.length==1&&h[0]==-1)||(h[0]==-2)){this.pound="";WH.clearHash();return}this.pound="#show:"+h.join(":");if(this.pound!="#show:boss"){location.replace(this.pound+(this.expanded?".map":""))}};ShowOnMap.prototype.clearChecks=function(c){for(var b=0;b<c.length;++b){c[b].checked=false;if(c[b][3]&&c[b][3].length>0){this.clearChecks(c[b][3])}}this._legend.hide()};ShowOnMap.prototype.checkMenu=function(m){this.clearChecks(this._menu);if(m[0]!=-1){this._legend.show()}else{this._legend.hide()}var b=this._menu;var k=[];for(var d=0;d<m.length;++d){for(var c=0;c<b.length;++c){if(b[c][0]==m[d]){b[c].checked=true;k.push([b[c][0],b[c][1]]);b=b[c][3];break}}}if(m[0]==-2){k.push([m[1],LANG.som[m[1]]])}var f=k.length-1;var g="";var h={rare:true,herb:true,vein:true};for(var d=0;d<k.length;++d){if(d>0&&h[k[0][0]]){var l=$("span",this._legendContents);l.removeClass("mapper-legend-pin");l.append($("<b/>",{text:" "+k[d][1].substr(k[d][1].lastIndexOf("("))}))}else{if(d==f){g+="<span>"}else{g+='<span class="breadcrumb-arrow">'}g+=k[d][1]+"</span>"}}this._legendLabel.html(g)};ShowOnMap.combinePins=function(u,A,g){var h={};var r=null,b=null;var l,k;var w=0;var d=function(B,n){var c=Math.floor(B[0]);var p=Math.floor(B[1]);if(!n){if(c%2==1){c+=1}if(p%2==1){p+=1}}if(h[c]===undefined){h[c]={}}if(h[c][p]===undefined){h[c][p]=[]}return[c,p]};for(var o=0;o<u.length;++o){var j=u[o];if(A){if(!j.quests){continue}var s=true;for(var q=0;q<j.quests.length;++q){if(j.quests[q].daily){s=false;break}}if(s){continue}}else{if(g){r=d([j.id,0],true);l=r[0];k=r[1];var f=WH.dO(j);f.coord=j.coords[0];h[l][k].push(f);w++;continue}}if(j.point=="start"||j.point=="end"){r=d(j.coord);l=r[0];k=r[1];if(h[l][k].length>3){var v=h[l][k];h[l][k]=[];for(var t=0;t<v.length;++t){b=d(v[t].coord,true);h[b[0]][b[1]].push(v[t])}}h[l][k].push(j);w++}else{for(var z=0;z<j.coords.length;++z){r=d(j.coords[z]);l=r[0];k=r[1];var f=WH.dO(j);f.coord=j.coords[z];if(h[l][k].length>3){var v=h[l][k];h[l][k]=[];for(var t=0;t<v.length;++t){b=d(v[t].coord,true);h[b[0]][b[1]].push(v[t])}}h[l][k].push(f);w++}}}var m=[];for(l in h){for(k in h[l]){m.push({coord:[h[l][k][0].coord[0],h[l][k][0].coord[1]],level:h[l][k][0].level,list:h[l][k]})}}return[m,w]};ShowOnMap.buildTooltip=function(v,y){var s="";var h="";var c=[];var w=-1;var f={};var g=0;var b={};var m=1;for(var r=0;r<v.length;++r){var j=v[r];h=(g_types[j.type]&&j.id?"/"+g_types[j.type]+"="+j.id:"");var A=h+j.item;var k=h+j.point;if(!f[A]){f[A]={url:h,obj:j,coords:[j.coord],all:[j]};g++}else{if(!b[k]){f[A].all.push(j)}f[A].coords.push(j.coord)}b[k]=1}var r=0;for(var A in f){var h=f[A].url;var d=f[A].all;var j=f[A].obj;var u=f[A].coords;if(r>0){s+="<br />"}c.push([r++,j.name,h]);m=j.type;if(!j.point){if((j.reacthorde==1&&j.reactalliance<1)||j.side==2){if(w==2||w==-1){w=2}else{w=0}}else{if((j.reactalliance==1&&j.reacthorde<1)||j.side==1){if(w==3||w==-1){w=3}else{w=0}}else{w=0}}}s+='<b class="q'+(w==2?" icon-horde":"")+(w==3?" icon-alliance":"")+'">'+j.name+"</b>";if(u.length>0){s+=" ("+u[0][0]+", "+u[0][1]+")<br />"}if(j.quests){if(j.quests.length>1){s+=LANG.som_startsquestpl}else{s+=LANG.som_startsquest}s+='<div class="indent">';for(var l=0;l<j.quests.length;++l){var t=j.quests[l];if(y&&!t.daily){continue}s+='<span class="q0">['+t.level+"]</span> "+t.name+((t.series&&!t.first)?'<sup style="font-size: 8px">(*)</sup>':"")+((t.category<0&&g_quest_sorts[t.category])?' <i class="q0">'+g_quest_sorts[t.category]+"</i>":"")+"<br />"}s+="</div>"}else{if(j.description){s+=j.description+"<br />"}else{if(j.point){for(var r=0;r<d.length;++r){var p=d[r];switch(p.point){case"start":s+=LANG.mapper_startsquest+"<br />";if(w=="end"){w="startend"}else{if(w!="startend"){w="start"}}break;case"end":s+=LANG.mapper_endsquest+"<br />";if(w=="start"){w="startend"}else{if(w!="startend"){w="end"}}break;case"sourcestart":s+=LANG.mapper_sourcestart+"<br />";s+='<div class="indent">'+p.item+"</div>";if(w=="end"){w="startend"}else{if(w!="startend"){w="start"}}break;case"sourceend":s+=LANG.mapper_sourceend+"<br />";s+='<div class="indent">'+p.item+"</div>";if(w=="start"){w="startend"}else{if(w!="startend"){w="end"}}break;case"requirement":s+=LANG.mapper_requiredquest+"<br />";if(w==-1){w=p.objective}break;case"sourcerequirement":s+=LANG.mapper_sourcereq+"<br />";s+='<div class="indent">'+p.item+"</div>";if(w==-1){w=p.objective}break}}}}}}s+='<div class="q2">';if(v.length==1){s+=(v[0].type==1?LANG.som_viewnpc:(v[0].type==2?LANG.som_viewobj:""))}else{if(g==1){s+=(m==1?LANG.som_viewnpc:(m==2?LANG.som_viewobj:""))}else{s+="<br />"+LANG.som_view}}s+="</div>";var z=[];z.push(s);z.push(w);if(v.length==1||g==1){z.push(h);z.push(null)}else{z.push("javascript:;");z.push(c)}return z};(function(g){var n=3;var l=new Array();var c=2650;var d=g("<audio />").get(0),b=g_staticUrl+"/sfx/wsa.wav",h=1,q=0,m=3,o;function f(r,t){if(t<=0){if(r==true||r=="true"){g("#wsa-overflow").fadeOut(1000,function(){g("#wsa-overflow").remove();h=1})}else{g("#wsa-overflow").remove();h=1}clearInterval(o)}return(t-1)}function p(r,u,s){var v=new Date();v.setDate(v.getDate()+s);var t=escape(u)+((s==null)?"":"; expires="+v.toUTCString());document.cookie=r+"="+t}function k(s){var t,r,v,u=document.cookie.split(";");for(t=0;t<u.length;t++){r=u[t].substr(0,u[t].indexOf("="));v=u[t].substr(u[t].indexOf("=")+1);r=r.replace(/^\s+|\s+$/g,"");if(r==s){return unescape(v)}}}function j(){for(key in l){clearTimeout(l[key])}}g(function(){g("body").delegate(".wsa-vol","click",function(){g(this).toggleClass("alt");if(g(this).hasClass("alt")==true){g.post("/account=setsound",{muted:1})}else{g.post("/account=setsound",{muted:0})}}).delegate(".wsa-notification","mouseover mouseout",function(r){if(r.type=="mouseover"){j();g(".wsa-notification").stop();g(this).css("z-index",1500000);if(g(this).attr("data-animated")=="true"){g(".wsa-notification").fadeTo(100,1)}}else{g(this).css("z-index",999999);if(g(this).attr("data-persistent")!="true"){g(".wsa-notification").each(function(t,s){var u=g(this).attr("id");if(g(this).attr("data-animated")=="true"){l[u]=setTimeout("$('#"+u+"').fadeOut(3000,function(){ $('#"+u+"').remove(); })",1000)}else{l[u]=setTimeout("$('#"+u+"').remove()",3000)}})}}}).delegate(".wsa-notification","click",function(r){if(!(g(r.target).is("a")||g(r.target).hasClass("wsa-vol"))){g(this).remove()}})});g.fn.wsaNotification=function(t){var v={caption:"??? No name",rank:1,href:"/user#achievements",animate:true,playsfx:true,desc:"",persist:false};var t=g.extend(v,t);var z=g("body").children("#wsa-overflow").length;var s=g("body").children(".wsa-notification").length;if(s<n&&z==0){var y=new Date(),y="wsan"+y.getTime();if(s!=(q%n)){q=0}var u=!t.playsfx;var w=t.rank==0?LANG.newprivilege:WH.sprintf(LANG.achievementunlocked_format,l_achievement_qualities[t.rank]);var r='<div class="wsa-notification" data-animated="'+t.animate+'" data-persistent="'+t.persist+'" style="bottom: '+(((q%n)*125)+15).toString()+'px" id="'+y+'"><em></em><ins></ins><span class="wsar'+t.rank+'"></span><div><var><i>'+w+'</i><a title="'+t.desc+'" href="'+t.href+'">'+LANG.viewdetails+" &rarr;</a></var>"+WH.getImitationHeading(t.caption,2,{asString:true})+'</div><div class="wsa-vol'+(u?" alt":"")+'"></div></div>';g("body").prepend(r);if(t.playsfx==true||t.playsfx=="true"){if(!g(d).attr("src")){g(d).attr("src",b)}if(d.play){d.play()}else{g(".wsa-sound").remove();g("body").append('<embed class="wsa-sound" src="'+b+'" autostart="true" hidden="true" loop="false" />')}}if(t.animate==true||t.animate=="true"){g("#"+y+" em").css("filter","");g("#"+y+" em").fadeOut(750,function(){g("#"+y+" em").remove()});g("#"+y+" ins").delay(250).animate({marginLeft:"355px",opacity:0},750,function(){g(this).remove();if(!t.persist){l[y]=setTimeout("$('#"+y+"').fadeOut(3000,function(){ $('#"+y+"').remove(); })",c)}})}else{g("#"+y+" em").remove();g("#"+y+" ins").remove();if(!t.persist){l[y]=setTimeout("$('#"+y+"').remove()",c+1000)}}q++}else{var r='<div class="wsa-overflow" id="wsa-overflow" style="bottom: '+0+'px"><a href="/user">'+WH.sprintf(LANG.wsamore_format,1)+"</a></div>";if(z==0){g("body").prepend(r);m=3;if(t.animate==true||t.animate=="true"){g("#wsa-overflow").slideDown()}else{g("#wsa-overflow").show()}o=setInterval(function(){m=f(t.animate,m)},1000)}else{m=3;h++;g("#wsa-overflow b").text(h)}}}})(jQuery);function AchievementCheck(){$.ajax({cache:false,url:"/ajax-achievement-check",type:"POST",success:function(data){if(data){eval("("+data+")")}}})}var Slider=new function(){var c,p,l;function o(r){r=WH.normalizeEvent(r);p=this;c=WH.getCursorPos(r);WH.aE(document,"mousemove",d);WH.aE(document,"mouseup",k);return false}function d(t){t=WH.normalizeEvent(t);if(!c||!p){return}var u=WH.getCursorPos(t),v=u[p._dir]-c[p._dir],s=q(p,p._pos+v),r=b(p);if(r&&p.input){p.input.value=r.value}if(!s){c=u}if(p.onMove){p.onMove(t,p,r)}}function k(r){r=WH.normalizeEvent(r);if(p.onMove){p.onMove(r,p,b(p))}p=null;c=null;WH.dE(document,"mousemove",d);WH.dE(document,"mouseup",k);return false}function n(u,t){t=WH.normalizeEvent(t);p=u;c=WH.getCursorPos(t);var v=WH.ac(p.parentNode),s=Math.floor(f(p)/2);q(p,c[p._dir]-v[p._dir]-s);var r=b(p);if(r&&p.input){p.input.value=r.value}if(p.onMove){p.onMove(t,p,r)}WH.aE(document,"mousemove",d);WH.aE(document,"mouseup",k);return false}function j(s,r){if(l){clearTimeout(l)}if(r.type=="change"||r.type=="keypress"&&r.which==13){m(s,r)}else{l=setTimeout(m.bind(0,s,r),1000)}}function m(u,t){var s=u.input.value,r=b(u);if(isNaN(s)){s=r.value}if(s>u._max){s=u._max}if(s<u._min){s=u._min}Slider.setValue(u,s);if(u.onMove){u.onMove(t,u,b(u))}}function q(t,u){var s=false;var r=h(t);if(u<0){u=0;s=true}else{if(u>r){u=r;s=true}}t.style[(t._dir=="y"?"top":"left")]="calc("+(parseFloat(u)/r*100)+"% - "+parseInt(f(t)/2)+"px)";t._pos=u;return s}function h(r){return g(r)-f(r)+2}function b(u){var s=u._pos/h(u),t=Math.round((s*(u._max-u._min))+u._min),r=[s,t];r.percent=s;r.value=t;return r}function g(r){if(r._tsz>0){return r._tsz}if(r._dir=="y"){return r.parentNode.offsetHeight}return r.parentNode.offsetWidth}function f(r){if(r._hsz>0){return r._hsz}if(r._dir=="y"){return r.offsetHeight}return r.offsetWidth}this.setPercent=function(s,r){q(s,r*h(s))};this.setValue=function(s,r){if(r<s._min){r=s._min}else{if(r>s._max){r=s._max}}if(s.input){s.input.value=r}this.setPercent(s,(r-s._min)/(s._max-s._min))};this.setSize=function(u,s){var t=b(u),r=h(u);u.parentNode.style[(u._dir=="y"?"height":"width")]=s+"px";if(r!=h(u)){this.setValue(u,t.value)}};this.init=function(s,u){var v=WH.ce("a");v.href="javascript:;";v.onmousedown=o;v.className="handle";var r=WH.ce("a");r.href="javascript:;";r.onmousedown=n.bind(0,v);r.className="track";WH.ae(s,WH.ce("span"));WH.ae(s,r);WH.ae(s,v);v._dir="x";v._min=1;v._max=100;v._pos=0;v._tsz=0;v._hsz=0;if(u!=null){if(u.direction=="y"){v._dir="y"}if(u.minValue){v._min=u.minValue}if(u.maxValue){v._max=u.maxValue}if(u.onMove){v.onMove=u.onMove}if(u.trackSize){v._tsz=u.trackSize}if(u.handleSize){v._hsz=u.handleSize}if(u.showLabels!==false){var t=WH.ce("div");t.innerHTML=v._min;t.className="label min";WH.ae(s,t);t=WH.ce("div");t.innerHTML=v._max;t.className="label max";WH.ae(s,t);v.input=WH.ce("input");$(v.input).attr({value:v._max,type:"text"}).bind("click",function(){this.select()}).keypress(function(z){var w=[];var y=z.which;for(i=48;i<58;i++){w.push(i)}if(!(WH.inArray(w,y)>=0)&&y!=13){z.preventDefault()}}).bind("keyup keydown change",j.bind(0,v));v.input.className="input";WH.ae(s,v.input)}}s.className="slider-"+v._dir+(u==null||u.showLabels!==false?" has-labels":"");return v}};var suDialog;function su_addToSaved(b,g,d,f){if(!b){return}if(!suDialog){suDialog=new Dialog()}var c=function(k){var j=WH.getWowheadCookie("compare_groups"),h="/compare";if(k.action>1){if(j){b=j+";"+b}WH.setWowheadCookie("compare_groups",b,true);if(f){WH.setWowheadCookie("compare_level",f,true)}}else{h+="?items="+b+(f?"&l="+f:"")}if(k.action<3){if(d){window.open(h)}else{location.href=h}}};suDialog.show("docompare",{data:{selecteditems:g,action:1},onSubmit:c})}Dialog.templates.docompare={title:LANG.dialog_compare,width:400,buttons:[["check",LANG.ok],["x",LANG.cancel]],fields:[{id:"selecteditems",type:"caption",compute:function(d,c,b,f){f.innerHTML=WH.sprintf((c==1?LANG.dialog_selecteditem:LANG.dialog_selecteditems),c)}},{id:"action",type:"radio",label:"",value:3,submitOnDblClick:1,options:{1:LANG.dialog_nosaveandview,2:LANG.dialog_saveandview,3:LANG.dialog_saveforlater}}]};function Tabs(b){WH.cO(this,b);if(this.parent){this.parent=WH.ge(this.parent)}else{return}this.selectedTab=-1;this.ul=null;this.tabs=[];this.nShows=0;if(this.maxRows==null&&Platform.getViewportWidth()<768){this.maxRows=4}if(this.poundable==null){this.poundable=1}this.poundedTab=null;if(this.onLoad==null){this.onLoad=Tabs.onLoad.bind(this)}if(this.onShow==null){this.onShow=Tabs.onShow.bind(this)}if(this.onHide){this.onHide=this.onHide.bind(this)}this.trackClick=Tabs.trackClick.bind(this)}Tabs.prototype={add:function(b,f){var d,c=this.tabs.length;d={caption:b,index:c,owner:this};WH.cO(d,f);this.tabs.push(d);if(this.ul){var g=this.createTab(d);WH.ae(this.ul,g)}return c},hide:function(d,g){if(this.tabs[d]){var c=this.selectedTab;if(d==0&&c==-1){this.poundedTab=this.selectedTab=c=0}if(d!=this.poundedTab){this.selectedTab=-1}this.tabs[d].hidden=!g;this.flush();if(!g&&d==c){this.selectedTab=c;for(var f=0,b=this.tabs.length;f<b;++f){if(f!=d&&!this.tabs[f].hidden){return this.show(f,1)}}}}},unlock:function(d,b){if(this.tabs[d]){this.tabs[d].locked=b;c=WH.gE(this.ul,"a");$(".fa-lock",c[d]).remove();if(b){$("div, b",c[d]).prepend('<span class="fa fa-lock" />')}var c=location.hash.substr(1).split(":")[0];if(this.tabs[d].id==c){this.show(d,1)}}},focus:function(b){if(b<0){b=this.tabs.length+b}this.forceScroll=1;WH.gE(this.ul,"a")[b].onclick({},true);this.forceScroll=null},show:function(c,d,g){var b;if(isNaN(c)||c<0){c=0}else{if(c>=this.tabs.length){c=this.tabs.length-1}}if((d==null&&c==this.selectedTab)||this.tabs[c].hidden){return}if(this.tabs[c].locked){return this.onShow(this.tabs[c],this.tabs[this.selectedTab])}if(this.selectedTab!=-1){b=this.tabs[this.selectedTab];if(this.onHide&&!this.onHide(b)){return}if(b.onHide&&!b.onHide()){return}}++this.nShows;b=WH.gE(this.ul,"a");if(this.selectedTab!=-1){b[this.selectedTab].className=""}b[c].className="selected";if(this.maxRows){var f=function(h){var j=$(h).parent().siblings(".tab-responsive-list");if(j.length){if(h.parentNode.getAttribute("data-responsive-hidden")=="true"){$("a",j).addClass("selected");$("div, b",j).html(this.getMoreTabName(true,$("b",h).html()))}else{$("a",j).removeClass("selected");$("div, b",j).html(this.getMoreTabName(true))}}};if(g){setTimeout(f.bind(this,b[c]),250)}else{f.call(this,b[c])}}b=this.tabs[c];if(b.onLoad){b.onLoad();b.onLoad=null}this.onShow(this.tabs[c],this.tabs[this.selectedTab]);if(b.onShow){b.onShow(this.tabs[this.selectedTab])}this.selectedTab=c},flush:function(g){var c;var b=WH.ce("div");b.className="tabs-container";var j="ul";this.ul=WH.ce(j);this.ul.className="tabs";WH.ae(b,this.ul);for(var d=0;d<this.tabs.length;++d){var h=this.tabs[d];var f=this.createTab(h);WH.ae(this.ul,f)}WH.ee(this.parent);WH.ae(this.parent,b);if(this.onLoad){c=this.onLoad();if(c!=null){this.poundedTab=g=c}}this.show(g,null,true);if(this.maxRows){setTimeout((function(){this.collapseExtraTabs()}).bind(this),1)}},createTab:function(k){var h,c,g;h=WH.ce("li");c=WH.ce("b");var f=WH.ce("a");if(k.className){h.className=k.className}if(k.hidden){h.style.display="none"}if(this.poundable&&!k.noPound){f.href="#"+k.id}else{f.href="javascript:;"}WH.disableOldIESelect(f);if(k.menu){Menu.add(f,k.menu,{showAtElement:true,onShow:k.onShowMenu,onHide:k.onHideMenu})}else{f.onclick=Tabs.onClick.bind(k,f)}var j=WH.ce("div");if(k.locked){g=WH.ce("span",{className:"fa fa-lock"});WH.ae(j,g)}else{if(k.icon){g=WH.ce("span",{classname:"icontiny"});g.style.backgroundImage="url("+g_staticUrl+"/images/wow/icons/tiny/"+k.icon.toLowerCase()+".gif)";WH.ae(j,g)}else{if(k.image){g=WH.ce("img");$.extend(g,k.image);WH.ae(j,g)}else{if(k.fontIcon){g=WH.ce("i",{className:"fa fa-"+k.fontIcon});WH.ae(j,g)}}}}if(k.tooltip){f.onmouseover=(function(b,d){WH.Tooltip.showAtCursor(d,b,0,0,"q")}).bind(f,k.tooltip);f.onmousemove=WH.Tooltip.cursorUpdate;f.onmouseout=WH.Tooltip.hide}if(k["class"]){j.className=k["class"]}WH.ae(j,WH.ct(k.caption));WH.ae(f,j);if(k.locked){g=WH.ce("span",{className:"fa fa-lock"});WH.ae(c,g)}else{if(k.icon){g=WH.ce("span",{className:"icontiny"});g.style.backgroundImage="url("+g_staticUrl+"/images/wow/icons/tiny/"+k.icon.toLowerCase()+".gif)";WH.ae(c,g)}else{if(k.image){g=WH.ce("img");$.extend(g,k.image);WH.ae(c,g)}else{if(k.fontIcon){g=WH.ce("i",{className:"fa fa-"+k.fontIcon});WH.ae(c,g)}}}}WH.ae(c,WH.ct(k.caption));WH.ae(f,c);WH.ae(h,f);return h},collapseExtraTabs:function(){var g=$(this.ul);var o=g.find("> li:first-child").outerHeight(true);if(g.height()>o*this.maxRows){var h=$("> li",g);var l=[];var d=[];var m=this.maxRows;h.each(function(r){var s=$(this);var q=s.position();if(q.top>(o*m)-o){d.push(s)}else{l.push(s);while(l.length>2){l.shift()}}});while(d.length>0&&l.length>0){d.unshift(l.pop())}var j=h.length-d.length;var c=[];var n=/<img[^>]+src="([^">]*)"[^>]*>\s*/;for(var f=0,k;k=d[f];f++){k.attr("data-responsive-hidden","true");var b=[f,$("b",k).html(),(function(q){$("a",q).trigger("click");if(Platform.getViewportWidth()<768){$("html, body").animate({scrollTop:$(this.ul).offset().top-42},150)}}).bind(this,k),null,{checkedFunc:(function(q){return this.selectedTab==q}).bind(this,f+j)}];var p=b[MENU_IDX_NAME].match(n);if(p){b[MENU_IDX_OPT].icon=p[1]}b[MENU_IDX_NAME]=b[MENU_IDX_NAME].replace(/<[^>]*>/,"");c.push(b)}this.add(this.getMoreTabName(false),{className:"tab-responsive-list",fontIcon:"bars",menu:c,onShowMenu:(function(){$(this.currentTabContents).addClass("tab-fade")}).bind(this),onHideMenu:(function(){$(".tab-fade").removeClass("tab-fade")}).bind(this),noPound:false})}},getMoreTabName:function(c,d){var b=c?'<i class="fa fa-bars"></i>':"";if(d){b+=" &ndash; "+d}return b},setTabName:function(d,c){this.tabs[d].caption=c;var b=WH.gE(this.ul,"a");WH.setTextNodes(b[d],c)},setTabPound:function(d,b){if(!this.poundable){return}var c=WH.gE(this.ul,"a");c[d].href="#"+this.tabs[d].id+(b?":"+b:"")},setTabTooltip:function(c,d){this.tabs[c].tooltip=d;var b=WH.gE(this.ul,"a");if(d==null){b[c].onmouseover=b[c].onmousemove=b[c].onmouseout=null}else{b[c].onmouseover=function(f){WH.Tooltip.showAtCursor(f,d,0,0,"q2")};b[c].onmousemove=WH.Tooltip.cursorUpdate;b[c].onmouseout=WH.Tooltip.hide}},getSelectedTab:function(){return this.selectedTab},getTabById:function(d){for(var c=0,b=this.tabs.length;c<b;++c){if(this.tabs[c].id==d){return c}}}};Tabs.onClick=function(b,g,f){if(f==null&&this.index==this.owner.selectedTab){return}var d=WH.rfWithoutControlKey(g);if(d==null){return}Menu.hide();this.owner.show(this.index,f);if(this.owner.poundable&&!this.locked){var c=b.href.indexOf("#");c!=-1&&location.replace(b.href.substr(c))}return d};Tabs.onLoad=function(){if(!this.poundable||!location.hash.length){return}var b=location.hash.substr(1).split(":")[0];if(b){return WH.inArray(this.tabs,b,function(c){if(!c.locked){return c.id}})}};Tabs.onShow=function(g,f){if(g.hidden||g.locked){return}if(f){WH.ge("tab-"+f.id).style.display="none"}if(this.poundedTab!=null||f){this.trackClick(g)}var d=WH.ge("tab-"+g.id);d.style.display="";this.currentTabContents=d;WH.Tools.Bloodmallet.updateChartsSizes(d);if(((this.nShows==1&&this.poundedTab!=null&&this.poundedTab>=0)||this.forceScroll)&&!this.noScroll){var c,b;if(this.__st){c=this.__st;b=15}else{c=d;b=this.parent.offsetHeight+15}setTimeout(WH.scrollTo.bind(null,c,b),10)}};Tabs.trackClick=function(b){if(!this.trackable||b.tracked){return}WH.Track.interactiveEvent("Tabs","Show",this.trackable+": "+b.id);b.tracked=1};WH.Tools=new function(){};WH.Track=new function(){var g=10000;var f=10;this.addClickEvents=function(o,k,t){if(!k||!k.actions||!k.category){if(WH.isDev()){WH.log("Tried to add analytics event without appropriate parameters.");WH.log(o);WH.log(k)}return}var l=k.category;var s=WH.gE(o,"a");for(var p=0,r;r=s[p];p++){var m="Follow link";for(var n in k.actions){if(k.actions.hasOwnProperty(n)&&k.actions[n]&&k.actions[n](r)){m=n;break}}var q=(t?t+"-":"")+c(r);$(r).click(WH.Track.interactiveEvent.bind(null,l,m,q))}};this.interactiveEvent=function(k,m,j,l){d(k,m,j,l)};this.linkClick=function(m,o,l,j,n){if(!b()){if(j){j()}return true}if(arguments[arguments.length-1] instanceof MouseEvent){n=arguments[arguments.length-1]}var p=m.target;if(n){if(n.which==2||n.shiftKey||n.ctrlKey||(window.navigator&&["MacIntel","Macintosh","MacPPC","Mac68K"].indexOf(window.navigator.platform)>-1&&n.metaKey)){p="_blank"}}if(typeof o=="function"){o=o(m)}if(typeof l=="function"){l=l(m)}WH.debug("Track Click:",o,l,m.href);var k=ga.bind(null,"send","event",o,"click",l,m.href,{transport:"beacon",hitCallback:(function(r,s,q){if(q){q()}else{if(s&&window.open){window.open(r,s)}else{document.location=r}}}).bind(null,m.href,p,j)});if(l&&l.indexOf("News - View Article")==0){ga("send","event","News","View full version",WH.news.getSubjectFromChild(m),{hitCallback:k,nonInteraction:1,transport:"beacon"})}else{k()}return false};this.nonInteractiveEvent=function(k,m,j,l){d(k,m,j,l,true)};this.setLinkClickEvent=function(k,l,j){if(!k.href||k.href.indexOf("javascript:")===0){return}k.onclick=WH.Track.linkClick.bind(null,k,l,j,k.onclick)};function b(){return !!(typeof ga==="function"&&window.ga&&ga.create)}function c(j){var l="unknown";var k=WH.getFirstTextContent(j);if(k){l=WH.urlize(k)}else{if(j.title){l=WH.urlize(j.title)}else{if(j.id){l=WH.urlize(j.id)}}}return l}function h(){var k={"database-logo":{category:"Homepage Logo",actions:{"Click image":function(m){return true}}},"database-featuredbox":{category:"Featured Box",actions:{"Follow link":function(m){return(m.parentNode.className!="database-featuredbox-links")},"Click image":function(m){return(m.parentNode.className=="database-featuredbox-links")}}},"database-oneliner":{category:"Oneliner",actions:{"Follow link":function(m){return true}}},"sidebar-container":{category:"Page sidebar",actions:{"Click image":function(m){return true}}},"header-promo":{category:"Page header",actions:{"Click image":function(m){return true}}}};for(var l in k){var j=WH.ge(l);if(j){WH.Track.addClickEvents(j,k[l])}}}function d(k,m,j,l,o,n){WH.debug("Track Event:",k,m,j,l,o,n);if(!b()){if(WH.isDev()){return}if(!n){n=0}n++;if(n*f>g){return}setTimeout(d.bind(null,k,m,j,l,o,n),f);return}if(typeof o==="boolean"){ga("send","event",k,m,j,l,{nonInteraction:o?1:0})}else{ga("send","event",k,m,j,l)}}$(h)};WH.Url=new function(){this.addGet=function(f,b,d){if(f instanceof Location){f=""+f}if(typeof f!=="string"){WH.error("Tried to add a get arg to a non-string!",f,b,d)}if(f.substr(-12)==="wowhead.com/"){f+="home"}var c=b+"\\b(=*[^&]+)?";if(f.indexOf("?"+b)>-1){f=f.replace(new RegExp("\\?"+c),"")}if(f.indexOf("&"+b)>-1){f=f.replace(new RegExp("&"+c),"")}return f+(f.indexOf("?")===-1&&f.indexOf("&")===-1?"?":"&")+b+(d?"="+d:"")};this.constructQueryString=function(c){var b=[];for(var d in c){if(!c.hasOwnProperty(d)){continue}if(c[d]===""){b.push(d)}else{if(typeof c[d]==="string"||typeof c[d]==="number"){b.push(d+"="+c[d])}else{b.push(d+"="+JSON.stringify(c[d]))}}}return b.join("&")}};var vi_thumbnails={1:"//i3.ytimg.com/vi/$1/default.jpg"};var vi_siteurls={1:"http://www.youtube.com/watch?v=$1"};var vi_sitevalidation=[/https?:\/\/(?:www\.)?youtube\.com\/watch\?v=([^& ]{11})/i,/https?:\/\/(?:www\.)?youtu\.be\/([^& ]{11})/i];function vi_submitAVideo(){tabsContribute.focus(2)}function vi_validateForm(c){if(!c.elements.videourl.value.length){alert(LANG.message_novideo);return false}var d=false;for(var b in vi_sitevalidation){if(!vi_sitevalidation.hasOwnProperty(b)){continue}if(c.elements.videourl.value.match(vi_sitevalidation[b])){d=true;break}}if(!d){alert(LANG.message_novideo);return false}return true}function vi_appendSticky(){var d=WH.ge("infobox-sticky-vi");if(!d){return}var g=g_pageInfo.type;var f=g_pageInfo.typeId;var k=WH.inArray(lv_videos,1,function(l){return l.sticky});if(k!=-1){d.className="has-thumb";var j=lv_videos[k];var b=WH.ce("a");b.href="#videos:id="+j.id;b.onclick=function(l){VideoViewer.show({videos:lv_videos,pos:k});return WH.rfWithoutControlKey(l)};var c=WH.ce("img");c.src=WH.sprintf(vi_thumbnails[j.videoType].replace(/\/default\.jpg/,"/mqdefault.jpg"),j.videoId);c.className="border";WH.ae(b,c);WH.ae(d,b);var h=$("#infobox-videos");if(!h){h=$("th",$(d).parents().prev("tr"))}h.append(" ("+lv_videos.length+")").wrapInner($('<a href="#videos"></a>').click(function(){tabsRelated.focus(tabsRelated.getTabById("videos"));return false}))}else{if(g_user){var b;if(g_user.id>0){b='<a href="javascript:;" onclick="vi_submitAVideo(); return false">'}else{b='<a href="/account=signin">'}d.innerHTML=WH.sprintf(LANG.infobox_noneyet,b+LANG.infobox_suggestone+"</a>")}else{$("#infobox-videos,#infobox-sticky-vi").closest("td, th").css("display","none")}}vi_appendSticky=function(){}}var g_videos=[];var VideoViewer=new function(){var q,n,r,B,G,b,t=0,v,l,s,c,m,y,z,D,o,w,k;function p(){var J=q[n];var I=Math.max(k.offsetHeight-18,0),H=Math.max(50,Math.min(520,WH.getWindowSize().h-72-I)),K=Math.min(1,H/520);r=Math.round(K*880);B=Math.round(K*520);y.style.height=z.style.height=D.style.height=(B-95)+"px";Lightbox.setSize(Math.max(480,r)+20,B+52+I)}function f(J){var H=q[J],I="#videos:";if(t==0){I+="id="+H.id}else{I+=v+":"+(J+1)}return I}function F(O){if(O&&(G==1)&&WH.getWindowSize().h>s.offsetHeight){return}s.style.visibility="hidden";var H=q[n];p();if(!O){var N=(H.caption!=null&&H.caption.length);WH.Track.interactiveEvent("Videos","Show",H.id+(N?" ("+H.caption+")":""));if(H.videoType==1){m.innerHTML=WH.markup.getHtml("[youtube="+H.videoId+" width="+r+" height="+B+"]")}o.href=WH.sprintf(vi_siteurls[H.videoType],H.videoId);if(!H.user&&typeof g_pageInfo=="object"){H.user=g_pageInfo.username}var M=(H.date&&H.user),L=(q.length>1);if(M){var K=new Date(H.date),Q=(g_serverTime-K)/1000;var P=w.firstChild.childNodes[1];P.href="/user="+H.user;P.innerHTML=H.user;var S=w.firstChild.childNodes[3];WH.ee(S);WH.formatDate(S,Q,K);w.firstChild.style.display=""}else{w.firstChild.style.display="none"}var S=w.childNodes[1];WH.ee(S);S=w.childNodes[2];if(L){var R="";if(H.user){R=LANG.dash}R+=(n+1)+LANG.lvpage_of+q.length;S.innerHTML=R;S.style.display=""}else{S.style.display="none"}w.style.display=(M||L?"":"none");var I=(H.subject!=null&&H.subject.length&&H.type&&H.typeId);if(N||I){var J="";if(I){J+=LANG.types[H.type][0]+LANG.colon;J+='<a href="/'+g_types[H.type]+"="+H.typeId+'">';J+=H.subject;J+="</a>"}if(N){if(I){J+=LANG.dash}J+=H.noMarkup?H.caption:WH.markup.getHtml(H.caption,{mode:WH.markup.MODE.SIGNATURE})}k.innerHTML=J;k.style.display=""}else{k.style.display="none"}if(q.length>1){y.href=f(E(-1));z.href=f(E(1));y.style.display=z.style.display="";D.style.display="none"}else{y.style.display=z.style.display="none";D.style.display=""}location.replace(f(n))}else{$("object, embed",m).each(function(){this.width=r;this.height=B})}Lightbox.reveal();s.style.visibility="visible";setTimeout(j,1)}function E(I){var H=n;H+=I;if(H<0){H=q.length-1}else{if(H>=q.length){H=0}}return H}function A(){n=E(-1);F();return false}function C(){n=E(1);F();return false}function j(){if(l){document.title=l}}function d(H){H=WH.normalizeEvent(H);switch(H.keyCode){case 37:A();break;case 39:C();break}}function h(){F(1)}function g(){WH.ee(m);if(q.length>1){WH.dE(document,"keyup",d)}if(b&&t==0){if(b.indexOf(":id=")!=-1){b="#videos"}WH.setHash(b)}else{WH.clearHash()}j()}function u(P,J,I){if(typeof I.videos=="string"){q=g_videos[I.videos];t=1;v=I.videos}else{q=I.videos;t=0;v=null}s=P;n=0;if(I.pos&&I.pos>=0&&I.pos<q.length){n=I.pos}if(J){P.className+=" has-lightbox-caption screenshotviewer";c=WH.ce("div");c.className="lightbox-content screenshotviewer-screen";var R=WH.ce("div");var M=WH.ce("div");R.className="screenshotviewer-page-wrapper screenshotviewer-prev-wrapper";M.className="screenshotviewer-page-wrapper screenshotviewer-next-wrapper";y=WH.ce("a");z=WH.ce("a");y.className="screenshotviewer-prev";z.className="screenshotviewer-next";y.href="javascript:;";z.href="javascript:;";var K=WH.ce("span");K.className="fa fa-chevron-left";WH.ae(y,K);K=WH.ce("span");K.className="fa fa-chevron-right";WH.ae(z,K);y.onclick=A;z.onclick=C;D=WH.ce("a");D.className="screenshotviewer-cover";D.href="javascript:;";D.onclick=Lightbox.hide;var N=WH.ce("span");var O=WH.ce("b");WH.ae(O,WH.ct(LANG.close));WH.ae(N,O);WH.ae(D,N);WH.ae(R,y);WH.ae(M,z);WH.ae(c,R);WH.ae(c,M);WH.ae(c,D);m=WH.ce("div",{className:"screenshotviewer-image"});WH.ae(c,m);WH.ae(P,c);var L=WH.ce("a");L.className="dialog-x fa fa-times";L.href="javascript:;";L.onclick=Lightbox.hide;WH.ae(L,WH.ct(LANG.close));WH.ae(P,L);o=WH.ce("a");o.className="dialog-arrow fa fa-external-link";o.href="javascript:;";o.target="_blank";WH.ae(o,WH.ct(LANG.original));WH.ae(P,o);var Q=WH.ce("div",{className:"lightbox-caption"});w=WH.ce("div");w.className="screenshotviewer-from";var H=WH.ce("span");WH.ae(H,WH.ct(LANG.lvscreenshot_from));WH.ae(H,WH.ce("a"));WH.ae(H,WH.ct(" "));WH.ae(H,WH.ce("span"));WH.ae(w,H);WH.ae(w,WH.ce("span"));WH.ae(w,WH.ce("span"));WH.ae(Q,w);k=WH.ce("div");k.className="screenshotviewer-caption";WH.ae(Q,k);WH.ae(P,Q)}b=location.hash;if(q.length>1){WH.aE(document,"keyup",d)}F()}this.checkPound=function(){l=$("title").html();if(location.hash&&location.hash.indexOf("#videos")==0){if(!g_listviews.videos){var I=location.hash.split(":");if(I.length==3){var J=g_videos[I[1]],H=parseInt(I[2]);if(J&&H>=1&&H<=J.length){VideoViewer.show({videos:I[1],pos:H-1})}}}}};this.show=function(H){Lightbox.show("videoviewer",{onShow:u,onHide:g,onResize:h},H);return false};$(document).ready(this.checkPound)};var WAS=new function(){var z={defaultChannelGroup:"Other",defaultChannelName:"Other",abTestOptions:["A","B"],abTests:{active:false,bPercent:50},blizzardGracePeriod:1000*60*10,skins:{bodyClass:"skinned",bodyClass3rdParty:"skinned-3rd-party",classPrefix:"skin",linkCount:2},DFP:{directAdvertisers:[24692954,4399774721,4449142733,4450726284,4471825129],refreshRate:90,refreshLimit:80,slots:{standard:{horizontal:{path:"/76136274/Wowhead_Horizontal_ATF",sizes:[[970,90],[970,250],[728,90]]},horizontalBTF:{path:"/76136274/Wowhead_Horizontal_BTF",sizes:[[970,90],[970,250],[728,90]]},vertical:{path:"/76136274/Wowhead_Vertical_ATF",sizes:[[300,600],[160,600],[300,250]]},skin:{path:"/76136274/WH_1x1",sizes:[1,1]}},instart:{horizontal:{path:"/76136274/Wowhead_Horizontal_ATF_Instart",sizes:[[970,90],[970,250],[728,90]]},horizontalBTF:{path:"/76136274/Wowhead_Horizontal_BTF_Instart",sizes:[[970,90],[970,250],[728,90]]},vertical:{path:"/76136274/Wowhead_Vertical_ATF_Instart",sizes:[[300,600],[160,600],[300,250]]},skin:{path:"/76136274/WH_1x1_Instart",sizes:[1,1]}}},maxLogCount:100},units:{horizontal:{applyClasses:{parent:["horizontal-block-bg is-atf"]}},horizontalBTF:{applyClasses:{parent:["horizontal-block-bg is-btf"]}},vertical:{applyClasses:{parent:["vertical-block-bg is-atf"]}},medrec:{applyClasses:{parent:["block-block-bg is-atf"]}},skin:{applyClasses:{parent:["skin-block-bg"]}},mobileFooter:{applyClasses:{parent:["mobile-fixed-footer-block-bg"]}}}};var p={channelGroup:"",channelName:"",pending:[],postSkinSetupCallbacks:[],removed:false,slotsAdded:{},dfpSlots:{},frozenSlots:["skin"],refreshCount:0,refreshInterval:null};this.defined={};this.init=function(C,E,D){WAS.setChannelGroup(E);WAS.setChannelName(C);if(D&&D instanceof Array){WAS.defineAds(D)}};this.getAdSetupDescription=function(){var E=WAS.getProvider();var C=j()==="instart"?"ins":"std";var D=WAS.getSide();return E+"-"+C+"-"+D};this.getSide=function(){if(!z.abTests.active){return"A"}var C="wasAB-"+z.abTests.bPercent;var F=WH.getGets();if(F.abtest&&z.abTestOptions.indexOf(F.abtest.toUpperCase())>-1){var D=F.abtest.toUpperCase();WH.sessionStorage.set(C,D);return D}var E=WH.sessionStorage.get(C);if(z.abTestOptions.indexOf(E)<0){if(Math.random()<z.abTests.bPercent*0.01){E="B"}else{E="A"}WH.sessionStorage.set(C,E)}return E};this.getProvider=function(){return"DFP"};function j(){return typeof I11C!=="undefined"&&I11C.Morph==1?"instart":"standard"}function w(){return z.DFP.refreshLimit}function g(){return z.DFP.refreshRate}this.getConfig=function(C){return z[C]};this.checkInitConditions=function(){return typeof g_user!="undefined"&&typeof Platform!="undefined"};this.showAds=function(){return g_user.ads&&!p.removed};this.setChannelGroup=function(C){p.channelGroup=C};this.setChannelName=function(C){p.channelName=C};this.getChannelGroup=function(){return p.channelGroup||z.defaultChannelGroup};this.getChannelName=function(){return p.channelName||z.defaultChannelName};this.isABActive=function(){return z.abTests.active};this.defineAds=function(C){if(WAS.getProvider()==="DFP"){googletag.cmd.push(function(){var G=0;for(var D=0,E;E=C[D];D++){var F=A(E.type,E.target);if(F){p.dfpSlots[E.type]=F;G++}}if(G>0){googletag.pubads().addEventListener("slotRenderEnded",WAS.slotCallbackDfp);googletag.pubads().enableSingleRequest();googletag.pubads().setTargeting("Channel",WAS.getChannelName());googletag.pubads().setTargeting("ChannelGroup",WAS.getChannelGroup());googletag.enableServices();if(g()){p.refreshInterval=setInterval(function(){var H=w();if(H&&p.refreshCount>=H){clearInterval(p.refreshInterval);return}if(!WAS.showAds()){clearInterval(p.refreshInterval);return}var J=[];for(var I in p.dfpSlots){if(p.frozenSlots.indexOf(I)===-1){J.push(p.dfpSlots[I])}}p.refreshCount++;googletag.pubads().refresh(J)},g()*1000)}}})}};function A(E,F){if(WAS.getProvider()!=="DFP"){return false}if(!WAS.checkCreateConditions(E,F,true)){return false}var D=j();if(!z.DFP.slots[D]||!z.DFP.slots[D][E]){return false}WAS.defined[E]=true;var C=z.DFP.slots[D][E];return googletag.defineSlot(C.path,C.sizes,F).addService(googletag.pubads())}this.create=function(C,D){if(WAS.getProvider()==="DFP"){return d(C,D)}else{return false}};function d(C,D){if(D.zamAdUnitName){return false}if(!WAS.checkCreateConditions(C,D)){if(typeof D==="string"){D=document.getElementById(D)}WAS.remove(D,C);return false}if(typeof D==="string"){D=document.getElementById(D)}if(!D){return false}D.zamAdUnitName=C;googletag.cmd.push(function(){googletag.display(D.id)});return true}this.addPostSkinSetupCallback=function(C){if(typeof C=="function"){p.postSkinSetupCallbacks.push(C)}};function l(D,F,G){var C=G?"block-premium-info":"block-remove";if(["skin","mobileFooter"].indexOf(D)>-1||$("."+C,F).length){return}var E=WH.ce("a",{innerHTML:G?"<b>"+LANG.wowheadPremium+"</b><br>"+LANG.premiumUpgradeTip:LANG.Ads.removeAll,href:"/premium",className:C});WH.ae(F,E)}this.checkCreateConditions=function(F,G,D){if(!D){var C=typeof G=="string"?$("#"+G):$(G);if(C.length&&!C.is(":visible")){return false}}if(WAS.getProvider()==="DFP"){var E=j();if(!z.DFP.slots[E][F]){return false}}switch(F){case"horizontal":case"horizontalBTF":if(!v()){return false}break;case"vertical":if(!k()){return false}break;case"medrec":break;case"mobileFooter":if(!y()){return false}break;case"skin":if(!m()||h()){return false}break;default:WH.error("Unknown ad type! Not displaying",F,"ad.");return false}if(typeof G=="string"&&G.indexOf("mobile")>-1&&!y()){return false}return true};this.addMobileMedrec=function(D){if(!y()){return}if(WH.ge("ad-mobile-medrec")){return}var C=$(D);if(!C.length){return}C.append('<div class="block-block-bg"><div id="ad-mobile-medrec"></div></div>');this.create("medrec","ad-mobile-medrec")};this.slotCallbackDfp=function(F){var G=n(F);if(typeof G!=="string"){WH.error("No slot found in DFP event!",F);B(F,null,"No slot found in DFP event.");return}if(F.advertiserId&&z.DFP.directAdvertisers.indexOf(F.advertiserId)>-1){p.frozenSlots.push(G)}var E=WH.ge("ad-"+G);if(!E){WH.debug('Div for DFP unit "'+G+'" not found!');var D=G==="skin"?null:'Div for DFP unit "'+G+'" not found!';B(F,G,D);return}B(F,G);q(G,E,F.size[0],F.size[1]);var C=WH.ce("a",{text:LANG.Ads.report,className:"block-report",onclick:(function(I,H){PageTemplate.expandSite();ContactTool.show();$('select[name="reason"]').val(9);setTimeout(function(){$('input[name="email"]').focus()},1)}).bind(null,E,G)});WH.ae(E,C)};this.getDfpLog=function(){var C=WH.localStorage.get("dfpLog");if(C){try{C=JSON.parse(C)}catch(D){}}if(typeof C!=="object"||!(C instanceof Array)){return[]}return C};function B(F,H,E){var C={_time:(new Date).toUTCString(),_env:j(),_slot:H,_channelName:WAS.getChannelName(),_channelGroup:WAS.getChannelGroup()};if(E){C._error=E}for(var G in F){if(F.hasOwnProperty(G)&&((typeof F[G]!=="object"||!F[G])||G==="size")){C[G]=F[G]}}var D=(WAS.getDfpLog()).slice(0,z.DFP.maxLogCount-1);D.unshift(C);WH.localStorage.set("dfpLog",JSON.stringify(D))}function n(C){for(var D in C){if(C.hasOwnProperty(D)){if(typeof C[D]==="object"){var G=n(C[D]);if(typeof G==="string"){return G}}else{if(typeof C[D]==="string"&&C[D].match(/^\/76136274\//)){for(var F in z.DFP.slots){if(z.DFP.slots.hasOwnProperty(F)){for(var E in z.DFP.slots[F]){if(z.DFP.slots[F].hasOwnProperty(E)&&z.DFP.slots[F][E].path===C[D]){return E}}}}}}}}return null}function q(I,J,D,K){var E=o(J);if(!E){return}D=parseInt(D);K=parseInt(K);E.className=E.className.replace(/ *\bis-[0-9]+x[0-9]+\b/g,"");E.className+=" is-"+D+"x"+K;l(I,E);l(I,E,true);if(I==="mobileFooter"){var F=document.createElement("a");F.className="mobile-dashboard-closer";F.onclick=function(){var L=this.parentNode;L.parentNode.removeChild(L)};E.appendChild(F)}var C=D+"x"+K;if(D===728||D===970){var G=E.parentNode.parentNode;G.setAttribute("data-contains-block",C);if(G.parentNode&&G.parentNode.parentNode&&G.parentNode.parentNode.parentNode&&G.parentNode.parentNode.parentNode.setAttribute){G.parentNode.parentNode.parentNode.setAttribute("data-contains-block",C)}}else{if(typeof I==="string"&&I.match(/^vertical/)){var H=$(J).parents("#sidebar");if(H.length){H.attr("data-contains-sidebar-block",C);$("#layout").attr("data-contains-sidebar-block",C);WH.updateContentHeight()}}}}this.remove=function(I,H){if(!I){return}var G=I.parentNode;if(!G){return}if(!H){var E=o(I);var C=$(E);for(var D in z.units){if(z.units.hasOwnProperty(D)&&z.units[D].applyClasses&&z.units[D].applyClasses.parent&&z.units[D].applyClasses.parent[0]){var F=C.closest("."+z.units[D].applyClasses.parent[0].split(" ").join("."));if(F.length){H=D;break}}}}G.removeChild(I);switch(H){case"horizontal":case"horizontalBTF":$(G).closest(".blocks").remove();break}};this.removeSkin=function(){if(document.body.className){document.body.className=document.body.className.replace(new RegExp(" "+z.skins.bodyClass+"(-[^ ]+)?"),"")}$("#skin-wrap").empty()};this.removeAll=function(){p.removed=true;var I=333;var E=$("#main > .blocks, #wrapper > .blocks, #page-content > .blocks");E.slideUp({complete:function(){E.remove();$(".horizontal-block-bg, .header-block-bg, .footer-block-bg").remove()},duration:I});$(".sidebar").animate({top:"0px"},I,false);var C=$(".block-block-bg");C.slideUp({complete:function(){C.remove();C.parent(":empty").remove()},duration:I});var H=false;var G=WH.ge("sidebar");if(G){for(var D=0,J;J=G.childNodes[D];D++){if(J.nodeType===Node.TEXT_NODE&&(!J.nodeValue||!J.nodeValue.trim())){WH.de(J)}}for(var D=0,J;J=G.childNodes[D];D++){if(J.getAttribute&&!J.getAttribute("data-was-parent")&&J.className!="top-sidebar-infobox"){H=true;break}}}var F=$(".vertical-block-bg, .sidebar-block-bg, #ds-box");if(H){F.slideUp({complete:function(){F.remove()},duration:I})}else{F.remove()}setTimeout(function(){$("[data-contains-block]").removeAttr("data-contains-block");$("[data-left-contains-block]").removeAttr("data-left-contains-block")},I+1)};this.display=function(D,C){var E=document.getElementById("ad-"+C);if(!WAS.checkCreateConditions(D,"ad-"+C)||!WAS.showAds()||WAS.isHidden(E,true)){WAS.remove(WH.ge("ad-"+C).parentNode,D);return}if(WAS.getProvider()==="DFP"){WAS.create(D,E)}};this.displaySkin=function(O){if(!WAS.checkCreateConditions("skin",null)){return false}var M=z.skins;var J=document.getElementById(M.classPrefix+"-wrap");if(J){J.innerHTML=""}else{J=document.body}var P="H";if(O.sidesOnly){P="sides-only"}else{if(O.usePageLeaderboard){P+=" "+M.classPrefix+"-use-page-leaderboard"}}document.body.className+=" "+M.bodyClass+" "+M.bodyClass+"-"+P;var L=M.classPrefix+"-link-";var F=0;var C=M.linkCount;while(F++<C){var K=J.insertBefore(document.createElement("a"),J.firstChild);K.className=L+F;K.target="_blank";K.href=O.link;K.style.backgroundImage="url("+O.image+")"}var I=function(U,T,S){var R=T.insertBefore(document.createElement("img"),T.firstChild);R.className=U.classPrefix+"-pixel";R.src=S};switch(typeof O.impressionTracking){case"string":I(M,J,O.impressionTracking);break;case"object":for(var E in O.impressionTracking){if(O.impressionTracking.hasOwnProperty(E)&&typeof O.impressionTracking[E]=="string"){I(M,J,O.impressionTracking[E])}}break}var G=O.splitHeight||90;if(O.superLeaderboard){var H=O.superLeaderboardHeight||"90";var Q=O.superLeaderboardWidth||"970";G=H;var N=J.insertBefore(document.createElement("div"),J.firstChild);N.className=M.classPrefix+"-"+Q+"x"+H;var D=document.createElement("iframe");D.src=O.superLeaderboard;D.marginWidth=D.marginHeight=D.hspace=D.vspace=D.frameBorder=D.frameborder=D.border=0;D.style.height=H+"px";D.style.width=Q+"px";D.scrolling="no";N.appendChild(D)}document.body.className+=" "+M.bodyClass+"-height-"+G;WAS.postSkinSetup.call(WAS,O,J);WH.Track.nonInteractiveEvent("Skin","Skin Displayed",O.creative,O.lineItem);WAS.displaySkin=function(R){WH.Track.nonInteractiveEvent("Skin","Extraneous Skin Display Attempt",R.creative,R.lineItem)};return true};this.make3rdPartySkinAdjustments=function(D){if(!m()){return}var C=z.skins;document.body.className+=" "+C.bodyClass3rdParty};this.postSkinSetup=function(F,G){var E=$("#distroscale-original-position");if(E.length){$("#sidebar").append(E)}if(!F.usePageLeaderboard&&!F.sidesOnly){$("#main > .blocks").remove()}WH.updateContentHeight();for(var C=0,D;D=p.postSkinSetupCallbacks[C];C++){D(F,G)}};this.intersect=function(H,I){var J;var G;var D=this.getUnitParents();for(var E=0,C=D.length;E<C;++E){var F=D[E];if(F){if(!f(F)){J=WH.ac(F);G=WH.createRect(J.x,J.y,F.offsetWidth,F.offsetHeight);if(WH.intersectRect(H,G)){if(I){this.hide(F)}return F}}}}return false};this.getUnitClasses=function(){var C=[];for(var D in z.units){if(z.units[D].applyClasses&&z.units[D].applyClasses.parent&&C.indexOf(z.units[D].applyClasses.parent[0])==-1){C.push(z.units[D].applyClasses.parent[0])}}this.getUnitClasses=(function(E){return E}).bind(null,C);return C};this.getUnitParents=function(){return $("."+(this.getUnitClasses()).join(", ."))};this.isHidden=function(D,C){return f(D,C)};this.hide=function(D){var C=o(D);C.setAttribute("data-hidden-by-was","true")};this.hideAll=function(){var C=this.getUnitParents();C.attr("data-hidden-by-was","true")};this.restoreHidden=function(){$('[data-hidden-by-was="true"]').attr("data-hidden-by-was","false")};function y(){return Platform.getViewportWidth()<768}function v(){return Platform.getViewportWidth()>=748}function k(){return Platform.getViewportWidth()>1200}function m(){return Platform.getViewportWidth()>=1250}function o(G){if(G.getAttribute("data-was-unit")=="true"){return G.parentNode}if(G.getAttribute("data-was-parent")=="true"){return G}if(G.parentNode.getAttribute("data-was-unit")=="true"){return G.parentNode.parentNode}if(G.parentNode.getAttribute("data-was-parent")=="true"){return G.parentNode}if(G.className){var E=WAS.getUnitClasses();var C=false;if(E.indexOf(G.className)>-1){C=true}if(!C){for(var D=0,F;F=E[D];D++){if(G.className.indexOf(F)>-1){C=true;break}}}if(!C){return G.parentNode}}else{return G.parentNode}return G}function f(E,D){var C=o(E);if(C){if(D){return C.style.visibility=="hidden"}else{return C.getAttribute("data-hidden-by-was")=="true"}}return false}function h(){var C=WH.isBlizzardReferral();var E=WH.localStorage.get("blizz-skin-suppression");if(E){E=parseInt(E);var D=Date.now?Date.now():new Date().getTime();if(!isNaN(E)&&E>D&&E<D+z.blizzardGracePeriod+(1000*20)){C=true}else{WH.localStorage.remove("blizz-skin-suppression")}}h=(function(F){return F}).bind(null,C);return C}var u=WH.isBlizzardReferral();if(u){var b=Date.now?Date.now():new Date().getTime();WH.localStorage.set("blizz-skin-suppression",b+z.blizzardGracePeriod);if(u=="brl"){var t=(""+location.href).replace(/[\?&]brl=[^\?&#]*/,"").replace(/[\?&]brl\b/,"").replace(/^(https?:\/\/[^\/]+\/)home$/,"$1");if(window.history&&window.history.replaceState){window.history.replaceState({},"",t)}else{location.replace(t)}}}if(h()){if(typeof ads_prepare=="object"){var c=[];for(var s=0,r;r=ads_prepare[s];s++){if(r.type!="skin"){c.push(r)}}ads_prepare=c}}};function pnetInitSkin(b){WAS.make3rdPartySkinAdjustments(b)}var Ads=new function(){this.displaySkin=function(){return WAS.displaySkin.apply(WAS,Array.prototype.slice.call(arguments,0))}};Ads.site=new function(){this.postSkinSetup=function(){return WAS.postSkinSetup.apply(WAS,Array.prototype.slice.call(arguments,0))}};function wt_getScaleFacetOptions(f,m){var d=[];if(f){for(var h=0,c;c=items_filterConfig.filters[h];h++){if(LANG.traits[c.name]&&f[c.name]){d.push([c.id,f[c.name]])}}}d.sort(function(o,j){return -WH.stringCompare(o[1],j[1])});var k=[],l=[];for(var g=0,n;n=d[g];g++){k.push(n[0]);l.push(n[1])}if(k.length&&l.length){var b={weights:k.join(":"),"weight-values":l.join(":")};if(m){b["gem-quality"]=3}return b}return{}}function wt_getScaleFilter(f,b){var d=wt_getScaleFacetOptions(f,b);if(d.weights&&d["weight-values"]){var c=";";if(b){c="&"}else{if(typeof d["gem-quality"]!="undefined"){c+="gm="+d["gem-quality"]+";"}}c+="weights="+d.weights+(b?"&":";")+"weight-values="+d["weight-values"];return c}return""}function wt_getScaleUrlSegment(f,b){var d=wt_getScaleFacetOptions(f,b);if(d.weights&&d["weight-values"]){var c="";if(!b&&typeof d["gem-quality"]!="undefined"){c+="/gem-quality:"+d["gem-quality"]}c+="/weights:"+d.weights+"/weight-values:"+d["weight-values"];return c}return""}function wt_showClassPresetMenu(F,s,u,g,G,C){if(!(s&&g&&G)){return}var f=[[,LANG.menu_chooseclassspec]];var r="/items";for(var w=0,y;y=items_filterConfig.categories[w];w++){if(y.id==g){r+="/"+y.url;break}}if(g==4&&G){r+="/slot:"+G}var n="";var v="/live-only:on/group-by:"+(g==2?"slot":"source")+"?filter=161;1;0";if(g==2){if(Locale.getName()=="enus"){if(g_item_slots[G]){v+="#"+WH.urlize(g_item_slots[G])}}else{v+="#slot-"+G}}if(g_user.weightscales&&g_user.weightscales.length){var A=[0,LANG.ficustom,,[]];f.push(A);for(var D=0,H;H=g_user.weightscales[D];D++){n=wt_getScaleUrlSegment(H)+"/upgrade-for:"+s;if(u&&u.length){n+="/upgrade-bonuses:"+u.join(":")}A[3].push([H.id,H.name,r+n+v])}}var q=WH.isSet("g_items")&&g_items[s]?g_items[s].specs:null;for(var E in wt_presets){if(!wt_presets.hasOwnProperty(E)){continue}var o=[E,g_chr_classes[E],,[],{className:"c"+E,tinyIcon:"class_"+g_file_classes[E]}];if(q!=null&&q.length>0&&g_chr_specs_by_class[E]){var h=g_chr_specs_by_class[E];var b=false;for(var B in h){if(h.hasOwnProperty(B)&&WH.inArray(q,h[B])!=-1){b=true;break}}if(!b){continue}}f.push(o);var z=0;for(var d in wt_presets[E]){if(!wt_presets[E].hasOwnProperty(d)){continue}o[3].push([,LANG.presets[d]?LANG.presets[d]:WH.sprintf(LANG.presets.ilvlformat.replace("%s","$1"),d)]);for(var t in wt_presets[E][d]){if(!wt_presets[E][d].hasOwnProperty(t)){continue}b=(q==null||q.length==0);if(!b){for(var m in q){if(q.hasOwnProperty(m)&&LANG.presets[t].indexOf(g_chr_specs[q[m]])!=-1){b=true;break}}}if(b){n="/class:"+E+wt_getScaleUrlSegment(wt_presets[E][d][t])+"/upgrade-for:"+s;if(u&&u.length){n+="/upgrade-bonuses:"+u.join(":")}o[3].push([z,LANG.presets[t],r+n+v,,{tinyIcon:wt_presets[E][d][t].__icon}]);z++}}}}Menu.sort(f);Menu.show(f,F)}WH.Wow=new function(){this.getVersionStringFromTimestamp=function(b){return(WH.Wow.getPatchVersionObject(b)).version};this.getPatchVersionObject=function(f){var b=false;if(!f){f=Date.now();b=true}var d="?????";var c={build:999999,timestamp:9999999999999,version:d,versionNum:999999};for(var h in g_wow_builds){if(!g_wow_builds.hasOwnProperty(h)){continue}var g=g_wow_builds[h];if((g.timestamp<=f)&&(c.version=="?????"||c.build<g.build)){c=g}}if(WH.isDev()&&c.version===d){if(b){WH.error("Could not find a build for the current time!",f,"Builds:",g_wow_builds)}else{WH.error("Could not find a build for timestamp "+f+"!","Builds:",g_wow_builds)}}return c};this.getVersionStrFromNum=function(b){b=parseInt(b);if(isNaN(b)){return""}return Math.floor(b/10000)+"."+Math.floor((b%10000)/100)+"."+(b%100)}};(function(){var g="//";var c=location.pathname+location.search+location.hash;var f=Locale.getId();var d=[];var j=null;$.each(Locale.getAllByName(),function(l,k){var m={type:"link",innerHTML:k.description,href:g+k.domain+c};if(k.id==f){m.checked=true;j=k}d.push(m)});var b=function(m,l,k){return k};var h=function(m,l,k){return !k};ZUL.setOptions({site:"wowhead",bodyIsRelative:false,mobileLoadCheck:PageTemplate.Responsive.check,mobileWidthCheck:PageTemplate.Responsive.check,mobileBackText:LANG.back_verb,mobileIconSpacing:true,states:{loggedOut:{pre:[{type:"custom",custom:function(n,m,k){var l=WH.ce("span");l.id=l.className="zul-bar-"+(k?"mobile":"user")+"-item-loginwith";l.innerHTML=LANG.zul_loginwith;WH.ae(n,l)},condition:h},{type:"link",name:"battlenet",innerHTML:"Battle.net",href:WH.getRelativeHostPrefix()+"/account=battlenet?r=1",className:function(n,m,l,k){return l?"blizzard-blue":"btn btn-site"},click:function(){WH.visitUrlWithPostData(WH.getRelativeHostPrefix()+"/account=battlenet",{r:1});return false},condition:h},{type:"link",name:"zam",innerHTML:"<span>ZAM</span>",href:WH.getLoginUrl(),className:function(n,m,l,k){return l?"zam-silver":"btn btn-site"},condition:h},{type:"custom",custom:function(p,n,k){p.style.paddingLeft="32px";var m=WH.ce("span");m.id=m.className="zul-bar-mobile-loginwithcolon";m.innerHTML=LANG.zul_loginwith;WH.ae(p,m);m=WH.ce("span");m.id=m.className="zul-bar-mobile-logincolon";m.innerHTML=LANG.zul_login+LANG.colon;WH.ae(p,m);var o=WH.ce("a",{id:"zul-bar-mobile-battlenet",className:"zul-bar-mobile-item-battlenet btn btn-site",innerHTML:"Battle.net",href:WH.getRelativeHostPrefix()+"/account=battlenet"});WH.aE(o,"tap",function(){WH.visitUrlWithPostData(WH.getRelativeHostPrefix()+"/account=battlenet",{r:1});return false});WH.ae(p,o);var l=WH.ce("a",{id:"zul-bar-mobile-zam",className:"zul-bar-mobile-item-zam btn btn-site",innerHTML:"<span>ZAM</span>",href:WH.getLoginUrl()});WH.aE(l,"tap",function(){WH.goToLoginPage();return false});WH.ae(p,l)},condition:b},{type:"link",name:"register",innerHTML:LANG.zul_register,href:WH.getRelativeHostPrefix()+"/account=signup"},{type:"link",name:"get-premium",innerHTML:LANG.zul_premium,href:"/premium",fontIcon:"star"}]},loggedIn:{pre:[{type:"link",name:"favorites",innerHTML:LANG.favorites,href:"javascript:;",className:"hassubmenu",menu:{mobile:function(){return Menu.prepareForZul(Favorites.getMenu())}},condition:function(m,l,k){return !k||Favorites.hasFavorites()}},{type:"custom",custom:function(p,n,k){if(!n.user.battlenetAvatar){return}var l="/user="+n.user.name;if(n.user.favoriteList){var o=li_getCurrentUserList(n.user.favoriteList);if(o){l=li_generateListUrl(o)}else{l="/list="+n.user.favoriteList}}var m=Icon.create(n.user.battlenetAvatar,1,null,l);m.id="zul-bar-"+(k?"mobile":"user")+"-item-avatar";m.className+=" "+m.id;WH.ae(p,m)},condition:h},{type:"link",name:"user",innerHTML:function(m,l,k){if(k){return l.user.name+" <small>("+WH.numberFormat(l.user.reputation)+" "+LANG.reputation+")</small>"}else{return l.user.name}},href:function(m,l,k){return k?null:"/user=%NAME%"},mobileMenuText:"%NAME%",menu:{mobile:Menu.prepareForZul(PageTemplate.getUserMenu())}},{type:"custom",custom:function(o,n,k){var m=WH.ce("span");m.id=m.className="zul-bar-"+(k?"mobile":"user")+"-item-reputation";m.title=LANG.reputationtip;WH.ae(m,WH.ct("("));var l=WH.ce("a");l.href="/reputation";l.innerHTML=WH.numberFormat(n.user.reputation);WH.ae(m,l);WH.ae(m,WH.ct(")"));WH.ae(o,m)},condition:h},{type:"link",name:"characters",innerHTML:LANG.li_myprofiles,menu:{mobile:Menu.prepareForZul(PageTemplate.getListsSubmenu())},condition:b},{type:"link",name:"upgrade",innerHTML:LANG.zul_upgrade,href:"/premium",fontIcon:"arrow-up",condition:function(m,l,k){return !l.user.premium}}]},universal:{pre:[{type:"link",name:"mobileheader",href:"/",heading:true,condition:b},{type:"concatenation",content:function(m,l,k){return b(m,l,k)?Menu.prepareForZul(mn_featuredContent,b):[]},condition:function(m,l,k){return k}},{type:"link",text:LANG.zul_nav,heading:true,condition:function(m,l,k){return k}},{type:"concatenation",content:function(m,l,k){return b(m,l,k)?Menu.prepareForZul(Menu.getMenu(),b):[]},condition:b},{type:"link",text:"",heading:true,condition:b}],content:[{type:"link",name:"feedback",innerHTML:LANG.zul_feedback,href:"javascript:;",fontIcon:"envelope",click:function(){ZUL.closeMobileMenu();ContactTool.show()}},{type:"link",name:"locale",innerHTML:j?j.description:LANG.zul_language,href:"javascript:;",mobileMenuText:LANG.zul_language,menu:{mobile:d}},{type:"link",name:"subsite",innerHTML:function(n,m,k){var l=LANG.zul_live;if(WH.isPtr()){l=LANG.zul_ptr}else{if(WH.isBeta()){l=LANG.zul_beta}}return WH.sprintf(LANG.zul_viewingdata,"<b>"+l+"</b>")},condition:function(m,l,k){return k&&(WH.isPtrActive()||WH.isBetaActive())},mobileMenuText:LANG.zul_changedataview,menu:{mobile:[{type:"link",innerHTML:WH.sprintf(LANG.zul_data,LANG.zul_live),href:window.location.protocol+"//www.wowhead.com"+window.location.pathname+(window.location.hash?"#"+window.location.hash:""),checked:function(m,l,k){return !WH.isPtr()&&!WH.isBeta()}},{type:"link",innerHTML:WH.sprintf(LANG.zul_data,LANG.zul_ptr),href:window.location.protocol+"//ptr.wowhead.com"+window.location.pathname+(window.location.hash?"#"+window.location.hash:""),checked:function(m,l,k){return WH.isPtr()},condition:function(m,l,k){return WH.isPtrActive()}},{type:"link",innerHTML:WH.sprintf(LANG.zul_data,LANG.zul_beta),href:window.location.protocol+"//beta.wowhead.com"+window.location.pathname+(window.location.hash?"#"+window.location.hash:""),checked:function(m,l,k){return WH.isBeta()},condition:function(m,l,k){return WH.isBetaActive()}}]}}],post:[{type:"sites",text:LANG.zul_zamsites}],mobileBarContent:[{type:"form",name:"search",action:"/search",method:"get",fields:[{type:"text",name:"q",label:WH.TERMS.searchGuidesNewsDatabase_stc_ellipsis,value:function(){var k=function(){var l=$(".header-search form input");if(!l.length){setTimeout(k,5);return}$("#zul-bar-form-q").val(l.val()||"")};k();setTimeout(function(){LiveSearch.attach($("#zul-bar-form-search-q"))},0);return""},focus:function(){document.body.scrollTop=0;document.body.scrollLeft=0;var k=WH.ge("zul-bar");k.style.position="absolute";setTimeout(function(){document.body.scrollTop=0;document.body.scrollLeft=0;var l=document.createElement("div");l.className="zul-bar-fade zul-bar-fade-body-only";l.onclick=function(){this.parentNode.removeChild(this)};$("#zul-bar").append(l)},5)},blur:function(){$(".zul-bar-fade.zul-bar-fade-body-only").remove();var k=WH.ge("zul-bar");k.style.position="fixed"}}]},{type:"link",name:"share",className:"fa fa-share-square-o",click:function(){var k=location.href;var l=[[,WH.TERMS.shareon_colon],[0,LANG.twitter,PageTemplate.getShareUrl("twitter",k),undefined,{fontIcon:"twitter",newWindow:true}],[1,LANG.facebook,PageTemplate.getShareUrl("facebook",k),undefined,{fontIcon:"facebook-official",newWindow:true}],[2,LANG.reddit,PageTemplate.getShareUrl("reddit",k),undefined,{fontIcon:"reddit-alien",newWindow:true}],[3,LANG.googleplus,PageTemplate.getShareUrl("google",k),undefined,{fontIcon:"google-plus",newWindow:true}]];Menu.show(l,this)}}]}},onCreateBar:function(){PageTemplate.initUserMenus()},onShowMobileBarStart:function(){Menu.hide()}})})();WH.Admin.Guide=function(){};WH.Tools.Bloodmallet=new function(){this.loadCharts=function(){if(typeof window.Highcharts!=="object"){WH.error("Can't load Bloodmallet charts because the Highcharts library isn't available.");return}if(typeof window.bloodmallet_charts!=="object"){$.getScript(g_staticUrl+"/js/3rd-party/bloodmallet_chart_import.js?2018-08-28",b)}else{b()}WH.Tools.Bloodmallet.loadCharts=function(){b()}};this.updateChartsSizes=function(d){var f=[];$(d).find(".bloodmallet_chart[data-highcharts-chart]").each(function(){f.push(this.getAttribute("data-highcharts-chart"))});if(f.length>0){WH.Tools.Highcharts.updateSizes(f)}};function b(){$(".bloodmallet_chart").each(function(){if(typeof $(this).attr("data-highcharts-chart")==="undefined"){bloodmallet_chart_import();return false}});setTimeout(c,9);$(window).resize(WH.Tools.Highcharts.updateSizes)}function c(){var f=0;var d=[];$(".bloodmallet_chart").each(function(){var g=this.getAttribute("data-highcharts-chart");if(g!==""){d.push(g)}else{f++}});if(d.length>0){WH.Tools.Highcharts.updateSizes(d)}if(f>0){setTimeout(c,9*f)}}};WH.Tools.Highcharts=new function(){var c={};var d=50;this.loadScript=function(f){if(typeof window.Highcharts!=="object"){$.getScript(g_staticUrl+"/js/highcharts.js",f)}else{f()}WH.Tools.Highcharts.loadScript=function(g){g()}};this.updateSizes=function(h){if(typeof Highcharts==="undefined"||!WH.isArray(Highcharts.charts)){return 0}var m=0;if(WH.isArray(h)){for(var k=0,g;g=h[k];k++){if(Highcharts.charts[g]){b(Highcharts.charts[g]);m++}}}else{for(var f=0,l;l=Highcharts.charts[f];f++){b(l);m++}}return m};function b(f){clearTimeout(c[f.index]);c[f.index]=setTimeout(function(){f.setSize(null,null)},d)}};var g_artifact_knowledge_max_level=55;var g_file_races={10:"bloodelf",11:"draenei",3:"dwarf",7:"gnome",1:"human",4:"nightelf",2:"orc",6:"tauren",8:"troll",5:"scourge",9:"goblin",22:"worgen",24:"pandaren",25:"pandaren",26:"pandaren",27:"nightborne",28:"highmountaintauren",29:"voidelf",30:"lightforgeddraenei",31:"zandalaritroll",32:"kultiran",34:"darkirondwarf",36:"magharorc",12:"felorc",13:"naga",14:"broken",15:"skeleton",16:"vrykul",17:"tuskarr",18:"foresttroll",19:"taunka",20:"northrendskeleton",21:"icetroll",23:"gilnean",33:"thinhuman",35:"vulpera"};var g_file_classes={6:"deathknight",12:"demonhunter",11:"druid",3:"hunter",8:"mage",10:"monk",2:"paladin",5:"priest",4:"rogue",7:"shaman",9:"warlock",1:"warrior"};var g_file_genders={0:"male",1:"female"};var g_file_factions={1:"alliance",2:"horde"};var g_file_racefactions={10:2,11:1,3:1,7:1,1:1,4:1,2:2,6:2,8:2,5:2,9:2,22:1,24:3,25:1,26:2,27:2,28:2,29:1,30:1,31:2,32:1,34:1,36:2};var g_npc_races=[12,13,14,15,16,17,18,19,20,21,23,33,35];var g_race_genders={12:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,33:0};var g_file_race_upright={2:{0:"uprightorc"},36:{0:"uprightmagharorc"}};var g_race_classes={1:[1,2,3,4,5,6,8,9,10],2:[1,3,4,6,7,8,9,10],3:[1,2,3,4,5,6,7,8,9,10],4:[1,3,4,5,6,8,10,11,12],5:[1,3,4,5,6,8,9,10],6:[1,2,3,5,6,7,10,11],7:[1,3,4,5,6,8,9,10],8:[1,3,4,5,6,7,8,9,10,11],9:[1,3,4,5,6,7,8,9],10:[1,2,3,4,5,6,8,9,10,12],11:[1,2,3,5,6,7,8,10],22:[1,3,4,5,6,8,9,11],24:[1,3,4,5,7,8,10],25:[1,3,4,5,7,8,10],26:[1,3,4,5,7,8,10],27:[1,3,4,5,8,9,10],28:[1,3,7,10,11],29:[1,3,4,5,8,9,10],30:[1,2,3,5,8],31:[1,3,7,11],32:[1],34:[1,2,3,4,5,7,8,9,10],36:[1,3,4,5,7,8,10]};var g_class_races={1:[1,2,3,4,5,6,7,8,9,10,11,22,24,25,26,27,28,29,30,31,32,34,36],2:[1,3,6,10,11,30,34],3:[1,2,3,4,5,6,7,8,9,10,11,22,24,25,26,27,28,29,30,31,34,36],4:[1,2,3,4,5,7,8,9,10,22,24,25,26,27,29,34,36],5:[1,3,4,5,6,7,8,9,10,11,22,24,25,26,27,29,30,34,36],6:[1,2,3,4,5,6,7,8,9,10,11,22],7:[2,3,6,8,9,11,24,25,26,28,31,34,36],8:[1,2,3,4,5,7,8,9,10,11,22,24,25,26,27,29,30,34,36],9:[1,2,3,5,7,8,9,10,22,27,29,34],10:[1,2,3,4,5,6,7,8,10,11,24,25,26,27,28,29,34,36],11:[4,6,8,22,28,31],12:[4,10]};var g_class_forums={6:18,12:29,11:3,3:4,8:6,10:28,2:7,5:8,4:5,7:9,9:10,1:11};var g_file_gems={1:"meta",2:"red",4:"yellow",6:"orange",8:"blue",10:"purple",12:"green",14:"prismatic",16:"hydraulic",32:"cogwheel"};var g_chr_specs_by_class={12:["577","581"],6:["250","251","252"],11:["102","103","104","105"],3:["253","254","255"],8:["62","63","64"],10:["268","270","269"],2:["65","66","70"],5:["256","257","258"],4:["259","260","261"],7:["262","263","264"],9:["265","266","267"],1:["71","72","73"]};var g_battlepet_types={1:"humanoid",2:"dragonkin",3:"flying",4:"undead",5:"critter",6:"magic",7:"elemental",8:"beast",9:"aquatic",10:"mechanical"};var g_battlepet_passives={1:238,2:245,3:239,4:242,5:236,6:243,7:241,8:237,9:240,10:244};var g_skill_recipe_subclass={171:6,164:4,185:5,333:8,202:3,356:9,773:11,755:10,165:1,186:12,197:2};var g_skill_recipe_subclass_url={171:"alchemy",164:"blacksmithing",185:"cooking",333:"enchanting",202:"engineering",356:"fishing",773:"inscription",755:"jewelcrafting",165:"leatherworking",186:"mining",197:"tailoring"};var g_world_bosses={71953:true,62346:true,60491:true,72057:true,69099:true,69161:true,71952:true,71954:true,71955:true};var g_grayedOutStats={3:[250,251,252,102,105,62,63,64,270,65,66,70,256,257,258,262,264,265,266,267,71,72,73],4:[102,103,104,105,253,254,255,62,63,64,268,270,269,65,256,257,258,259,260,261,262,263,264,265,266,267],5:[71,72,73,259,260,261,253,254,255,103,104,250,251,252,66,70,263,268,269],6:[250,251,252,102,103,104,253,254,255,62,63,64,268,269,66,70,258,259,260,261,262,263,265,266,267,71,72,73],50:[251,252,102,103,105,253,254,255,62,63,64,270,269,65,70,256,257,258,259,260,261,262,263,264,265,266,267,71,72]};var g_specDependantStats=[71,72,73,74];var g_specPrimaryStatOrders={62:[5,3,4],63:[5,3,4],64:[5,3,4],65:[5,4,3],66:[4,3,5],70:[4,3,5],71:[4,3,5],72:[4,3,5],73:[4,3,5],102:[5,3,4],103:[3,4,5],104:[3,4,5],105:[5,3,4],250:[4,3,5],251:[4,3,5],252:[4,3,5],253:[3,5,4],254:[3,5,4],255:[3,5,4],256:[5,3,4],257:[5,3,4],258:[5,3,4],259:[3,4,5],260:[3,4,5],261:[3,4,5],262:[5,3,4],263:[3,5,4],264:[5,3,4],265:[5,3,4],266:[5,3,4],267:[5,3,4],268:[3,5,4],269:[3,5,4],270:[5,3,4]};var g_spec_to_role={62:2,63:2,64:2,65:1,66:0,70:2,71:2,72:2,73:0,74:2,79:2,81:0,102:2,103:2,104:0,105:1,250:0,251:2,252:2,253:2,254:2,255:2,256:1,257:1,258:2,259:2,260:2,261:2,262:2,263:2,264:1,265:2,266:2,267:2,268:0,269:2,270:1,535:2,536:2,537:0,577:2,581:0};var g_item_slots_to_character_slots={1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:[11,12],12:[13,14],13:[16,17],14:17,15:16,16:15,17:16,18:null,19:19,20:5,21:16,22:17,23:17,24:null,25:null,28:null};var g_character_slots_data=[{id:1,name:"head",itemSlots:[1]},{id:2,name:"neck",itemSlots:[2],noModel:1},{id:3,name:"shoulder",itemSlots:[3]},{id:15,name:"back",itemSlots:[16],iconName:"chest"},{id:5,name:"chest",itemSlots:[5,20]},{id:4,name:"shirt",itemSlots:[4]},{id:19,name:"tabard",itemSlots:[19]},{id:9,name:"wrists",itemSlots:[9]},{id:10,name:"hands",itemSlots:[10]},{id:6,name:"waist",itemSlots:[6]},{id:7,name:"legs",itemSlots:[7]},{id:8,name:"feet",itemSlots:[8]},{id:11,name:"finger",itemSlots:[11],noModel:1,simCraftName:"finger1"},{id:12,name:"finger",itemSlots:[11],noModel:1,simCraftName:"finger2"},{id:13,name:"trinket",itemSlots:[12],noModel:1,simCraftName:"trinket1"},{id:14,name:"trinket",itemSlots:[12],noModel:1,simCraftName:"trinket2"},{id:16,name:"mainhand",itemSlots:[21,13,17,15,25,28],simCraftName:"main_hand"},{id:17,name:"offhand",itemSlots:[22,13,23,14],simCraftName:"off_hand"}];var g_classes_allowed_armor={6:[1,2,3,4,5],12:[1,2,5],11:[1,2,5],3:[1,2,3,5],8:[1,5],10:[1,2,5],2:[1,2,3,4,5,6],5:[1,5],4:[1,2,5],7:[1,2,3,5],9:[1,5],1:[1,2,3,4,5,6]};var g_classes_allowed_weapon={6:[0,1,4,5,6,7,8],12:[0,7,9,13,15],11:[4,5,6,10,13,15],3:[2,3,6,10,18],8:[7,10,15,19],10:[0,4,6,7,10,13],2:[0,1,4,5,6,7,8],5:[4,10,15,19],4:[0,2,3,4,7,13,15,18],7:[0,1,4,5,6,10,13,15],9:[7,10,15,19],1:[0,1,2,3,4,5,6,7,8,10,13,15,18]};var g_character_slots_to_item_slots={1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:11,13:12,14:12,15:16,16:[13,15,17,21],17:[13,14,22,23],19:19};WH.getClassesAlphabetized=function(){var b=[];for(var d=1,c;c=g_chr_classes[d];d++){b.push({id:d,name:c})}b.sort(function(g,f){return WH.stringCompare(g.name,f.name)});return b};WH.getRaceSideSortString=function(c){var b=parseInt(c.side||g_file_racefactions[c.id]);if(b===1){return"alliance"}else{if(b===2){return"horde"}else{if(b===3){return"both"}}}return"npc"};WH.getSpecIndexFromSpecId=function(b){b=b.toString();for(var c in g_chr_specs_by_class){if(g_chr_specs_by_class.hasOwnProperty(c)&&g_chr_specs_by_class[c].indexOf(b)>-1){return g_chr_specs_by_class[c].indexOf(b)+1}}return null};var g_achievements={};var g_affixes={};var g_bfa_champions={};var g_bluetweets={};var g_buildings={};var g_champions={};var g_charts={};var g_classes={};var g_factions={};var g_followers={};var g_gatheredcurrencies={};var g_gatheredzones={};var g_guides={};var g_holidays={};var g_icons={};var g_items={};var g_itemsets={};var g_missionabilities={};var g_missions={};var g_npcs={};var g_objects={};var g_orderadvancements={};var g_outfits={};var g_petabilities={};var g_pets={};var g_quests={};var g_races={};var g_resources={};var g_ships={};var g_skills={};var g_sounds={};var g_spells={};var g_threats={};var g_titles={};var g_transmogsets={};WH.entities.encounters={};WH.data.typeIds={NPC:1,OBJECT:2,ITEM:3,ITEM_SET:4,QUEST:5,SPELL:6,ZONE:7,FACTION:8,PET:9,ACHIEVEMENT:10,TITLE:11,EVENT:12,CLASS:13,RACE:14,SKILL:15,CURRENCY:17,SOUND:19,BUILDING:20,FOLLOWER:21,MISSION_ABILITY:22,MISSION:23,SHIP:25,THREAT:26,RESOURCE:27,CHAMPION:28,ICON:29,ORDER_ADVANCEMENT:30,FOLLOWER_A:31,FOLLOWER_H:32,SHIP_A:33,SHIP_H:34,CHAMPION_A:35,CHAMPION_H:36,TRANSMOG_ITEM:37,AFFIX:40,GUIDE:100,TRANSMOG_SET:101,OUTFIT:110,PET_ABILITY:200};var g_types={1:"npc",2:"object",3:"item",4:"item-set",5:"quest",6:"spell",7:"zone",8:"faction",9:"pet",10:"achievement",11:"title",12:"event",13:"class",14:"race",15:"skill",17:"currency",19:"sound",20:"building",21:"follower",22:"mission-ability",23:"mission",25:"ship",26:"threat",27:"resource",28:"champion",29:"icon",30:"order-advancement",31:"follower_a",32:"follower_h",33:"ship_a",34:"ship_h",35:"champion_a",36:"champion_h",37:"item",38:"bfa-champion",39:"bfa-champion_a",40:"affix",41:"bfa-champion_b",100:"guide",101:"transmog-set",110:"outfit",150:"gallery",200:"pet-ability"};var g_gathered_types={1:g_npcs,2:g_objects,3:g_items,4:g_itemsets,5:g_quests,6:g_spells,7:g_zones,8:g_factions,9:g_pets,10:g_achievements,11:g_titles,12:g_holidays,13:g_classes,14:g_races,15:g_skills,17:g_currencies,19:g_sounds,20:g_buildings,21:g_followers,22:g_missionabilities,23:g_missions,25:g_ships,26:g_threats,27:g_resources,28:g_champions,29:g_icons,30:g_orderadvancements,31:g_followers,32:g_followers,33:g_ships,34:g_ships,35:g_champions,36:g_champions,38:g_bfa_champions,39:g_bfa_champions,40:g_affixes,41:g_bfa_champions,100:g_guides,101:g_transmogsets,110:g_outfits,200:g_petabilities};var g_completion_categories={1:[12],3:[2,4,9,"15-2","15-5"],6:[-5,-6,9,11]};WH.cO(g_items,{add:function(c,b){if(g_items[c]!=null){WH.cO(g_items[c],b)}else{g_items[c]=b}},getIcon:function(h,d,g){var c=g_items[h];var f="inv_misc_questionmark";if(c!=null&&c.icon){f=c.icon}var b=g_items.getAppearance(h,d,g);if(b!=null&&b[1]){f=b[1]}return f},getAppearance:function(b,c,g){var f=null;var d=g_items[b];var k=-1;var h=(d&&d.appearances)?d.appearances:(d&&d.jsonequip&&d.jsonequip.appearances?d.jsonequip.appearances:null);if(g&&h&&h[g]){f=h[g]}else{if(WH.isSet("g_itembonuses")&&c&&c.length>0){for(var l in c){var j=c[l];if(j>0&&g_itembonuses[j]){WH.arrayWalk(g_itembonuses[j],function(m){if(m[0]==7){k=m[1]}})}if(k!=-1&&h&&h[k]){f=h[k];break}}}}return f},createIcon:function(h,c,b,g,d){var f=(d&&d.length>0)?("&bonus="+d.join(":")):"";return Icon.create(g_items.getIcon(h,d),c,null,"/item="+h+f,b,g)},getItemQualityColor:function(c){var b=["9d9d9d","ffffff","1eff00","0070dd","a335ee","ff8000","e5cc80","00ccff","00ccff"];return b[c]}});WH.cO(g_spells,{ZAM_IDS:1000000,add:function(c,b){if(g_spells[c]!=null){WH.cO(g_spells[c],b)}else{g_spells[c]=b}},getIcon:function(b){if(g_spells[b]!=null&&g_spells[b].icon){return g_spells[b].icon}else{return"inv_misc_questionmark"}},createIcon:function(f,c,b,d){return Icon.create(g_spells.getIcon(f),c,null,"/spell="+f,b,d)}});WH.cO(g_petabilities,{add:function(c,b){if(g_petabilities[c]!=null){WH.cO(g_petabilities[c],b)}else{g_petabilities[c]=b}},getIcon:function(b){if(g_petabilities[b]!=null&&g_petabilities[b].icon){return g_petabilities[b].icon}else{return"inv_misc_questionmark"}},createIcon:function(f,c,b,d){return Icon.create(g_petabilities.getIcon(f),c,null,"/pet-ability="+f,b,d)}});WH.cO(g_achievements,{getIcon:function(b){if(g_achievements[b]!=null&&g_achievements[b].icon){return g_achievements[b].icon}else{return"inv_misc_questionmark"}},createIcon:function(f,c,b,d){return Icon.create(g_achievements.getIcon(f),c,null,"/achievement="+f,b,d)}});WH.cO(g_classes,{getIcon:function(b){if(g_file_classes[b]){return"class_"+g_file_classes[b]}else{return"inv_misc_questionmark"}},createIcon:function(f,c,b,d){return Icon.create(g_classes.getIcon(f),c,null,"/class="+f,b,d)}});WH.cO(g_races,{getIcon:function(c,b){if(b===undefined){b=0}if(g_file_races[c]&&g_file_genders[b]){return"race_"+g_file_races[c]+"_"+g_file_genders[b]}else{return"inv_misc_questionmark"}},createIcon:function(f,c,b,d){return Icon.create(g_races.getIcon(f),c,null,"/race="+f,b,d)}});WH.cO(g_skills,{getIcon:function(b){if(g_skills[b]!=null&&g_skills[b].icon){return g_skills[b].icon}else{return"inv_misc_questionmark"}},createIcon:function(f,c,b,d){return Icon.create(g_skills.getIcon(f),c,null,"/skill="+f,b,d)}});WH.cO(g_gatheredcurrencies,{getIcon:function(c,b){if(g_gatheredcurrencies[c]!=null&&g_gatheredcurrencies[c].icon){if(WH.isArray(g_gatheredcurrencies[c].icon)&&!isNaN(b)){return g_gatheredcurrencies[c].icon[b]}return g_gatheredcurrencies[c].icon}else{return"inv_misc_questionmark"}},createIcon:function(f,c,b,d){return Icon.create(g_gatheredcurrencies.getIcon(f,(b>0?0:1)),c,null,null,Math.abs(b),d)}});WH.cO(g_holidays,{getIcon:function(b){if(g_holidays[b]!=null&&g_holidays[b].icon){return g_holidays[b].icon}else{return"inv_misc_questionmark"}},createIcon:function(f,c,b,d){return Icon.create(g_holidays.getIcon(f),c,null,"/event="+f,b,d)}});WH.cO(g_missionabilities,{getIcon:function(b){if(g_missionabilities[b]!=null&&g_missionabilities[b].icon){return g_missionabilities[b].icon}else{return"inv_misc_questionmark"}},createIcon:function(g,d,b,f){var c=Icon.create(g_missionabilities.getIcon(g),d,null,"/mission-ability="+g,b,f);c.className+=" garrison-ability";return c}});WH.getIngameLink=function(b,d,c){c=c.replace(/:+$/,"");return'/script DEFAULT_CHAT_FRAME:AddMessage("\\124c'+b+"\\124H"+d+"\\124h["+c.replace(/"/g,'\\"')+']\\124h\\124r");'};WH.Wow.Item=new function(){};WH.Wow.PlayerClass=new function(){this.specNumToId=function(f,d){if(g_chr_specs_by_class[f]){for(var c=0,b;b=g_chr_specs_by_class[f][c];c++){if(c+1===d){return parseInt(b)}}}else{WH.error("Tried to get a specialization ID from a non-existent class.",f,d)}WH.error("Could not get a specialization ID for this class and spec.",f,d);return null}};WH.Wow.Spell=new function(){var b=6;this.getPath=function(d,c){return WH.Entity.getLegacyPath(b,d,c)}};